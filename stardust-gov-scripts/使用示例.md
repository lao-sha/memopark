# 使用示例

## 示例 1: 批量转账脚本运行示例

### 命令
```bash
node batch-transfer.js
```

### 完整输出示例
```
🚀 批量转账脚本启动

============================================================
✅ 加密库准备完成
✅ 发送账户地址验证通过
   地址: 5CrDBEVDgXUwctSuV8EvQEBo2m187PcxoY36V7H7PGErHUW4

🔌 正在连接节点: ws://127.0.0.1:9944
✅ 已连接 Stardust Development • Stardust Node v1.0.0
   代币: DUST (精度: 12)

💰 检查账户余额...
   可用余额: 1000000.0 DUST

📋 生成转账列表...
============================================================
1. 5CSepuULuCiDSBjeRqr9ZburDSdTwTk5ro9BgV5u1SbHiQh9
   金额: 0.045678 DUST
2. 5CotZ9gD2mLLBQ6sqL2b8gRS1Vxo6HfmRcQ2iu3T825DFgSq
   金额: 0.087234 DUST
3. 5C7RjMrgfCJYyscR5Du1BLP99vFGgRDXjAt3ronftJZe39Qo
   金额: 0.056789 DUST
4. 5CRubhWmwNmJ3z2Ffqs3nf71XQGHBkfKSc1edNvuHZErqvdL
   金额: 0.092345 DUST
============================================================
总转账金额: 0.282046 DUST
总笔数: 4
预估总手续费: 0.000400 DUST
需要总额: 0.282446 DUST
✅ 余额充足

🎯 开始批量转账...
============================================================

[1/4] 转账到 5CSepuULuCiDSBjeRqr9ZburDSdTwTk5ro9BgV5u1SbHiQh9

⚙️  提交转账: 5CSepuULuCiDSBjeRqr9ZburDSdTwTk5ro9BgV5u1SbHiQh9
   金额: 0.045678 DUST
   📦 状态: Ready
   📡 已广播
   ✅ 包含区块: 0x1a2b3c4d5e...
   🎉 最终确认: 0x1a2b3c4d5e...
   ✅ 转账成功！

[2/4] 转账到 5CotZ9gD2mLLBQ6sqL2b8gRS1Vxo6HfmRcQ2iu3T825DFgSq

⚙️  提交转账: 5CotZ9gD2mLLBQ6sqL2b8gRS1Vxo6HfmRcQ2iu3T825DFgSq
   金额: 0.087234 DUST
   📦 状态: Ready
   📡 已广播
   ✅ 包含区块: 0x2b3c4d5e6f...
   🎉 最终确认: 0x2b3c4d5e6f...
   ✅ 转账成功！

[3/4] 转账到 5C7RjMrgfCJYyscR5Du1BLP99vFGgRDXjAt3ronftJZe39Qo

⚙️  提交转账: 5C7RjMrgfCJYyscR5Du1BLP99vFGgRDXjAt3ronftJZe39Qo
   金额: 0.056789 DUST
   📦 状态: Ready
   📡 已广播
   ✅ 包含区块: 0x3c4d5e6f7a...
   🎉 最终确认: 0x3c4d5e6f7a...
   ✅ 转账成功！

[4/4] 转账到 5CRubhWmwNmJ3z2Ffqs3nf71XQGHBkfKSc1edNvuHZErqvdL

⚙️  提交转账: 5CRubhWmwNmJ3z2Ffqs3nf71XQGHBkfKSc1edNvuHZErqvdL
   金额: 0.092345 DUST
   📦 状态: Ready
   📡 已广播
   ✅ 包含区块: 0x4d5e6f7a8b...
   🎉 最终确认: 0x4d5e6f7a8b...
   ✅ 转账成功！

============================================================
📊 批量转账完成
============================================================
✅ 成功: 4 笔
❌ 失败: 0 笔
📝 总计: 4 笔

📋 详细结果:

✅ [1] 5CSepuULuCiDSBjeRqr9ZburDSdTwTk5ro9BgV5u1SbHiQh9
   金额: 0.045678 DUST
   区块: 0x1a2b3c4d5e...

✅ [2] 5CotZ9gD2mLLBQ6sqL2b8gRS1Vxo6HfmRcQ2iu3T825DFgSq
   金额: 0.087234 DUST
   区块: 0x2b3c4d5e6f...

✅ [3] 5C7RjMrgfCJYyscR5Du1BLP99vFGgRDXjAt3ronftJZe39Qo
   金额: 0.056789 DUST
   区块: 0x3c4d5e6f7a...

✅ [4] 5CRubhWmwNmJ3z2Ffqs3nf71XQGHBkfKSc1edNvuHZErqvdL
   金额: 0.092345 DUST
   区块: 0x4d5e6f7a8b...

💰 最终余额查询...
   初始余额: 1000000.0 DUST
   最终余额: 999999.717554 DUST
   实际花费: 0.282446 DUST

👋 脚本执行完成
```

---

## 示例 2: 治理脚本运行示例

### 命令
```bash
node governance-cli.js
```

### 交互流程示例

#### 步骤 1: 选择账户
```
📍 选择要使用的委员会私钥 (↑ ↓ 选择, Enter 确认, Esc 取消)
请选择登录账户
   ↑ ↓ 切换，Enter 确认，Esc 取消

 > 🗳️ 成员 5CrDBEVDgXUwctSuV8EvQEBo2m187PcxoY36V7H7PGErHUW4
   🗳️ 成员 5CSepuULuCiDSBjeRqr9ZburDSdTwTk5ro9BgV5u1SbHiQh9
   🗳️ 成员 5CotZ9gD2mLLBQ6sqL2b8gRS1Vxo6HfmRcQ2iu3T825DFgSq
   返回并退出
```

#### 步骤 2: 连接节点
```
✅ 账户已加载: 5CrDBEVDgXUwctSuV8EvQEBo2m187PcxoY36V7H7PGErHUW4

🔌 正在连接节点: ws://127.0.0.1:9944
✅ 已连接 Stardust Development • Stardust Node v1.0.0
💰 当前余额: 1000000.0 DUST
```

#### 步骤 3: 显示委员会成员身份
```
👥 可进入的委员会:
 - 主委员会 (Council) (成员数 3)
 - 技术委员会 (Technical Committee) (成员数 2)
```

#### 步骤 4: 选择委员会
```
选择要参与的委员会
   ↑ ↓ 切换，Enter 确认，Esc 退出

 > 主委员会 (Council) (成员数 3)
   技术委员会 (Technical Committee) (成员数 2)
   退出脚本
```

#### 步骤 5: 查看做市商申请（主委员会）
```
==============================
进入 主委员会 (Council)
==============================

📊 做市商申请总览
 - #1 状态: PendingReview 拥有者: 5GrwvaEF5zXb26Fz9rcQpDWS57CtERHpNehXCPcNoHGKutQY
     押金: 1000.0 DUST | 提案: 未创建
 - #2 状态: PendingReview 拥有者: 5FHneW46xGXgs5mUiveU4sbTyGBzmstUspZC92UhjJM694ty
     押金: 1000.0 DUST | 提案: 已存在
     投票: 1 赞成 / 0 反对 (阈值 2)
     已投票: 否
```

#### 步骤 6: 选择待处理项目
```
请选择要处理的项目
   ↑ ↓ 切换，Enter 确认，Esc 返回

 > 发起提案 ｜ 做市商 #1 ｜ 暂无投票
   投票 ｜ 做市商 #2 ｜ 投票 1/2
   返回上一层
```

#### 步骤 7: 查看详情并发起提案
```
==============================
做市商申请 #1
------------------------------
状态          : PendingReview
申请人        : 5GrwvaEF5zXb26Fz9rcQpDWS57CtERHpNehXCPcNoHGKutQY
押金          : 1000.0 DUST
提案哈希      : 0xabcdef1234567890...
提案阶段      : 发起提案
==============================

🎯 即将发起提案：审批做市商 #1
   阈值: 2

按 Enter 确认，Esc 取消

⚙️  提交交易: Council 提案
   📦 状态: Ready
   📡 已广播
   ✅ 包含区块: 0x9876543210fedcba...
   🎉 最终确认: 0x9876543210fedcba...
📌 新提案索引: 5 哈希: 0xabcdef1234567890...
```

#### 步骤 8: 投票
```
请选择投票意向
   ↑ ↓ 切换，Enter 确认

 > 赞成 (Aye)
   反对 (Nay)
   返回上一层

🗳️  即将投赞成票 给提案 0xabcdef1234567890...

按 Enter 确认，Esc 取消

⚙️  提交交易: Council 投票 (赞成)
   📦 状态: Ready
   📡 已广播
   ✅ 包含区块: 0xfedcba0987654321...
   🎉 最终确认: 0xfedcba0987654321...
```

#### 步骤 9: 执行提案
```
==============================
做市商申请 #2
------------------------------
状态          : PendingReview
申请人        : 5FHneW46xGXgs5mUiveU4sbTyGBzmstUspZC92UhjJM694ty
押金          : 1000.0 DUST
提案哈希      : 0x1234567890abcdef...
提案阶段      : 执行提案
投票计数      : 赞成 2 / 阈值 2
是否已投票    : 是
提案索引      : 3
==============================

🚀 即将执行提案 0x1234567890abcdef...

按 Enter 确认，Esc 取消

⚙️  提交交易: Council 执行提案
   📦 状态: Ready
   📡 已广播
   ✅ 包含区块: 0x0fedcba987654321...
   🎉 最终确认: 0x0fedcba987654321...
```

---

## 示例 3: 使用环境变量指定节点

### 临时指定节点地址
```bash
STARDUST_WS=ws://192.168.1.100:9944 node batch-transfer.js
```

### 持久设置（Linux/Mac）
```bash
# 编辑 ~/.bashrc 或 ~/.zshrc
export STARDUST_WS=ws://192.168.1.100:9944

# 重新加载配置
source ~/.bashrc

# 运行脚本
node batch-transfer.js
```

---

## 示例 4: 错误处理示例

### 余额不足
```
💰 检查账户余额...
   可用余额: 0.5 DUST

📋 生成转账列表...
============================================================
...
总转账金额: 0.282046 DUST
总笔数: 4
预估总手续费: 0.000400 DUST
需要总额: 0.282446 DUST

❌ 余额不足！
   可用: 0.5 DUST
   需要: 0.282446 DUST
   差额: -0.217554 DUST
```

### 节点连接失败
```
🔌 正在连接节点: ws://127.0.0.1:9944

❌ 发生错误: Connection to ws://127.0.0.1:9944 failed

堆栈跟踪:
Error: Connection to ws://127.0.0.1:9944 failed
    at ...
```

### 地址验证失败
```
✅ 加密库准备完成
❌ 地址验证失败
   期望: 5CrDBEVDgXUwctSuV8EvQEBo2m187PcxoY36V7H7PGErHUW4
   实际: 5Cxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

---

## 示例 5: npm 脚本使用

### 安装依赖
```bash
$ cd /home/xiaodong/文档/stardust/stardust-gov-scripts
$ npm install

added 123 packages, and audited 124 packages in 15s
found 0 vulnerabilities
```

### 运行治理脚本
```bash
$ npm run gov

> stardust-gov-scripts@1.0.0 gov
> node governance-cli.js

📍 选择要使用的委员会私钥 (↑ ↓ 选择, Enter 确认, Esc 取消)
...
```

### 运行批量转账
```bash
$ npm run transfer

> stardust-gov-scripts@1.0.0 transfer
> node batch-transfer.js

🚀 批量转账脚本启动
...
```

---

## 总结

通过以上示例，你可以看到：

1. **批量转账脚本** 是全自动的，运行后自动完成所有转账
2. **治理脚本** 是交互式的，需要通过键盘选择和确认
3. 两个脚本都提供了详细的进度和状态信息
4. 错误处理清晰，便于排查问题
5. 支持环境变量自定义配置

更多详情请参考：
- `README.md` - 完整文档
- `批量转账使用说明.md` - 转账详解
- `快速开始.md` - 快速上手指南

