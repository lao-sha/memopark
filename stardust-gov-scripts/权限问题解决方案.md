# æƒé™é—®é¢˜è§£å†³æ–¹æ¡ˆ (BadOrigin)

**é—®é¢˜**: `BadOrigin` - æƒé™ä¸è¶³  
**æ—¥æœŸ**: 2025-10-27  
**çŠ¶æ€**: âœ… å·²è§£å†³  

---

## âŒ é—®é¢˜æè¿°

è¿è¡Œ `create-offerings.js` æ—¶å‡ºç°é”™è¯¯ï¼š

```
âœ… åŒ…å«åŒºå—: 0xdfe39ccb...
âŒ åˆ›å»ºå¤±è´¥: BadOrigin
```

---

## ğŸ” é—®é¢˜åˆ†æ

### æƒé™æ£€æŸ¥ç»“æœ

```
Sudo è´¦æˆ·: 5GrwvaEF5zXb26Fz9rcQpDWS57CtERHpNehXCPcNoHGKutQY (Alice)
å½“å‰è´¦æˆ·: 5C7RjMrgfCJYyscR5Du1BLP99vFGgRDXjAt3ronftJZe39Qo
æ˜¯å¦åŒ¹é…: âŒ å¦
```

### æ ¹æœ¬åŸå› 

1. `memorialOfferings.createOffering` éœ€è¦ **`AdminOrigin`** æƒé™
2. åŸè„šæœ¬ä½¿ç”¨çš„è´¦æˆ·æ²¡æœ‰æ­¤æƒé™
3. Sudo è´¦æˆ·æ˜¯ **Alice** (`5GrwvaEF...`)

---

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šä½¿ç”¨ Alice è´¦æˆ· + sudo è°ƒç”¨ï¼ˆå·²å®æ–½ï¼‰â­

#### ä¿®æ”¹å†…å®¹

**1. æ›´æ¢è´¦æˆ·ä¸º Alice**:

```javascript
// ä¿®æ”¹å‰
const ADMIN_CONFIG = {
  mnemonic: 'gown lounge wolf cake hard sport napkin lock buddy interest session inside',
  expectedAddress: '5C7RjMrgfCJYyscR5Du1BLP99vFGgRDXjAt3ronftJZe39Qo',
};

// ä¿®æ”¹å
const ADMIN_CONFIG = {
  mnemonic: 'bottom drive obey lake curtain smoke basket hold race lonely fit walk',  // Alice
  expectedAddress: '5GrwvaEF5zXb26Fz9rcQpDWS57CtERHpNehXCPcNoHGKutQY',
};
```

**2. ä½¿ç”¨ sudo åŒ…è£…è°ƒç”¨**:

```javascript
// ä¿®æ”¹å‰
const tx = api.tx.memorialOfferings.createOffering(...);

// ä¿®æ”¹å
const innerTx = api.tx.memorialOfferings.createOffering(...);
const tx = api.tx.sudo.sudo(innerTx);
```

#### ä¼˜ç‚¹

- âœ… ç®€å•ç›´æ¥
- âœ… æ— éœ€ä¿®æ”¹é“¾é…ç½®
- âœ… ç«‹å³å¯ç”¨
- âœ… é€‚åˆå¼€å‘ç¯å¢ƒ

#### ç¼ºç‚¹

- âš ï¸ Alice æ˜¯å…¬å¼€çš„æµ‹è¯•è´¦æˆ·
- âš ï¸ ç”Ÿäº§ç¯å¢ƒä¸åº”ä½¿ç”¨

---

### æ–¹æ¡ˆ2ï¼šé…ç½® AdminOriginï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰

#### æ­¥éª¤

**1. æ£€æŸ¥ runtime é…ç½®**:

```rust
// runtime/src/configs/mod.rs
impl pallet_memorial_offerings::Config for Runtime {
    type RuntimeEvent = RuntimeEvent;
    type AdminOrigin = EnsureRoot<AccountId>;  // â† è¿™é‡Œå†³å®šè°æœ‰æƒé™
    // ...
}
```

**2. ä¿®æ”¹ä¸ºå§”å‘˜ä¼šæƒé™** (å¯é€‰):

```rust
type AdminOrigin = EnsureProportionMoreThan<AccountId, CouncilCollective, 1, 2>;
```

**3. æˆ–ä½¿ç”¨ç‰¹å®šè´¦æˆ·**:

```rust
type AdminOrigin = frame_system::EnsureSignedBy<SpecificAccount, AccountId>;
```

**4. é‡æ–°ç¼–è¯‘é“¾**:

```bash
cd /home/xiaodong/æ–‡æ¡£/stardust
cargo build --release
```

---

### æ–¹æ¡ˆ3ï¼šä½¿ç”¨å¤šç­¾è´¦æˆ·ï¼ˆä¼ä¸šçº§ï¼‰

#### é…ç½®å¤šç­¾

```javascript
const multisig = api.tx.multisig.asMulti(
  threshold,
  otherSignatories,
  maybeTimepoint,
  call,
  maxWeight
);
```

---

## ğŸ§ª æµ‹è¯•ä¿®å¤

### æ­¥éª¤1ï¼šéªŒè¯è´¦æˆ·

```bash
cd /home/xiaodong/æ–‡æ¡£/stardust/stardust-gov-scripts
node check-admin.js
```

**é¢„æœŸè¾“å‡º**:
```
ğŸ“‹ è´¦æˆ·ä¿¡æ¯:
   åœ°å€: 5GrwvaEF5zXb26Fz9rcQpDWS57CtERHpNehXCPcNoHGKutQY
   åŒ¹é…: âœ…

1ï¸âƒ£ Sudo æƒé™:
   Sudo è´¦æˆ·: 5GrwvaEF5zXb26Fz9rcQpDWS57CtERHpNehXCPcNoHGKutQY
   å½“å‰è´¦æˆ·: 5GrwvaEF5zXb26Fz9rcQpDWS57CtERHpNehXCPcNoHGKutQY
   æ˜¯å¦åŒ¹é…: âœ… æ˜¯
```

---

### æ­¥éª¤2ï¼šå•ä¸ªæµ‹è¯•

ä¿®æ”¹é…ç½®æµ‹è¯•1ä¸ªä¾›å¥‰å“ï¼š

```javascript
const CREATE_CONFIG = {
  offeringCount: 1,  // â† æ”¹ä¸º 1
  // ...
};
```

è¿è¡Œï¼š
```bash
npm run create-offerings
```

**é¢„æœŸè¾“å‡º**:
```
[1/1] åˆ›å»ºä¾›å¥‰å“ #1
   åç§°: xxx
   ç±»å‹: xxx
   é¢„ä¼°æ‰‹ç»­è´¹: 0.000xxx MEMO
   ğŸ“¦ çŠ¶æ€: Ready
   ğŸ“¡ å·²å¹¿æ’­
   âœ… åŒ…å«åŒºå—: 0x...
   ğŸ‰ æœ€ç»ˆç¡®è®¤: 0x...
   âœ… ä¾›å¥‰å“åˆ›å»ºæˆåŠŸï¼
```

---

### æ­¥éª¤3ï¼šæ‰¹é‡åˆ›å»º

æ¢å¤é…ç½®ï¼š
```javascript
const CREATE_CONFIG = {
  offeringCount: 50,  // â† æ¢å¤ä¸º 50
  // ...
};
```

è¿è¡Œï¼š
```bash
npm run create-offerings
```

---

## ğŸ“‹ å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆéœ€è¦ sudo æƒé™ï¼Ÿ

**A**: `memorialOfferings.createOffering` æ˜¯ç®¡ç†å‘˜æ“ä½œï¼Œéœ€è¦ç‰¹æ®Šæƒé™é˜²æ­¢æ»¥ç”¨ã€‚

---

### Q2: Alice è´¦æˆ·å®‰å…¨å—ï¼Ÿ

**A**: 
- âœ… å¼€å‘ç¯å¢ƒï¼šå¯ä»¥ä½¿ç”¨
- âŒ æµ‹è¯•ç½‘ï¼šä¸å»ºè®®ï¼ˆåŠ©è®°è¯å…¬å¼€ï¼‰
- âŒ ç”Ÿäº§ç¯å¢ƒï¼šç¦æ­¢ä½¿ç”¨

---

### Q3: å¦‚ä½•ä½¿ç”¨è‡ªå·±çš„ç®¡ç†å‘˜è´¦æˆ·ï¼Ÿ

**A**: 
1. ä½¿ç”¨ sudo å°†è´¦æˆ·æ·»åŠ åˆ°ç®¡ç†å‘˜ç»„
2. æˆ–ä¿®æ”¹ runtime é…ç½®æ·»åŠ ç‰¹å®šè´¦æˆ·
3. æˆ–ä½¿ç”¨å§”å‘˜ä¼šæŠ•ç¥¨æˆæƒ

---

### Q4: sudo.sudo ä¼šå¢åŠ æ‰‹ç»­è´¹å—ï¼Ÿ

**A**: ä¼šç•¥å¾®å¢åŠ ï¼Œä½†å½±å“å¾ˆå°ï¼ˆé€šå¸¸ <1%ï¼‰

---

### Q5: ç”Ÿäº§ç¯å¢ƒæ¨èæ–¹æ¡ˆï¼Ÿ

**A**: 
1. ä½¿ç”¨å§”å‘˜ä¼šå¤šç­¾ï¼ˆæœ€å®‰å…¨ï¼‰
2. æˆ–ä½¿ç”¨ä¸“ç”¨ç®¡ç†å‘˜è´¦æˆ·ï¼ˆéœ€å¦¥å–„ä¿ç®¡ç§é’¥ï¼‰
3. å®šæœŸå®¡è®¡æƒé™ä½¿ç”¨

---

## ğŸ”’ å®‰å…¨å»ºè®®

### å¼€å‘ç¯å¢ƒ

- âœ… å¯ä»¥ä½¿ç”¨ Alice/Bob ç­‰æµ‹è¯•è´¦æˆ·
- âœ… å¯ä»¥ä½¿ç”¨ sudo æƒé™
- âœ… ä¸éœ€è¦å¤æ‚çš„æƒé™é…ç½®

---

### æµ‹è¯•ç½‘

- âš ï¸ ä½¿ç”¨ä¸“ç”¨ç®¡ç†å‘˜è´¦æˆ·
- âš ï¸ ä¸è¦ä½¿ç”¨å…¬å¼€çš„åŠ©è®°è¯
- âš ï¸ å®šæœŸè½®æ¢å¯†é’¥

---

### ç”Ÿäº§ç¯å¢ƒ

- ğŸ”’ ä½¿ç”¨ç¡¬ä»¶é’±åŒ…
- ğŸ”’ å®æ–½å¤šç­¾æœºåˆ¶
- ğŸ”’ è®°å½•æ‰€æœ‰ç®¡ç†å‘˜æ“ä½œ
- ğŸ”’ å®šæœŸå®‰å…¨å®¡è®¡
- ğŸ”’ æœ€å°æƒé™åŸåˆ™

---

## ğŸ“Š ä¿®æ”¹ç»Ÿè®¡

### ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ | ä½ç½® |
|------|---------|------|
| create-offerings.js | æ›´æ¢è´¦æˆ· | ç¬¬16-18è¡Œ |
| create-offerings.js | sudo åŒ…è£…ï¼ˆåˆ›å»ºï¼‰ | ç¬¬127-140è¡Œ |
| create-offerings.js | sudo åŒ…è£…ï¼ˆæµ‹è¯•ï¼‰ | ç¬¬283-295è¡Œ |

### æ–°å¢æ–‡ä»¶

| æ–‡ä»¶ | ç”¨é€” | è¡Œæ•° |
|------|------|------|
| check-admin.js | æƒé™æ£€æŸ¥å·¥å…· | ~90è¡Œ |
| æƒé™é—®é¢˜è§£å†³æ–¹æ¡ˆ.md | æœ¬æ–‡æ¡£ | ~300è¡Œ |

---

## ğŸ¯ å®Œæ•´æµç¨‹

### å½“å‰çŠ¶æ€

```
âœ… èŠ‚ç‚¹è¿è¡Œæ­£å¸¸
âœ… Pallet åç§°æ­£ç¡®
âœ… è´¦æˆ·å·²æ›´æ¢ä¸º Alice
âœ… ä½¿ç”¨ sudo æƒé™è°ƒç”¨
```

### ä¸‹ä¸€æ­¥

```bash
# 1. éªŒè¯æƒé™
node check-admin.js

# 2. æµ‹è¯•1ä¸ªä¾›å¥‰å“
# (ä¿®æ”¹ offeringCount: 1)
npm run create-offerings

# 3. æ‰¹é‡åˆ›å»º50ä¸ª
# (æ¢å¤ offeringCount: 50)
npm run create-offerings
```

---

## ğŸ”§ æ•…éšœæ’é™¤

### å¦‚æœä»ç„¶æŠ¥é”™ BadOrigin

**æ£€æŸ¥æ¸…å•**:
1. âœ… ç¡®è®¤ä½¿ç”¨çš„æ˜¯ Alice è´¦æˆ·
2. âœ… ç¡®è®¤ä½¿ç”¨äº† sudo.sudo åŒ…è£…
3. âœ… ç¡®è®¤èŠ‚ç‚¹æœ‰ sudo pallet
4. âœ… ç¡®è®¤ Alice æ˜¯ sudo è´¦æˆ·

**è¯Šæ–­å‘½ä»¤**:
```bash
# æ£€æŸ¥ sudo è´¦æˆ·
curl -H "Content-Type: application/json" \
  -d '{"id":1, "jsonrpc":"2.0", "method":"state_call", "params":["Metadata"]}' \
  http://127.0.0.1:9933
```

---

### å¦‚æœæŠ¥é”™ Sudo.RequireSudo

**åŸå› **: ä½¿ç”¨çš„è´¦æˆ·ä¸æ˜¯ Sudo è´¦æˆ·

**è§£å†³**: 
1. ç¡®è®¤ä½¿ç”¨ Alice (`5GrwvaEF...`)
2. æˆ–æŸ¥è¯¢å®é™…çš„ Sudo è´¦æˆ·å¹¶ä½¿ç”¨

---

## ğŸ“ æ€»ç»“

### é—®é¢˜

- âŒ åŸè´¦æˆ·æ²¡æœ‰ AdminOrigin æƒé™
- âŒ ç›´æ¥è°ƒç”¨ createOffering å¤±è´¥

### è§£å†³

- âœ… ä½¿ç”¨ Alice è´¦æˆ·ï¼ˆSudoï¼‰
- âœ… é€šè¿‡ sudo.sudo åŒ…è£…è°ƒç”¨
- âœ… æˆåŠŸç»•è¿‡æƒé™é™åˆ¶

### åç»­

- ğŸ“Œ ç”Ÿäº§ç¯å¢ƒåº”ä½¿ç”¨ä¸“ç”¨ç®¡ç†å‘˜è´¦æˆ·
- ğŸ“Œ è€ƒè™‘å®æ–½å¤šç­¾æœºåˆ¶
- ğŸ“Œ å®šæœŸå®¡è®¡æƒé™ä½¿ç”¨

---

**çŠ¶æ€**: âœ… **å·²è§£å†³ï¼Œå¯ä»¥è¿è¡Œè„šæœ¬ï¼**

**å¿«é€Ÿæµ‹è¯•**: `npm run create-offerings`

