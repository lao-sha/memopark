# 做市商配置管理系统

## 📋 概述

本系统为做市商提供了一个统一的 Web 界面，用于管理和更新桥接服务配置、业务配置等信息。

### 核心功能

1. **桥接服务配置管理** 🔧
   - 更新 TRON 地址
   - 调整最大兑换额
   - 修改手续费率

2. **服务状态管理** 🔄
   - 重新启用桥接服务
   - 禁用桥接服务

3. **业务配置管理** 📊
   - 更新公开资料 CID
   - 更新私密资料 CID
   - 调整 OTC 费率
   - 设置最小下单额

---

## 🚀 快速开始

### 访问地址
```
http://127.0.0.1:5173/#/otc/bridge-config
```

### 基本操作

1. **查看配置**：页面会自动加载您的配置信息
2. **更新配置**：只填写需要修改的字段，其他字段留空
3. **提交更新**：点击按钮并输入密码签名
4. **等待确认**：交易成功后自动刷新（约 3 秒）

---

## 📁 文件结构

### 前端组件

```
memopark-dapp/src/features/otc/
├── MakerBridgeConfigPage.tsx    # 配置管理主页面（695 行）
├── MarketMakerConfigPage.tsx    # Epay 配置页面（602 行）
├── CreateMarketMakerPage.tsx    # 做市商申请页面
└── README_做市商配置管理.md     # 本文档
```

### 路由配置

```typescript
// routes.tsx
{ 
  match: h => h === '#/otc/bridge-config', 
  component: lazy(() => import('./features/otc/MakerBridgeConfigPage')) 
}
```

---

## 🎯 功能特性

### 1️⃣ 部分更新机制

- ✅ 只更新有变化的字段
- ✅ 智能检测配置变化
- ✅ 友好的提示信息

### 2️⃣ 押金自动管理

- ✅ 自动计算押金
- ✅ 友好的押金提示
- ✅ 链端自动验证

**押金规则**：
```
押金 = 最大兑换额 × 100 MEMO
```

### 3️⃣ 实时反馈

- ✅ 交易状态实时提示
- ✅ 自动刷新数据
- ✅ 友好的错误提示

### 4️⃣ 表单验证

- ✅ TRON 地址格式验证
- ✅ 金额范围验证
- ✅ 费率范围验证

---

## 🔧 技术实现

### 前端技术栈

- **框架**：React 18 + TypeScript
- **UI 库**：Ant Design 5
- **区块链库**：@polkadot/api
- **签名库**：本地签名（`signAndSendLocalFromKeystore`）

### 链端接口

1. **update_bridge_service**
   - 功能：更新桥接服务配置
   - 参数：`mm_id`, `tron_address?`, `max_swap_amount?`, `fee_rate_bps?`

2. **re_enable_bridge_service**
   - 功能：重新启用桥接服务
   - 参数：`mm_id`

3. **disable_bridge_service**
   - 功能：禁用桥接服务
   - 参数：`mm_id`

4. **update_maker_info**
   - 功能：更新做市商业务配置
   - 参数：`mm_id`, `public_cid?`, `private_cid?`, `fee_bps?`, `min_amount?`

---

## 📚 相关文档

### 用户文档

- [做市商配置管理-快速开始](/home/xiaodong/文档/memopark/docs/做市商配置管理-快速开始.md)
  - 5 分钟上手指南
  - 常用操作演示
  - 常见错误解决

- [做市商配置管理前端使用指南](/home/xiaodong/文档/memopark/docs/做市商配置管理前端使用指南.md)
  - 详细功能说明
  - 完整操作流程
  - 常见问题解答

### 技术文档

- [做市商配置管理前端集成完成报告](/home/xiaodong/文档/memopark/docs/做市商配置管理前端集成完成报告.md)
  - 实施总结
  - 技术实现
  - 测试场景

- [做市商字段维护分析与优化建议](/home/xiaodong/文档/memopark/docs/做市商字段维护分析与优化建议.md)
  - 问题分析
  - 优化建议
  - 实施计划

---

## 🧪 测试

### 测试场景

1. **更新 TRON 地址**
2. **增加最大兑换额（检查押金）**
3. **重新启用桥接服务**
4. **更新业务配置**

详细测试步骤请参考：[做市商配置管理前端集成完成报告](/home/xiaodong/文档/memopark/docs/做市商配置管理前端集成完成报告.md#测试场景)

---

## ⚠️ 注意事项

### 配置更新

1. **部分更新**：只填写需要修改的字段
2. **押金管理**：增加额度需要追加押金
3. **费率限制**：
   - 桥接服务：5-500 bps
   - OTC 费率：10-1000 bps
4. **生效时间**：配置更新后立即生效

### 安全性

1. **密码保护**：所有操作需要输入钱包密码
2. **权限验证**：链端自动验证做市商身份
3. **敏感信息**：私密资料 CID 仅治理审核可见

---

## 📞 联系与支持

如有问题或建议，请：
1. 查看[详细使用指南](/home/xiaodong/文档/memopark/docs/做市商配置管理前端使用指南.md)
2. 查看[常见问题](/home/xiaodong/文档/memopark/docs/做市商配置管理前端使用指南.md#常见问题)
3. 联系开发团队

---

**版本**：v1.0  
**最后更新**：2025-10-19  
**作者**：AI 助手

