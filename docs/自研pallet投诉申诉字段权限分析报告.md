# è‡ªç ”PalletæŠ•è¯‰/ç”³è¯‰å­—æ®µæƒé™åˆ†ææŠ¥å‘Š

> **ç”Ÿæˆæ—¥æœŸ**: 2025-10-27  
> **åˆ†æèŒƒå›´**: æ‰€æœ‰è‡ªç ”palletçš„æŠ•è¯‰(Complaint)ã€ç”³è¯‰(Appeal)ã€äº‰è®®(Dispute)åŠŸèƒ½  

---

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

æœ¬æŠ¥å‘Šè¯¦ç»†åˆ†æäº†Stardustç”Ÿæ€ä¸­æ‰€æœ‰è‡ªç ”palletçš„æŠ•è¯‰ã€ç”³è¯‰å’Œäº‰è®®æœºåˆ¶ï¼Œæ˜ç¡®åˆ—å‡ºäº†**æ™®é€šç”¨æˆ·å¯ä¿®æ”¹çš„å­—æ®µ**å’Œ**æ™®é€šç”¨æˆ·ä¸å¯ä¿®æ”¹çš„å­—æ®µ**ï¼Œç¡®ä¿ç³»ç»Ÿå®‰å…¨æ€§å’Œæ•°æ®å®Œæ•´æ€§ã€‚

---

## ğŸ¯ æ¶‰åŠæŠ•è¯‰/ç”³è¯‰åŠŸèƒ½çš„è‡ªç ”Palletæ¸…å•

| Palletåç§° | åŠŸèƒ½æ¨¡å— | æŠ•è¯‰/ç”³è¯‰ç±»å‹ |
|-----------|---------|-------------|
| pallet-stardust-appeals | é€šç”¨ç”³è¯‰æ²»ç† | ç”³è¯‰(Appeal) |
| pallet-deceased-text | é€è€…æ–‡æœ¬æ‰©å±• | æŠ•è¯‰(Complaint) |
| pallet-deceased-media | é€è€…åª’ä½“æ‰©å±• | æŠ•è¯‰(Complaint) |
| pallet-stardust-grave | å¢“åœ°ç®¡ç† | æŠ•è¯‰(Complaint) |
| pallet-escrow | æ‰˜ç®¡æœåŠ¡ | äº‰è®®(Dispute) |
| pallet-arbitration | å»ä¸­å¿ƒåŒ–ä»²è£ | äº‰è®®(Dispute) |

---

## 1ï¸âƒ£ pallet-stardust-appealsï¼ˆé€šç”¨ç”³è¯‰æ²»ç†æ¨¡å—ï¼‰

### ğŸ“¦ Appealæ•°æ®ç»“æ„

```rust
pub struct Appeal<AccountId, Balance, BlockNumber> {
    pub who: AccountId,                              // ç”³è¯‰äººè´¦æˆ·
    pub domain: u8,                                  // ç”³è¯‰åŸŸ
    pub target: u64,                                 // ç›®æ ‡å¯¹è±¡ID
    pub action: u8,                                  // æ“ä½œç±»å‹
    pub reason_cid: BoundedVec<u8, ConstU32<128>>,  // ç†ç”±CID
    pub evidence_cid: BoundedVec<u8, ConstU32<128>>, // è¯æ®CID
    pub deposit_id: Option<u64>,                     // æŠ¼é‡‘IDï¼ˆPhase 2ï¼‰
    pub deposit: Balance,                            // æŠ¼é‡‘é‡‘é¢ï¼ˆå¾…å¼ƒç”¨ï¼‰
    pub status: u8,                                  // ç”³è¯‰çŠ¶æ€
    pub execute_at: Option<BlockNumber>,             // æ‰§è¡Œå—å·
    pub approved_at: Option<BlockNumber>,            // æ‰¹å‡†æ—¶é—´
    pub new_owner: Option<AccountId>,                // æ–°æ‰€æœ‰è€…ï¼ˆè½¬ç§»åœºæ™¯ï¼‰
}
```

### âœ… **ä»»æ„ç”¨æˆ·å¯ä»¥ä¿®æ”¹çš„å­—æ®µå†…å®¹**

| å­—æ®µå | ä¿®æ”¹æ–¹å¼ | æƒé™è¦æ±‚ | å¯ä¿®æ”¹æ—¶æœº | è¯´æ˜ |
|--------|---------|---------|-----------|------|
| `who` | `submit_appeal()` | ä»»æ„ç­¾åç”¨æˆ· | æäº¤ç”³è¯‰æ—¶ | è‡ªåŠ¨è®°å½•ç”³è¯‰äººè´¦æˆ· |
| `domain` | `submit_appeal()` | ä»»æ„ç­¾åç”¨æˆ· | æäº¤ç”³è¯‰æ—¶ | ç”¨æˆ·æŒ‡å®šç”³è¯‰åŸŸï¼ˆ1-6ï¼‰ |
| `target` | `submit_appeal()` | ä»»æ„ç­¾åç”¨æˆ· | æäº¤ç”³è¯‰æ—¶ | ç”¨æˆ·æŒ‡å®šç›®æ ‡å¯¹è±¡ID |
| `action` | `submit_appeal()` | ä»»æ„ç­¾åç”¨æˆ· | æäº¤ç”³è¯‰æ—¶ | ç”¨æˆ·æŒ‡å®šç”³è¯‰æ“ä½œç±»å‹ |
| `reason_cid` | `submit_appeal()` | ä»»æ„ç­¾åç”¨æˆ· | æäº¤ç”³è¯‰æ—¶ | ç”¨æˆ·æä¾›ç†ç”±CIDï¼ˆIPFSï¼‰ |
| `evidence_cid` | `submit_appeal()` | ä»»æ„ç­¾åç”¨æˆ· | æäº¤ç”³è¯‰æ—¶ | ç”¨æˆ·æä¾›è¯æ®CIDï¼ˆå¿…å¡«ï¼‰ |
| `new_owner` | `submit_owner_transfer_appeal()` | ä»»æ„ç­¾åç”¨æˆ· | æäº¤è½¬ç§»ç”³è¯‰æ—¶ | ä»…ç”¨äºè½¬ç§»æ‰€æœ‰æƒåœºæ™¯ |
| - | `withdraw_appeal()` | **ä»…ç”³è¯‰äººæœ¬äºº** | status=0æ—¶ | æ’¤å›ç”³è¯‰ï¼ˆç½šæ²¡10%æŠ¼é‡‘ï¼‰ |

**âœ¨ ç”¨æˆ·æäº¤ç”³è¯‰çš„é™åˆ¶æ¡ä»¶ï¼š**
- âœ”ï¸ å¿…é¡»æä¾›`evidence_cid`ï¼ˆä¸èƒ½ä¸ºç©ºï¼‰
- âœ”ï¸ `evidence_cid`é•¿åº¦ â‰¥ `MinEvidenceCidLen`ï¼ˆæœ€å°é•¿åº¦ï¼‰
- âœ”ï¸ `reason_cid`ï¼ˆè‹¥æä¾›ï¼‰é•¿åº¦ â‰¥ `MinReasonCidLen`
- âœ”ï¸ é™é¢‘æ§åˆ¶ï¼šæ—¶é—´çª—å£å†…æœ€å¤šæäº¤`MaxPerWindow`æ¬¡
- âœ”ï¸ éœ€å†»ç»“æŠ¼é‡‘ï¼ˆé€šè¿‡`pallet-deposits`ç®¡ç†ï¼‰

### âŒ **æ™®é€šç”¨æˆ·ä¸å¯ä»¥ä¿®æ”¹çš„å­—æ®µå†…å®¹**

| å­—æ®µå | ä¿®æ”¹æ–¹å¼ | æƒé™è¦æ±‚ | è¯´æ˜ |
|--------|---------|---------|------|
| `deposit_id` | ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆ | - | ç”±`pallet-deposits`ç»Ÿä¸€ç®¡ç† |
| `deposit` | ç³»ç»Ÿè‡ªåŠ¨è®¡ç®— | - | æ ¹æ®`AppealDepositPolicy`ç­–ç•¥è®¡ç®— |
| `status` | `approve_appeal()` | **æ²»ç†å§”å‘˜ä¼š/Root** | æ‰¹å‡†ç”³è¯‰ï¼ˆ0â†’1ï¼‰ |
| `status` | `reject_appeal()` | **æ²»ç†å§”å‘˜ä¼š/Root** | é©³å›ç”³è¯‰ï¼ˆ0â†’2ï¼Œç½šæ²¡30%ï¼‰ |
| `execute_at` | `approve_appeal()` | **æ²»ç†å§”å‘˜ä¼š/Root** | æ‰¹å‡†æ—¶è®¾ç½®å…¬ç¤ºåˆ°æœŸæ—¶é—´ |
| `approved_at` | `approve_appeal()` | **æ²»ç†å§”å‘˜ä¼š/Root** | æ‰¹å‡†æ—¶è‡ªåŠ¨è®°å½•å½“å‰å—å· |
| `status` | ç³»ç»Ÿ`on_initialize` | - | åˆ°æœŸè‡ªåŠ¨æ‰§è¡Œï¼ˆ1â†’4ï¼‰ |
| `status` | ç³»ç»Ÿ`on_initialize` | - | é‡è¯•å¤±è´¥ï¼ˆ1â†’5ï¼‰ |
| `status` | ç³»ç»Ÿ`on_initialize` | - | åº”ç­”è‡ªåŠ¨å¦å†³ï¼ˆ1â†’6ï¼‰ |

**âš ï¸ å…³é”®å®‰å…¨æœºåˆ¶ï¼š**
- ğŸ”’ ç”³è¯‰çŠ¶æ€å˜æ›´åªèƒ½ç”±æ²»ç†å§”å‘˜ä¼šæˆ–ç³»ç»Ÿè‡ªåŠ¨è§¦å‘
- ğŸ”’ æ‰§è¡Œæ—¶é—´ç”±æ²»ç†è®¾ç½®ï¼Œç”¨æˆ·æ— æ³•å¹²é¢„
- ğŸ”’ æŠ¼é‡‘ç®¡ç†å®Œå…¨ç”±ç³»ç»Ÿæ§åˆ¶ï¼Œé˜²æ­¢èµ„é‡‘é€ƒé€¸

---

## 2ï¸âƒ£ pallet-deceased-textï¼ˆé€è€…æ–‡æœ¬æŠ•è¯‰æ¨¡å—ï¼‰

### ğŸ“¦ ComplaintCaseæ•°æ®ç»“æ„

```rust
pub struct ComplaintCase<T: Config> {
    pub complainant: T::AccountId,    // æŠ•è¯‰äºº
    pub deposit: BalanceOf<T>,        // æŠ•è¯‰æŠ¼é‡‘
    pub created: BlockNumberFor<T>,   // åˆ›å»ºæ—¶é—´
    pub status: ComplaintStatus,      // æŠ•è¯‰çŠ¶æ€ï¼ˆPending/Resolvedï¼‰
}
```

**æŠ•è¯‰åŸŸï¼š**
- Domain 3: ç”Ÿå¹³ä»‹ç» (Life)
- Domain 4: æ‚¼è¯ (Eulogy)

### âœ… **ä»»æ„ç”¨æˆ·å¯ä»¥ä¿®æ”¹çš„å­—æ®µå†…å®¹**

| å­—æ®µå | ä¿®æ”¹æ–¹å¼ | æƒé™è¦æ±‚ | å¯ä¿®æ”¹æ—¶æœº | è¯´æ˜ |
|--------|---------|---------|-----------|------|
| `complainant` | `complain_life()` | ä»»æ„ç­¾åç”¨æˆ· | æŠ•è¯‰ç”Ÿå¹³æ—¶ | è‡ªåŠ¨è®°å½•æŠ•è¯‰äººè´¦æˆ· |
| `complainant` | `complain_eulogy()` | ä»»æ„ç­¾åç”¨æˆ· | æŠ•è¯‰æ‚¼è¯æ—¶ | è‡ªåŠ¨è®°å½•æŠ•è¯‰äººè´¦æˆ· |

**âœ¨ ç”¨æˆ·æŠ•è¯‰çš„é™åˆ¶æ¡ä»¶ï¼š**
- âœ”ï¸ ç›®æ ‡æ–‡æœ¬å¿…é¡»å­˜åœ¨
- âœ”ï¸ ä¸èƒ½é‡å¤æŠ•è¯‰åŒä¸€ä¸ªå¯¹è±¡ï¼ˆå­˜åœ¨Pendingæ¡ˆä»¶æ—¶æ‹’ç»ï¼‰
- âœ”ï¸ éœ€å†»ç»“`ComplaintDeposit`æŠ¼é‡‘
- âœ”ï¸ ç³»ç»Ÿè‡ªåŠ¨è®°å½•æŠ•è¯‰è®¡æ•°ï¼ˆ`LifeComplaints`ã€`EulogyComplaints`ï¼‰

### âŒ **æ™®é€šç”¨æˆ·ä¸å¯ä»¥ä¿®æ”¹çš„å­—æ®µå†…å®¹**

| å­—æ®µå | ä¿®æ”¹æ–¹å¼ | æƒé™è¦æ±‚ | è¯´æ˜ |
|--------|---------|---------|------|
| `deposit` | ç³»ç»Ÿè‡ªåŠ¨è®¾ç½® | - | ä»Configè¯»å–`ComplaintDeposit` |
| `created` | ç³»ç»Ÿè‡ªåŠ¨è®¾ç½® | - | å½“å‰å—å· |
| `status` | `gov_resolve_life_complaint()` | **æ²»ç†å§”å‘˜ä¼š/Root** | è£å†³ç”Ÿå¹³æŠ•è¯‰ |
| `status` | `gov_resolve_eulogy_complaint()` | **æ²»ç†å§”å‘˜ä¼š/Root** | è£å†³æ‚¼è¯æŠ•è¯‰ |

**âš ï¸ è£å†³åˆ†è´¦è§„åˆ™ï¼ˆæ™®é€šç”¨æˆ·æ— æ³•å¹²é¢„ï¼‰ï¼š**
- **ç»´æŒæŠ•è¯‰(uphold=true)**ï¼š
  - ä¸Šä¼ è€…æŠ¼é‡‘ï¼š20%å¥–åŠ±æŠ•è¯‰äººï¼Œ5%ä»²è£è´¹ï¼Œ75%é€€å›ä¸Šä¼ è€…
  - æŠ•è¯‰äººæŠ¼é‡‘ï¼šå…¨é¢é‡Šæ”¾
  - å›æ»šæ–‡æœ¬å†…å®¹åˆ°å‰ä¸€ä¸ªç‰ˆæœ¬
- **é©³å›æŠ•è¯‰(uphold=false)**ï¼š
  - æŠ•è¯‰äººæŠ¼é‡‘ï¼š20%å¥–åŠ±ä¸Šä¼ è€…ï¼Œ5%ä»²è£è´¹ï¼Œ75%é€€å›æŠ•è¯‰äºº

---

## 3ï¸âƒ£ pallet-deceased-mediaï¼ˆé€è€…åª’ä½“æŠ•è¯‰æ¨¡å—ï¼‰

### ğŸ“¦ ComplaintCaseæ•°æ®ç»“æ„

```rust
pub struct ComplaintCase<T: Config> {
    pub complainant: T::AccountId,    // æŠ•è¯‰äºº
    pub deposit: BalanceOf<T>,        // æŠ•è¯‰æŠ¼é‡‘
    pub created: BlockNumberFor<T>,   // åˆ›å»ºæ—¶é—´
    pub status: ComplaintStatus,      // æŠ•è¯‰çŠ¶æ€ï¼ˆPending/Resolvedï¼‰
}
```

**æŠ•è¯‰åŸŸï¼š**
- Domain 1: ç›¸å†Œ (Album)
- Domain 2: åª’ä½“ (Media - ç…§ç‰‡/éŸ³é¢‘/è§†é¢‘)

### âœ… **ä»»æ„ç”¨æˆ·å¯ä»¥ä¿®æ”¹çš„å­—æ®µå†…å®¹**

| å­—æ®µå | ä¿®æ”¹æ–¹å¼ | æƒé™è¦æ±‚ | å¯ä¿®æ”¹æ—¶æœº | è¯´æ˜ |
|--------|---------|---------|-----------|------|
| `complainant` | `complain_album()` | ä»»æ„ç­¾åç”¨æˆ· | æŠ•è¯‰ç›¸å†Œæ—¶ | è‡ªåŠ¨è®°å½•æŠ•è¯‰äººè´¦æˆ· |
| `complainant` | `complain_media()` | ä»»æ„ç­¾åç”¨æˆ· | æŠ•è¯‰åª’ä½“æ—¶ | è‡ªåŠ¨è®°å½•æŠ•è¯‰äººè´¦æˆ· |

**âœ¨ ç”¨æˆ·æŠ•è¯‰çš„é™åˆ¶æ¡ä»¶ï¼š**
- âœ”ï¸ ç›®æ ‡ç›¸å†Œ/åª’ä½“å¿…é¡»å­˜åœ¨
- âœ”ï¸ ä¸èƒ½é‡å¤æŠ•è¯‰åŒä¸€ä¸ªå¯¹è±¡ï¼ˆå­˜åœ¨Pendingæ¡ˆä»¶æ—¶æ‹’ç»ï¼‰
- âœ”ï¸ éœ€å†»ç»“`ComplaintDeposit`æŠ¼é‡‘
- âœ”ï¸ ç³»ç»Ÿè‡ªåŠ¨è®°å½•æŠ•è¯‰è®¡æ•°ï¼ˆ`AlbumComplaints`ã€`MediaComplaints`ï¼‰

### âŒ **æ™®é€šç”¨æˆ·ä¸å¯ä»¥ä¿®æ”¹çš„å­—æ®µå†…å®¹**

| å­—æ®µå | ä¿®æ”¹æ–¹å¼ | æƒé™è¦æ±‚ | è¯´æ˜ |
|--------|---------|---------|------|
| `deposit` | ç³»ç»Ÿè‡ªåŠ¨è®¾ç½® | - | ä»Configè¯»å–`ComplaintDeposit` |
| `created` | ç³»ç»Ÿè‡ªåŠ¨è®¾ç½® | - | å½“å‰å—å· |
| `status` | `gov_resolve_album_complaint()` | **æ²»ç†å§”å‘˜ä¼š/Root** | è£å†³ç›¸å†ŒæŠ•è¯‰ |
| `status` | `gov_resolve_media_complaint()` | **æ²»ç†å§”å‘˜ä¼š/Root** | è£å†³åª’ä½“æŠ•è¯‰ |

**âš ï¸ è£å†³åˆ†è´¦è§„åˆ™ï¼ˆæ™®é€šç”¨æˆ·æ— æ³•å¹²é¢„ï¼‰ï¼š**
- **ç»´æŒæŠ•è¯‰(uphold=true)**ï¼š
  - ä¸Šä¼ è€…æŠ¼é‡‘ï¼š20%å¥–åŠ±æŠ•è¯‰äººï¼Œ5%ä»²è£è´¹ï¼Œ75%é€€å›ä¸Šä¼ è€…
  - æŠ•è¯‰äººæŠ¼é‡‘ï¼šå…¨é¢é‡Šæ”¾
  - æ¸…é™¤`AlbumDeposits`/`MediaDeposits`å’Œ`Maturity`è®°å½•
- **é©³å›æŠ•è¯‰(uphold=false)**ï¼š
  - æŠ•è¯‰äººæŠ¼é‡‘ï¼š20%å¥–åŠ±ä¸Šä¼ è€…ï¼Œ5%ä»²è£è´¹ï¼Œ75%é€€å›æŠ•è¯‰äºº

---

## 4ï¸âƒ£ pallet-stardust-graveï¼ˆå¢“åœ°æŠ•è¯‰æ¨¡å—ï¼‰

### ğŸ“¦ Complaintæ•°æ®ç»“æ„

```rust
pub struct Complaint<T: Config> {
    pub who: T::AccountId,                      // æŠ•è¯‰äºº
    pub cid: BoundedVec<u8, T::MaxCidLen>,     // æŠ•è¯‰è¯æ®CID
    pub time: BlockNumberFor<T>,               // æŠ•è¯‰æ—¶é—´
}
```

**å­˜å‚¨ç»“æ„ï¼š**
```rust
pub type ComplaintsByGrave<T> = StorageMap<
    grave_id,
    BoundedVec<Complaint<T>, MaxComplaintsPerGrave>
>;
```

### âœ… **ä»»æ„ç”¨æˆ·å¯ä»¥ä¿®æ”¹çš„å­—æ®µå†…å®¹**

| å­—æ®µå | ä¿®æ”¹æ–¹å¼ | æƒé™è¦æ±‚ | å¯ä¿®æ”¹æ—¶æœº | è¯´æ˜ |
|--------|---------|---------|-----------|------|
| `who` | æŠ•è¯‰æ¥å£ï¼ˆå¾…ç¡®è®¤ï¼‰ | ä»»æ„ç­¾åç”¨æˆ· | æäº¤æŠ•è¯‰æ—¶ | è‡ªåŠ¨è®°å½•æŠ•è¯‰äººè´¦æˆ· |
| `cid` | æŠ•è¯‰æ¥å£ï¼ˆå¾…ç¡®è®¤ï¼‰ | ä»»æ„ç­¾åç”¨æˆ· | æäº¤æŠ•è¯‰æ—¶ | ç”¨æˆ·æä¾›æŠ•è¯‰è¯æ®CID |

**âœ¨ ç‰¹æ®Šè®¾è®¡ï¼š**
- æ¯ä¸ªå¢“åœ°å¯ä»¥ç´¯ç§¯å¤šä¸ªæŠ•è¯‰è®°å½•ï¼ˆæœ€å¤š`MaxComplaintsPerGrave`æ¡ï¼‰
- æŠ•è¯‰è®°å½•ä¸ºåªè¯»è¿½åŠ æ¨¡å¼ï¼Œä¸å¯å•ç‹¬åˆ é™¤æˆ–ä¿®æ”¹

### âŒ **æ™®é€šç”¨æˆ·ä¸å¯ä»¥ä¿®æ”¹çš„å­—æ®µå†…å®¹**

| å­—æ®µå | ä¿®æ”¹æ–¹å¼ | æƒé™è¦æ±‚ | è¯´æ˜ |
|--------|---------|---------|------|
| `time` | ç³»ç»Ÿè‡ªåŠ¨è®¾ç½® | - | å½“å‰å—å· |
| æ•´ä½“æ¸…é™¤ | æ²»ç†æ¥å£ | **æ²»ç†å§”å‘˜ä¼š/Root** | æ¸…ç†å¢“åœ°æ‰€æœ‰æŠ•è¯‰è®°å½• |

**âš ï¸ æ³¨æ„äº‹é¡¹ï¼š**
- æŠ•è¯‰è®°å½•ä¸€æ—¦æäº¤æ— æ³•æ’¤å›
- éœ€è¦æ²»ç†å§”å‘˜ä¼šå®¡æŸ¥åå†³å®šæ˜¯å¦é‡‡å–è¡ŒåŠ¨
- æŠ•è¯‰ç´¯ç§¯è¾¾åˆ°é˜ˆå€¼å¯èƒ½è§¦å‘å¢“åœ°å®¡æ ¸æœºåˆ¶

---

## 5ï¸âƒ£ pallet-escrowï¼ˆæ‰˜ç®¡äº‰è®®æ¨¡å—ï¼‰

### ğŸ“¦ Disputeç›¸å…³å­—æ®µ

```rust
// çŠ¶æ€å­˜å‚¨
pub type LockStateOf<T> = StorageMap<id, u8>; 
// 0=Locked, 1=Disputed, 2=Resolved, 3=Closed

// äº‰è®®äº‹ä»¶
Disputed {
    id: u64,
    reason: u16,  // äº‰è®®åŸå› ç 
}
```

### âœ… **ä»»æ„ç”¨æˆ·å¯ä»¥ä¿®æ”¹çš„å­—æ®µå†…å®¹**

**âš ï¸ é‡è¦ï¼š`pallet-escrow`çš„äº‰è®®åŠŸèƒ½è®¾è®¡ä¸ºæˆæƒè°ƒç”¨ï¼Œæ™®é€šç”¨æˆ·æ— æ³•ç›´æ¥ä¿®æ”¹ä»»ä½•å­—æ®µï¼**

| æ“ä½œ | æƒé™è¦æ±‚ | è¯´æ˜ |
|------|---------|------|
| è¿›å…¥äº‰è®®çŠ¶æ€ | **ä»…AuthorizedOrigin/Root** | æ™®é€šç”¨æˆ·éœ€é€šè¿‡å…¶ä»–palletï¼ˆå¦‚OTCï¼‰é—´æ¥è§¦å‘ |

### âŒ **æ™®é€šç”¨æˆ·ä¸å¯ä»¥ä¿®æ”¹çš„å­—æ®µå†…å®¹**

| å­—æ®µå | ä¿®æ”¹æ–¹å¼ | æƒé™è¦æ±‚ | è¯´æ˜ |
|--------|---------|---------|------|
| `LockStateOf` | `dispute()` | **AuthorizedOrigin/Root** | è®¾ç½®ä¸ºDisputedçŠ¶æ€ï¼ˆ1ï¼‰ |
| `LockStateOf` | `apply_decision_release_all()` | **AuthorizedOrigin/Root** | ä»²è£å†³è®®-å…¨é¢é‡Šæ”¾ |
| `LockStateOf` | `apply_decision_refund_all()` | **AuthorizedOrigin/Root** | ä»²è£å†³è®®-å…¨é¢é€€æ¬¾ |
| `LockStateOf` | `apply_decision_partial_bps()` | **AuthorizedOrigin/Root** | ä»²è£å†³è®®-æŒ‰æ¯”ä¾‹åˆ†è´¦ |

**âš ï¸ å®‰å…¨è®¾è®¡ç‰¹ç‚¹ï¼š**
- ğŸ”’ äº‰è®®çŠ¶æ€ä¸‹ç¦æ­¢æ™®é€šrelease/refundæ“ä½œ
- ğŸ”’ ä»²è£å†³è®®åªèƒ½ç”±æˆæƒæ–¹è°ƒç”¨
- ğŸ”’ èµ„é‡‘è½¬å‡ºå—æ‰˜ç®¡è´¦æˆ·ä¿æŠ¤
- ğŸ”’ æ”¯æŒæš‚åœåŠŸèƒ½ï¼ˆ`Paused`ï¼‰ï¼Œåº”æ€¥æ­¢è¡€

---

## 6ï¸âƒ£ pallet-arbitrationï¼ˆå»ä¸­å¿ƒåŒ–ä»²è£æ¨¡å—ï¼‰

### ğŸ“¦ Disputeç›¸å…³ç»“æ„

```rust
// äº‰è®®ç™»è®°å­˜å‚¨
pub type Disputed<T> = StorageDoubleMap<
    domain,      // [u8; 8] ä¸šåŠ¡åŸŸæ ‡è¯†
    object_id,   // u64 ä¸šåŠ¡å¯¹è±¡ID
    ()           // æ ‡è®°å­˜åœ¨
>;

// è¯æ®å¼•ç”¨åˆ—è¡¨
pub type EvidenceIds<T> = StorageDoubleMap<
    domain,
    object_id,
    BoundedVec<u64, MaxEvidence>  // è¯æ®IDåˆ—è¡¨
>;

// è£å†³å†³å®šæšä¸¾
pub enum Decision {
    Release,        // å…¨é¢æ”¾æ¬¾
    Refund,         // å…¨é¢é€€æ¬¾
    Partial(u16),   // éƒ¨åˆ†æ”¾æ¬¾ï¼ˆbpsï¼‰
}
```

**æ”¯æŒçš„ä¸šåŠ¡åŸŸï¼š**
- `b"stardust/otc_order"`: OTCè®¢å•äº‰è®®
- `b"stardust/simple_bridge"`: è·¨é“¾æ¡¥æ¥äº‰è®®
- å…¶ä»–è‡ªå®šä¹‰åŸŸï¼ˆé€šè¿‡Routeræ‰©å±•ï¼‰

### âœ… **ä»»æ„ç”¨æˆ·å¯ä»¥ä¿®æ”¹çš„å­—æ®µå†…å®¹**

| æ“ä½œ | æƒé™è¦æ±‚ | å¯ä¿®æ”¹æ—¶æœº | è¯´æ˜ |
|-----|---------|-----------|------|
| `dispute()` | ç­¾åç”¨æˆ· + `Router::can_dispute()` | å‘èµ·äº‰è®®æ—¶ | éœ€é€šè¿‡Routeræ ¡éªŒï¼ˆä¹°å®¶/å–å®¶/åšå¸‚å•†ï¼‰ |
| `dispute_with_evidence_id()` | ç­¾åç”¨æˆ· + `Router::can_dispute()` | å‘èµ·äº‰è®®æ—¶ | å¼•ç”¨å·²æäº¤çš„è¯æ®IDï¼ˆæ¨èï¼‰ |

**âœ¨ ç”¨æˆ·å‘èµ·äº‰è®®çš„é™åˆ¶æ¡ä»¶ï¼š**
- âœ”ï¸ å¿…é¡»é€šè¿‡`Router::can_dispute()`æ ¡éªŒï¼ˆä¸šåŠ¡palletåˆ¤æ–­æ˜¯å¦ä¸ºå‚ä¸æ–¹ï¼‰
- âœ”ï¸ ä¸èƒ½é‡å¤å‘èµ·äº‰è®®ï¼ˆåŒä¸€domain+idåªèƒ½å­˜åœ¨ä¸€ä¸ªäº‰è®®ï¼‰
- âœ”ï¸ æ¨èä½¿ç”¨`dispute_with_evidence_id()`ï¼ˆå…ˆæäº¤è¯æ®åˆ°pallet-evidenceï¼‰
- âœ”ï¸ OTCåŸŸï¼šä»…ä¹°å®¶æˆ–å–å®¶å¯å‘èµ·
- âœ”ï¸ BridgeåŸŸï¼šä»…ç”¨æˆ·æˆ–åšå¸‚å•†å¯å‘èµ·

**âš ï¸ Routeræƒé™æ ¡éªŒç¤ºä¾‹ï¼š**
```rust
// OTCè®¢å•äº‰è®®
fn can_dispute(domain: [u8; 8], who: &AccountId, id: u64) -> bool {
    match domain {
        b"stardust/otc_order" => {
            // æ£€æŸ¥æ˜¯å¦ä¸ºä¹°å®¶æˆ–å–å®¶
            pallet_otc_order::is_participant(who, id)
        },
        b"stardust/simple_bridge" => {
            // æ£€æŸ¥æ˜¯å¦ä¸ºç”¨æˆ·æˆ–åšå¸‚å•†
            pallet_simple_bridge::is_party(who, id)
        },
        _ => false,
    }
}
```

### âŒ **æ™®é€šç”¨æˆ·ä¸å¯ä»¥ä¿®æ”¹çš„å­—æ®µå†…å®¹**

| å­—æ®µ/æ“ä½œ | ä¿®æ”¹æ–¹å¼ | æƒé™è¦æ±‚ | è¯´æ˜ |
|----------|---------|---------|------|
| `Disputed` | ç³»ç»Ÿè‡ªåŠ¨è®¾ç½® | - | ç™»è®°äº‰è®®çŠ¶æ€ |
| `EvidenceIds` | ç³»ç»Ÿè‡ªåŠ¨è¿½åŠ  | - | è®°å½•è¯æ®å¼•ç”¨åˆ—è¡¨ |
| è£å†³æ‰§è¡Œ | `arbitrate()` | **DecisionOriginï¼ˆæ²»ç†å§”å‘˜ä¼š/Rootï¼‰** | åšå‡ºè£å†³å†³å®š |
| èµ„é‡‘åˆ†é… | `Router::apply_decision()` | **DecisionOrigin** | é€šè¿‡Routerè·¯ç”±åˆ°ä¸šåŠ¡pallet |

**âš ï¸ è£å†³æµç¨‹ï¼ˆæ™®é€šç”¨æˆ·æ— æ³•å¹²é¢„ï¼‰ï¼š**
1. **æ²»ç†å®¡æŸ¥**ï¼šå§”å‘˜ä¼šæŸ¥çœ‹è¯æ®ï¼ˆé€šè¿‡evidence_idï¼‰
2. **æŠ•ç¥¨è¡¨å†³**ï¼šå§”å‘˜ä¼šæŠ•ç¥¨å†³å®šè£å†³ç»“æœï¼ˆRelease/Refund/Partialï¼‰
3. **æ‰§è¡Œè£å†³**ï¼šè°ƒç”¨`arbitrate(domain, id, decision_code, bps)`
4. **è·¯ç”±åˆ†å‘**ï¼šé€šè¿‡Routerå°†è£å†³è·¯ç”±åˆ°ä¸šåŠ¡pallet
5. **åº”ç”¨å†³ç­–**ï¼šä¸šåŠ¡palletæ‰§è¡Œèµ„é‡‘é‡Šæ”¾/é€€æ¬¾ã€æ›´æ–°çŠ¶æ€ã€æ‰£ä¿¡ç”¨åˆ†

**ğŸ”’ å®‰å…¨è®¾è®¡ç‰¹ç‚¹ï¼š**
- ğŸ”’ è£å†³æƒé™ä¸¥æ ¼é™åˆ¶åœ¨æ²»ç†å§”å‘˜ä¼š/Root
- ğŸ”’ åŸŸè·¯ç”±è§£è€¦ï¼Œå„ä¸šåŠ¡palletç‹¬ç«‹å®ç°è£å†³é€»è¾‘
- ğŸ”’ è¯æ®ç»Ÿä¸€ç®¡ç†ï¼ˆé€šè¿‡pallet-evidenceï¼‰
- ğŸ”’ æ”¯æŒç§æœ‰è¯æ®å’Œè®¿é—®æ§åˆ¶
- ğŸ”’ é˜²æ­¢é‡å¤å‘èµ·äº‰è®®

**ğŸ“‹ è£å†³å†³å®šç±»å‹ï¼š**
- **Decision::Release** (decision_code=0): å…¨é¢æ”¾æ¬¾ç»™å–å®¶/åšå¸‚å•†
  - é€‚ç”¨ï¼šä¹°å®¶æ¶æ„äº‰è®®ã€åšå¸‚å•†å±¥çº¦æ­£å¸¸
- **Decision::Refund** (decision_code=1): å…¨é¢é€€æ¬¾ç»™ä¹°å®¶
  - é€‚ç”¨ï¼šåšå¸‚å•†è¿çº¦ã€å–å®¶ä¸å‘è´§
- **Decision::Partial(bps)** (decision_code=2): æŒ‰æ¯”ä¾‹åˆ†è´¦
  - é€‚ç”¨ï¼šåŒæ–¹éƒ½æœ‰è´£ä»»ã€éƒ¨åˆ†å±¥çº¦
  - bpsèŒƒå›´ï¼š0-10000ï¼ˆ0.00%-100.00%ï¼‰

---

## ğŸ“Š æƒé™æ€»ç»“è¡¨

| Pallet | ç”¨æˆ·å¯æäº¤ | ç”¨æˆ·å¯æ’¤å› | ç”¨æˆ·å¯ä¿®æ”¹çŠ¶æ€ | æ²»ç†å¯è£å†³ | ç³»ç»Ÿè‡ªåŠ¨æ‰§è¡Œ |
|--------|-----------|-----------|---------------|-----------|------------|
| stardust-appeals | âœ… | âœ…ï¼ˆstatus=0ï¼‰ | âŒ | âœ… | âœ… |
| deceased-text | âœ… | âŒ | âŒ | âœ… | âŒ |
| deceased-media | âœ… | âŒ | âŒ | âœ… | âŒ |
| stardust-grave | âœ… | âŒ | âŒ | âœ… | âŒ |
| escrow | âŒï¼ˆéœ€æˆæƒï¼‰ | âŒ | âŒ | âœ… | âœ…ï¼ˆåˆ°æœŸï¼‰ |
| arbitration | âœ…ï¼ˆéœ€Routeræ ¡éªŒï¼‰ | âŒ | âŒ | âœ… | âŒ |

---

## ğŸ” å®‰å…¨æœºåˆ¶æ±‡æ€»

### 1. æŠ¼é‡‘ä¿æŠ¤æœºåˆ¶
- âœ… æ‰€æœ‰æŠ•è¯‰/ç”³è¯‰éƒ½éœ€å†»ç»“æŠ¼é‡‘
- âœ… æŠ¼é‡‘é‡‘é¢ç”±ç³»ç»Ÿé…ç½®æˆ–åŠ¨æ€ç­–ç•¥å†³å®š
- âœ… æ’¤å›/é©³å›ä¼šç½šæ²¡éƒ¨åˆ†æŠ¼é‡‘ï¼ˆ10%-30%ï¼‰
- âœ… Phase 2ç»Ÿä¸€ä½¿ç”¨`pallet-deposits`ç®¡ç†

### 2. çŠ¶æ€ä¿æŠ¤æœºåˆ¶
- âœ… å…³é”®çŠ¶æ€å­—æ®µï¼ˆ`status`ã€`execute_at`ç­‰ï¼‰ä»…æ²»ç†/ç³»ç»Ÿå¯ä¿®æ”¹
- âœ… é‡å¤æŠ•è¯‰ä¿æŠ¤ï¼ˆåŒä¸€å¯¹è±¡å­˜åœ¨Pendingæ¡ˆä»¶æ—¶æ‹’ç»ï¼‰
- âœ… çŠ¶æ€æµè½¬ä¸¥æ ¼å—é™ï¼ˆsubmittedâ†’approvedâ†’executedï¼‰

### 3. é™é¢‘ä¿æŠ¤æœºåˆ¶
- âœ… `pallet-stardust-appeals`ï¼šæ—¶é—´çª—å£å†…é™åˆ¶æäº¤æ¬¡æ•°
- âœ… é˜²æ­¢æ¶æ„åˆ·å±å’ŒDoSæ”»å‡»

### 4. è¯æ®å®Œæ•´æ€§ä¿æŠ¤
- âœ… `evidence_cid`å¼ºåˆ¶å¿…å¡«ä¸”æœ‰æœ€å°é•¿åº¦è¦æ±‚
- âœ… è¯æ®å­˜å‚¨åœ¨IPFSï¼Œé“¾ä¸Šä»…è®°å½•CID
- âœ… æ²»ç†è£å†³æ—¶éœ€æä¾›é¢å¤–`evidence_cid`

### 5. èµ„é‡‘å®‰å…¨ä¿æŠ¤
- âœ… æ‰˜ç®¡èµ„é‡‘ç”±ä¸“ç”¨PalletIdè´¦æˆ·ç®¡ç†
- âœ… äº‰è®®çŠ¶æ€ä¸‹ç¦æ­¢æ™®é€šé‡Šæ”¾/é€€æ¬¾æ“ä½œ
- âœ… ä»²è£å†³è®®æœ‰ä¸‰ç§æ¨¡å¼ï¼ˆå…¨é¢é‡Šæ”¾/å…¨é¢é€€æ¬¾/æŒ‰æ¯”ä¾‹åˆ†è´¦ï¼‰
- âœ… æ”¯æŒå…¨å±€æš‚åœåŠŸèƒ½

### 6. åŸŸè·¯ç”±è§£è€¦ä¿æŠ¤
- âœ… `pallet-arbitration`é€šè¿‡Router Traitä¸ä¸šåŠ¡palletè§£è€¦
- âœ… æƒé™æ ¡éªŒç”±å„ä¸šåŠ¡palletç‹¬ç«‹å®ç°ï¼ˆ`can_dispute`ï¼‰
- âœ… è£å†³åº”ç”¨ç”±å„ä¸šåŠ¡palletç‹¬ç«‹å®ç°ï¼ˆ`apply_decision`ï¼‰
- âœ… é˜²æ­¢è·¨åŸŸè¶Šæƒæ“ä½œ

---

## ğŸ¯ å…³é”®å‘ç°ä¸å»ºè®®

### ç”¨æˆ·å¯ä¿®æ”¹çš„å†…å®¹
1. **æäº¤é˜¶æ®µ**ï¼šç”¨æˆ·å¯ä»¥è‡ªç”±æäº¤æŠ•è¯‰/ç”³è¯‰ï¼Œæä¾›è¯æ®CIDå’Œç†ç”±
2. **æ’¤å›æƒé™**ï¼šä»…`pallet-stardust-appeals`å…è®¸ç”¨æˆ·æ’¤å›ï¼ˆçŠ¶æ€=0æ—¶ï¼‰
3. **å­—æ®µèŒƒå›´**ï¼šç”¨æˆ·ä»…èƒ½æŒ‡å®š`domain`ã€`target`ã€`action`ã€è¯æ®CIDç­‰ä¸šåŠ¡å­—æ®µ

### ç”¨æˆ·ä¸å¯ä¿®æ”¹çš„å†…å®¹
1. **çŠ¶æ€æ§åˆ¶**ï¼šæ‰€æœ‰çŠ¶æ€å˜æ›´ç”±æ²»ç†å§”å‘˜ä¼šæˆ–ç³»ç»Ÿè‡ªåŠ¨æ‰§è¡Œ
2. **æŠ¼é‡‘ç®¡ç†**ï¼šæŠ¼é‡‘é‡‘é¢ã€ç½šæ²¡æ¯”ä¾‹ã€åˆ†è´¦é€»è¾‘å®Œå…¨ç”±ç³»ç»Ÿæ§åˆ¶
3. **æ—¶é—´æ§åˆ¶**ï¼šæ‰§è¡Œæ—¶é—´ã€æ‰¹å‡†æ—¶é—´ç”±æ²»ç†è®¾ç½®ï¼Œç”¨æˆ·æ— æ³•å¹²é¢„
4. **ä»²è£å†³è®®**ï¼šè£å†³ç»“æœã€èµ„é‡‘åˆ†é…ç”±æ²»ç†å§”å‘˜ä¼šç‹¬ç«‹å†³å®š

### æ”¹è¿›å»ºè®®
1. âœ… **å·²å®Œæˆ**ï¼š`pallet-stardust-appeals`é‡‡ç”¨åŠ¨æ€æŠ¼é‡‘ç­–ç•¥
2. ğŸš§ **è¿›è¡Œä¸­**ï¼šPhase 2ç»Ÿä¸€ä½¿ç”¨`pallet-deposits`ç®¡ç†æŠ¼é‡‘
3. ğŸ’¡ **å»ºè®®**ï¼š`pallet-stardust-grave`çš„æŠ•è¯‰æœºåˆ¶å¯å¢åŠ æ’¤å›åŠŸèƒ½
4. ğŸ’¡ **å»ºè®®**ï¼šæ‰€æœ‰æŠ•è¯‰æ¨¡å—ç»Ÿä¸€è¿ç§»åˆ°`pallet-stardust-appeals`ï¼ˆé•¿æœŸç›®æ ‡ï¼‰

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [pallet-stardust-appeals README](/home/xiaodong/æ–‡æ¡£/stardust/pallets/stardust-appeals/README.md)
- [pallet-deceased-text README](/home/xiaodong/æ–‡æ¡£/stardust/pallets/deceased-text/README.md)
- [pallet-deceased-media README](/home/xiaodong/æ–‡æ¡£/stardust/pallets/deceased-media/README.md)
- [pallet-escrow README](/home/xiaodong/æ–‡æ¡£/stardust/pallets/escrow/README.md)
- [pallet-deposits README](/home/xiaodong/æ–‡æ¡£/stardust/pallets/deposits/README.md)
- [pallet-arbitration README](/home/xiaodong/æ–‡æ¡£/stardust/pallets/arbitration/README.md)

---

## ğŸ“ æ›´æ–°æ—¥å¿—

| æ—¥æœŸ | ç‰ˆæœ¬ | æ›´æ–°å†…å®¹ |
|-----|------|---------|
| 2025-10-27 | v1.0 | åˆå§‹ç‰ˆæœ¬ï¼Œè¦†ç›–5ä¸ªè‡ªç ”palletçš„æŠ•è¯‰/ç”³è¯‰æœºåˆ¶åˆ†æ |

---

**ç”Ÿæˆå·¥å…·**: Cursor AI  
**å®¡æ ¸çŠ¶æ€**: å¾…å®¡æ ¸  
**ç»´æŠ¤è´£ä»»**: é¡¹ç›®æ¶æ„ç»„

