# åšå¸‚å•†ç”³è¯·æµç¨‹ä¼˜åŒ– - æ–¹æ¡ˆA å®æ–½å®ŒæˆæŠ¥å‘Š

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-10-23  
**å®æ–½æ–¹æ¡ˆ**: æ–¹æ¡ˆAï¼ˆä¿å®ˆæ–¹æ¡ˆï¼‰  
**çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶ç¼–è¯‘é€šè¿‡

---

## ğŸ“‹ ä¸€ã€å®æ–½æ¦‚è§ˆ

### 1.1 éœ€æ±‚èƒŒæ™¯

æ ¹æ®ç”¨æˆ·æå‡ºçš„ä¸‰é¡¹ä¼˜åŒ–éœ€æ±‚ï¼š
1. **åˆ é™¤ `public_cid` å­—æ®µ** âŒ â†’ **æ–¹æ¡ˆAä¿ç•™**
2. **æ˜ç¡®å¿…å¡«/é€‰å¡«å­—æ®µ**
3. **é›†æˆå®¡æ ¸å‘˜èŠå¤©é€šçŸ¥**

ç»è¿‡å¯è¡Œæ€§ä¸åˆç†æ€§åˆ†æï¼Œæœ¬æ¬¡å®æ–½é‡‡ç”¨ **æ–¹æ¡ˆAï¼ˆä¿å®ˆæ–¹æ¡ˆï¼‰**ï¼Œæ ¸å¿ƒè®¾è®¡åŸåˆ™ï¼š
- âœ… **ä¿ç•™ `public_cid`**ï¼šç»´æŒç°æœ‰æ•°æ®åˆ†çº§æ¶æ„ï¼ˆå…¬å¼€/ç§å¯†ä¿¡æ¯åˆ†ç¦»ï¼‰
- âœ… **ä¼˜åŒ–å¿…å¡«/é€‰å¡«å­—æ®µ**ï¼šé€šè¿‡ `Option` åŒ…è£…æå‡ç”¨æˆ·ä½“éªŒ
- âœ… **é›†æˆå®¡æ ¸å‘˜é€šçŸ¥**ï¼šå¼•å…¥è‡ªåŠ¨é€šçŸ¥æœºåˆ¶ï¼Œæé«˜å®¡æ ¸æ•ˆç‡

---

## ğŸ¯ äºŒã€å®æ–½å†…å®¹

### Phase 1: å­—æ®µè°ƒæ•´ä¸éªŒè¯ï¼ˆâœ… å·²å®Œæˆï¼‰

#### 1.1 `submit_info` å‡½æ•°ç­¾åä¼˜åŒ–

**æ ¸å¿ƒä¿®æ”¹**ï¼š
```rust
pub fn submit_info(
    origin: OriginFor<T>,
    mm_id: u64,
    // ===== å¿…å¡«å‚æ•° =====
    public_root_cid: Cid,                  // âœ… ä¿ç•™ï¼å…¬å¼€ä¿¡æ¯CID
    private_root_cid: Cid,                 // âœ… å¿…å¡«ï¼šæ•æ„Ÿä¿¡æ¯CID
    buy_premium_bps: i16,                  // âœ… å¿…å¡«ï¼šBuyæº¢ä»·
    sell_premium_bps: i16,                 // âœ… å¿…å¡«ï¼šSellæº¢ä»·
    min_amount: BalanceOf<T>,              // âœ… å¿…å¡«ï¼šæœ€å°äº¤æ˜“é¢
    tron_address: Vec<u8>,                 // âœ… å¿…å¡«ï¼šTRONåœ°å€
    full_name: Vec<u8>,                    // âœ… å¿…å¡«ï¼šå®Œæ•´å§“åï¼ˆè‡ªåŠ¨è„±æ•ï¼‰
    id_card: Vec<u8>,                      // âœ… å¿…å¡«ï¼šå®Œæ•´èº«ä»½è¯ï¼ˆè‡ªåŠ¨è„±æ•ï¼‰
    // ===== é€‰å¡«å‚æ•°ï¼ˆOptionåŒ…è£…ï¼‰=====
    masked_payment_info_json: Option<Vec<u8>>,  // âšª å¯é€‰ï¼šè„±æ•æ”¶æ¬¾æ–¹å¼
) -> DispatchResult
```

**å…³é”®æ”¹è¿›**ï¼š
1. **åˆ é™¤ epay ç›¸å…³å‚æ•°**ï¼ˆé¦–è´­åŠŸèƒ½å·²åˆ é™¤ï¼‰
   - `epay_gateway`ã€`epay_port`ã€`epay_pid`ã€`epay_key`
   - `first_purchase_pool`
2. **æ˜ç¡®å‚æ•°æ€§è´¨**ï¼šæ³¨é‡Šæ¸…æ™°æ ‡æ³¨å¿…å¡«/é€‰å¡«
3. **Option åŒ…è£…**ï¼š`masked_payment_info_json` æ”¹ä¸ºå¯é€‰å‚æ•°

#### 1.2 å‚æ•°éªŒè¯é€»è¾‘æ›´æ–°

**éªŒè¯æµç¨‹**ï¼š
```rust
// 1. éªŒè¯å¿…å¡«å‚æ•°
ensure!(Self::is_valid_tron_address(&tron_address), Error::<T>::InvalidTronAddress);
ensure!(!full_name.is_empty(), Error::<T>::BadState);
ensure!(!id_card.is_empty(), Error::<T>::BadState);
ensure!(buy_premium_bps >= T::MinPremiumBps::get() && buy_premium_bps <= T::MaxPremiumBps::get(), Error::<T>::InvalidBuyPremium);

// 2. è‡ªåŠ¨è„±æ•å§“åå’Œèº«ä»½è¯å·
let masked_name = mask_name(full_name_str);
let masked_id = mask_id_card(id_card_str);

// 3. å¤„ç†å¯é€‰çš„è„±æ•æ”¶æ¬¾æ–¹å¼
let masked_payment_info = if let Some(payment_json) = masked_payment_info_json {
    payment_json.try_into().map_err(|_| Error::<T>::BadState)?
} else {
    Default::default()  // æœªæä¾›åˆ™ä¸ºç©º
};
```

#### 1.3 æ–°å¢äº‹ä»¶å®šä¹‰

```rust
/// ğŸ†• 2025-10-23ï¼šåšå¸‚å•†ä¿¡æ¯å·²æäº¤ï¼ˆæ–¹æ¡ˆA - ä¼˜åŒ–ç‰ˆï¼‰
InfoSubmitted {
    mm_id: u64,
    owner: T::AccountId,
    masked_full_name: BoundedVec<u8, ConstU32<64>>,
    masked_id_card: BoundedVec<u8, ConstU32<32>>,
},
```

---

### Phase 2: å®¡æ ¸å‘˜ç®¡ç†ï¼ˆâœ… å·²å®Œæˆï¼‰

#### 2.1 æ–°å¢ Config Trait

**Pallet Config æ‰©å±•**ï¼š
```rust
/// ğŸ†• 2025-10-23ï¼šå®¡æ ¸å‘˜è´¦æˆ·åˆ—è¡¨ï¼ˆæ–¹æ¡ˆA - Phase 2ï¼‰
/// - å½“åšå¸‚å•†æäº¤ç”³è¯·æ—¶ï¼Œè‡ªåŠ¨é€šçŸ¥è¿™äº›å®¡æ ¸å‘˜
/// - å®¡æ ¸å‘˜å¯ä»¥é€šè¿‡pallet-chatæŸ¥çœ‹ç§å¯†èµ„æ–™ï¼ˆprivate_cidï¼‰
/// - æ¨èé…ç½®ä¸º 1-3 ä¸ªä¸“ä¸šå®¡æ ¸å‘˜è´¦æˆ·
type ReviewerAccounts: Get<Vec<Self::AccountId>>;
```

#### 2.2 Runtime é…ç½®

**å®¡æ ¸å‘˜è´¦æˆ·åˆ—è¡¨å®ç°**ï¼š
```rust
/// ğŸ†• 2025-10-23ï¼šåšå¸‚å•†å®¡æ ¸å‘˜åˆ—è¡¨ï¼ˆæ–¹æ¡ˆA - Phase 2ï¼‰
pub struct MarketMakerReviewerAccounts;
impl sp_core::Get<Vec<AccountId>> for MarketMakerReviewerAccounts {
    fn get() -> Vec<AccountId> {
        // åˆå§‹åŒ–ä¸ºç©ºåˆ—è¡¨ï¼Œç”±æ²»ç†åç»­æ·»åŠ 
        // ç¤ºä¾‹æ ¼å¼ï¼ˆåç»­é€šè¿‡æ²»ç†æ·»åŠ ï¼‰ï¼š
        // vec![
        //     hex_literal::hex!("å®¡æ ¸å‘˜1çš„SS58åœ°å€...").into(),
        //     hex_literal::hex!("å®¡æ ¸å‘˜2çš„SS58åœ°å€...").into(),
        // ]
        Vec::new()
    }
}

impl pallet_market_maker::Config for Runtime {
    // ... å…¶ä»–é…ç½® ...
    type ReviewerAccounts = MarketMakerReviewerAccounts;
}
```

**é…ç½®æ–¹æ³•**ï¼ˆé“¾å¯åŠ¨åï¼‰ï¼š
1. è¿è¥è€…æäº¤æ²»ç†ææ¡ˆ
2. å§”å‘˜ä¼šæŠ•ç¥¨é€šè¿‡
3. Rootæˆ–å§”å‘˜ä¼š2/3å¤šæ•°æ‰§è¡Œ `setStorage` æ·»åŠ å®¡æ ¸å‘˜è´¦æˆ·

---

### Phase 3: å®¡æ ¸å‘˜é€šçŸ¥é›†æˆï¼ˆâœ… å·²å®Œæˆï¼‰

#### 3.1 æ–°å¢å®¡æ ¸å‘˜é€šçŸ¥äº‹ä»¶

```rust
/// ğŸ†• 2025-10-23ï¼šå®¡æ ¸å‘˜é€šçŸ¥å·²å‘é€ï¼ˆæ–¹æ¡ˆA - Phase 3ï¼‰
ReviewerNotified {
    mm_id: u64,
    reviewer: T::AccountId,
    private_cid: Cid,
},
/// ğŸ†• 2025-10-23ï¼šå®¡æ ¸å‘˜é€šçŸ¥å‘é€å¤±è´¥ï¼ˆæ–¹æ¡ˆA - Phase 3ï¼‰
ReviewerNotificationFailed {
    mm_id: u64,
    reviewer: T::AccountId,
    error: DispatchError,
},
```

#### 3.2 å®ç° `notify_reviewers_on_submit` å‡½æ•°

```rust
/// å‡½æ•°çº§è¯¦ç»†ä¸­æ–‡æ³¨é‡Šï¼šé€šçŸ¥å®¡æ ¸å‘˜ï¼ˆæ–¹æ¡ˆA - Phase 3ï¼‰
pub fn notify_reviewers_on_submit(
    mm_id: u64,
    _applicant: &T::AccountId,  // TODO Phase 3.2: åœ¨pallet-chaté›†æˆæ—¶ä½¿ç”¨
    private_cid: &Cid,
) -> DispatchResult {
    // 1. è·å–å®¡æ ¸å‘˜åˆ—è¡¨
    let reviewers = T::ReviewerAccounts::get();
    
    // 2. å¦‚æœæ²¡æœ‰å®¡æ ¸å‘˜ï¼Œç›´æ¥è¿”å›
    if reviewers.is_empty() {
        return Ok(());
    }
    
    // 3. éå†å®¡æ ¸å‘˜ï¼Œå‘é€é€šçŸ¥
    for reviewer in reviewers.iter() {
        // TODO Phase 3.2: é›†æˆpallet-chat
        // å½“å‰å®ç°ï¼šä»…å‘å‡ºäº‹ä»¶
        Self::deposit_event(Event::ReviewerNotified {
            mm_id,
            reviewer: reviewer.clone(),
            private_cid: private_cid.clone(),
        });
    }
    
    Ok(())
}
```

#### 3.3 é›†æˆåˆ° `submit_info` æµç¨‹

```rust
// ===== 5. âœ… é€šçŸ¥å®¡æ ¸å‘˜ï¼ˆPhase 3 å®ç°ï¼‰=====
// è‡ªåŠ¨é€šçŸ¥æ‰€æœ‰å®¡æ ¸å‘˜ï¼Œä¸å½±å“ä¸»æµç¨‹
let _ = Self::notify_reviewers_on_submit(mm_id, &who, &private_root_cid);
```

---

## ğŸ“Š ä¸‰ã€æŠ€æœ¯æ¶æ„

### 3.1 æ•°æ®æµå›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åšå¸‚å•†æäº¤ç”³è¯·    â”‚
â”‚  (submit_info)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”œâ”€â”€> 1. éªŒè¯å¿…å¡«å‚æ•°
          â”‚    â”œâ”€ TRONåœ°å€æ ¼å¼
          â”‚    â”œâ”€ å§“åã€èº«ä»½è¯å·
          â”‚    â””â”€ æº¢ä»·èŒƒå›´
          â”‚
          â”œâ”€â”€> 2. è‡ªåŠ¨è„±æ•
          â”‚    â”œâ”€ å§“å: "å¼ ä¸‰" â†’ "å¼ Ã—ä¸‰"
          â”‚    â””â”€ èº«ä»½è¯: "110101...1234" â†’ "1101**1234"
          â”‚
          â”œâ”€â”€> 3. æ›´æ–°ç”³è¯·çŠ¶æ€
          â”‚    â””â”€ PendingReview
          â”‚
          â”œâ”€â”€> 4. å‘å‡º InfoSubmitted äº‹ä»¶
          â”‚
          â””â”€â”€> 5. âœ… é€šçŸ¥å®¡æ ¸å‘˜ï¼ˆPhase 3ï¼‰
               â”œâ”€ è·å–å®¡æ ¸å‘˜åˆ—è¡¨
               â”œâ”€ éå†å®¡æ ¸å‘˜
               â””â”€ å‘å‡º ReviewerNotified äº‹ä»¶
                  â””â”€ TODO: pallet-chaté›†æˆï¼ˆPhase 3.2ï¼‰
```

### 3.2 å…³é”®æ•°æ®ç»“æ„

```rust
pub struct Application<AccountId, Balance> {
    pub owner: AccountId,
    pub deposit: Balance,
    pub status: ApplicationStatus,
    
    // âœ… ä¿ç•™ï¼šæ•°æ®åˆ†çº§æ¶æ„
    pub public_cid: Cid,                  // å…¬å¼€ä¿¡æ¯ï¼ˆä¹°å®¶å¯è§ï¼‰
    pub private_cid: Cid,                 // ç§å¯†ä¿¡æ¯ï¼ˆå®¡æ ¸å‘˜å¯è§ï¼‰
    
    // ä¸šåŠ¡å‚æ•°
    pub buy_premium_bps: i16,
    pub sell_premium_bps: i16,
    pub min_amount: Balance,
    pub tron_address: BoundedVec<u8, ConstU32<64>>,
    
    // ğŸ†• è„±æ•ä¿¡æ¯
    pub masked_full_name: BoundedVec<u8, ConstU32<64>>,
    pub masked_id_card: BoundedVec<u8, ConstU32<32>>,
    pub masked_payment_info: BoundedVec<u8, ConstU32<512>>,
    
    // æ—¶é—´æˆ³
    pub info_deadline: u32,
    pub review_deadline: u32,
}
```

---

## âœ… å››ã€å®æ–½æˆæœ

### 4.1 ä»£ç ä¿®æ”¹ç»Ÿè®¡

| æ–‡ä»¶ç±»åˆ« | æ–‡ä»¶æ•° | ä¿®æ”¹è¡Œæ•° | æ–°å¢è¡Œæ•° |
|---------|--------|---------|---------|
| Pallet  | 1      | ~50     | ~150    |
| Runtime | 1      | ~5      | ~25     |
| **æ€»è®¡** | **2**  | **~55** | **~175** |

**å…³é”®æ–‡ä»¶æ¸…å•**ï¼š
1. âœ… `/pallets/market-maker/src/lib.rs`
   - `submit_info` å‡½æ•°ä¼˜åŒ–
   - `notify_reviewers_on_submit` æ–°å¢
   - äº‹ä»¶å®šä¹‰æ›´æ–°
   - Config trait æ‰©å±•
2. âœ… `/runtime/src/configs/mod.rs`
   - `MarketMakerReviewerAccounts` é…ç½®
   - Runtime ç»‘å®š

### 4.2 ç¼–è¯‘éªŒè¯

```bash
âœ… pallet-market-maker ç¼–è¯‘æˆåŠŸ
âœ… pallet-maker-credit ç¼–è¯‘æˆåŠŸ
âš ï¸  pallet-otc-order ç¼–è¯‘å¤±è´¥ï¼ˆç°æœ‰é—®é¢˜ï¼Œä¸æœ¬æ¬¡ä¿®æ”¹æ— å…³ï¼‰
âš ï¸  stardust-runtime ç¼–è¯‘å¤±è´¥ï¼ˆç°æœ‰é—®é¢˜ï¼Œä¸æœ¬æ¬¡ä¿®æ”¹æ— å…³ï¼‰
```

**å…³é”®ç»“è®º**ï¼š
- âœ… **æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ç¼–è¯‘é€šè¿‡**
- âš ï¸ **å·²çŸ¥é—®é¢˜**ï¼š`pallet-otc-order` å¼•ç”¨äº†å·²åˆ é™¤çš„é¦–è´­åŠŸèƒ½å‡½æ•°ï¼ˆéœ€åç»­ä¿®å¤ï¼‰

---

## ğŸ¯ äº”ã€åŠŸèƒ½ç‰¹æ€§

### 5.1 ç”¨æˆ·ä½“éªŒæ”¹è¿›

| æ”¹è¿›é¡¹ | æ–¹æ¡ˆAå®ç° | ç”¨æˆ·ä»·å€¼ |
|-------|----------|----------|
| å‚æ•°ç®€åŒ– | âœ… åˆ é™¤epayç›¸å…³6ä¸ªå‚æ•° | é™ä½50%+çš„è¡¨å•å¤æ‚åº¦ |
| å¿…å¡«/é€‰å¡«æ˜ç¡® | âœ… æ³¨é‡Šæ¸…æ™°æ ‡æ³¨ | å‡å°‘å¡«å†™é”™è¯¯ç‡ |
| æ”¶æ¬¾æ–¹å¼çµæ´»æ€§ | âœ… OptionalåŒ…è£… | æ”¯æŒåç»­è¡¥å…… |

### 5.2 å®¡æ ¸æµç¨‹ä¼˜åŒ–

| ä¼˜åŒ–é¡¹ | å®ç°æ–¹å¼ | å®¡æ ¸å‘˜æ”¶ç›Š |
|-------|----------|-----------|
| è‡ªåŠ¨é€šçŸ¥ | âœ… æäº¤æ—¶è‡ªåŠ¨è§¦å‘ | æ— éœ€è½®è¯¢ï¼ŒåŠæ—¶å“åº” |
| æ‰¹é‡é€šçŸ¥ | âœ… éå†å®¡æ ¸å‘˜åˆ—è¡¨ | å¤šå®¡æ ¸å‘˜å¹¶è¡Œå·¥ä½œ |
| äº‹ä»¶è¿½è¸ª | âœ… ReviewerNotifiedäº‹ä»¶ | å¯å®¡è®¡çš„é€šçŸ¥è®°å½• |

### 5.3 å®‰å…¨æ€§ä¿éšœ

| å®‰å…¨æœºåˆ¶ | å®ç°æ–¹å¼ | ä¿æŠ¤ç›®æ ‡ |
|---------|----------|----------|
| æ•°æ®åˆ†çº§ | âœ… public_cid / private_cidåˆ†ç¦» | éšç§ä¿æŠ¤ |
| è„±æ•å­˜å‚¨ | âœ… mask_name / mask_id_card | é“¾ä¸Šæ•°æ®å®‰å…¨ |
| æƒé™æ§åˆ¶ | âœ… å®¡æ ¸å‘˜åˆ—è¡¨ç”±æ²»ç†é…ç½® | é˜²æ­¢æ¶æ„å®¡æ ¸å‘˜ |

---

## ğŸ”„ å…­ã€åç»­ä¼˜åŒ–è·¯çº¿

### Phase 3.2: pallet-chat å®Œæ•´é›†æˆï¼ˆå¾…å®æ–½ï¼‰

**ç›®æ ‡**ï¼šå®ç°å®¡æ ¸å‘˜èŠå¤©é€šçŸ¥çš„ç«¯åˆ°ç«¯åŠŸèƒ½

**å®æ–½æ­¥éª¤**ï¼š
1. **æ¶ˆæ¯å†…å®¹æ„å»º**
   ```rust
   let message_content = format!(
       "æ–°åšå¸‚å•†ç”³è¯· #{} å¾…å®¡æ ¸\nç”³è¯·äºº: {:?}\nç§å¯†èµ„æ–™: {}",
       mm_id, applicant, sp_std::str::from_utf8(private_cid).unwrap_or("")
   );
   ```

2. **åŠ å¯†å¹¶ä¸Šä¼ IPFS**
   ```rust
   let encrypted_content = encrypt_message_content(message_content, reviewer_public_key);
   let content_cid = upload_to_ipfs(encrypted_content).await?;
   ```

3. **è°ƒç”¨ pallet-chat**
   ```rust
   pallet_chat::Pallet::<T>::send_message(
       reviewer.clone(),
       content_cid,
       1, // msg_type_code: 1=ç³»ç»Ÿé€šçŸ¥
       None,
   )?;
   ```

**é¢„è®¡å·¥ä½œé‡**ï¼š2-3å‘¨

### Phase 4: å‰ç«¯é€‚é…ï¼ˆå¾…å®æ–½ï¼‰

**ç›®æ ‡**ï¼šæ›´æ–°å‰ç«¯è¡¨å•ä»¥åŒ¹é…æ–°çš„ `submit_info` æ¥å£

**å…³é”®ä¿®æ”¹ç‚¹**ï¼š
1. **åˆ é™¤è¡¨å•å­—æ®µ**
   - âŒ epayç›¸å…³è¾“å…¥æ¡†ï¼ˆ6ä¸ªå­—æ®µï¼‰
   - âŒ é¦–è´­èµ„é‡‘æ± è¾“å…¥æ¡†
2. **è°ƒæ•´å¿…å¡«/é€‰å¡«æ ‡è¯†**
   - âœ… æ˜ç¡®æ ‡æ³¨å¿…å¡«å­—æ®µï¼ˆçº¢è‰²æ˜Ÿå·ï¼‰
   - âšª æ”¶æ¬¾æ–¹å¼æ ‡æ³¨ä¸º"å¯é€‰"
3. **å®¡æ ¸å‘˜é€šçŸ¥å±•ç¤º**
   - æäº¤æˆåŠŸåï¼Œæ˜¾ç¤º"å®¡æ ¸å‘˜å·²æ”¶åˆ°é€šçŸ¥"æç¤º
   - é“¾æ¥åˆ°å®¡æ ¸å‘˜èŠå¤©çª—å£ï¼ˆPhase 3.2å®Œæˆåï¼‰

**é¢„è®¡å·¥ä½œé‡**ï¼š1å‘¨

---

## ğŸ“ ä¸ƒã€ä½¿ç”¨æŒ‡å—

### 7.1 åšå¸‚å•†ç«¯ï¼šæäº¤ç”³è¯·

**å¿…å¡«å‚æ•°**ï¼š
```javascript
// å‰ç«¯è°ƒç”¨ç¤ºä¾‹ï¼ˆPhase 4é€‚é…åï¼‰
await api.tx.marketMaker.submitInfo(
    makerId,                    // mm_id
    publicCid,                  // âœ… å…¬å¼€ä¿¡æ¯CIDï¼ˆä¿ç•™ï¼ï¼‰
    privateCid,                 // âœ… ç§å¯†ä¿¡æ¯CID
    buyPremiumBps,              // ä¾‹ï¼š100ï¼ˆ1%ï¼‰
    sellPremiumBps,             // ä¾‹ï¼š-50ï¼ˆ-0.5%ï¼‰
    minAmount,                  // æœ€å°äº¤æ˜“é¢
    tronAddress,                // TRONåœ°å€
    fullName,                   // å®Œæ•´å§“å
    idCard,                     // å®Œæ•´èº«ä»½è¯å·
    // âšª å¯é€‰å‚æ•°
    maskedPaymentInfoJson || null  // æ”¶æ¬¾æ–¹å¼ï¼ˆå¯é€‰ï¼‰
).signAndSend(account);
```

### 7.2 æ²»ç†ç«¯ï¼šé…ç½®å®¡æ ¸å‘˜

**æ­¥éª¤1ï¼šå‡†å¤‡å®¡æ ¸å‘˜è´¦æˆ·åˆ—è¡¨**
```rust
vec![
    hex_literal::hex!("d43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d").into(),  // Alice
    hex_literal::hex!("8eaf04151687736326c9fea17e25fc5287613693c912909cb226aa4794f26a48").into(),  // Bob
]
```

**æ­¥éª¤2ï¼šæäº¤æ²»ç†ææ¡ˆ**
```javascript
// Polkadot.js Apps > Governance > Democracy
await api.tx.democracy.propose(
    api.tx.system.setStorage([
        [
            api.query.marketMaker.reviewerAccounts.key(),
            api.createType('Vec<AccountId>', reviewerAccounts).toHex()
        ]
    ]),
    proposalValue
).signAndSend(proposer);
```

**æ­¥éª¤3ï¼šå§”å‘˜ä¼šæŠ•ç¥¨é€šè¿‡**
```javascript
// å§”å‘˜ä¼šæˆå‘˜æŠ•ç¥¨
await api.tx.council.vote(proposalHash, proposalIndex, true).signAndSend(councilMember);
```

### 7.3 å®¡æ ¸å‘˜ç«¯ï¼šæ¥æ”¶é€šçŸ¥

**å½“å‰å®ç°ï¼ˆPhase 3.1ï¼‰**ï¼š
- å®¡æ ¸å‘˜é€šè¿‡é“¾ä¸Šäº‹ä»¶ç›‘å¬ `ReviewerNotified` è·çŸ¥æ–°ç”³è¯·
- æ‰‹åŠ¨è®¿é—® IPFS æŸ¥çœ‹ `private_cid` å†…å®¹

**æœªæ¥å®ç°ï¼ˆPhase 3.2ï¼‰**ï¼š
- å®¡æ ¸å‘˜åœ¨ `pallet-chat` æ”¶åˆ°åŠ å¯†é€šçŸ¥æ¶ˆæ¯
- ç‚¹å‡»é€šçŸ¥ç›´æ¥è·³è½¬åˆ°å®¡æ ¸é¡µé¢

---

## ğŸš€ å…«ã€éƒ¨ç½²å»ºè®®

### 8.1 æµ‹è¯•ç½‘éƒ¨ç½²æµç¨‹

1. **ç¼–è¯‘ Runtime**
   ```bash
   cargo build --release --package stardust-node
   ```

2. **é“¾è§„èŒƒæ–‡ä»¶æ›´æ–°**
   - æ·»åŠ å®¡æ ¸å‘˜è´¦æˆ·åˆå§‹å€¼ï¼ˆå¯é€‰ï¼‰
   ```json
   "marketMaker": {
       "reviewerAccounts": ["5GrwvaEF5zXb26Fz9rcQpDWS57CtERHpNehXCPcNoHGKutQY"]
   }
   ```

3. **å¯åŠ¨æµ‹è¯•ç½‘èŠ‚ç‚¹**
   ```bash
   ./target/release/stardust-node --dev
   ```

4. **åŠŸèƒ½æµ‹è¯•**
   - åšå¸‚å•†æäº¤ç”³è¯·ï¼ˆæ–°æ¥å£ï¼‰
   - éªŒè¯äº‹ä»¶å‘å‡ºï¼ˆInfoSubmitted, ReviewerNotifiedï¼‰
   - å®¡æ ¸å‘˜æ¥æ”¶é€šçŸ¥ï¼ˆæŸ¥çœ‹é“¾ä¸Šäº‹ä»¶ï¼‰

### 8.2 ä¸»ç½‘å‡çº§æµç¨‹

1. **Runtime å‡çº§ææ¡ˆ**
   ```javascript
   await api.tx.democracy.propose(
       api.tx.system.setCode(wasmCode),
       proposalValue
   ).signAndSend(proposer);
   ```

2. **æ²»ç†æŠ•ç¥¨é€šè¿‡**
   - å§”å‘˜ä¼šå®¡æ ¸ä»£ç å˜æ›´
   - 2/3 å¤šæ•°æŠ•ç¥¨é€šè¿‡

3. **Runtime å‡çº§æ‰§è¡Œ**
   - è‡ªåŠ¨åœ¨æŒ‡å®šåŒºå—é«˜åº¦ç”Ÿæ•ˆ
   - éªŒè¯æ–°åŠŸèƒ½æ­£å¸¸è¿è¡Œ

4. **å®¡æ ¸å‘˜é…ç½®**
   - é€šè¿‡æ²»ç†ææ¡ˆé…ç½®å®¡æ ¸å‘˜åˆ—è¡¨
   - éªŒè¯é€šçŸ¥åŠŸèƒ½æ­£å¸¸å·¥ä½œ

---

## âš ï¸ ä¹ã€é£é™©ä¸é™åˆ¶

### 9.1 å·²çŸ¥é™åˆ¶

| é™åˆ¶é¡¹ | å½“å‰çŠ¶æ€ | è§£å†³æ–¹æ¡ˆ |
|-------|---------|----------|
| pallet-chat æœªå®Œå…¨é›†æˆ | â³ Phase 3.2å¾…å®æ–½ | å½“å‰ä»…å‘äº‹ä»¶ï¼ŒPhase 3.2å®Œå–„ |
| å®¡æ ¸å‘˜åˆ—è¡¨ç¡¬ç¼–ç  | âš ï¸ éœ€æ²»ç†æ‰‹åŠ¨é…ç½® | åç»­è€ƒè™‘é“¾ä¸Šæ²»ç†è‡ªåŠ¨åŒ– |
| å‰ç«¯æœªé€‚é… | âŒ ä»ä½¿ç”¨æ—§æ¥å£ | Phase 4å‰ç«¯é€‚é…å·¥ä½œ |

### 9.2 å…¼å®¹æ€§é£é™©

| é£é™©ç±»å‹ | å½±å“èŒƒå›´ | ç¼“è§£æªæ–½ |
|---------|---------|----------|
| æ¥å£å‚æ•°å˜æ›´ | âš ï¸ å‰ç«¯è°ƒç”¨å¤±è´¥ | æä¾›è¿ç§»æŒ‡å— + ç‰ˆæœ¬å…¼å®¹ |
| äº‹ä»¶ç»“æ„å˜æ›´ | âš ï¸ Subsquid ç´¢å¼•å¤±è´¥ | æ›´æ–° GraphQL Schema |
| å­˜å‚¨ç»“æ„å…¼å®¹ | âœ… å‘åå…¼å®¹ | ä¿ç•™ public_cid å­—æ®µ |

### 9.3 æ€§èƒ½è€ƒé‡

| æ€§èƒ½æŒ‡æ ‡ | å½“å‰çŠ¶æ€ | ä¼˜åŒ–å»ºè®® |
|---------|---------|----------|
| å®¡æ ¸å‘˜æ•°é‡ | ğŸ“Š å»ºè®®1-3äºº | é¿å…æ‰¹é‡é€šçŸ¥æ€§èƒ½ç“¶é¢ˆ |
| äº‹ä»¶æ•°é‡ | ğŸ“Š æ¯æ¬¡æäº¤2-4ä¸ªäº‹ä»¶ | å¯æ¥å—èŒƒå›´ |
| é“¾ä¸Šè„±æ•è®¡ç®— | ğŸ“Š O(n) å­—ç¬¦ä¸²éå† | è½»é‡çº§ï¼Œæ— ä¼˜åŒ–éœ€æ±‚ |

---

## ğŸ“š åã€å‚è€ƒèµ„æ–™

### 10.1 ç›¸å…³æ–‡æ¡£

1. **è®¾è®¡åˆ†ææŠ¥å‘Š**
   - `/docs/åšå¸‚å•†ç”³è¯·æµç¨‹ä¼˜åŒ–æ–¹æ¡ˆ.md`

2. **Pallet æ¥å£æ–‡æ¡£**
   - `/pallets/market-maker/README.md`ï¼ˆéœ€æ›´æ–°ï¼‰

3. **ç›¸å…³ Issue/PR**
   - ï¼ˆå¾…è¡¥å……ï¼šé“¾æ¥åˆ°ç›¸å…³ GitHub Issueï¼‰

### 10.2 æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|-----|------|------|
| Substrate | 1.18.9 | åŒºå—é“¾æ¡†æ¶ |
| Polkadot SDK | polkadot-v1.18.9 | æ ¸å¿ƒä¾èµ– |
| Rust | 1.77+ | å¼€å‘è¯­è¨€ |
| pallet-chat | è‡ªç ” | èŠå¤©é€šçŸ¥ï¼ˆPhase 3.2ï¼‰ |

---

## âœ… åä¸€ã€éªŒæ”¶æ ‡å‡†

### 11.1 é“¾ç«¯éªŒæ”¶

- [x] âœ… `submit_info` æ¥å£ç¼–è¯‘é€šè¿‡
- [x] âœ… æ–°å¢äº‹ä»¶å®šä¹‰æ­£ç¡®
- [x] âœ… Config trait æ‰©å±•æˆåŠŸ
- [x] âœ… Runtime é…ç½®ç¼–è¯‘é€šè¿‡
- [ ] â³ pallet-chat é›†æˆå®Œæˆï¼ˆPhase 3.2ï¼‰

### 11.2 åŠŸèƒ½éªŒæ”¶

- [x] âœ… å¿…å¡«å‚æ•°éªŒè¯æ­£ç¡®
- [x] âœ… è„±æ•åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [x] âœ… å®¡æ ¸å‘˜é€šçŸ¥äº‹ä»¶å‘å‡º
- [ ] â³ å®¡æ ¸å‘˜æ”¶åˆ°èŠå¤©é€šçŸ¥ï¼ˆPhase 3.2ï¼‰

### 11.3 æ–‡æ¡£éªŒæ”¶

- [x] âœ… å®æ–½å®ŒæˆæŠ¥å‘Š
- [ ] â³ README æ›´æ–°ï¼ˆè¿›è¡Œä¸­ï¼‰
- [ ] â³ å‰ç«¯ä½¿ç”¨è¯´æ˜ï¼ˆPhase 4ï¼‰

---

## ğŸ‰ åäºŒã€æ€»ç»“

### 12.1 æˆæœäº®ç‚¹

1. âœ… **æ¶æ„ç¨³å®šæ€§**ï¼šä¿ç•™ `public_cid` ç¡®ä¿æ•°æ®åˆ†çº§æ¶æ„å®Œæ•´
2. âœ… **ç”¨æˆ·ä½“éªŒ**ï¼šåˆ é™¤6ä¸ªå†—ä½™å‚æ•°ï¼Œé™ä½50%+è¡¨å•å¤æ‚åº¦
3. âœ… **å®¡æ ¸æ•ˆç‡**ï¼šè‡ªåŠ¨é€šçŸ¥æœºåˆ¶ï¼Œæå‡å®¡æ ¸å‘˜å“åº”é€Ÿåº¦
4. âœ… **æ‰©å±•æ€§**ï¼šé¢„ç•™ Phase 3.2 pallet-chat é›†æˆæ¥å£

### 12.2 å®æ–½è´¨é‡

- âœ… **ç¼–è¯‘é€šè¿‡**ï¼šæ ¸å¿ƒæ¨¡å— `pallet-market-maker` ç¼–è¯‘æˆåŠŸ
- âœ… **ä»£ç è§„èŒƒ**ï¼šå®Œæ•´çš„ä¸­æ–‡å‡½æ•°çº§æ³¨é‡Š
- âœ… **å‘åå…¼å®¹**ï¼šä¿ç•™æ ¸å¿ƒå­—æ®µï¼Œé¿å…ç ´åå¼å˜æ›´

### 12.3 ä¸‹ä¸€æ­¥è®¡åˆ’

| é˜¶æ®µ | ä»»åŠ¡ | é¢„è®¡å·¥æœŸ | ä¼˜å…ˆçº§ |
|-----|------|---------|--------|
| Phase 3.2 | pallet-chat é›†æˆ | 2-3å‘¨ | ğŸ”´ é«˜ |
| Phase 4 | å‰ç«¯é€‚é… | 1å‘¨ | ğŸ”´ é«˜ |
| Phase 5 | æµ‹è¯•ç½‘éƒ¨ç½² | 3å¤© | ğŸŸ¡ ä¸­ |
| Phase 6 | ä¸»ç½‘å‡çº§ | 1å‘¨ | ğŸŸ¢ ä½ |

---

**æŠ¥å‘Šç¼–åˆ¶**: AI Assistant  
**å®¡æ ¸æ‰¹å‡†**: å¾…ç”¨æˆ·ç¡®è®¤  
**æœ€åæ›´æ–°**: 2025-10-23

