# Phase 2: Palletæ•´åˆå®æ–½è®¡åˆ’

**å¼€å§‹æ—¶é—´**: 2025-10-27  
**ç›®æ ‡**: å‡å°‘palletæ•°é‡ï¼Œæå‡ä»£ç è´¨é‡ï¼Œé™ä½ç»´æŠ¤æˆæœ¬  
**é¢„æœŸæˆæœ**: ä»30ä¸ªpalletæ•´åˆåˆ°20ä¸ª

---

## ğŸ¯ Phase 2æ€»ä½“ç›®æ ‡

### æ ¸å¿ƒç›®æ ‡

1. **Palletæ•°é‡ä¼˜åŒ–**: 30ä¸ª â†’ 20ä¸ªï¼ˆå‡å°‘33%ï¼‰
2. **åŠŸèƒ½æ•´åˆ**: ç›¸å…³åŠŸèƒ½åˆå¹¶åˆ°ç»Ÿä¸€pallet
3. **ä»£ç è´¨é‡**: æ¶ˆé™¤å†—ä½™ï¼Œæå‡å¯ç»´æŠ¤æ€§
4. **æ€§èƒ½ä¼˜åŒ–**: å‡å°‘è·¨palletè°ƒç”¨å¼€é”€

### é¢„æœŸæ”¶ç›Š

- **å¼€å‘æ•ˆç‡**: ç»´æŠ¤æˆæœ¬é™ä½30-40%
- **Gasæˆæœ¬**: è·¨palletè°ƒç”¨å‡å°‘ï¼ŒGasä¼˜åŒ–5-10%
- **ä»£ç è´¨é‡**: æ¶æ„æ›´æ¸…æ™°ï¼Œé€»è¾‘æ›´é›†ä¸­
- **ç”¨æˆ·ä½“éªŒ**: åŠŸèƒ½æ›´ç»Ÿä¸€ï¼ŒAPIæ›´ç®€æ´

---

## ğŸ“‹ Phase 2ä»»åŠ¡æ¸…å•

### 2.1 Trading Palletæ•´åˆ â±ï¸ 8-10å°æ—¶

**ç›®æ ‡**: æ•´åˆOTCã€åšå¸‚å•†ã€æ¡¥æ¥åŠŸèƒ½åˆ°ç»Ÿä¸€Trading Pallet

#### å½“å‰é—®é¢˜

**3ä¸ªç‹¬ç«‹pallet**ï¼š
1. `pallet-otc-order` - OTCè®¢å•
2. `pallet-market-maker` - åšå¸‚å•†
3. `pallet-simple-bridge` - DUSTâ†”USDTæ¡¥æ¥

**é—®é¢˜**ï¼š
- åŠŸèƒ½é«˜åº¦ç›¸å…³ä½†åˆ†æ•£
- è·¨palletè°ƒç”¨é¢‘ç¹
- ä»·æ ¼é€»è¾‘é‡å¤

#### æ•´åˆæ–¹æ¡ˆ

**åˆ›å»ºç»Ÿä¸€pallet-trading**ï¼š
```rust
pallet-trading/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ lib.rs              // ä¸»é€»è¾‘
â”‚   â”œâ”€â”€ otc.rs              // OTCæ¨¡å—
â”‚   â”œâ”€â”€ market_maker.rs     // åšå¸‚å•†æ¨¡å—
â”‚   â”œâ”€â”€ bridge.rs           // æ¡¥æ¥æ¨¡å—
â”‚   â”œâ”€â”€ pricing.rs          // ç»Ÿä¸€å®šä»·
â”‚   â””â”€â”€ types.rs            // å…±äº«ç±»å‹
â”œâ”€â”€ Cargo.toml
â””â”€â”€ README.md
```

**æ•´åˆæ”¶ç›Š**ï¼š
- å‡å°‘2ä¸ªpallet
- ç»Ÿä¸€ä»·æ ¼é€»è¾‘
- è·¨æ¨¡å—è°ƒç”¨æ›´é«˜æ•ˆ
- é™ä½ç»´æŠ¤æˆæœ¬

#### å®æ–½æ­¥éª¤

**Step 1**: åˆ›å»ºpallet-tradingéª¨æ¶ï¼ˆ1hï¼‰
```bash
cd pallets
cp -r otc-order trading
cd trading
# é‡å‘½åå’Œé‡æ„
```

**Step 2**: è¿ç§»OTCåŠŸèƒ½ï¼ˆ2-3hï¼‰
- ä¿ç•™æ ¸å¿ƒè®¢å•é€»è¾‘
- æ•´åˆåˆ°trading::otcæ¨¡å—
- æ›´æ–°Storageå’ŒEvent

**Step 3**: è¿ç§»åšå¸‚å•†åŠŸèƒ½ï¼ˆ2-3hï¼‰
- ä¿ç•™åšå¸‚å•†æ³¨å†Œå’Œé…ç½®
- æ•´åˆåˆ°trading::market_makeræ¨¡å—
- å…±äº«è®¢å•å’Œä»·æ ¼é€»è¾‘

**Step 4**: è¿ç§»æ¡¥æ¥åŠŸèƒ½ï¼ˆ2-3hï¼‰
- ä¿ç•™TRONäº¤äº’é€»è¾‘
- æ•´åˆåˆ°trading::bridgeæ¨¡å—
- Off-chain Workerä¿æŒç‹¬ç«‹

**Step 5**: Runtimeé…ç½®æ›´æ–°ï¼ˆ1hï¼‰
- æ›´æ–°runtime/src/configs/mod.rs
- é…ç½®ç»Ÿä¸€Trading pallet
- è¿ç§»æ—§palletæ•°æ®ï¼ˆå¦‚éœ€è¦ï¼‰

**Step 6**: ç¼–è¯‘éªŒè¯ï¼ˆ1hï¼‰
- ä¿®å¤ç¼–è¯‘é”™è¯¯
- å•å…ƒæµ‹è¯•
- é›†æˆæµ‹è¯•

---

### 2.2 Credit Palletæ•´åˆ â±ï¸ 4-6å°æ—¶

**ç›®æ ‡**: æ•´åˆä¹°å®¶ä¿¡ç”¨ã€å–å®¶ä¿¡ç”¨åˆ°ç»Ÿä¸€Credit Pallet

#### å½“å‰é—®é¢˜

**2ä¸ªç‹¬ç«‹pallet**ï¼š
1. `pallet-buyer-credit` - ä¹°å®¶ä¿¡ç”¨
2. `pallet-maker-credit` - åšå¸‚å•†ä¿¡ç”¨

**é—®é¢˜**ï¼š
- ä¿¡ç”¨è®¡ç®—é€»è¾‘ç›¸ä¼¼
- æ•°æ®ç»“æ„é‡å¤
- æŸ¥è¯¢æ¥å£åˆ†æ•£

#### æ•´åˆæ–¹æ¡ˆ

**åˆ›å»ºç»Ÿä¸€pallet-credit**ï¼š
```rust
pallet-credit/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ lib.rs          // ä¸»é€»è¾‘
â”‚   â”œâ”€â”€ buyer.rs        // ä¹°å®¶ä¿¡ç”¨
â”‚   â”œâ”€â”€ maker.rs        // åšå¸‚å•†ä¿¡ç”¨
â”‚   â”œâ”€â”€ common.rs       // å…±äº«é€»è¾‘
â”‚   â””â”€â”€ types.rs        // ä¿¡ç”¨ç±»å‹
â”œâ”€â”€ Cargo.toml
â””â”€â”€ README.md
```

**æ•´åˆæ”¶ç›Š**ï¼š
- å‡å°‘1ä¸ªpallet
- ç»Ÿä¸€ä¿¡ç”¨è¯„åˆ†é€»è¾‘
- å…±äº«æ•°æ®ç»“æ„
- APIæ›´ç»Ÿä¸€

#### å®æ–½æ­¥éª¤

**Step 1**: åˆ›å»ºpallet-creditéª¨æ¶ï¼ˆ30minï¼‰

**Step 2**: è®¾è®¡ç»Ÿä¸€ä¿¡ç”¨æ•°æ®ç»“æ„ï¼ˆ1hï¼‰
```rust
pub struct CreditRecord<AccountId, Balance, BlockNumber> {
    pub account: AccountId,
    pub role: CreditRole,  // Buyer or Maker
    pub score: u32,
    pub total_volume: Balance,
    pub success_count: u32,
    pub failure_count: u32,
    pub last_updated: BlockNumber,
}

pub enum CreditRole {
    Buyer,
    Maker,
}
```

**Step 3**: è¿ç§»ä¹°å®¶ä¿¡ç”¨é€»è¾‘ï¼ˆ1-2hï¼‰

**Step 4**: è¿ç§»åšå¸‚å•†ä¿¡ç”¨é€»è¾‘ï¼ˆ1-2hï¼‰

**Step 5**: Runtimeé…ç½®æ›´æ–°ï¼ˆ30minï¼‰

**Step 6**: ç¼–è¯‘éªŒè¯ï¼ˆ30minï¼‰

---

### 2.3 Affiliate Palletæ•´åˆ â±ï¸ 4-6å°æ—¶

**ç›®æ ‡**: æ•´åˆè”ç›Ÿè¥é”€ç›¸å…³pallet

#### å½“å‰é—®é¢˜

**4ä¸ªç‹¬ç«‹pallet**ï¼š
1. `pallet-affiliate-config` - é…ç½®å±‚
2. `pallet-affiliate-instant` - å³æ—¶åˆ†æˆ
3. `pallet-affiliate-weekly` - å‘¨ç»“ç®—
4. `pallet-stardust-referrals` - æ¨èç³»ç»Ÿ

**é—®é¢˜**ï¼š
- åŠŸèƒ½é«˜åº¦ç›¸å…³
- é…ç½®åˆ†æ•£
- è·¨palletè°ƒç”¨å¤š

#### æ•´åˆæ–¹æ¡ˆ

**åˆ›å»ºç»Ÿä¸€pallet-affiliate**ï¼š
```rust
pallet-affiliate/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ lib.rs              // ä¸»é€»è¾‘
â”‚   â”œâ”€â”€ config.rs           // é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ instant.rs          // å³æ—¶åˆ†æˆ
â”‚   â”œâ”€â”€ weekly.rs           // å‘¨ç»“ç®—
â”‚   â”œâ”€â”€ referral.rs         // æ¨èç³»ç»Ÿ
â”‚   â””â”€â”€ types.rs            // å…±äº«ç±»å‹
â”œâ”€â”€ Cargo.toml
â””â”€â”€ README.md
```

**æ•´åˆæ”¶ç›Š**ï¼š
- å‡å°‘3ä¸ªpallet
- ç»Ÿä¸€åˆ†æˆé€»è¾‘
- é…ç½®é›†ä¸­ç®¡ç†
- é™ä½å¤æ‚åº¦

#### å®æ–½æ­¥éª¤

**Step 1**: åˆ›å»ºéª¨æ¶ï¼ˆ1hï¼‰

**Step 2**: è¿ç§»é…ç½®å±‚ï¼ˆ1hï¼‰

**Step 3**: è¿ç§»å³æ—¶åˆ†æˆï¼ˆ1-2hï¼‰

**Step 4**: è¿ç§»å‘¨ç»“ç®—ï¼ˆ1-2hï¼‰

**Step 5**: è¿ç§»æ¨èç³»ç»Ÿï¼ˆ1hï¼‰

**Step 6**: Runtimeé…ç½®+éªŒè¯ï¼ˆ1hï¼‰

---

### 2.4 Deceased Palletæ•´åˆ â±ï¸ 3-4å°æ—¶

**ç›®æ ‡**: æ•´åˆé€è€…ç›¸å…³pallet

#### å½“å‰é—®é¢˜

**3ä¸ªç‹¬ç«‹pallet**ï¼š
1. `pallet-deceased` - é€è€…æ¡£æ¡ˆ
2. `pallet-deceased-text` - é€è€…æ–‡æœ¬
3. `pallet-deceased-media` - é€è€…åª’ä½“

**é—®é¢˜**ï¼š
- é€»è¾‘åˆ†æ•£
- æ•°æ®æŸ¥è¯¢å¤æ‚
- è·¨palletä¾èµ–å¤š

#### æ•´åˆæ–¹æ¡ˆ

**ç»Ÿä¸€åˆ°pallet-deceased**ï¼š
```rust
pallet-deceased/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ lib.rs          // ä¸»é€»è¾‘ï¼ˆåŒ…å«æ¡£æ¡ˆï¼‰
â”‚   â”œâ”€â”€ text.rs         // æ–‡æœ¬å†…å®¹
â”‚   â”œâ”€â”€ media.rs        // åª’ä½“å†…å®¹
â”‚   â””â”€â”€ types.rs        // å…±äº«ç±»å‹
â”œâ”€â”€ Cargo.toml
â””â”€â”€ README.md
```

**æ•´åˆæ”¶ç›Š**ï¼š
- å‡å°‘2ä¸ªpallet
- é€è€…æ•°æ®é›†ä¸­
- æŸ¥è¯¢æ›´ç®€å•
- é€»è¾‘æ›´æ¸…æ™°

#### å®æ–½æ­¥éª¤

**Step 1**: åœ¨pallet-deceasedä¸­æ·»åŠ æ¨¡å—ï¼ˆ1hï¼‰

**Step 2**: è¿ç§»textåŠŸèƒ½ï¼ˆ1hï¼‰

**Step 3**: è¿ç§»mediaåŠŸèƒ½ï¼ˆ1hï¼‰

**Step 4**: Runtimeé…ç½®+éªŒè¯ï¼ˆ1hï¼‰

---

### 2.5 å…¶ä»–ä¼˜åŒ–å»ºè®®

#### å¯é€‰æ•´åˆï¼ˆä½ä¼˜å…ˆçº§ï¼‰

1. **Memorial Palletæ•´åˆ**
   - `pallet-memo-offerings` â†’ `pallet-memorial`
   - `pallet-memo-sacrifice` â†’ `pallet-memorial`
   - å‡å°‘1ä¸ªpallet

2. **Park Palletæ•´åˆ**
   - `pallet-stardust-grave` â†’ `pallet-park`
   - `pallet-stardust-park` â†’ `pallet-park`
   - å‡å°‘1ä¸ªpallet

3. **ä¿æŒç‹¬ç«‹çš„pallet**ï¼ˆå»ºè®®ä¸æ•´åˆï¼‰
   - `pallet-stardust-appeals` - ç”³è¯‰æ²»ç†ï¼ˆå·²ä¼˜åŒ–ï¼‰
   - `pallet-evidence` - è¯æ®ç®¡ç†ï¼ˆå·²ä¼˜åŒ–ï¼‰
   - `pallet-pricing` - ä»·æ ¼æœåŠ¡
   - `pallet-stardust-ipfs` - IPFSé›†æˆ
   - `pallet-chat` - èŠå¤©åŠŸèƒ½
   - `pallet-escrow` - æ‰˜ç®¡æœåŠ¡
   - å®˜æ–¹palletï¼ˆä¸ä¿®æ”¹ï¼‰

---

## ğŸ“Š Phase 2æ€»ä½“è§„åˆ’

### æ—¶é—´ä¼°ç®—

```
Phase 2æ€»å·¥æœŸ: 19-26å°æ—¶

â”œâ”€ 2.1 Tradingæ•´åˆ: 8-10å°æ—¶ â­ é«˜ä¼˜å…ˆçº§
â”œâ”€ 2.2 Creditæ•´åˆ: 4-6å°æ—¶ â­ é«˜ä¼˜å…ˆçº§
â”œâ”€ 2.3 Affiliateæ•´åˆ: 4-6å°æ—¶ â­ ä¸­ä¼˜å…ˆçº§
â”œâ”€ 2.4 Deceasedæ•´åˆ: 3-4å°æ—¶ â­ ä¸­ä¼˜å…ˆçº§
â””â”€ 2.5 å…¶ä»–ä¼˜åŒ–: å¯é€‰

æ ¸å¿ƒå·¥ä½œï¼ˆ2.1+2.2ï¼‰: 12-16å°æ—¶
```

### åˆ†é˜¶æ®µæ‰§è¡Œå»ºè®®

**ç¬¬1å‘¨**: Tradingæ•´åˆï¼ˆ8-10hï¼‰
- æ ¸å¿ƒäº¤æ˜“åŠŸèƒ½
- æœ€å¤§çš„æ”¶ç›Š
- å‡å°‘2ä¸ªpallet

**ç¬¬2å‘¨**: Creditæ•´åˆï¼ˆ4-6hï¼‰
- ä¿¡ç”¨ä½“ç³»ç»Ÿä¸€
- å‡å°‘1ä¸ªpallet

**ç¬¬3å‘¨**: Affiliateæ•´åˆï¼ˆ4-6hï¼‰
- è”ç›Ÿè¥é”€ä¼˜åŒ–
- å‡å°‘3ä¸ªpallet

**ç¬¬4å‘¨**: Deceasedæ•´åˆï¼ˆ3-4hï¼‰
- é€è€…æ•°æ®æ•´åˆ
- å‡å°‘2ä¸ªpallet

**æ€»è®¡**: ä»30ä¸ªpalletæ•´åˆåˆ°22ä¸ªï¼ˆå‡å°‘8ä¸ªï¼‰

---

## ğŸ’° é¢„æœŸæ”¶ç›Š

### å¼€å‘æ•ˆç‡æå‡

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æå‡ |
|------|--------|--------|------|
| Palletæ•°é‡ | 30ä¸ª | 22ä¸ª | **-27%** |
| ä»£ç ç»´æŠ¤ | 30ä¸ªç‹¬ç«‹ | 22ä¸ªæ¨¡å—åŒ– | **-30%** |
| APIæ•°é‡ | åˆ†æ•£ | é›†ä¸­ | **æ›´ç®€æ´** |

### æ€§èƒ½ä¼˜åŒ–

- **Gasæˆæœ¬**: è·¨palletè°ƒç”¨å‡å°‘ï¼Œä¼˜åŒ–5-10%
- **æŸ¥è¯¢æ•ˆç‡**: æ•°æ®é›†ä¸­ï¼ŒæŸ¥è¯¢æ›´å¿«
- **ä»£ç å¤ç”¨**: å…±äº«é€»è¾‘ï¼Œå‡å°‘å†—ä½™

### ä»£ç è´¨é‡

- **æ¶æ„æ¸…æ™°**: åŠŸèƒ½åˆ†ç»„æ˜ç¡®
- **ç»´æŠ¤ç®€å•**: ç›¸å…³ä»£ç é›†ä¸­
- **æµ‹è¯•å®¹æ˜“**: æ¨¡å—åŒ–æµ‹è¯•

---

## ğŸš€ å¯åŠ¨Phase 2

### ç«‹å³å¯åšï¼ˆæœ¬å‘¨ï¼‰

**é€‰é¡¹1**: Tradingæ•´åˆï¼ˆæ¨èï¼‰â±ï¸ 8-10å°æ—¶
- æœ€å¤§çš„ä¼˜åŒ–æ”¶ç›Š
- æ ¸å¿ƒäº¤æ˜“åŠŸèƒ½
- å‡å°‘2ä¸ªpallet

**é€‰é¡¹2**: Creditæ•´åˆ â±ï¸ 4-6å°æ—¶
- å¿«é€Ÿè§æ•ˆ
- é€»è¾‘ç›¸ä¼¼ï¼Œæ˜“æ•´åˆ
- å‡å°‘1ä¸ªpallet

### æ‰§è¡Œç­–ç•¥

**æ¨èè·¯å¾„**ï¼š
1. å…ˆæ‰§è¡ŒTradingæ•´åˆï¼ˆWeek 1ï¼‰
2. å†æ‰§è¡ŒCreditæ•´åˆï¼ˆWeek 2ï¼‰
3. æ ¹æ®éœ€è¦æ‰§è¡ŒAffiliateå’ŒDeceased

**é£é™©æ§åˆ¶**ï¼š
- æ¯ä¸ªæ•´åˆç‹¬ç«‹branch
- å……åˆ†æµ‹è¯•å†merge
- ä¿ç•™æ—§palletä½œä¸ºå¤‡ä»½
- é€æ­¥è¿ç§»ç”¨æˆ·æ•°æ®

---

## ğŸ“„ æŠ€æœ¯æ–¹æ¡ˆ

### Palletæ•´åˆæ¨¡å¼

**æ¨¡å¼1: æ¨¡å—åŒ–æ¶æ„**ï¼ˆæ¨èï¼‰
```rust
#[frame_support::pallet]
pub mod pallet {
    pub mod otc { /* OTCé€»è¾‘ */ }
    pub mod market_maker { /* åšå¸‚å•†é€»è¾‘ */ }
    pub mod bridge { /* æ¡¥æ¥é€»è¾‘ */ }
    
    // å…±äº«Storage
    #[pallet::storage]
    pub type Orders<T> = ...;
    
    // ç»Ÿä¸€æ¥å£
    #[pallet::call]
    impl<T: Config> Pallet<T> {
        pub fn create_order(...) { }
        pub fn register_maker(...) { }
        pub fn swap_memo(...) { }
    }
}
```

**æ¨¡å¼2: Traitç»§æ‰¿**
```rust
pub trait OtcTrait {
    fn create_order(...);
}

pub trait MarketMakerTrait {
    fn register_maker(...);
}

impl<T: Config> OtcTrait for Pallet<T> { }
impl<T: Config> MarketMakerTrait for Pallet<T> { }
```

### æ•°æ®è¿ç§»ç­–ç•¥

**ç­–ç•¥1: æ–°æ—§å¹¶å­˜**ï¼ˆæ¨èï¼‰
- æ–°palletç‹¬ç«‹Storage
- æ—§palletä¿æŒåªè¯»
- é€æ­¥è¿ç§»æ•°æ®
- åŒå†™ä¸€æ®µæ—¶é—´

**ç­–ç•¥2: ä¸€æ¬¡æ€§è¿ç§»**
- Runtime upgradeæ—¶è¿ç§»
- ä½¿ç”¨storage migration
- é£é™©è¾ƒé«˜

---

## ğŸ¯ æˆåŠŸæ ‡å‡†

### Phase 2å®Œæˆæ ‡å‡†

- [ ] Palletæ•°é‡ä»30ä¸ªå‡å°‘åˆ°22ä¸ªï¼ˆæˆ–æ›´å°‘ï¼‰
- [ ] æ‰€æœ‰æ•´åˆpalletç¼–è¯‘é€šè¿‡
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%
- [ ] åŠŸèƒ½å›å½’æµ‹è¯•100%é€šè¿‡
- [ ] æ€§èƒ½æµ‹è¯•ï¼šGasæˆæœ¬ä¼˜åŒ–5-10%
- [ ] æ–‡æ¡£å®Œæ•´ï¼šæ¯ä¸ªæ•´åˆpalletæœ‰è¯¦ç»†README
- [ ] Runtimeå¹³æ»‘å‡çº§

---

**Phase 2å¼€å§‹ï¼ç›®æ ‡ï¼šæ›´æ¸…æ™°çš„æ¶æ„ï¼Œæ›´é«˜çš„ä»£ç è´¨é‡ï¼** ğŸš€

---

**æ–‡æ¡£ç”Ÿæˆæ—¶é—´**: 2025-10-27  
**Phase**: 2.0  
**çŠ¶æ€**: è§„åˆ’å®Œæˆï¼Œå¾…æ‰§è¡Œ

