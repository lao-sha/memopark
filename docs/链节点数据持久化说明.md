# é“¾èŠ‚ç‚¹æ•°æ®æŒä¹…åŒ–å¯åŠ¨è¯´æ˜

## ğŸ“š æ¦‚è¿°

Memopark é“¾èŠ‚ç‚¹æ”¯æŒä¸¤ç§æ•°æ®å­˜å‚¨æ¨¡å¼:
1. **ä¸´æ—¶æ¨¡å¼** - æ•°æ®å­˜å‚¨åœ¨ä¸´æ—¶ç›®å½•,é‡å¯åæ¸…ç©º
2. **æŒä¹…åŒ–æ¨¡å¼** - æ•°æ®ä¿å­˜åˆ°æŒ‡å®šç›®å½•,é‡å¯åä¿ç•™

## ğŸ”§ å¯åŠ¨å‚æ•°å¯¹æ¯”

### ä¸´æ—¶æ¨¡å¼ (ä¸ä¿ç•™æ•°æ®)
```bash
./target/release/memopark-node --dev --tmp
```

**ç‰¹ç‚¹**:
- âœ… é€‚åˆå¼€å‘æµ‹è¯•
- âœ… æ¯æ¬¡å¯åŠ¨éƒ½æ˜¯å…¨æ–°çŠ¶æ€
- âŒ æ•°æ®ä¸ä¿ç•™
- âŒ é‡å¯ååŒºå—é“¾çŠ¶æ€é‡ç½®

---

### æŒä¹…åŒ–æ¨¡å¼ (ä¿ç•™æ•°æ®)
```bash
./target/release/memopark-node \
  --dev \
  --rpc-external \
  --rpc-port 9944 \
  --rpc-cors=all \
  --base-path ./my-chain-state/
```

**ç‰¹ç‚¹**:
- âœ… æ•°æ®æŒä¹…åŒ–ä¿å­˜
- âœ… é‡å¯åä¿ç•™æ‰€æœ‰åŒºå—å’ŒçŠ¶æ€
- âœ… é€‚åˆé•¿æœŸè¿è¡Œ
- âš ï¸ å ç”¨ç£ç›˜ç©ºé—´

---

## ğŸ“‹ å‚æ•°è¯¦è§£

| å‚æ•° | è¯´æ˜ | æ˜¯å¦å¿…éœ€ |
|------|------|---------|
| `--dev` | å¼€å‘æ¨¡å¼,ä½¿ç”¨å¼€å‘é“¾è§„æ ¼ | âœ… å¿…éœ€ |
| `--base-path <PATH>` | æ•°æ®å­˜å‚¨ç›®å½• | âœ… æŒä¹…åŒ–å¿…éœ€ |
| `--rpc-external` | å…è®¸å¤–éƒ¨RPCè®¿é—® | âš ï¸ æ¨è(DAPPè®¿é—®) |
| `--rpc-port 9944` | RPCç«¯å£ | âš ï¸ æ¨è(å›ºå®šç«¯å£) |
| `--rpc-cors=all` | å…è®¸æ‰€æœ‰è·¨åŸŸè¯·æ±‚ | âš ï¸ æ¨è(å‰ç«¯è®¿é—®) |

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### æ–¹å¼1: ä½¿ç”¨å¯åŠ¨è„šæœ¬ (æ¨è)

```bash
./start-node.sh
```

**äº¤äº’å¼é€‰æ‹©**:
```
=== Memopark é“¾èŠ‚ç‚¹å¯åŠ¨ ===

è¯·é€‰æ‹©å¯åŠ¨æ¨¡å¼:
  1) ä¸´æ—¶æ¨¡å¼ (--tmp) - æ•°æ®ä¸ä¿ç•™,é‡å¯åæ¸…ç©º
  2) æŒä¹…åŒ–æ¨¡å¼ (--base-path) - ä¿ç•™é“¾ä¸Šæ•°æ®

è¯·è¾“å…¥é€‰æ‹© [1/2] (é»˜è®¤: 1): 2
```

**é€‰æ‹© 2** å³å¯å¯åŠ¨æŒä¹…åŒ–æ¨¡å¼ã€‚

---

### æ–¹å¼2: ç›´æ¥å‘½ä»¤å¯åŠ¨

**æŒä¹…åŒ–å¯åŠ¨**:
```bash
./target/release/memopark-node \
  --dev \
  --rpc-external \
  --rpc-port 9944 \
  --rpc-cors=all \
  --base-path ./my-chain-state/
```

**ä¸´æ—¶å¯åŠ¨**:
```bash
./target/release/memopark-node --dev --tmp
```

---

## ğŸ“ æ•°æ®ç›®å½•ç»“æ„

æŒä¹…åŒ–æ¨¡å¼ä¸‹,æ•°æ®ä¿å­˜åœ¨ `my-chain-state/` ç›®å½•:

```
my-chain-state/
â”œâ”€â”€ chains/
â”‚   â””â”€â”€ dev/
â”‚       â”œâ”€â”€ db/              # åŒºå—é“¾æ•°æ®åº“
â”‚       â”‚   â””â”€â”€ full/        # å®Œæ•´èŠ‚ç‚¹æ•°æ®
â”‚       â”œâ”€â”€ network/         # P2Pç½‘ç»œæ•°æ®
â”‚       â””â”€â”€ keystore/        # èŠ‚ç‚¹å¯†é’¥
â””â”€â”€ ...
```

**ç›®å½•å¤§å°**:
- åˆå§‹: ~50MB
- 1000åŒºå—: ~200MB
- 10000åŒºå—: ~1GB+

---

## ğŸ”„ æ•°æ®ç®¡ç†

### æŸ¥çœ‹æ•°æ®å¤§å°
```bash
du -sh ./my-chain-state/
```

### æ¸…ç©ºæ•°æ® (é‡ç½®é“¾)
```bash
# æ–¹å¼1: åˆ é™¤æ•°æ®ç›®å½•
rm -rf ./my-chain-state/

# æ–¹å¼2: ä½¿ç”¨æ¸…ç†è„šæœ¬
./é“¾ç«¯å®Œå…¨é‡ç½®å¹¶å¯åŠ¨.sh
```

### å¤‡ä»½æ•°æ®
```bash
# åœæ­¢èŠ‚ç‚¹åå¤‡ä»½
cp -r ./my-chain-state/ ./my-chain-state-backup-$(date +%Y%m%d)
```

### æ¢å¤æ•°æ®
```bash
# åœæ­¢èŠ‚ç‚¹åæ¢å¤
rm -rf ./my-chain-state/
cp -r ./my-chain-state-backup-20251006/ ./my-chain-state/
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. ç«¯å£å ç”¨é—®é¢˜
**ç°è±¡**: `Address already in use` é”™è¯¯

**è§£å†³**:
```bash
# æŸ¥æ‰¾å ç”¨è¿›ç¨‹
lsof -i :9944

# åœæ­¢æ—§è¿›ç¨‹
pkill -9 memopark-node
```

---

### 2. æ•°æ®æŸåæ¢å¤
**ç°è±¡**: èŠ‚ç‚¹å¯åŠ¨æŠ¥é”™æˆ–åŒºå—åŒæ­¥å¼‚å¸¸

**è§£å†³**:
```bash
# åˆ é™¤æ•°æ®åº“é‡æ–°åŒæ­¥
rm -rf ./my-chain-state/chains/dev/db/
```

---

### 3. ç£ç›˜ç©ºé—´ä¸è¶³
**ç°è±¡**: èŠ‚ç‚¹è¿è¡Œç¼“æ…¢æˆ–åœæ­¢

**æ£€æŸ¥**:
```bash
# æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h

# æ£€æŸ¥æ•°æ®ç›®å½•å¤§å°
du -sh ./my-chain-state/
```

**è§£å†³**:
- æ¸…ç†æ—§æ•°æ®
- è¿ç§»åˆ°æ›´å¤§ç£ç›˜
- ä½¿ç”¨å½’æ¡£æ¨¡å¼

---

### 4. æƒé™é—®é¢˜
**ç°è±¡**: `Permission denied` é”™è¯¯

**è§£å†³**:
```bash
# èµ‹äºˆæ•°æ®ç›®å½•æƒé™
chmod -R 755 ./my-chain-state/
```

---

## ğŸ” å®‰å…¨å»ºè®®

### ç”Ÿäº§ç¯å¢ƒé…ç½®

**ä¸æ¨è**:
```bash
--rpc-external --rpc-cors=all  # å…è®¸æ‰€æœ‰è®¿é—®
```

**æ¨è**:
```bash
--rpc-external \
--rpc-cors=http://localhost:3000,http://localhost:5173 \  # é™åˆ¶CORSæº
--rpc-methods=Safe  # ä»…å…è®¸å®‰å…¨æ–¹æ³•
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### åŒºå—ä¿®å‰ª (Pruning)
```bash
# ä»…ä¿ç•™æœ€è¿‘256ä¸ªåŒºå—çŠ¶æ€
--pruning=256

# å½’æ¡£æ¨¡å¼ (ä¿ç•™æ‰€æœ‰çŠ¶æ€,å ç”¨ç©ºé—´å¤§)
--pruning=archive
```

### æ•°æ®åº“ä¼˜åŒ–
```bash
# å¢å¤§æ•°æ®åº“ç¼“å­˜ (é»˜è®¤128MB)
--db-cache=512

# ä½¿ç”¨æ›´å¿«çš„æ•°æ®åº“åç«¯
--database=rocksdb
```

---

## ğŸ§ª æµ‹è¯•åœºæ™¯

### åœºæ™¯1: å¼€å‘æµ‹è¯• (æ¨èä¸´æ—¶æ¨¡å¼)
```bash
./target/release/memopark-node --dev --tmp
```

### åœºæ™¯2: åŠŸèƒ½æ¼”ç¤º (æ¨èæŒä¹…åŒ–)
```bash
./target/release/memopark-node \
  --dev \
  --base-path ./demo-data/ \
  --rpc-external \
  --rpc-cors=all
```

### åœºæ™¯3: é•¿æœŸè¿è¡Œ (æ¨èæŒä¹…åŒ–+ä¼˜åŒ–)
```bash
./target/release/memopark-node \
  --dev \
  --base-path ./my-chain-state/ \
  --rpc-external \
  --rpc-port 9944 \
  --rpc-cors=all \
  --pruning=256 \
  --db-cache=512
```

---

## ğŸ“ˆ ç›‘æ§ä¸æ—¥å¿—

### æŸ¥çœ‹å®æ—¶æ—¥å¿—
```bash
# å¯åŠ¨èŠ‚ç‚¹æ—¶è‡ªåŠ¨æ˜¾ç¤º
./start-node.sh

# æˆ–ä½¿ç”¨ tail æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶(å¦‚æœé‡å®šå‘)
tail -f node.log
```

### ç›‘æ§æŒ‡æ ‡
```bash
# åŒºå—é«˜åº¦
curl -H "Content-Type: application/json" \
  -d '{"id":1, "jsonrpc":"2.0", "method": "chain_getBlock"}' \
  http://localhost:9944

# èŠ‚ç‚¹å¥åº·çŠ¶æ€
curl http://localhost:9944/health
```

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•çŸ¥é“å½“å‰ä½¿ç”¨çš„æ˜¯å“ªä¸ªæ•°æ®ç›®å½•?
**A**: æŸ¥çœ‹èŠ‚ç‚¹å¯åŠ¨æ—¥å¿—,ä¼šæ˜¾ç¤º `Database: RocksDb at /path/to/data`

### Q2: å¯ä»¥ä¿®æ”¹æ•°æ®ç›®å½•è·¯å¾„å—?
**A**: å¯ä»¥,ä¿®æ”¹ `--base-path` å‚æ•°:
```bash
--base-path /home/user/custom-chain-data/
```

### Q3: æ•°æ®ç›®å½•å¯ä»¥åœ¨ä¸åŒæœºå™¨é—´è¿ç§»å—?
**A**: å¯ä»¥,ä½†éœ€è¦ç›¸åŒç‰ˆæœ¬çš„èŠ‚ç‚¹è½¯ä»¶:
```bash
# æœºå™¨A: åœæ­¢èŠ‚ç‚¹,æ‰“åŒ…æ•°æ®
tar -czf chain-data.tar.gz my-chain-state/

# æœºå™¨B: è§£å‹æ•°æ®,å¯åŠ¨èŠ‚ç‚¹
tar -xzf chain-data.tar.gz
./target/release/memopark-node --dev --base-path ./my-chain-state/
```

### Q4: --tmp å’Œ --base-path å¯ä»¥åŒæ—¶ä½¿ç”¨å—?
**A**: ä¸å¯ä»¥,å®ƒä»¬æ˜¯äº’æ–¥çš„:
- `--tmp`: ä¸´æ—¶æ¨¡å¼
- `--base-path`: æŒä¹…åŒ–æ¨¡å¼

### Q5: å¦‚ä½•æ¸…ç†ä½†ä¿ç•™å¯†é’¥?
**A**: ä»…åˆ é™¤æ•°æ®åº“:
```bash
rm -rf ./my-chain-state/chains/dev/db/
# ä¿ç•™ keystore/ å’Œ network/
```

---

## ğŸ¯ æ¨èé…ç½®

### å¼€å‘ç¯å¢ƒ (å¿«é€Ÿè¿­ä»£)
```bash
./target/release/memopark-node --dev --tmp
```

### æµ‹è¯•ç¯å¢ƒ (æ•°æ®ä¿ç•™)
```bash
./target/release/memopark-node \
  --dev \
  --base-path ./test-chain-data/ \
  --rpc-external \
  --rpc-cors=all
```

### ç”Ÿäº§ç¯å¢ƒ (å®Œæ•´é…ç½®)
```bash
./target/release/memopark-node \
  --dev \
  --base-path /var/lib/memopark/ \
  --rpc-external \
  --rpc-port 9944 \
  --rpc-cors=http://yourdomain.com \
  --rpc-methods=Safe \
  --pruning=256 \
  --db-cache=1024 \
  --name="Memopark-Node-1" \
  --telemetry-url="wss://telemetry.polkadot.io/submit/ 0"
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [é“¾èŠ‚ç‚¹å¯åŠ¨è¯´æ˜](./é“¾èŠ‚ç‚¹å¯åŠ¨è¯´æ˜.md)
- [Substrate æ•°æ®åº“æ–‡æ¡£](https://docs.substrate.io/maintain/chain-ops/database/)
- [RPC é…ç½®æŒ‡å—](https://docs.substrate.io/reference/command-line-tools/node-template/)

---

**æœ€åæ›´æ–°**: 2025-10-06
**ç‰ˆæœ¬**: v1.0

