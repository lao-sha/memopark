# 🚀 项目改名优化 - 快速开始指南

**📅 日期**: 2025-10-29  
**🎯 目标**: 完成剩余的改名优化工作  
**⏱️ 预计时间**: 35分钟 - 3小时（取决于选择的方案）

---

## 📊 当前状态

### ✅ 已完成（95%）
- Pallet层完全重命名
- Runtime配置更新
- 前端变量和API路径更新
- UI文本更新（DUST → DUST）
- Package.json的name字段更新
- 代码注释更新（79%）

### ⏳ 待优化（5%）
- 目录名称（5个目录）
- 脚本路径引用（7个文件）
- description字段（1处）
- 代码注释残留（21%）
- 文档内容（可选）

---

## 🎯 推荐执行方案

### 方案选择建议

| 方案 | 时间 | 影响 | 适用场景 |
|------|------|------|----------|
| **快速方案** | 35分钟 | 最小 | 立即改善，不影响团队 |
| **标准方案** | 2小时 | 中等 | 本周内完成，需团队协调 |
| **完整方案** | 3小时 | 较大 | 分阶段执行，达到100% |

---

## 🏃 快速方案（35分钟）⭐ 推荐新手

**适用场景**: 快速改善，不修改目录名，不影响现有工作流

### 步骤1: 创建备份（1分钟）

```bash
cd /home/xiaodong/文档/stardust

# 创建备份标签
git add .
git commit -m "保存当前状态 - 优化前备份" || true
git tag -a before-optimization-quickfix -m "快速优化前备份"
```

### 步骤2: 更新description字段（2分钟）

```bash
# 更新 memopark-governance/package.json
sed -i 's/Memopark 治理管理平台/Stardust 治理管理平台/g' \
  memopark-governance/package.json

# 验证修改
echo "=== 验证 memopark-governance/package.json ==="
grep "description" memopark-governance/package.json
```

### 步骤3: 完成代码注释更新（30分钟）

```bash
# 创建临时脚本
cat > /tmp/finish-comments-update.sh << 'EOF'
#!/bin/bash
set -e

REPO_ROOT="/home/xiaodong/文档/stardust"
cd "$REPO_ROOT"

echo "=== 开始更新代码注释中的 DUST → DUST ==="

# 更新Rust代码注释（仅中文注释）
find pallets runtime -type f -name "*.rs" -exec sed -i \
  -e 's/\(\/\/.*\)DUST\([^_A-Z]\)/\1DUST\2/g' \
  -e 's/\(\/\/.*\)DUST$/\1DUST/g' \
  -e 's/\(\/\/\/.*\)DUST\([^_A-Z]\)/\1DUST\2/g' \
  -e 's/\(\/\/\/.*\)DUST$/\1DUST/g' \
  {} +

# 更新TypeScript代码注释
find memopark-dapp memopark-governance -type f \( -name "*.ts" -o -name "*.tsx" \) -exec sed -i \
  -e 's/\(\/\/.*\)DUST\([^_A-Z]\)/\1DUST\2/g' \
  -e 's/\(\/\/.*\)DUST$/\1DUST/g' \
  -e 's/\(\/\*.*\)DUST\([^_A-Z]\)/\1DUST\2/g' \
  -e 's/\(\*.*\)DUST\([^_A-Z]\)/\1DUST\2/g' \
  {} +

echo "=== 代码注释更新完成 ==="

# 显示修改统计
echo ""
echo "=== 修改统计 ==="
git diff --stat
EOF

chmod +x /tmp/finish-comments-update.sh
/tmp/finish-comments-update.sh
```

### 步骤4: 验证和提交（2分钟）

```bash
# 检查修改
git diff

# 编译验证（可选，但推荐）
cd memopark-dapp
npm run build 2>&1 | head -20

# 如果编译通过，提交更改
cd /home/xiaodong/文档/stardust
git add .
git commit -m "优化: 完成代码注释和description字段更新"
git tag -a after-optimization-quickfix -m "快速优化后"
```

### ✅ 完成！

快速方案执行完毕，你已经完成：
- ✅ description字段更新
- ✅ 代码注释更新（从79% → ~95%）
- ✅ Git备份和提交

---

## 🏗️ 标准方案（2小时）⭐⭐ 推荐进阶用户

**适用场景**: 包含目录重命名，需要团队协调

### 前提条件
- ✅ 已通知所有团队成员
- ✅ 已选择合适的执行时间
- ✅ 已备份所有重要数据

### 步骤1: 执行快速方案（35分钟）

先执行上面的快速方案步骤1-4

### 步骤2: 停止所有服务（1分钟）

```bash
cd /home/xiaodong/文档/stardust

# 停止所有服务
./停止所有服务.sh || true

# 确认没有进程在运行
ps aux | grep -E "node|vite|stardust-node" || true
```

### 步骤3: 创建备份（1分钟）

```bash
# 创建备份标签
git add .
git commit -m "保存当前状态 - 目录重命名前备份" || true
git tag -a before-dir-rename -m "目录重命名前备份"
```

### 步骤4: 重命名目录（5分钟）

```bash
cd /home/xiaodong/文档/stardust

# 重命名5个目录
mv memopark-dapp stardust-dapp
mv memopark-governance stardust-governance
mv memopark-gov stardust-gov
mv memopark-squid stardust-squid
mv memopark-gov-scripts stardust-gov-scripts

# 验证重命名
ls -d stardust-* | grep -E "dapp|governance|gov|squid"
```

### 步骤5: 更新脚本路径（10分钟）

```bash
# 创建路径更新脚本
cat > /tmp/update-script-paths.sh << 'EOF'
#!/bin/bash
set -e

REPO_ROOT="/home/xiaodong/文档/stardust"
cd "$REPO_ROOT"

echo "=== 更新脚本中的路径引用 ==="

# 更新启动脚本
sed -i 's/memopark-dapp/stardust-dapp/g' 启动所有服务.sh
sed -i 's/memopark-governance/stardust-governance/g' 启动所有服务.sh
sed -i 's/memopark-gov/stardust-gov/g' 启动所有服务.sh

# 更新停止脚本
sed -i 's/memopark-dapp/stardust-dapp/g' 停止所有服务.sh
sed -i 's/memopark-governance/stardust-governance/g' 停止所有服务.sh

# 更新INSTALL脚本
sed -i 's/memopark-dapp/stardust-dapp/g' stardust-dapp/EXECUTE_FIX.sh 2>/dev/null || true
sed -i 's/memopark-gov/stardust-gov/g' stardust-gov/INSTALL.sh 2>/dev/null || true
sed -i 's/memopark-governance/stardust-governance/g' stardust-governance/INSTALL.sh 2>/dev/null || true

# 更新测试脚本
sed -i 's/memopark-dapp/stardust-dapp/g' tests/integration/run-all.sh 2>/dev/null || true

# 更新IPFS脚本
sed -i 's/memo-ipfs/stardust-ipfs/g' scripts/enable-memo-ipfs.sh 2>/dev/null || true

echo "=== 路径更新完成 ==="
EOF

chmod +x /tmp/update-script-paths.sh
/tmp/update-script-paths.sh
```

### 步骤6: 更新README和文档（5分钟）

```bash
# 更新主README中的路径引用
sed -i 's/memopark-dapp/stardust-dapp/g' README.md
sed -i 's/memopark-governance/stardust-governance/g' README.md

# 更新快速开始文档（如果存在）
find docs -type f -name "*.md" -exec sed -i \
  -e 's/memopark-dapp/stardust-dapp/g' \
  -e 's/memopark-governance/stardust-governance/g' \
  -e 's/memopark-gov/stardust-gov/g' \
  {} +
```

### 步骤7: 验证服务启动（10分钟）

```bash
cd /home/xiaodong/文档/stardust

# 测试启动脚本
echo "=== 测试启动所有服务 ==="
./启动所有服务.sh

# 等待30秒
sleep 30

# 检查服务状态
ps aux | grep -E "node|vite|stardust-node"

# 测试停止脚本
echo "=== 测试停止所有服务 ==="
./停止所有服务.sh
```

### 步骤8: 提交更改（2分钟）

```bash
cd /home/xiaodong/文档/stardust

# 暂存所有更改
git add .

# 提交
git commit -m "重构: 目录重命名 memopark → stardust

- 重命名 memopark-dapp → stardust-dapp
- 重命名 memopark-governance → stardust-governance  
- 重命名 memopark-gov → stardust-gov
- 重命名 memopark-squid → stardust-squid
- 重命名 memopark-gov-scripts → stardust-gov-scripts
- 更新所有脚本中的路径引用
- 更新文档中的路径引用"

# 创建标签
git tag -a after-dir-rename -m "目录重命名后"
```

### ✅ 完成！

标准方案执行完毕，你已经完成：
- ✅ 快速方案的所有内容
- ✅ 5个目录重命名
- ✅ 所有脚本路径更新
- ✅ 文档路径更新
- ✅ 验证服务正常启动

### 📢 通知团队成员

发送通知给所有团队成员：

```
📢 重要通知：项目目录已重命名

以下目录已更新，请更新本地配置：

旧目录名               新目录名
─────────────────────────────────────
memopark-dapp        → stardust-dapp
memopark-governance  → stardust-governance
memopark-gov         → stardust-gov
memopark-squid       → stardust-squid
memopark-gov-scripts → stardust-gov-scripts

操作步骤：
1. git pull origin [your-branch]
2. 更新你的IDE/编辑器项目设置
3. 重新启动开发服务器

如有问题请联系。
```

---

## 🎨 完整方案（3小时）⭐⭐⭐ 推荐团队执行

**适用场景**: 达到100%改名一致性，包含文档更新

### 步骤1-8: 执行标准方案（2小时）

先执行上面的标准方案步骤1-8

### 步骤9: 批量更新文档（1小时）

```bash
cd /home/xiaodong/文档/stardust

# 创建文档更新脚本
cat > /tmp/update-docs.sh << 'EOF'
#!/bin/bash
set -e

REPO_ROOT="/home/xiaodong/文档/stardust"
cd "$REPO_ROOT"

echo "=== 批量更新Markdown文档 ==="

# 更新所有README文件
find . -type f -name "README.md" -not -path "*/node_modules/*" -exec sed -i \
  -e 's/DUST\([^_A-Z]\)/DUST\1/g' \
  -e 's/DUST$/DUST/g' \
  -e 's/memopark-dapp/stardust-dapp/g' \
  -e 's/memopark-governance/stardust-governance/g' \
  -e 's/Memopark/Stardust/g' \
  {} +

# 更新docs目录下的所有md文件（排除已生成的报告）
find docs -type f -name "*.md" \
  -not -name "*RENAME*.md" \
  -not -name "*重命名*.md" \
  -not -name "*MEMO_TO_DUST*.md" \
  -exec sed -i \
    -e 's/DUST\([^_A-Z]\)/DUST\1/g' \
    -e 's/DUST$/DUST/g' \
    -e 's/Memopark/Stardust/g' \
    {} +

# 更新pallets目录下的README
find pallets -type f -name "README.md" -exec sed -i \
  -e 's/DUST\([^_A-Z]\)/DUST\1/g' \
  -e 's/DUST$/DUST/g' \
  -e 's/Memopark/Stardust/g' \
  {} +

echo "=== 文档更新完成 ==="

# 显示修改统计
git diff --stat
EOF

chmod +x /tmp/update-docs.sh
/tmp/update-docs.sh
```

### 步骤10: 最终验证（10分钟）

```bash
cd /home/xiaodong/文档/stardust

# 检查是否还有遗漏
echo "=== 检查 memopark 残留 ==="
grep -r "memopark" --include="*.md" --exclude-dir=node_modules . | wc -l

echo "=== 检查 DUST 残留（代码中）==="
grep -r "DUST[^_A-Z]" --include="*.rs" pallets runtime | wc -l

# 如果数量很少，手动检查并修复
```

### 步骤11: 提交更改（2分钟）

```bash
git add .
git commit -m "文档: 批量更新MEMO→DUST和Memopark→Stardust

- 更新所有README文件
- 更新docs目录文档
- 更新pallets文档
- 达到100%品牌一致性"

git tag -a after-full-optimization -m "完整优化后 - 100%完成"
```

### ✅ 完成！

完整方案执行完毕，你已经达到**100%改名一致性**！

---

## 🚨 故障排除

### 问题1: 目录重命名后Git报错

**错误信息**:
```
fatal: pathspec 'memopark-dapp' did not match any files
```

**解决方案**:
```bash
# Git会自动跟踪重命名，使用git add -A
git add -A
git status  # 应该看到 renamed: memopark-dapp -> stardust-dapp
```

### 问题2: 服务启动失败

**错误信息**:
```
cd: no such file or directory: memopark-dapp
```

**解决方案**:
```bash
# 检查脚本路径是否更新
grep "memopark" 启动所有服务.sh

# 如果还有残留，手动更新
vim 启动所有服务.sh
```

### 问题3: 编译错误

**错误信息**:
```
Cannot find module 'memopark-xxx'
```

**解决方案**:
```bash
# 清除缓存并重新安装
cd stardust-dapp
rm -rf node_modules package-lock.json
npm install
```

### 问题4: 回滚到优化前

```bash
# 查看所有备份标签
git tag -l "before-*"

# 回滚到特定标签
git reset --hard before-optimization-quickfix  # 快速方案前
# 或
git reset --hard before-dir-rename  # 目录重命名前

# 如果已经重命名目录，还需要手动改回来
mv stardust-dapp memopark-dapp
mv stardust-governance memopark-governance
# ... 其他目录
```

---

## 📋 执行检查清单

### 快速方案检查清单

- [ ] 创建Git备份标签 `before-optimization-quickfix`
- [ ] 更新 memopark-governance/package.json 的 description
- [ ] 执行代码注释更新脚本
- [ ] 编译验证前端
- [ ] 提交更改并创建标签 `after-optimization-quickfix`

**预计时间**: 35分钟  
**风险级别**: 🟢 低

---

### 标准方案检查清单

- [ ] 完成快速方案所有步骤
- [ ] 通知团队成员
- [ ] 停止所有服务
- [ ] 创建Git备份标签 `before-dir-rename`
- [ ] 重命名5个目录
- [ ] 执行路径更新脚本
- [ ] 更新README和文档
- [ ] 验证服务启动
- [ ] 提交更改并创建标签 `after-dir-rename`
- [ ] 通知团队成员更新本地配置

**预计时间**: 2小时  
**风险级别**: 🟡 中

---

### 完整方案检查清单

- [ ] 完成标准方案所有步骤
- [ ] 执行文档更新脚本
- [ ] 最终验证残留
- [ ] 提交更改并创建标签 `after-full-optimization`
- [ ] 庆祝达到100%！🎉

**预计时间**: 3小时  
**风险级别**: 🟡 中

---

## 📊 优化成果预期

### 快速方案成果

| 项目 | 优化前 | 优化后 | 提升 |
|------|--------|--------|------|
| 代码注释 | 79% | ~95% | +16% |
| description字段 | 0% | 100% | +100% |
| **总体完成度** | **95%** | **97%** | **+2%** |

### 标准方案成果

| 项目 | 优化前 | 优化后 | 提升 |
|------|--------|--------|------|
| 代码注释 | 79% | ~95% | +16% |
| 目录名称 | 0% | 100% | +100% |
| 脚本路径 | 0% | 100% | +100% |
| description字段 | 0% | 100% | +100% |
| **总体完成度** | **95%** | **98%** | **+3%** |

### 完整方案成果

| 项目 | 优化前 | 优化后 | 提升 |
|------|--------|--------|------|
| 代码注释 | 79% | ~98% | +19% |
| 目录名称 | 0% | 100% | +100% |
| 脚本路径 | 0% | 100% | +100% |
| 文档内容 | 10% | ~80% | +70% |
| **总体完成度** | **95%** | **99-100%** | **+4-5%** |

---

## 🎯 开始执行

### 推荐执行路径

1. **如果你是单人开发**：
   - 选择 **标准方案** 或 **完整方案**
   - 立即执行，2-3小时完成

2. **如果你是小团队（2-5人）**：
   - 先执行 **快速方案**（立即）
   - 协调后执行 **标准方案**（本周）
   - 可选执行 **完整方案**（未来2周）

3. **如果你是大团队（5人以上）**：
   - 先执行 **快速方案**（立即）
   - 充分协调后执行 **标准方案**（选择合适时机）
   - 分批执行 **完整方案**（长期计划）

### 立即开始

```bash
# 复制下面的命令开始执行快速方案
cd /home/xiaodong/文档/stardust
git add .
git commit -m "保存当前状态 - 优化前备份" || true
git tag -a before-optimization-quickfix -m "快速优化前备份"

# 然后按照上面的步骤2-4执行
```

---

**📅 文档生成时间**: 2025-10-29  
**✍️ 创建者**: AI Assistant  
**🔄 版本**: v1.0  
**📦 状态**: ✅ 就绪，可立即执行

**🚀 祝你顺利完成优化！达到100%改名一致性！🎉**

