# é“¾ç«¯ä»£ç å…¨é¢æ¸…ç† - ç»¼åˆæ–¹æ¡ˆ

**ç”Ÿæˆæ—¶é—´**: 2025-10-29  
**ä»»åŠ¡**: æ¸…ç†é“¾ç«¯ä»£ç ä¸­æ‰€æœ‰ `memo` å’Œ `memopark` ç›¸å…³å­—æ ·

---

## ğŸ“Š å…¨é¢æ‰«æç»“æœ

### æ€»ä½“ç»Ÿè®¡

| å…³é”®è¯ | åŒ¹é…æ•° | æ–‡ä»¶æ•° | ä¼˜å…ˆçº§ | çŠ¶æ€ |
|--------|--------|--------|--------|------|
| `memo` (å°å†™) | 986 | 92 | â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸ | ğŸ“‹ å¾…æ¸…ç† |
| `memopark` (å°å†™) | 64 | 20 | â­ï¸â­ï¸â­ï¸â­ï¸ | ğŸ“‹ å¾…æ¸…ç† |
| **æ€»è®¡** | **1050** | **~100** | - | **å¾…æ¸…ç†** |

---

## ğŸ¯ æ ¸å¿ƒé—®é¢˜æ€»ç»“

### é—®é¢˜ 1ï¼šç”¨æˆ·å¯è§ä¿¡æ¯ä¸ä¸€è‡´ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸

**å‰ç«¯ vs é“¾ç«¯å¯¹æ¯”**:

| é¡¹ç›® | å‰ç«¯ | é“¾ç«¯ | çŠ¶æ€ |
|------|------|------|------|
| **é“¾åç§°** | - | `MEMOPARK` | âŒ ä¸ä¸€è‡´ |
| **ä»£å¸ç¬¦å·** | æ˜¾ç¤º "DUST" âœ… | è¿”å› "MEMO" âŒ | âŒ ä¸ä¸€è‡´ |
| **å˜é‡å** | `dustAmount` âœ… | `memo_amount` âŒ | âŒ ä¸ä¸€è‡´ |
| **å‡½æ•°å** | `formatDUST` âœ… | `release_memo` âŒ | âŒ ä¸ä¸€è‡´ |
| **APIè·¯å¾„** | `stardustAppeals` âœ… | - | âœ… ä¸€è‡´ |
| **ç‰ˆæƒå£°æ˜** | - | `Memopark Team` | âŒ ä¸ä¸€è‡´ |

**å½±å“**:
- âŒ ç”¨æˆ·çœ‹åˆ°ä»£å¸ç¬¦å·ä¸º "MEMO"ï¼Œä½†å‰ç«¯æ˜¾ç¤ºä¸º "DUST"
- âŒ é’±åŒ…é›†æˆæ—¶ä½¿ç”¨é”™è¯¯çš„é“¾åç§°
- âŒ å“ç‰Œæ ‡è¯†ä¸ç»Ÿä¸€

---

### é—®é¢˜ 2ï¼šå…³é”®APIå‡½æ•°ä¸åŒ¹é…ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰â­ï¸â­ï¸â­ï¸â­ï¸

**Pricing Pallet**:
```rust
// å½“å‰
pub fn get_memo_market_price_weighted() -> u64

// åº”æ”¹ä¸º
pub fn get_dust_market_price_weighted() -> u64
```

**Trading Pallet**:
```rust
// å½“å‰
pub fn release_memo(origin, order_id)
pub fn bridge_memo_to_tron(...)
pub fn bridge_usdt_to_memo(...)

// åº”æ”¹ä¸º
pub fn release_dust(origin, order_id)
pub fn bridge_dust_to_tron(...)
pub fn bridge_usdt_to_dust(...)
```

**å½±å“**:
- âš ï¸ å‰ç«¯å·²ä½¿ç”¨ `tradingService.ts` å°è£…ï¼Œå½±å“æœ‰é™
- âš ï¸ ç›´æ¥è°ƒç”¨é“¾ç«¯APIæ—¶ä¼šé‡åˆ°ä¸ä¸€è‡´é—®é¢˜

---

### é—®é¢˜ 3ï¼šæ•°æ®ç»“æ„å­—æ®µåä¸ä¸€è‡´ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰â­ï¸â­ï¸â­ï¸â­ï¸

**å­˜å‚¨ç»“æ„**:
```rust
// OtcOrder
pub struct OtcOrder<AccountId, Balance, BlockNumber> {
    pub memo_amount: Balance,  // âŒ åº”ä¸º dust_amount
    // ...
}

// PriceRecord
pub struct PriceRecord {
    pub memo_qty: u128,  // âŒ åº”ä¸º dust_qty
}
```

**äº‹ä»¶**:
```rust
// SwapCreated
SwapCreated { 
    memo_amount: BalanceOf<T>,  // âŒ åº”ä¸º dust_amount
    // ...
}
```

**å½±å“**:
- âš ï¸ å‰ç«¯ç›‘å¬äº‹ä»¶æ—¶ï¼Œå­—æ®µå `memo_amount` éœ€æ”¹ä¸º `dust_amount`
- âš ï¸ å‰ç«¯æŸ¥è¯¢é“¾ä¸Šæ•°æ®æ—¶ï¼Œè®¿é—®å­—æ®µéœ€æ›´æ–°

---

## ğŸš€ æ¨èæ‰§è¡Œæ–¹æ¡ˆ

### æ–¹æ¡ˆ Aï¼šå…¨é¢æ¸…ç†ï¼ˆå¼ºçƒˆæ¨èï¼‰â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸

**æ‰§è¡Œä¸¤ä¸ªæ¸…ç†è„šæœ¬**ï¼Œå½»åº•è§£å†³æ‰€æœ‰ä¸ä¸€è‡´é—®é¢˜ã€‚

#### æ­¥éª¤ 1: æ¸…ç† memo å­—æ ·ï¼ˆ70åˆ†é’Ÿï¼‰

```bash
cd /home/xiaodong/æ–‡æ¡£/memopark
./docs/é“¾ç«¯memoæ¸…ç†-è‡ªåŠ¨æ‰§è¡Œ.sh
```

**åŒ…å«**:
- âœ… é“¾åç§°ï¼š`MEMOPARK` â†’ `STARDUST`
- âœ… ä»£å¸ç¬¦å·ï¼š`MEMO` â†’ `DUST`
- âœ… å‡½æ•°åï¼š`release_memo` â†’ `release_dust`
- âœ… å˜é‡åï¼š`memo_amount` â†’ `dust_amount`
- âœ… æ‰€æœ‰æ³¨é‡Šä¸­çš„ `MEMO` â†’ `DUST`

#### æ­¥éª¤ 2: æ¸…ç† memopark å­—æ ·ï¼ˆ10åˆ†é’Ÿï¼‰

```bash
cd /home/xiaodong/æ–‡æ¡£/memopark
./docs/é“¾ç«¯memoparkæ¸…ç†-è‡ªåŠ¨æ‰§è¡Œ.sh
```

**åŒ…å«**:
- âœ… ç‰ˆæƒå£°æ˜ï¼š`Memopark Team` â†’ `Stardust Team`
- âœ… æ³¨é‡Šï¼š`Memopark:` â†’ `Stardust:`
- âœ… æ¸…ç†ç¼–è¯‘å™¨æ—¥å¿—æ–‡ä»¶

#### æ­¥éª¤ 3: å…¨é‡ç¼–è¯‘éªŒè¯

```bash
cargo build --release
```

#### æ­¥éª¤ 4: å¯åŠ¨èŠ‚ç‚¹æµ‹è¯•

```bash
./target/release/stardust-node --dev --tmp
```

**æ€»æ—¶é—´**: çº¦ 80-90 åˆ†é’Ÿï¼ˆè‡ªåŠ¨åŒ–æ‰§è¡Œï¼Œå®é™…ç­‰å¾…çº¦ 10 åˆ†é’Ÿï¼‰

**ä¼˜åŠ¿**:
- âœ… å½»åº•è§£å†³æ‰€æœ‰ä¸ä¸€è‡´é—®é¢˜
- âœ… å‰ç«¯å’Œé“¾ç«¯å®Œå…¨åŒæ­¥
- âœ… ä»£å¸ç¬¦å·æ˜¾ç¤ºæ­£ç¡®
- âœ… å“ç‰Œæ ‡è¯†ç»Ÿä¸€
- âœ… è‡ªåŠ¨å¤‡ä»½ï¼Œæ˜“å›æ»š

---

### æ–¹æ¡ˆ Bï¼šä»…ä¿®æ”¹ç”¨æˆ·å¯è§ä¿¡æ¯ï¼ˆæœ€å°åŒ–ï¼‰

**å¿«é€Ÿè§£å†³æ˜¾ç¤ºé—®é¢˜**ï¼Œä½†å†…éƒ¨ä»£ç ä»ä¿æŒä¸ä¸€è‡´ã€‚

**ä¿®æ”¹å†…å®¹**:
1. é“¾åç§°ï¼š`MEMOPARK` â†’ `STARDUST`
2. ä»£å¸ç¬¦å·ï¼š`MEMO` â†’ `DUST`
3. Runtimeåç§°ï¼š`memopark-runtime` â†’ `stardust-runtime`

**æ‰‹åŠ¨æ‰§è¡Œ**:
```bash
# node/src/chain_spec.rs
sed -i 's/\.with_name("MEMOPARK")/.with_name("STARDUST")/g' node/src/chain_spec.rs
sed -i 's/"tokenSymbol"\.into(), "MEMO"\.into()/"tokenSymbol".into(), "DUST".into()/g' node/src/chain_spec.rs

# runtime/src/lib.rs
sed -i 's/"memopark-runtime"/"stardust-runtime"/g' runtime/src/lib.rs
```

**æ—¶é—´**: 5 åˆ†é’Ÿ

**ç¼ºç‚¹**:
- âŒ å†…éƒ¨ä»£ç ä»ä½¿ç”¨ `memo_amount`ï¼ˆæ··ä¹±ï¼‰
- âŒ APIå‡½æ•°åä»ä¸º `release_memo`
- âŒ åç»­ä»éœ€å…¨é¢æ¸…ç†

---

### æ–¹æ¡ˆ Cï¼šæš‚ä¸æ¸…ç†ï¼Œæ ‡è®°æŠ€æœ¯å€ºåŠ¡

**é€‚ç”¨åœºæ™¯**: å½“å‰æœ‰æ›´ç´§æ€¥çš„ä»»åŠ¡ï¼ˆå¦‚ä¿®å¤å‰ç«¯ç¼–è¯‘é”™è¯¯ï¼‰

**é£é™©**:
- âŒ å‰ç«¯ä»£å¸ç¬¦å·æ˜¾ç¤ºé”™è¯¯
- âŒ ä»£ç åº“å­˜åœ¨ä¸¥é‡ä¸ä¸€è‡´
- âŒ æŠ€æœ¯å€ºåŠ¡ç´¯ç§¯

---

## ğŸ“‹ å¯¹æ¯”ï¼šä¸‰ç§æ–¹æ¡ˆ

| æ–¹æ¡ˆ | æ—¶é—´ | å®Œæ•´åº¦ | é£é™© | æ¨èæŒ‡æ•° |
|------|------|--------|------|----------|
| **æ–¹æ¡ˆAï¼šå…¨é¢æ¸…ç†** | 80-90åˆ†é’Ÿ | 100% | æä½ | â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸ |
| **æ–¹æ¡ˆBï¼šæœ€å°åŒ–** | 5åˆ†é’Ÿ | 30% | ä½ | â­ï¸â­ï¸ |
| **æ–¹æ¡ˆCï¼šæš‚ä¸æ¸…ç†** | 0åˆ†é’Ÿ | 0% | é«˜ | â­ï¸ |

---

## ğŸ“Š è¯¦ç»†ä¿®æ”¹æ¸…å•

### æ¸…ç† memo å­—æ ·ï¼ˆé“¾ç«¯memoæ¸…ç†-è‡ªåŠ¨æ‰§è¡Œ.shï¼‰

| ç±»åˆ« | ä¿®æ”¹å†…å®¹ | æ–‡ä»¶æ•° | é¢„è®¡æ—¶é—´ |
|------|----------|--------|----------|
| **é“¾æ ‡è¯†** | `MEMOPARK` â†’ `STARDUST` | 2 | 10åˆ†é’Ÿ |
| **ä»£å¸ç¬¦å·** | `MEMO` â†’ `DUST` | 2 | å·²åŒ…å« |
| **Pricing Pallet** | `memo_qty` â†’ `dust_qty` | 3 | 15åˆ†é’Ÿ |
| **Trading Pallet** | `release_memo` â†’ `release_dust` | 6 | 20åˆ†é’Ÿ |
| **Runtimeé…ç½®** | `memo_price_usdt` â†’ `dust_price_usdt` | 1 | 10åˆ†é’Ÿ |
| **æ³¨é‡Šæ¸…ç†** | æ‰¹é‡æ›¿æ¢ `MEMO` â†’ `DUST` | ~80 | 5åˆ†é’Ÿ |
| **ç¼–è¯‘éªŒè¯** | `cargo build --release` | - | 10åˆ†é’Ÿ |

### æ¸…ç† memopark å­—æ ·ï¼ˆé“¾ç«¯memoparkæ¸…ç†-è‡ªåŠ¨æ‰§è¡Œ.shï¼‰

| ç±»åˆ« | ä¿®æ”¹å†…å®¹ | æ–‡ä»¶æ•° | é¢„è®¡æ—¶é—´ |
|------|----------|--------|----------|
| **ç‰ˆæƒå£°æ˜** | `Memopark Team` â†’ `Stardust Team` | ~20 | 5åˆ†é’Ÿ |
| **æ³¨é‡Š** | `Memopark:` â†’ `Stardust:` | ~20 | 5åˆ†é’Ÿ |
| **æ—¥å¿—æ¸…ç†** | åˆ é™¤ `rustc-ice-*.txt` | 3 | 2åˆ†é’Ÿ |

---

## âš ï¸ é£é™©è¯„ä¼°

| é£é™©é¡¹ | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ | ä¸¥é‡åº¦ |
|--------|------|------|----------|--------|
| **å‰ç«¯APIè°ƒç”¨å¤±è´¥** | ä¸­ | ä½ | `tradingService.ts` å·²å°è£… | ä¸­ |
| **äº‹ä»¶ç›‘å¬å¤±è´¥** | ä¸­ | ä½ | éœ€åŒæ­¥æ›´æ–°å‰ç«¯äº‹ä»¶å¤„ç† | ä¸­ |
| **ç¼–è¯‘å¤±è´¥** | é«˜ | æä½ | Gitå¤‡ä»½ï¼Œæ˜“å›æ»š | ä½ |
| **æ•°æ®ä¸å…¼å®¹** | é«˜ | æ—  | é›¶è¿ç§»é˜¶æ®µï¼Œæ— å†å²æ•°æ® | æ—  |

**æ€»ä½“é£é™©**: âœ… **ä½**ï¼ˆè‡ªåŠ¨å¤‡ä»½ + é›¶è¿ç§»é˜¶æ®µï¼‰

---

## âœ… éªŒè¯æ¸…å•

### ç¼–è¯‘éªŒè¯
- [ ] `cargo check -p stardust-node` é€šè¿‡
- [ ] `cargo check -p stardust-runtime` é€šè¿‡
- [ ] `cargo check -p pallet-pricing` é€šè¿‡
- [ ] `cargo check -p pallet-trading` é€šè¿‡
- [ ] `cargo build --release` é€šè¿‡

### åŠŸèƒ½éªŒè¯
- [ ] èŠ‚ç‚¹å¯åŠ¨æˆåŠŸ
- [ ] é“¾åç§°æ˜¾ç¤ºä¸º "STARDUST"
- [ ] Polkadot.js Apps æ˜¾ç¤ºä»£å¸ç¬¦å·ä¸º "DUST"
- [ ] å‰ç«¯ DApp æ˜¾ç¤ºä»£å¸ç¬¦å·ä¸º "DUST"
- [ ] Trading OTC è®¢å•åˆ›å»ºæˆåŠŸ
- [ ] Bridge å…‘æ¢åŠŸèƒ½æ­£å¸¸
- [ ] Pricing å®æ—¶ä»·æ ¼æŸ¥è¯¢æ­£å¸¸

### ä»£ç è´¨é‡
- [ ] æ—  `memo_amount` æ®‹ç•™
- [ ] æ—  `MEMO` ä»£å¸å•ä½æ®‹ç•™
- [ ] æ—  `Memopark Team` ç‰ˆæƒå£°æ˜æ®‹ç•™
- [ ] æ—  `memopark-runtime` æ ‡è¯†æ®‹ç•™
- [ ] Git æäº¤æ¸…æ™°
- [ ] æ–‡æ¡£åŒæ­¥æ›´æ–°

---

## ğŸ“ æ‰§è¡Œååç»­ä»»åŠ¡

### 1. å‰ç«¯é€‚é…ï¼ˆå¦‚éœ€è¦ï¼‰

**æ£€æŸ¥äº‹ä»¶ç›‘å¬**:
```typescript
// æ—§: event.data.memo_amount
// æ–°: event.data.dust_amount
```

**æ£€æŸ¥å­˜å‚¨æŸ¥è¯¢**:
```typescript
// æ—§: order.memo_amount
// æ–°: order.dust_amount
```

**éªŒè¯APIè°ƒç”¨**:
```bash
# æ£€æŸ¥å‰ç«¯æ˜¯å¦æœ‰ç›´æ¥è°ƒç”¨
grep -r "api.tx.trading.releaseMemo" memopark-dapp/src/
grep -r "memo_amount" memopark-dapp/src/
```

### 2. æ–‡æ¡£åŒæ­¥

- [ ] æ›´æ–°æ‰€æœ‰ README.mdï¼ˆä»£å¸ç¬¦å·ï¼‰
- [ ] æ›´æ–°å¼€å‘è€…æ–‡æ¡£ï¼ˆé“¾åç§°ï¼‰
- [ ] æ›´æ–°APIæ–‡æ¡£ï¼ˆå‡½æ•°åï¼‰

### 3. å®Œæ•´æµ‹è¯•

- [ ] ç«¯åˆ°ç«¯åŠŸèƒ½æµ‹è¯•
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•
- [ ] ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š

---

## ğŸ¯ æ¨èæ‰§è¡Œæµç¨‹

### ç«‹å³æ‰§è¡Œï¼ˆæ¨èï¼‰â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸

```bash
# æ­¥éª¤ 1: è¿›å…¥é¡¹ç›®ç›®å½•
cd /home/xiaodong/æ–‡æ¡£/memopark

# æ­¥éª¤ 2: æ‰§è¡Œ memo æ¸…ç†ï¼ˆ70åˆ†é’Ÿï¼‰
./docs/é“¾ç«¯memoæ¸…ç†-è‡ªåŠ¨æ‰§è¡Œ.sh

# æ­¥éª¤ 3: æ‰§è¡Œ memopark æ¸…ç†ï¼ˆ10åˆ†é’Ÿï¼‰
./docs/é“¾ç«¯memoparkæ¸…ç†-è‡ªåŠ¨æ‰§è¡Œ.sh

# æ­¥éª¤ 4: å…¨é‡ç¼–è¯‘ï¼ˆ10åˆ†é’Ÿï¼‰
cargo build --release

# æ­¥éª¤ 5: å¯åŠ¨èŠ‚ç‚¹æµ‹è¯•
./target/release/stardust-node --dev --tmp
```

**æ€»æ—¶é—´**: 90 åˆ†é’Ÿï¼ˆå¤§éƒ¨åˆ†æ˜¯è‡ªåŠ¨åŒ–æ‰§è¡Œï¼‰

---

## ğŸ“Š é¢„æœŸæˆæœ

æ¸…ç†å®Œæˆåï¼š

### é“¾ç«¯
- âœ… é“¾åç§°ï¼š`STARDUST`
- âœ… ä»£å¸ç¬¦å·ï¼š`DUST`
- âœ… Runtimeåç§°ï¼š`stardust-runtime`
- âœ… æ‰€æœ‰å˜é‡/å‡½æ•°åä½¿ç”¨ `dust`
- âœ… ç‰ˆæƒå£°æ˜ï¼š`Stardust Team`

### å‰ç«¯ + é“¾ç«¯åŒæ­¥
- âœ… ä»£å¸ç¬¦å·æ˜¾ç¤ºï¼š`DUST`
- âœ… å˜é‡å‘½åï¼š`dustAmount`
- âœ… å‡½æ•°å‘½åï¼š`release_dust`, `formatDUST`
- âœ… APIè·¯å¾„ï¼š`stardustAppeals`
- âœ… å“ç‰Œæ ‡è¯†ï¼šç»Ÿä¸€ä¸º `Stardust`

### ä»£ç è´¨é‡
- âœ… æ— æ··ä¹±ï¼ˆMEMO/DUSTæ··ç”¨ï¼‰
- âœ… æ— ä¸ä¸€è‡´ï¼ˆå‰ç«¯/é“¾ç«¯ï¼‰
- âœ… æ•´æ´è§„èŒƒ
- âœ… æ˜“äºç»´æŠ¤

---

## ğŸ”§ è´¨é‡ä¿è¯

### Git å¤‡ä»½ç­–ç•¥
```bash
# memo æ¸…ç†å‰
before-chain-memo-cleanup

# memo æ¸…ç†å
after-chain-memo-cleanup

# memopark æ¸…ç†å‰
before-memopark-cleanup

# memopark æ¸…ç†å
after-memopark-cleanup
```

### å›æ»šæ–¹æ¡ˆ
```bash
# å¦‚é‡é—®é¢˜ï¼Œå›æ»šåˆ° memo æ¸…ç†å‰
git reset --hard before-chain-memo-cleanup

# æˆ–å›æ»šåˆ° memopark æ¸…ç†å‰
git reset --hard before-memopark-cleanup
```

---

## ğŸ‰ ç»“è®º

**å¼ºçƒˆæ¨è**ç«‹å³æ‰§è¡Œæ–¹æ¡ˆAï¼ˆå…¨é¢æ¸…ç†ï¼‰ï¼Œç†ç”±ï¼š

1. âœ… **å½»åº•è§£å†³é—®é¢˜**ï¼šå‰ç«¯å·²å®Œæˆé‡å‘½åï¼Œé“¾ç«¯å¿…é¡»åŒæ­¥
2. âœ… **é¿å…æ··ä¹±**ï¼šéƒ¨åˆ†MEMOã€éƒ¨åˆ†DUSTä¼šå¯¼è‡´ä¸¥é‡æ··ä¹±
3. âœ… **ç”¨æˆ·ä½“éªŒ**ï¼šä»£å¸ç¬¦å·æ˜¾ç¤ºæ­£ç¡®
4. âœ… **å“ç‰Œç»Ÿä¸€**ï¼šStardust æ ‡è¯†ç»Ÿä¸€
5. âœ… **æŠ€æœ¯å€ºåŠ¡**ï¼šä¸€æ¬¡æ€§æ¸…é™¤ï¼Œé¿å…ç´¯ç§¯
6. âœ… **é£é™©å¯æ§**ï¼šè‡ªåŠ¨å¤‡ä»½ï¼Œé›¶è¿ç§»é˜¶æ®µï¼Œæ˜“å›æ»š

**é¢„è®¡æ€»æ—¶é—´**: 90åˆ†é’Ÿ  
**å®é™…æ“ä½œæ—¶é—´**: 10åˆ†é’Ÿï¼ˆå…¶ä½™ä¸ºè‡ªåŠ¨åŒ–æ‰§è¡Œï¼‰  
**é£é™©ç­‰çº§**: âœ… ä½

---

**ä¸‹ä¸€æ­¥**: ç«‹å³æ‰§è¡Œæ–¹æ¡ˆA ğŸš€

