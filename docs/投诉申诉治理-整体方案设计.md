# StardustæŠ•è¯‰/ç”³è¯‰æ²»ç† - æ•´ä½“æ–¹æ¡ˆè®¾è®¡

> **ç‰ˆæœ¬**: v1.0  
> **æ—¥æœŸ**: 2025-10-27  
> **çŠ¶æ€**: è®¾è®¡é˜¶æ®µ - å¾…è¯„å®¡  
> **è´Ÿè´£äºº**: é¡¹ç›®æ¶æ„ç»„

---

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

æœ¬æ–¹æ¡ˆæ—¨åœ¨ä¸ºStardustç”Ÿæ€å»ºç«‹ä¸€ä¸ª**ç»Ÿä¸€ã€å®‰å…¨ã€é«˜æ•ˆ**çš„æŠ•è¯‰/ç”³è¯‰æ²»ç†ä½“ç³»ï¼Œè§£å†³å½“å‰6ä¸ªè‡ªç ”palletæŠ•è¯‰æœºåˆ¶ä¸ç»Ÿä¸€çš„é—®é¢˜ï¼Œæå‡ç”¨æˆ·ä½“éªŒå’Œæ²»ç†æ•ˆç‡ã€‚

### æ ¸å¿ƒç›®æ ‡
1. âœ… **ç»Ÿä¸€æ¶æ„**ï¼šå»ºç«‹ç»Ÿä¸€çš„æŠ•è¯‰/ç”³è¯‰å¤„ç†æ¡†æ¶
2. âœ… **æƒé™æ¸…æ™°**ï¼šæ˜ç¡®ç”¨æˆ·ã€æ²»ç†ã€ç³»ç»Ÿçš„æƒè´£è¾¹ç•Œ
3. âœ… **å®‰å…¨å¯é **ï¼šå¤šå±‚å®‰å…¨æœºåˆ¶ä¿æŠ¤èµ„é‡‘å’Œæ•°æ®
4. âœ… **ç”¨æˆ·å‹å¥½**ï¼šç®€åŒ–æµç¨‹ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
5. âœ… **å¯æ‰©å±•æ€§**ï¼šæ”¯æŒæœªæ¥æ–°ä¸šåŠ¡åŸŸçš„å¿«é€Ÿæ¥å…¥

---

## ğŸ—ï¸ æ•´ä½“æ¶æ„è®¾è®¡

### æ¶æ„å›¾

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·å±‚ (User Layer)                       â”‚
â”‚  - æäº¤æŠ•è¯‰/ç”³è¯‰    - æä¾›è¯æ®    - æ’¤å›ç”³è¯‰    - æŸ¥è¯¢çŠ¶æ€      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å‰ç«¯åº”ç”¨å±‚ (Frontend Layer)                   â”‚
â”‚  - ç»Ÿä¸€æŠ•è¯‰å…¥å£    - è¯æ®ä¸Šä¼     - è¿›åº¦è¿½è¸ª    - æ¶ˆæ¯é€šçŸ¥       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   APIèšåˆå±‚ (API Aggregation)                    â”‚
â”‚  - è·¯ç”±åˆ†å‘    - æƒé™æ ¡éªŒ    - æ•°æ®èšåˆ    - äº‹ä»¶ç›‘å¬           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ²»ç†ä¸­æ¢ (Governance Hub)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚         pallet-stardust-appeals (æ ¸å¿ƒç”³è¯‰å¼•æ“)        â”‚           â”‚
â”‚  â”‚  - ç”³è¯‰ç™»è®°    - å…¬ç¤ºæœŸç®¡ç†    - è‡ªåŠ¨æ‰§è¡Œ        â”‚           â”‚
â”‚  â”‚  - é‡è¯•æœºåˆ¶    - åº”ç­”å¦å†³      - æŠ¼é‡‘ç®¡ç†        â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚      pallet-arbitration (äº‰è®®ä»²è£ä¸­å¿ƒ)           â”‚           â”‚
â”‚  â”‚  - äº‰è®®ç™»è®°    - åŸŸè·¯ç”±        - è£å†³æ‰§è¡Œ        â”‚           â”‚
â”‚  â”‚  - è¯æ®å…³è”    - åˆ†è´¦é€»è¾‘      - ä¿¡ç”¨æ‰£å‡        â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ”¯æ’‘æœåŠ¡å±‚ (Supporting Services)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚pallet-depositsâ”‚  â”‚pallet-evidenceâ”‚  â”‚pallet-escrow â”‚          â”‚
â”‚  â”‚  æŠ¼é‡‘ç®¡ç†     â”‚  â”‚  è¯æ®å­˜å‚¨     â”‚  â”‚  èµ„é‡‘æ‰˜ç®¡    â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ä¸šåŠ¡åŸŸå±‚ (Business Domain Layer)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚deceased- â”‚  â”‚deceased- â”‚  â”‚  memo-   â”‚  â”‚   OTC    â”‚        â”‚
â”‚  â”‚  text    â”‚  â”‚  media   â”‚  â”‚  grave   â”‚  â”‚  order   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚  - å®ç°æŠ•è¯‰æ¥å£  - æ‰§è¡Œè£å†³é€»è¾‘  - å†…å®¹å›æ»š  - çŠ¶æ€æ›´æ–°         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åˆ†å±‚èŒè´£

| å±‚çº§ | èŒè´£ | å…³é”®ç»„ä»¶ |
|-----|------|---------|
| **ç”¨æˆ·å±‚** | æäº¤ã€æŸ¥è¯¢ã€åº”ç­” | Web App, Mobile App |
| **å‰ç«¯åº”ç”¨å±‚** | UIäº¤äº’ã€æ•°æ®å±•ç¤º | Reactç»„ä»¶ã€çŠ¶æ€ç®¡ç† |
| **APIèšåˆå±‚** | è·¯ç”±ã€èšåˆã€ç›‘å¬ | Subsquid (å¯é€‰)ã€Polkadot.js |
| **æ²»ç†ä¸­æ¢** | æ ¸å¿ƒæ²»ç†é€»è¾‘ | stardust-appeals, arbitration |
| **æ”¯æ’‘æœåŠ¡å±‚** | é€šç”¨æœåŠ¡ | deposits, evidence, escrow |
| **ä¸šåŠ¡åŸŸå±‚** | ä¸šåŠ¡å®ç° | å„ä¸šåŠ¡pallet |

---

## ğŸ¯ ç»Ÿä¸€æ²»ç†æµç¨‹è®¾è®¡

### æµç¨‹1ï¼šå†…å®¹æŠ•è¯‰æµç¨‹ï¼ˆText/Mediaï¼‰

```mermaid
graph TD
    A[ç”¨æˆ·å‘ç°ä¸å½“å†…å®¹] --> B{é€‰æ‹©æŠ•è¯‰å…¥å£}
    B -->|æ–‡æœ¬| C[æŠ•è¯‰ç”Ÿå¹³/æ‚¼è¯]
    B -->|åª’ä½“| D[æŠ•è¯‰ç›¸å†Œ/åª’ä½“]
    B -->|å¢“åœ°| E[æŠ•è¯‰å¢“åœ°]
    
    C --> F[ä¸Šä¼ è¯æ®åˆ°IPFS]
    D --> F
    E --> F
    
    F --> G[æäº¤è¯æ®åˆ°pallet-evidence]
    G --> H[è·å¾—evidence_id]
    
    H --> I[æäº¤æŠ•è¯‰åˆ°pallet-stardust-appeals]
    I --> J[å†»ç»“æŠ•è¯‰æŠ¼é‡‘]
    
    J --> K[æ²»ç†å§”å‘˜ä¼šå®¡æŸ¥]
    K --> L{è£å†³ç»“æœ}
    
    L -->|ç»´æŒæŠ•è¯‰| M[å†…å®¹å›æ»š/éšè—]
    L -->|é©³å›æŠ•è¯‰| N[æŠ•è¯‰äººç½šæ²¡30%]
    
    M --> O[åˆ†è´¦: 20%å¥–åŠ±/5%ä»²è£/75%é€€å›]
    N --> O
    
    O --> P[æ›´æ–°ä¿¡ç”¨åˆ†]
    P --> Q[ç»“æŸ]
```

**å…³é”®èŠ‚ç‚¹è¯´æ˜ï¼š**

1. **æäº¤é˜¶æ®µ**ï¼š
   - ç”¨æˆ·é€‰æ‹©æŠ•è¯‰ç±»å‹ï¼ˆæ–‡æœ¬/åª’ä½“/å¢“åœ°ï¼‰
   - ä¸Šä¼ è¯æ®åˆ°IPFSï¼ˆå›¾ç‰‡ã€æˆªå›¾ã€è¯´æ˜æ–‡æ¡£ï¼‰
   - æäº¤è¯æ®åˆ°`pallet-evidence`è·å¾—`evidence_id`
   - è°ƒç”¨`pallet-stardust-appeals::submit_appeal()`
   - ç³»ç»Ÿå†»ç»“æŠ•è¯‰æŠ¼é‡‘ï¼ˆé»˜è®¤100 DUSTï¼Œæ ¹æ®å†å²åŠ¨æ€è°ƒæ•´ï¼‰

2. **å®¡æŸ¥é˜¶æ®µ**ï¼š
   - æ²»ç†å§”å‘˜ä¼šæŸ¥çœ‹è¯æ®ï¼ˆé€šè¿‡`evidence_id`ï¼‰
   - å§”å‘˜ä¼šæŠ•ç¥¨è¡¨å†³ï¼ˆéœ€2/3é€šè¿‡ï¼‰
   - æ‰¹å‡†åè¿›å…¥30å¤©å…¬ç¤ºæœŸ

3. **æ‰§è¡Œé˜¶æ®µ**ï¼š
   - å…¬ç¤ºæœŸåˆ°æœŸè‡ªåŠ¨æ‰§è¡Œ
   - åŸŸè·¯ç”±åˆ†å‘åˆ°å…·ä½“ä¸šåŠ¡pallet
   - ä¸šåŠ¡palletæ‰§è¡Œå†…å®¹å›æ»š/éšè—
   - è‡ªåŠ¨åˆ†è´¦ï¼ˆ20%å¥–åŠ±èµ¢å®¶ã€5%ä»²è£è´¹ã€75%é€€å›è¾“å®¶ï¼‰

4. **ç»“æŸé˜¶æ®µ**ï¼š
   - æ›´æ–°ç”¨æˆ·ä¿¡ç”¨åˆ†
   - å‘é€é€šçŸ¥æ¶ˆæ¯
   - è®°å½•æ²»ç†æ—¥å¿—

---

### æµç¨‹2ï¼šäº¤æ˜“äº‰è®®æµç¨‹ï¼ˆOTC/Bridgeï¼‰

```mermaid
graph TD
    A[è®¢å•å¼‚å¸¸/è¿çº¦] --> B[ç”¨æˆ·æäº¤è¯æ®åˆ°pallet-evidence]
    B --> C[è·å¾—evidence_id]
    
    C --> D[è°ƒç”¨pallet-arbitration::dispute_with_evidence_id]
    D --> E{Routeræƒé™æ ¡éªŒ}
    
    E -->|ä¹°å®¶/å–å®¶| F[ç™»è®°äº‰è®®]
    E -->|éå‚ä¸æ–¹| G[æ‹’ç»]
    
    F --> H[æ‰˜ç®¡èµ„é‡‘è¿›å…¥DisputedçŠ¶æ€]
    H --> I[æ²»ç†å§”å‘˜ä¼šå®¡æŸ¥]
    
    I --> J{è£å†³å†³å®š}
    
    J -->|Release| K[å…¨é¢æ”¾æ¬¾ç»™å–å®¶/åšå¸‚å•†]
    J -->|Refund| L[å…¨é¢é€€æ¬¾ç»™ä¹°å®¶]
    J -->|Partial| M[æŒ‰æ¯”ä¾‹åˆ†è´¦]
    
    K --> N[æ›´æ–°è®¢å•çŠ¶æ€]
    L --> N
    M --> N
    
    N --> O[æ›´æ–°ä¿¡ç”¨åˆ†]
    O --> P[é‡Šæ”¾æ‰˜ç®¡èµ„é‡‘]
    P --> Q[ç»“æŸ]
```

**å…³é”®èŠ‚ç‚¹è¯´æ˜ï¼š**

1. **å‘èµ·é˜¶æ®µ**ï¼š
   - ç”¨æˆ·ï¼ˆä¹°å®¶/å–å®¶/åšå¸‚å•†ï¼‰å‘ç°è®¢å•é—®é¢˜
   - ä¸Šä¼ è¯æ®ï¼ˆèŠå¤©è®°å½•ã€è½¬è´¦å‡­è¯ã€è¶…æ—¶è¯æ˜ï¼‰
   - æäº¤åˆ°`pallet-evidence`
   - è°ƒç”¨`pallet-arbitration::dispute_with_evidence_id()`

2. **æƒé™æ ¡éªŒ**ï¼š
   - `Router::can_dispute()`æ ¡éªŒèº«ä»½
   - OTCåŸŸï¼šä»…ä¹°å®¶æˆ–å–å®¶
   - BridgeåŸŸï¼šä»…ç”¨æˆ·æˆ–åšå¸‚å•†
   - é˜²æ­¢ç¬¬ä¸‰æ–¹æ¶æ„å‘èµ·äº‰è®®

3. **æ‰˜ç®¡é”å®š**ï¼š
   - æ‰˜ç®¡èµ„é‡‘çŠ¶æ€å˜ä¸º`Disputed`
   - ç¦æ­¢æ™®é€šrelease/refundæ“ä½œ
   - ä»…ç­‰å¾…ä»²è£å†³è®®

4. **è£å†³æ‰§è¡Œ**ï¼š
   - å§”å‘˜ä¼šæŠ•ç¥¨ï¼ˆ2/3é€šè¿‡ï¼‰
   - ä¸‰ç§è£å†³ï¼šReleaseï¼ˆ0ï¼‰ã€Refundï¼ˆ1ï¼‰ã€Partialï¼ˆ2,bpsï¼‰
   - Routerè·¯ç”±åˆ°ä¸šåŠ¡pallet
   - ä¸šåŠ¡palletè°ƒç”¨`escrow`é‡Šæ”¾/é€€æ¬¾èµ„é‡‘

5. **åç»­å¤„ç†**ï¼š
   - æ›´æ–°ä¹°å®¶/åšå¸‚å•†ä¿¡ç”¨åˆ†
   - è´¥è¯‰æ–¹æ‰£åˆ†ï¼ˆbuyer-credit/maker-creditï¼‰
   - æ›´æ–°è®¢å•çŠ¶æ€ä¸ºResolved
   - å‘é€é€šçŸ¥

---

### æµç¨‹3ï¼šç”³è¯‰æ’¤å›æµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ·æäº¤ç”³è¯‰] --> B[status = 0 Submitted]
    B --> C{ç”¨æˆ·åæ‚”}
    
    C -->|æ˜¯| D[è°ƒç”¨withdraw_appeal]
    C -->|å¦| E[ç­‰å¾…å®¡æŸ¥]
    
    D --> F{çŠ¶æ€æ£€æŸ¥}
    F -->|status == 0| G[å…è®¸æ’¤å›]
    F -->|status != 0| H[æ‹’ç»: å·²æ‰¹å‡†/å·²é©³å›]
    
    G --> I[ç½šæ²¡10%æŠ¼é‡‘åˆ°å›½åº“]
    I --> J[é€€å›90%æŠ¼é‡‘]
    J --> K[status = 3 Withdrawn]
    K --> L[ç»“æŸ]
    
    E --> M[æ²»ç†å®¡æŸ¥...]
```

**å…³é”®èŠ‚ç‚¹è¯´æ˜ï¼š**

1. **æ’¤å›æ¡ä»¶**ï¼š
   - ä»…`status=0`ï¼ˆå·²æäº¤ï¼‰æ—¶å¯æ’¤å›
   - å·²æ‰¹å‡†/å·²é©³å›/å·²æ‰§è¡Œä¸å¯æ’¤å›
   - ä»…ç”³è¯‰äººæœ¬äººå¯æ“ä½œ

2. **ç½šæ²¡æœºåˆ¶**ï¼š
   - æ’¤å›ç½šæ²¡10%æŠ¼é‡‘ï¼ˆé˜²æ­¢éšæ„æäº¤ï¼‰
   - é€€å›90%æŠ¼é‡‘ç»™ç”³è¯‰äºº
   - 10%æŠ¼é‡‘è¿›å…¥å›½åº“ï¼ˆTreasuryï¼‰

---

## ğŸ” æƒé™ç®¡ç†æ–¹æ¡ˆ

### ä¸‰å±‚æƒé™æ¨¡å‹

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Root/è¶…çº§ç®¡ç†å‘˜                       â”‚
â”‚  - æ‰€æœ‰æƒé™    - åº”æ€¥æš‚åœ    - å‚æ•°é…ç½®    - å¼ºåˆ¶æ‰§è¡Œ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ²»ç†å§”å‘˜ä¼š (Governance Committee)           â”‚
â”‚  - å®¡æŸ¥æŠ•è¯‰    - è£å†³äº‰è®®    - æ‰¹å‡†/é©³å›    - æŠ•ç¥¨è¡¨å†³  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                æ™®é€šç”¨æˆ· (Normal Users)                   â”‚
â”‚  - æäº¤æŠ•è¯‰    - æäº¤äº‰è®®    - æ’¤å›ç”³è¯‰    - æŸ¥è¯¢çŠ¶æ€   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æƒé™çŸ©é˜µ

| æ“ä½œ | æ™®é€šç”¨æˆ· | ä¸šåŠ¡Pallet | æ²»ç†å§”å‘˜ä¼š | Root |
|-----|---------|-----------|-----------|------|
| **æäº¤æŠ•è¯‰/ç”³è¯‰** | âœ… | âŒ | âœ… | âœ… |
| **æ’¤å›ç”³è¯‰** | âœ…ï¼ˆæœ¬äºº+status=0ï¼‰ | âŒ | âŒ | âœ… |
| **æŸ¥è¯¢çŠ¶æ€** | âœ… | âœ… | âœ… | âœ… |
| **æ‰¹å‡†ç”³è¯‰** | âŒ | âŒ | âœ… | âœ… |
| **é©³å›ç”³è¯‰** | âŒ | âŒ | âœ… | âœ… |
| **è£å†³äº‰è®®** | âŒ | âŒ | âœ… | âœ… |
| **ä¿®æ”¹çŠ¶æ€** | âŒ | âŒ | âœ… | âœ… |
| **ä¿®æ”¹æŠ¼é‡‘** | âŒ | âŒ | âŒ | âœ… |
| **å…¨å±€æš‚åœ** | âŒ | âŒ | âŒ | âœ… |
| **æ‰§è¡Œè£å†³** | âŒ | âœ…ï¼ˆé€šè¿‡Routerï¼‰ | âŒ | âœ… |
| **åº”ç­”å¦å†³** | âœ…ï¼ˆé—´æ¥-ä¿æŒæ´»è·ƒï¼‰ | âŒ | âŒ | âŒ |

### åŠ¨æ€æƒé™ç­–ç•¥

#### 1. Routeræƒé™æ ¡éªŒï¼ˆarbitrationï¼‰

```rust
// Runtimeå®ç°ç¤ºä¾‹
impl ArbitrationRouter<AccountId> for RuntimeArbitrationRouter {
    fn can_dispute(domain: [u8; 8], who: &AccountId, id: u64) -> bool {
        match domain {
            // OTCåŸŸï¼šä¹°å®¶æˆ–å–å®¶
            b"stardust/otc_order" => {
                let order = OtcOrder::orders(id)?;
                who == &order.buyer || who == &order.seller
            },
            // BridgeåŸŸï¼šç”¨æˆ·æˆ–åšå¸‚å•†
            b"stardust/simple_bridge" => {
                let record = SimpleBridge::records(id)?;
                who == &record.user || who == &record.maker
            },
            // DeceasedåŸŸï¼šå¢“ä¸»æˆ–ç®¡ç†å‘˜
            b"stardust/deceased_text" | b"stardust/deceased_media" => {
                let deceased_id = Self::extract_deceased_id(domain, id)?;
                MemoGrave::is_owner_or_admin(who, deceased_id)
            },
            _ => false,
        }
    }
}
```

#### 2. æ²»ç†Originé…ç½®

```rust
// Runtimeé…ç½®ç¤ºä¾‹
impl pallet_memo_appeals::Config for Runtime {
    type GovernanceOrigin = EitherOfDiverse<
        // Rootæ€»æ˜¯æœ‰æƒé™
        EnsureRoot<AccountId>,
        // æˆ–å†…å®¹å§”å‘˜ä¼š2/3é€šè¿‡
        EnsureProportionAtLeast<
            AccountId,
            ContentCommitteeInstance,
            2, 3
        >,
    >;
}

impl pallet_arbitration::Config for Runtime {
    type DecisionOrigin = EitherOfDiverse<
        EnsureRoot<AccountId>,
        EnsureProportionAtLeast<
            AccountId,
            ArbitrationCommitteeInstance,
            2, 3
        >,
    >;
}
```

---

## ğŸ›¡ï¸ å®‰å…¨æœºåˆ¶è®¾è®¡

### 1. å¤šå±‚é˜²æŠ¤ä½“ç³»

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 1: è¾“å…¥éªŒè¯å±‚                                     â”‚
â”‚  - è¯æ®CIDé•¿åº¦æ ¡éªŒ    - å‚æ•°èŒƒå›´æ£€æŸ¥    - ç­¾åéªŒè¯      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 2: æƒé™æ§åˆ¶å±‚                                     â”‚
â”‚  - Originé‰´æƒ    - Routeræ ¡éªŒ    - çŠ¶æ€é—¨æ§             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 3: ä¸šåŠ¡é€»è¾‘å±‚                                     â”‚
â”‚  - é™é¢‘æ§åˆ¶    - é‡å¤æ£€æŸ¥    - å¹¶å‘ä¸²è¡ŒåŒ–               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 4: èµ„é‡‘ä¿æŠ¤å±‚                                     â”‚
â”‚  - æŠ¼é‡‘å†»ç»“    - æ‰˜ç®¡é”å®š    - åˆ†è´¦è‡ªåŠ¨åŒ–               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 5: åº”æ€¥å“åº”å±‚                                     â”‚
â”‚  - å…¨å±€æš‚åœ    - äº‰è®®é”å®š    - Rootå¼ºåˆ¶æ‰§è¡Œ             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. æŠ¼é‡‘åŠ¨æ€ç­–ç•¥

```rust
// åŠ¨æ€æŠ¼é‡‘è®¡ç®—ç­–ç•¥
impl AppealDepositPolicy for ContentAppealDepositPolicy {
    fn calc_deposit(
        who: &AccountId,
        domain: u8,
        target: u64,
        action: u8,
    ) -> Option<Balance> {
        // åŸºç¡€æŠ¼é‡‘
        let base = 100 * DUST;
        
        // å†å²æˆåŠŸç‡è°ƒæ•´
        let history = Appeals::list_by_account(who, None, 0, 100);
        let success_rate = calculate_success_rate(&history);
        let multiplier = if success_rate > 0.8 {
            0.8  // ä¼˜è´¨ç”¨æˆ·8æŠ˜
        } else if success_rate < 0.3 {
            2.0  // æ¶æ„ç”¨æˆ·2å€
        } else {
            1.0  // æ­£å¸¸ç”¨æˆ·åŸä»·
        };
        
        // ç›®æ ‡è§„æ¨¡è°ƒæ•´ï¼ˆé«˜ä»·å€¼å†…å®¹éœ€æ›´é«˜æŠ¼é‡‘ï¼‰
        let scale_multiplier = match domain {
            2 => {  // DeceasedåŸŸ
                let followers = MemoGrave::followers_count(target);
                if followers > 1000 { 1.5 } else { 1.0 }
            },
            _ => 1.0,
        };
        
        Some((base as f64 * multiplier * scale_multiplier) as Balance)
    }
}
```

### 3. é™é¢‘ä¿æŠ¤ç­–ç•¥

```text
çª—å£é™é¢‘è§„åˆ™ï¼š
- æ—¶é—´çª—å£ï¼š600å—ï¼ˆçº¦1å°æ—¶ï¼‰
- çª—å£å†…é™åˆ¶ï¼šæ¯ç”¨æˆ·æœ€å¤š5æ¬¡æŠ•è¯‰/ç”³è¯‰
- è¶…å‡ºæ‹’ç»ï¼šè¿”å›RateLimitedé”™è¯¯

ç´¯è®¡é™é¢‘è§„åˆ™ï¼š
- 24å°æ—¶å†…ï¼šæœ€å¤š20æ¬¡
- 7å¤©å†…ï¼šæœ€å¤š50æ¬¡
- æ¶æ„åˆ·å±è€…ï¼šæš‚æ—¶å°ç¦

ç™½åå•æœºåˆ¶ï¼š
- æ²»ç†å§”å‘˜ä¼šæˆå‘˜ï¼šæ— é™é¢‘é™åˆ¶
- ä¿¡ç”¨AAAç”¨æˆ·ï¼š2å€çª—å£é™é¢
```

### 4. å¹¶å‘æ§åˆ¶ç­–ç•¥

```rust
// åŒä¸»ä½“å¹¶å‘ä¸²è¡ŒåŒ–
// ä¿éšœåŒä¸€æ—¶åˆ»åªå­˜åœ¨ä¸€ä¸ªå¤„äºæ‰¹å‡†å¾…æ‰§è¡Œçš„ç”³è¯‰
pub type PendingBySubject<T> = StorageMap<
    (domain, target) -> appeal_id
>;

// æäº¤æ—¶æ£€æŸ¥
ensure!(
    PendingBySubject::get((domain, target)).is_none(),
    Error::AlreadyPending
);

// æ‰¹å‡†æ—¶å ä½
PendingBySubject::insert((domain, target), appeal_id);

// æ‰§è¡Œåé‡Šæ”¾
PendingBySubject::remove((domain, target));
```

---

## ğŸ¨ å‰ç«¯äº¤äº’è®¾è®¡

### 1. ç»Ÿä¸€æŠ•è¯‰å…¥å£

```typescript
// å‰ç«¯ç»„ä»¶ï¼šComplaintEntrance.tsx
interface ComplaintEntranceProps {
  domain: 'text' | 'media' | 'grave' | 'otc' | 'bridge';
  targetId: string;
  targetInfo: {
    title: string;
    owner: string;
    createTime: string;
  };
}

// ç”¨æˆ·æµç¨‹
1. ç‚¹å‡»"æŠ•è¯‰"æŒ‰é’® â†’ å¼¹å‡ºæŠ•è¯‰è¡¨å•
2. é€‰æ‹©æŠ•è¯‰ç±»å‹ï¼ˆä¸å½“å†…å®¹/è¿è§„äº¤æ˜“/è™šå‡ä¿¡æ¯ç­‰ï¼‰
3. ä¸Šä¼ è¯æ®ï¼ˆå›¾ç‰‡/æ–‡æ¡£/æˆªå›¾ï¼Œè‡ªåŠ¨ä¸Šä¼ IPFSï¼‰
4. å¡«å†™æŠ•è¯‰ç†ç”±ï¼ˆå¯é€‰ï¼Œå­˜IPFSï¼‰
5. é¢„è§ˆæŠ¼é‡‘é‡‘é¢ï¼ˆæ ¹æ®å†å²åŠ¨æ€è®¡ç®—ï¼‰
6. ç¡®è®¤æäº¤ â†’ è°ƒç”¨é“¾ä¸Šæ¥å£
7. æ˜¾ç¤ºäº¤æ˜“Hashå’ŒæŠ•è¯‰ID
8. è·³è½¬åˆ°"æˆ‘çš„æŠ•è¯‰"è¿½è¸ªè¿›åº¦
```

### 2. æŠ•è¯‰è¿›åº¦è¿½è¸ª

```typescript
// å‰ç«¯ç»„ä»¶ï¼šComplaintTracker.tsx
interface ComplaintStatus {
  id: string;
  domain: string;
  target: string;
  status: 'submitted' | 'approved' | 'rejected' | 'executed' | 'withdrawn';
  submitTime: Date;
  executeAt?: Date;
  deposit: string;
  evidence: Evidence[];
}

// çŠ¶æ€å±•ç¤º
- Submitted: "å®¡æŸ¥ä¸­" - é»„è‰²è¿›åº¦æ¡
- Approved: "å·²æ‰¹å‡†Â·å…¬ç¤ºæœŸå€’è®¡æ—¶30å¤©" - è“è‰²è¿›åº¦æ¡
- Rejected: "å·²é©³å›Â·ç½šæ²¡30%" - çº¢è‰²
- Executed: "å·²æ‰§è¡ŒÂ·å†…å®¹å·²å¤„ç†" - ç»¿è‰²
- Withdrawn: "å·²æ’¤å›Â·ç½šæ²¡10%" - ç°è‰²
```

### 3. æ²»ç†å§”å‘˜ä¼šå®¡æŸ¥é¢æ¿

```typescript
// å‰ç«¯ç»„ä»¶ï¼šGovernancePanel.tsx (ä»…å§”å‘˜å¯è§)
interface GovernanceTask {
  id: string;
  type: 'complaint' | 'dispute';
  submitTime: Date;
  submitter: string;
  target: string;
  evidence: Evidence[];
  votes: {
    approve: number;
    reject: number;
    threshold: number;
  };
}

// åŠŸèƒ½
1. æŸ¥çœ‹å¾…å®¡æŸ¥ä»»åŠ¡åˆ—è¡¨ï¼ˆæŒ‰æ—¶é—´æ’åºï¼‰
2. æŸ¥çœ‹è¯æ®è¯¦æƒ…ï¼ˆå›¾ç‰‡/æ–‡æ¡£/é“¾ä¸Šæ•°æ®ï¼‰
3. æŠ•ç¥¨è¡¨å†³ï¼ˆApprove/Rejectï¼‰
4. æŸ¥çœ‹å…¶ä»–å§”å‘˜æŠ•ç¥¨æƒ…å†µ
5. æ·»åŠ è£å†³ç†ç”±ï¼ˆå­˜IPFSï¼‰
6. æ‰¹é‡å¤„ç†ï¼ˆå¤šé€‰æ‰¹é‡æ‰¹å‡†/é©³å›ï¼‰
```

### 4. æ¶ˆæ¯é€šçŸ¥ç³»ç»Ÿ

```typescript
// é€šçŸ¥ç±»å‹
enum NotificationType {
  ComplaintSubmitted,     // æŠ•è¯‰å·²æäº¤
  ComplaintApproved,      // æŠ•è¯‰å·²æ‰¹å‡†
  ComplaintRejected,      // æŠ•è¯‰å·²é©³å›
  ComplaintExecuted,      // æŠ•è¯‰å·²æ‰§è¡Œ
  ContentReported,        // æ‚¨çš„å†…å®¹è¢«æŠ•è¯‰
  DisputeOpened,          // è®¢å•è¿›å…¥äº‰è®®
  ArbitrationResult,      // ä»²è£ç»“æœ
  DepositReturned,        // æŠ¼é‡‘å·²é€€å›
  CreditUpdated,          // ä¿¡ç”¨åˆ†å·²æ›´æ–°
}

// é€šçŸ¥è§¦å‘
1. é“¾ä¸Šäº‹ä»¶ç›‘å¬ï¼ˆSubsquid/Polkadot.jsï¼‰
2. å®æ—¶æ¨é€åˆ°å‰ç«¯ï¼ˆWebSocketï¼‰
3. æµè§ˆå™¨é€šçŸ¥ï¼ˆNotification APIï¼‰
4. ç«™å†…æ¶ˆæ¯ä¸­å¿ƒ
5. å¯é€‰é‚®ä»¶é€šçŸ¥
```

---

## ğŸ“Š æ•°æ®æµè®¾è®¡

### 1. æŠ•è¯‰æ•°æ®æµ

```text
ç”¨æˆ·æäº¤
  â†“
[evidence_cid] â†’ IPFSå­˜å‚¨
  â†“
[evidence_id] â†’ pallet-evidence::commit()
  â†“
[appeal_id] â†’ pallet-stardust-appeals::submit_appeal()
  â†“
[deposit_id] â†’ pallet-deposits::reserve()
  â†“
é“¾ä¸Šäº‹ä»¶: AppealSubmitted
  â†“
å‰ç«¯ç›‘å¬ â†’ æ›´æ–°UIçŠ¶æ€
  â†“
Subsquidç´¢å¼• â†’ æ•°æ®åº“å­˜å‚¨ï¼ˆå¯é€‰ï¼‰
  â†“
ç”¨æˆ·æŸ¥è¯¢ â†’ å‰ç«¯å±•ç¤º
```

### 2. äº‰è®®æ•°æ®æµ

```text
ç”¨æˆ·æäº¤è¯æ®
  â†“
[evidence_id] â†’ pallet-evidence::commit()
  â†“
ç”¨æˆ·å‘èµ·äº‰è®®
  â†“
[dispute_key] â†’ pallet-arbitration::dispute_with_evidence_id()
  â†“
Routeræƒé™æ ¡éªŒ â†’ can_dispute()
  â†“
ç™»è®°äº‰è®® â†’ Disputed[(domain, id)] = ()
  â†“
æ‰˜ç®¡é”å®š â†’ escrow::dispute(id)
  â†“
é“¾ä¸Šäº‹ä»¶: Disputed
  â†“
æ²»ç†å®¡æŸ¥ â†’ å§”å‘˜ä¼šæŠ•ç¥¨
  â†“
è£å†³æ‰§è¡Œ â†’ arbitration::arbitrate()
  â†“
Routeråˆ†å‘ â†’ apply_decision()
  â†“
ä¸šåŠ¡æ‰§è¡Œ â†’ é‡Šæ”¾èµ„é‡‘/æ›´æ–°çŠ¶æ€/æ‰£ä¿¡ç”¨åˆ†
  â†“
é“¾ä¸Šäº‹ä»¶: Arbitrated
  â†“
å‰ç«¯é€šçŸ¥ â†’ ç”¨æˆ·æŸ¥çœ‹ç»“æœ
```

---

## ğŸ”„ è¿ç§»ä¸ç»Ÿä¸€æ–¹æ¡ˆ

### Phase 1: çŸ­æœŸä¼˜åŒ–ï¼ˆå½“å‰-1ä¸ªæœˆï¼‰

**ç›®æ ‡**ï¼šä¼˜åŒ–ç°æœ‰6ä¸ªpalletçš„æŠ•è¯‰æœºåˆ¶ï¼Œä¿æŒå‘åå…¼å®¹

#### 1.1 deceased-textè¿ç§»

```rust
// æ­¥éª¤1ï¼šä¿ç•™ç°æœ‰æ¥å£ï¼ˆå‘åå…¼å®¹ï¼‰
pub fn complain_life(...) -> DispatchResult {
    // æ—§é€»è¾‘ä¿ç•™
    ...
    
    // åŒæ—¶è°ƒç”¨æ–°ç³»ç»Ÿï¼ˆå¯é€‰ï¼‰
    #[cfg(feature = "unified-governance")]
    {
        let evidence_id = T::Evidence::commit(...)?;
        T::Appeals::submit_appeal(
            domain: 3u8,  // Deceased Text
            target: deceased_id.into(),
            action: 0u8,  // Delete Life
            evidence_id,
        )?;
    }
}

// æ­¥éª¤2ï¼šæ·»åŠ åºŸå¼ƒè­¦å‘Š
#[deprecated(note = "Use pallet-stardust-appeals instead")]
pub fn complain_life(...) -> DispatchResult { ... }

// æ­¥éª¤3ï¼šæ–‡æ¡£æ›´æ–°
// README.mdæ·»åŠ è¿ç§»è¯´æ˜
```

#### 1.2 deceased-mediaè¿ç§»

```rust
// ç±»ä¼¼deceased-text
// ä¿ç•™æ—§æ¥å£ + æ·»åŠ ç»Ÿä¸€è°ƒç”¨
```

#### 1.3 stardust-graveè¿ç§»

```rust
// ç‰¹æ®Šå¤„ç†ï¼šä¿ç•™ç´¯ç§¯æŠ•è¯‰åˆ—è¡¨
// æ–°å¢ï¼šå¯é€‰è½¬æ¢ä¸ºç»Ÿä¸€ç”³è¯‰
pub fn convert_complaint_to_appeal(
    grave_id: u64,
    complaint_idx: u32,
) -> DispatchResult {
    let complaint = ComplaintsByGrave::get(grave_id)[complaint_idx];
    // è½¬æ¢ä¸ºç»Ÿä¸€ç”³è¯‰
    T::Appeals::submit_appeal(...)?;
}
```

---

### Phase 2: ä¸­æœŸç»Ÿä¸€ï¼ˆ1-3ä¸ªæœˆï¼‰

**ç›®æ ‡**ï¼šé€æ­¥è¿ç§»åˆ°ç»Ÿä¸€æ²»ç†æ¡†æ¶

#### 2.1 ç»Ÿä¸€æ¥å£è®¾è®¡

```rust
// æ–°å¢trait: ComplaintHandler
pub trait ComplaintHandler {
    /// æäº¤æŠ•è¯‰ï¼ˆç»Ÿä¸€å…¥å£ï¼‰
    fn submit_complaint(
        who: &AccountId,
        domain: u8,
        target: u64,
        action: u8,
        evidence_id: u64,
        reason_cid: Vec<u8>,
    ) -> DispatchResult;
    
    /// æŸ¥è¯¢æŠ•è¯‰çŠ¶æ€
    fn complaint_status(domain: u8, target: u64) -> Option<ComplaintStatus>;
    
    /// æ‰§è¡Œè£å†³ï¼ˆç”±æ²»ç†è°ƒç”¨ï¼‰
    fn apply_decision(
        domain: u8,
        target: u64,
        decision: Decision,
    ) -> DispatchResult;
}

// æ‰€æœ‰ä¸šåŠ¡palletå®ç°è¯¥trait
impl<T: Config> ComplaintHandler<T> for Pallet<T> {
    fn submit_complaint(...) -> DispatchResult {
        // ç»Ÿä¸€è°ƒç”¨stardust-appeals
        T::Appeals::submit_appeal(...)?;
        Ok(())
    }
    
    fn apply_decision(domain, target, decision) -> DispatchResult {
        // æ ¹æ®domainæ‰§è¡Œå…·ä½“é€»è¾‘
        match domain {
            3 => Self::handle_text_complaint(target, decision),
            4 => Self::handle_media_complaint(target, decision),
            ...
        }
    }
}
```

#### 2.2 å‰ç«¯ç»Ÿä¸€æ”¹é€ 

```typescript
// ç»Ÿä¸€æŠ•è¯‰SDK
export class UnifiedComplaintSDK {
  // æäº¤æŠ•è¯‰ï¼ˆè‡ªåŠ¨è·¯ç”±åˆ°æ­£ç¡®palletï¼‰
  async submitComplaint(params: {
    domain: Domain;
    targetId: string;
    action: Action;
    evidence: File[];
    reason?: string;
  }): Promise<ComplaintResult> {
    // 1. ä¸Šä¼ è¯æ®åˆ°IPFS
    const evidenceCid = await this.uploadToIPFS(params.evidence);
    
    // 2. æäº¤è¯æ®åˆ°é“¾ä¸Š
    const evidenceId = await this.submitEvidence(evidenceCid);
    
    // 3. æäº¤æŠ•è¯‰
    const appealId = await this.api.tx.memoAppeals.submitAppeal(
      params.domain,
      params.targetId,
      params.action,
      params.reason || '',
      evidenceCid,
    ).signAndSend(this.signer);
    
    return { appealId, evidenceId };
  }
  
  // æŸ¥è¯¢æŠ•è¯‰çŠ¶æ€ï¼ˆç»Ÿä¸€æ¥å£ï¼‰
  async getComplaintStatus(appealId: string): Promise<ComplaintStatus> {
    const appeal = await this.api.query.memoAppeals.appeals(appealId);
    return this.parseAppealStatus(appeal);
  }
}
```

---

### Phase 3: é•¿æœŸä¼˜åŒ–ï¼ˆ3-6ä¸ªæœˆï¼‰

**ç›®æ ‡**ï¼šå®Œå…¨ç»Ÿä¸€ï¼Œç§»é™¤å†—ä½™ä»£ç 

#### 3.1 ç§»é™¤æ—§æ¥å£

```rust
// deceased-text/lib.rs
// ç§»é™¤æ—§æŠ•è¯‰æ¥å£
// #[pallet::call_index(13)]
// pub fn complain_life(...) { ... }  // DELETED

// README.mdæ›´æ–°
// ç§»é™¤æ—§æ¥å£æ–‡æ¡£
```

#### 3.2 æ•°æ®è¿ç§»è„šæœ¬

```typescript
// scripts/migrate-complaints.ts
async function migrateOldComplaints() {
  // 1. è¯»å–æ—§æŠ•è¯‰æ•°æ®
  const oldComplaints = await api.query.deceasedText.complaintOf.entries();
  
  // 2. è½¬æ¢ä¸ºæ–°æ ¼å¼
  for (const [key, complaint] of oldComplaints) {
    const [domain, target] = key.args;
    
    // åˆ›å»ºè¯æ®IDï¼ˆå¦‚æœæ²¡æœ‰ï¼‰
    let evidenceId = complaint.evidence_id;
    if (!evidenceId) {
      evidenceId = await createLegacyEvidence(complaint);
    }
    
    // æäº¤åˆ°æ–°ç³»ç»Ÿ
    await api.tx.memoAppeals.submitAppeal(
      domain,
      target,
      0, // action
      '', // reason_cid
      evidenceId,
    ).signAndSend(admin);
  }
  
  // 3. æ¸…ç†æ—§æ•°æ®ï¼ˆéœ€governanceæ‰¹å‡†ï¼‰
  // await api.tx.sudo.sudo(
  //   api.tx.deceasedText.purgeOldComplaints()
  // ).signAndSend(admin);
}
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ

### 1. é“¾ä¸Šä¼˜åŒ–

```rust
// 1. åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–
pub fn list_appeals_paginated(
    start_id: u64,
    limit: u32,
    filters: Option<Filters>,
) -> Vec<AppealSummary> {
    // ä»…è¿”å›æ‘˜è¦ï¼Œä¸åŒ…å«å®Œæ•´æ•°æ®
    // å‰ç«¯æŒ‰éœ€åŠ è½½è¯¦æƒ…
}

// 2. ç´¢å¼•ä¼˜åŒ–
// æ·»åŠ äºŒçº§ç´¢å¼•ï¼šæŒ‰çŠ¶æ€æŸ¥è¯¢
pub type AppealsByStatus<T> = StorageDoubleMap<
    status,
    appeal_id,
    ()
>;

// 3. æ‰¹é‡æ“ä½œ
pub fn batch_approve_appeals(
    appeal_ids: Vec<u64>,
    notice_blocks: BlockNumber,
) -> DispatchResult {
    // æ‰¹é‡æ‰¹å‡†ï¼Œé™ä½äº¤æ˜“æˆæœ¬
}
```

### 2. é“¾ä¸‹ä¼˜åŒ–ï¼ˆSubsquidï¼‰

```typescript
// schema.graphql
type Appeal @entity {
  id: ID!
  domain: Int!
  target: BigInt!
  action: Int!
  submitter: String!
  status: AppealStatus!
  submitTime: DateTime!
  executeAt: DateTime
  deposit: BigInt!
  evidence: [Evidence!]! @derivedFrom(field: "appeal")
}

type Evidence @entity {
  id: ID!
  appeal: Appeal!
  cid: String!
  type: EvidenceType!
  uploadTime: DateTime!
}

// æŸ¥è¯¢ç¤ºä¾‹
query GetMyAppeals($account: String!) {
  appeals(
    where: { submitter_eq: $account },
    orderBy: submitTime_DESC,
    limit: 20
  ) {
    id
    domain
    status
    submitTime
    deposit
  }
}
```

---

## ğŸ§ª æµ‹è¯•æ–¹æ¡ˆ

### 1. å•å…ƒæµ‹è¯•

```rust
// pallets/stardust-appeals/src/tests.rs
#[test]
fn test_submit_appeal_success() {
    new_test_ext().execute_with(|| {
        // å‡†å¤‡æµ‹è¯•æ•°æ®
        let who = account(1);
        let domain = 3u8;
        let target = 1u64;
        
        // æäº¤ç”³è¯‰
        assert_ok!(MemoAppeals::submit_appeal(
            Origin::signed(who),
            domain,
            target,
            0,
            vec![1,2,3].try_into().unwrap(),
            vec![4,5,6].try_into().unwrap(),
        ));
        
        // éªŒè¯çŠ¶æ€
        let appeal = Appeals::<Test>::get(1).unwrap();
        assert_eq!(appeal.status, 0);
        assert_eq!(appeal.domain, domain);
    });
}

#[test]
fn test_withdraw_appeal_slash() {
    new_test_ext().execute_with(|| {
        // æäº¤ç”³è¯‰
        submit_test_appeal(account(1));
        
        let balance_before = Balances::free_balance(account(1));
        
        // æ’¤å›ç”³è¯‰
        assert_ok!(MemoAppeals::withdraw_appeal(
            Origin::signed(account(1)),
            1,
        ));
        
        let balance_after = Balances::free_balance(account(1));
        
        // éªŒè¯ç½šæ²¡10%
        let deposit = AppealDeposit::get();
        let slash = deposit * 10 / 100;
        assert_eq!(balance_before - balance_after, slash);
    });
}
```

### 2. é›†æˆæµ‹è¯•

```typescript
// tests/integration/complaint.test.ts
describe('Unified Complaint System', () => {
  it('should submit complaint and execute decision', async () => {
    // 1. æäº¤è¯æ®
    const evidenceId = await submitEvidence({
      cid: 'QmTest123',
      domain: 3,
      target: 1,
    });
    
    // 2. æäº¤æŠ•è¯‰
    const appealId = await submitAppeal({
      domain: 3,
      target: 1,
      action: 0,
      evidenceId,
    });
    
    // 3. æ²»ç†æ‰¹å‡†
    await governanceApprove(appealId);
    
    // 4. ç­‰å¾…å…¬ç¤ºæœŸ
    await advanceBlocks(432000); // 30å¤©
    
    // 5. éªŒè¯æ‰§è¡Œ
    const appeal = await getAppeal(appealId);
    expect(appeal.status).toBe('executed');
    
    // 6. éªŒè¯å†…å®¹å›æ»š
    const text = await getDeceasedText(1);
    expect(text.cid).toBe(previousCid);
  });
});
```

### 3. å‹åŠ›æµ‹è¯•

```typescript
// tests/stress/rate-limit.test.ts
describe('Rate Limiting', () => {
  it('should block rapid submissions', async () => {
    const user = account(1);
    
    // å¿«é€Ÿæäº¤6æ¬¡ï¼ˆçª—å£é™åˆ¶5æ¬¡ï¼‰
    for (let i = 0; i < 6; i++) {
      if (i < 5) {
        await expect(submitAppeal(user, i)).resolves.toBeDefined();
      } else {
        await expect(submitAppeal(user, i)).rejects.toThrow('RateLimited');
      }
    }
  });
});
```

---

## ğŸ“‹ å®æ–½è·¯çº¿å›¾

### é‡Œç¨‹ç¢‘1ï¼šåŸºç¡€æ¶æ„ï¼ˆWeek 1-2ï¼‰

- [ ] å®Œæˆæ–¹æ¡ˆè®¾è®¡è¯„å®¡
- [ ] ç¡®å®šæŠ€æœ¯æ ˆå’Œä¾èµ–
- [ ] æ­å»ºå¼€å‘ç¯å¢ƒ
- [ ] ç¼–å†™æŠ€æœ¯è§„èŒƒæ–‡æ¡£

### é‡Œç¨‹ç¢‘2ï¼šæ ¸å¿ƒåŠŸèƒ½å¼€å‘ï¼ˆWeek 3-6ï¼‰

- [ ] pallet-stardust-appealså¢å¼ºï¼ˆåŠ¨æ€æŠ¼é‡‘ã€åº”ç­”å¦å†³ï¼‰
- [ ] pallet-arbitrationå®Œå–„ï¼ˆRouterè§£è€¦ï¼‰
- [ ] pallet-depositsé›†æˆ
- [ ] pallet-evidenceåŠŸèƒ½è¡¥å……
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡>80%

### é‡Œç¨‹ç¢‘3ï¼šå‰ç«¯å¼€å‘ï¼ˆWeek 7-10ï¼‰

- [ ] ç»Ÿä¸€æŠ•è¯‰å…¥å£ç»„ä»¶
- [ ] è¿›åº¦è¿½è¸ªé¢æ¿
- [ ] æ²»ç†å®¡æŸ¥é¢æ¿
- [ ] æ¶ˆæ¯é€šçŸ¥ç³»ç»Ÿ
- [ ] SDKå°è£…

### é‡Œç¨‹ç¢‘4ï¼šæ•°æ®è¿ç§»ï¼ˆWeek 11-12ï¼‰

- [ ] ç¼–å†™è¿ç§»è„šæœ¬
- [ ] æµ‹è¯•ç½‘æ•°æ®è¿ç§»
- [ ] å‘åå…¼å®¹æ€§éªŒè¯
- [ ] æ–‡æ¡£æ›´æ–°

### é‡Œç¨‹ç¢‘5ï¼šæµ‹è¯•ä¸ä¼˜åŒ–ï¼ˆWeek 13-14ï¼‰

- [ ] é›†æˆæµ‹è¯•
- [ ] å‹åŠ›æµ‹è¯•
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] å®‰å…¨å®¡è®¡

### é‡Œç¨‹ç¢‘6ï¼šä¸Šçº¿å‡†å¤‡ï¼ˆWeek 15-16ï¼‰

- [ ] ä¸»ç½‘éƒ¨ç½²å‡†å¤‡
- [ ] ç”¨æˆ·åŸ¹è®­æ–‡æ¡£
- [ ] è¿è¥æ‰‹å†Œ
- [ ] ç›‘æ§å‘Šè­¦é…ç½®
- [ ] ç°åº¦å‘å¸ƒ

---

## ğŸ’° æˆæœ¬ä¼°ç®—

| é¡¹ç›® | å·¥ä½œé‡ | é¢„ç®—ï¼ˆäººå¤©ï¼‰ | å¤‡æ³¨ |
|-----|--------|------------|------|
| æ¶æ„è®¾è®¡ | é«˜ | 5 | æŠ€æœ¯æ–¹æ¡ˆã€APIè®¾è®¡ |
| åç«¯å¼€å‘ | é«˜ | 20 | Palletå¼€å‘ã€æµ‹è¯• |
| å‰ç«¯å¼€å‘ | ä¸­ | 15 | UIç»„ä»¶ã€SDK |
| æ•°æ®è¿ç§» | ä¸­ | 8 | è„šæœ¬ã€éªŒè¯ |
| æµ‹è¯• | é«˜ | 10 | å•å…ƒã€é›†æˆã€å‹åŠ› |
| æ–‡æ¡£ | ä¸­ | 5 | æŠ€æœ¯æ–‡æ¡£ã€ç”¨æˆ·æ‰‹å†Œ |
| éƒ¨ç½²ä¸Šçº¿ | ä½ | 3 | éƒ¨ç½²ã€ç›‘æ§ |
| **æ€»è®¡** | - | **66äººå¤©** | çº¦3ä¸ªæœˆï¼ˆ2äººå›¢é˜Ÿï¼‰ |

---

## ğŸ¯ æˆåŠŸæŒ‡æ ‡

### æŠ€æœ¯æŒ‡æ ‡

- [ ] 6ä¸ªpalletç»Ÿä¸€åˆ°1ä¸ªæ²»ç†æ¡†æ¶
- [ ] ä»£ç å†—ä½™åº¦é™ä½60%
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡>80%
- [ ] äº¤æ˜“æˆåŠŸç‡>99%
- [ ] å¹³å‡å“åº”æ—¶é—´<3ç§’

### ç”¨æˆ·æŒ‡æ ‡

- [ ] æŠ•è¯‰æäº¤æˆåŠŸç‡>95%
- [ ] ç”¨æˆ·æ»¡æ„åº¦>4.0/5.0
- [ ] æ¶æ„æŠ•è¯‰ç‡<5%
- [ ] æ²»ç†å†³ç­–æ—¶é—´<7å¤©

### ä¸šåŠ¡æŒ‡æ ‡

- [ ] æŠ•è¯‰å¤„ç†æ•ˆç‡æå‡50%
- [ ] æ²»ç†å§”å‘˜ä¼šå·¥ä½œé‡é™ä½30%
- [ ] èµ„é‡‘å®‰å…¨äº‹æ•…=0
- [ ] ç”¨æˆ·ç”³è¯‰æˆåŠŸç‡>40%

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [è‡ªç ”palletæŠ•è¯‰ç”³è¯‰å­—æ®µæƒé™åˆ†ææŠ¥å‘Š](./è‡ªç ”palletæŠ•è¯‰ç”³è¯‰å­—æ®µæƒé™åˆ†ææŠ¥å‘Š.md)
- [æŠ•è¯‰ç”³è¯‰å­—æ®µæƒé™-å¿«é€Ÿå‚è€ƒ](./æŠ•è¯‰ç”³è¯‰å­—æ®µæƒé™-å¿«é€Ÿå‚è€ƒ.md)
- [pallet-stardust-appeals README](/home/xiaodong/æ–‡æ¡£/stardust/pallets/stardust-appeals/README.md)
- [pallet-arbitration README](/home/xiaodong/æ–‡æ¡£/stardust/pallets/arbitration/README.md)
- [pallet-deposits README](/home/xiaodong/æ–‡æ¡£/stardust/pallets/deposits/README.md)
- [pallet-evidence README](/home/xiaodong/æ–‡æ¡£/stardust/pallets/evidence/README.md)

---

## ğŸ“ å˜æ›´æ—¥å¿—

| æ—¥æœŸ | ç‰ˆæœ¬ | å˜æ›´å†…å®¹ | è´£ä»»äºº |
|-----|------|---------|--------|
| 2025-10-27 | v1.0 | åˆå§‹ç‰ˆæœ¬ï¼Œå®Œæ•´æ–¹æ¡ˆè®¾è®¡ | æ¶æ„ç»„ |

---

## âœ… å®¡æ‰¹æµç¨‹

| è§’è‰² | å§“å | å®¡æ‰¹çŠ¶æ€ | æ—¥æœŸ | å¤‡æ³¨ |
|-----|------|---------|------|------|
| æ¶æ„å¸ˆ | - | å¾…å®¡æ‰¹ | - | - |
| æŠ€æœ¯è´Ÿè´£äºº | - | å¾…å®¡æ‰¹ | - | - |
| äº§å“ç»ç† | - | å¾…å®¡æ‰¹ | - | - |
| é¡¹ç›®ç»ç† | - | å¾…å®¡æ‰¹ | - | - |

---

**æ–‡æ¡£çŠ¶æ€**: ğŸ“ è‰ç¨¿ - å¾…è¯„å®¡  
**ç»´æŠ¤è´£ä»»**: é¡¹ç›®æ¶æ„ç»„  
**è”ç³»æ–¹å¼**: architecture@stardust.io

