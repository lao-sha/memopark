# DeepSeek AI ç­–ç•¥ - å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸ¯ 5åˆ†é’Ÿä¸Šæ‰‹

### ç¬¬ä¸€æ­¥ï¼šè·å– DeepSeek API Key

1. è®¿é—® https://platform.deepseek.com/
2. æ³¨å†Œå¹¶ç™»å½•
3. åˆ›å»º API Key (æ ¼å¼: `sk-xxxxxxxxxxxxx`)
4. å¤åˆ¶ API Key å¤‡ç”¨

### ç¬¬äºŒæ­¥ï¼šé…ç½®èŠ‚ç‚¹

```bash
# è®¾ç½® DeepSeek API Key ç¯å¢ƒå˜é‡
export DEEPSEEK_API_KEY="sk-your-api-key-here"

# ç¼–è¯‘é¡¹ç›®ï¼ˆå¦‚æœè¿˜æ²¡ç¼–è¯‘ï¼‰
cd /home/xiaodong/æ–‡æ¡£/stardust
cargo build --release

# å¯åŠ¨èŠ‚ç‚¹
./target/release/stardust-node --dev --tmp --rpc-external --rpc-port 9944 --rpc-cors=all
```

### ç¬¬ä¸‰æ­¥ï¼šè¿è¡Œæµ‹è¯•è„šæœ¬

**æ‰“å¼€æ–°ç»ˆç«¯ï¼š**

```bash
cd /home/xiaodong/æ–‡æ¡£/stardust

# å®‰è£…ä¾èµ–ï¼ˆå¦‚æœè¿˜æ²¡å®‰è£…ï¼‰
npm install

# è¿è¡Œ DeepSeek ç­–ç•¥æµ‹è¯•
node test-deepseek-strategy.js
```

### ç¬¬å››æ­¥ï¼šç›‘æ§æ—¥å¿—

**æ‰“å¼€ç¬¬ä¸‰ä¸ªç»ˆç«¯ï¼š**

```bash
# ç›‘æ§èŠ‚ç‚¹æ—¥å¿—ï¼ŒæŸ¥çœ‹ DeepSeek è°ƒç”¨æƒ…å†µ
tail -f /tmp/stardust-node.log | grep -E "ğŸ¤–|DeepSeek|AI"
```

---

## ğŸ“Š é¢„æœŸè¾“å‡º

### æµ‹è¯•è„šæœ¬è¾“å‡º

```
ğŸš€ å¯åŠ¨ DeepSeek AI ç­–ç•¥æµ‹è¯•...

ğŸ“¡ è¿æ¥åˆ° Stardust é“¾...
âœ… å·²è¿æ¥åˆ°é“¾
   é“¾åç§°: Development
   èŠ‚ç‚¹ç‰ˆæœ¬: 0.1.0

ğŸ‘¤ ä½¿ç”¨æµ‹è¯•è´¦æˆ·:
   åœ°å€: 5CrDBEVDgXUwctSuV8EvQEBo2m187PcxoY36V7H7PGErHUW4
   ä½™é¢: 1.0000 MUNIT

âš™ï¸  é…ç½® DeepSeek AI æ¨¡å‹...
   ä¸»æ¨¡å‹: DeepSeek
   æ¨ç†ç«¯ç‚¹: https://api.deepseek.com/chat/completions
   ç½®ä¿¡åº¦é˜ˆå€¼: 70%
   è¶…æ—¶æ—¶é—´: 30ç§’

ğŸ“Š ç­–ç•¥å‚æ•°ï¼ˆç½‘æ ¼äº¤æ˜“ï¼‰:
   ä¸‹ç•Œä»·æ ¼: $40,000
   ä¸Šç•Œä»·æ ¼: $50,000
   ç½‘æ ¼å±‚æ•°: 10
   æ¯å•é‡‘é¢: $1,000

ğŸ›¡ï¸  é£æ§é™åˆ¶:
   æœ€å¤§ä»“ä½: $10,000
   æœ€å¤§æ æ†: 3x
   æ­¢æŸä»·æ ¼: $39,000
   æ­¢ç›ˆä»·æ ¼: $51,000
   æ¯æ—¥æœ€å¤§äº¤æ˜“æ•°: 20
   æ¯æ—¥æœ€å¤§äºæŸ: $1,000

ğŸ“ åˆ›å»º AI ç­–ç•¥äº¤æ˜“...
   ç­–ç•¥åç§°: DeepSeek BTC Grid Strategy
   äº¤æ˜“å¯¹: BTC-USD

â³ ç­‰å¾…äº¤æ˜“ç¡®è®¤...

   äº¤æ˜“çŠ¶æ€: Ready
   äº¤æ˜“çŠ¶æ€: InBlock

âœ… äº¤æ˜“å·²æ‰“åŒ…åˆ°åŒºå—: 0x1234...
   äº‹ä»¶: aiStrategy.AIStrategyCreated

ğŸ‰ ç­–ç•¥åˆ›å»ºæˆåŠŸï¼
   ç­–ç•¥ID: 0

ğŸ”’ äº¤æ˜“å·²ç¡®è®¤

ğŸ“– æŸ¥è¯¢ç­–ç•¥è¯¦æƒ…...

ç­–ç•¥è¯¦æƒ…:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ç­–ç•¥ID: 0
åˆ›å»ºè€…: 5CrDBEVDgXUwctSuV8EvQEBo2m187PcxoY36V7H7PGErHUW4
ç­–ç•¥åç§°: DeepSeek BTC Grid Strategy
äº¤æ˜“å¯¹: BTC-USD
çŠ¶æ€: Active
ç­–ç•¥ç±»å‹: Grid
AI ä¸»æ¨¡å‹: DeepSeek
ç½®ä¿¡åº¦é˜ˆå€¼: 70%
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ‘‚ å¼€å§‹ç›‘å¬ AI ä¿¡å·äº‹ä»¶...
   (OCW ä¼šæ¯10ä¸ªåŒºå—æ‰§è¡Œä¸€æ¬¡ï¼Œè¯·ç­‰å¾…...)

ğŸ¤– [17:30:45] AI ä¿¡å·ç”Ÿæˆ:
   ç­–ç•¥ID: 0
   äº¤æ˜“åŠ¨ä½œ: BUY
   ç½®ä¿¡åº¦: 85%
   ä»“ä½å¤§å°: $1000
   ç†ç”±: å¸‚åœºè¶‹åŠ¿å‘ä¸Šï¼Œå»ºè®®ä¹°å…¥

ğŸ’° [17:30:46] äº¤æ˜“å·²æ‰§è¡Œ:
   ç­–ç•¥ID: 0
   è®¢å•ID: hyperliquid-order-abc123
```

### èŠ‚ç‚¹æ—¥å¿—è¾“å‡º

```
2025-11-04 17:30:42 ğŸ¤– OCW started at block 100
2025-11-04 17:30:42 ğŸ¤– OCWæ‰§è¡ŒäºåŒºå— #100
2025-11-04 17:30:42 ğŸ“Š å¤„ç†ç­–ç•¥ #0
2025-11-04 17:30:42 ğŸŒ è°ƒç”¨ DeepSeek API: https://api.deepseek.com/chat/completions
2025-11-04 17:30:44 ğŸ“¥ DeepSeek å“åº”: 200 OK
2025-11-04 17:30:44 ğŸ¤– DeepSeek ä¿¡å·: BUY, ç½®ä¿¡åº¦: 85%
2025-11-04 17:30:44 âœ… ä¿¡å·éªŒè¯é€šè¿‡
2025-11-04 17:30:44 ğŸ’° æ„å»º Hyperliquid è®¢å•...
2025-11-04 17:30:45 ğŸ“ æäº¤æ— ç­¾åäº¤æ˜“åˆ°é“¾ä¸Š
2025-11-04 17:30:45 âœ… å·²è®°å½• AI ä¿¡å·åˆ°é“¾ä¸Š
```

---

## âš™ï¸ é…ç½®é€‰é¡¹

### ä¿®æ”¹ç½®ä¿¡åº¦é˜ˆå€¼

åœ¨ `test-deepseek-strategy.js` ä¸­ä¿®æ”¹ï¼š

```javascript
const aiConfig = {
  // ...
  confidenceThreshold: 80,  // æ”¹ä¸º 80%ï¼Œåªæ‰§è¡Œé«˜ç½®ä¿¡åº¦ä¿¡å·
  // ...
};
```

### ä¿®æ”¹ç­–ç•¥ç±»å‹

æ”¯æŒçš„ç­–ç•¥ç±»å‹ï¼š
- `Grid` - ç½‘æ ¼äº¤æ˜“
- `MarketMaking` - åšå¸‚ç­–ç•¥
- `Arbitrage` - å¥—åˆ©ç­–ç•¥
- `DCA` - å®šæŠ•ç­–ç•¥

```javascript
const tx = api.tx.aiStrategy.createAiStrategy(
  // ...
  'MarketMaking',  // æ”¹ä¸ºåšå¸‚ç­–ç•¥
  // ...
);
```

### ä¿®æ”¹ Prompt æ¸©åº¦å‚æ•°

åœ¨ `pallets/ai-strategy/src/deepseek.rs` ä¸­ä¿®æ”¹ï¼š

```rust
const request = DeepSeekRequest {
    // ...
    temperature: 5,  // 0.5 - æ›´ä¿å®ˆï¼Œæ”¹ä¸º 10 (1.0) æ›´æ¿€è¿›
    // ...
};
```

---

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: API Key æ— æ•ˆ

**ç—‡çŠ¶ï¼š** èŠ‚ç‚¹æ—¥å¿—æ˜¾ç¤º `401 Unauthorized`

**è§£å†³ï¼š**
```bash
# æ£€æŸ¥ç¯å¢ƒå˜é‡
echo $DEEPSEEK_API_KEY

# é‡æ–°è®¾ç½®
export DEEPSEEK_API_KEY="sk-correct-key"

# é‡å¯èŠ‚ç‚¹
pkill stardust-node
./target/release/stardust-node --dev --tmp
```

### é—®é¢˜ 2: ç½‘ç»œè¯·æ±‚è¶…æ—¶

**ç—‡çŠ¶ï¼š** èŠ‚ç‚¹æ—¥å¿—æ˜¾ç¤º `HTTP request timeout`

**è§£å†³ï¼š**

åœ¨ `pallets/ai-strategy/src/deepseek.rs` ä¸­å¢åŠ è¶…æ—¶æ—¶é—´ï¼š

```rust
.deadline(sp_runtime::offchain::timestamp().add(Duration::from_millis(60000)))  // æ”¹ä¸º 60 ç§’
```

### é—®é¢˜ 3: JSON è§£æå¤±è´¥

**ç—‡çŠ¶ï¼š** èŠ‚ç‚¹æ—¥å¿—æ˜¾ç¤º `Failed to parse DeepSeek response`

**è§£å†³ï¼š**

æ£€æŸ¥ DeepSeek å“åº”æ ¼å¼ï¼Œå¯èƒ½éœ€è¦è°ƒæ•´ Promptï¼š

```rust
// åœ¨ Prompt æœ«å°¾å¼ºè°ƒ
**é‡è¦ï¼šè¯·åŠ¡å¿…è¿”å›ä¸¥æ ¼çš„JSONæ ¼å¼ï¼Œä¸è¦åŒ…å«ä»»ä½•å…¶ä»–æ–‡æœ¬ã€æ³¨é‡Šæˆ– Markdown æ ‡è®°ã€‚**
```

### é—®é¢˜ 4: OCW ä¸æ‰§è¡Œ

**ç—‡çŠ¶ï¼š** æ—¥å¿—ä¸­æ²¡æœ‰ `ğŸ¤– OCWæ‰§è¡ŒäºåŒºå—` æ¶ˆæ¯

**æ£€æŸ¥ï¼š**
```bash
# 1. ç¡®è®¤ OCW é…ç½®
grep -r "offchain_worker" runtime/src/

# 2. æ£€æŸ¥ç­–ç•¥çŠ¶æ€
# åœ¨æµ‹è¯•è„šæœ¬ä¸­æŸ¥è¯¢ç­–ç•¥ï¼Œç¡®è®¤ status æ˜¯ Active

# 3. é‡æ–°ç¼–è¯‘å¹¶å¯åŠ¨
cargo build --release
./target/release/stardust-node --dev --tmp --rpc-external --enable-offchain-indexing true
```

---

## ğŸ“ˆ è¿›é˜¶ç”¨æ³•

### 1. ä½¿ç”¨çœŸå®å¸‚åœºæ•°æ®

ä¿®æ”¹ OCW ä»£ç ï¼Œä» Hyperliquid æˆ–å…¶ä»– API è·å–çœŸå®ä»·æ ¼ï¼š

```rust
// åœ¨ ocw.rs ä¸­
fn fetch_market_data(symbol: &[u8]) -> Result<MarketData, &'static str> {
    // HTTP GET åˆ° Hyperliquid API
    let url = format!("https://api.hyperliquid.xyz/info?type=candles&symbol={}", symbol);
    // ... è·å–å¹¶è§£æå¸‚åœºæ•°æ®
}
```

### 2. å¤šç­–ç•¥å¹¶è¡Œ

åˆ›å»ºå¤šä¸ªç­–ç•¥ï¼Œè®© DeepSeek åŒæ—¶ç®¡ç†ï¼š

```javascript
// ç­–ç•¥ 1: BTC ç½‘æ ¼
await createStrategy('BTC-USD', 'Grid', ...);

// ç­–ç•¥ 2: ETH åšå¸‚
await createStrategy('ETH-USD', 'MarketMaking', ...);

// ç­–ç•¥ 3: SOL å®šæŠ•
await createStrategy('SOL-USD', 'DCA', ...);
```

### 3. è‡ªå®šä¹‰ Prompt

ä¿®æ”¹ `build_trading_prompt` å‡½æ•°ï¼Œæ·»åŠ æ›´å¤šä¸Šä¸‹æ–‡ï¼š

```rust
let prompt = format!(
    r#"ä½ æ˜¯ä¸“ä¸šçš„äº¤æ˜“AIã€‚å½“å‰æŒä»“ï¼š{}ã€‚
    
    å¸‚åœºæ•°æ®ï¼š...
    
    æ ¹æ®ä½ çš„åˆ†æå†å²ï¼š[ä¸Šæ¬¡å»ºè®®: BUY, æ‰§è¡Œä»·: $45000, å½“å‰ç›ˆäº: +2%]
    
    è¯·ç»™å‡ºä¸‹ä¸€æ­¥å»ºè®®..."#,
    current_position
);
```

---

## ğŸ’° æˆæœ¬ä¼˜åŒ–å»ºè®®

1. **é™ä½è°ƒç”¨é¢‘ç‡**
   - ä»æ¯ 10 ä¸ªåŒºå—æ”¹ä¸ºæ¯ 50 ä¸ªåŒºå—
   - åªåœ¨å¸‚åœºæ³¢åŠ¨å¤§æ—¶è°ƒç”¨

2. **ä½¿ç”¨æœ¬åœ°æ¨¡å‹é¢„ç­›é€‰**
   - å…ˆç”¨ LSTM æœ¬åœ°æ¨¡å‹åˆ¤æ–­
   - åªåœ¨å…³é”®å†³ç­–æ—¶è°ƒç”¨ DeepSeek

3. **ç¼“å­˜ DeepSeek å“åº”**
   - ç›¸ä¼¼å¸‚åœºæ¡ä»¶ä½¿ç”¨ç¼“å­˜ç»“æœ
   - è®¾ç½® 5 åˆ†é’Ÿç¼“å­˜æœ‰æ•ˆæœŸ

4. **æ‰¹é‡å¤„ç†**
   - ä¸€æ¬¡è°ƒç”¨å¤„ç†å¤šä¸ªäº¤æ˜“å¯¹
   - å‡å°‘ HTTP è¯·æ±‚æ¬¡æ•°

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å®Œæ•´é›†æˆæ–¹æ¡ˆ](./DeepSeek-AIäº¤æ˜“å†³ç­–é›†æˆæ–¹æ¡ˆ.md)
- [AI Strategy Pallet README](../pallets/ai-strategy/README.md)
- [æµ‹è¯•æŒ‡å—](./AI-Strategyæµ‹è¯•æŒ‡å—.md)

---

*å¿«é€Ÿå¼€å§‹æŒ‡å— - 2025-11-04*

