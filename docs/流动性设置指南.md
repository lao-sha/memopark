# Uniswap V3 流动性设置指南

## 📊 所需流动性池

### 1. DUST/USDC 池
**用途**: 用户存款时将 DUST 兑换成 USDC

**参数**:
- Token 0: DUST (ERC20)
- Token 1: USDC
- 手续费层级: 0.3% (标准)
- 价格区间: ±20% (根据市场波动调整)
- 初始流动性: $100,000 等值

### 2. stUSDC/USDC 池
**用途**: 用户提取时将 stUSDC 兑换成 USDC

**参数**:
- Token 0: stUSDC (ERC20)
- Token 1: USDC
- 手续费层级: 0.05% (稳定币池)
- 价格区间: ±5% (根据 NAV 波动)
- 初始流动性: $50,000 等值

## 🚀 创建流动性池步骤

### 在 Uniswap V3 上创建（Arbitrum）

#### 1. 访问 Uniswap

https://app.uniswap.org/#/pools

选择网络: Arbitrum One

#### 2. 创建 DUST/USDC 池

1. 点击 "Create Pool"
2. 选择代币对:
   - Token A: DUST 合约地址
   - Token B: USDC (0xaf88d065e77c8cC2239327C5EDb3A432268e5831)
3. 选择手续费层级: 0.3%
4. 设置初始价格（例如: 1 DUST = 0.10 USDC）
5. 设置价格区间:
   - Min Price: 0.08 USDC
   - Max Price: 0.12 USDC
6. 添加流动性:
   - DUST: 1,000,000 DUST
   - USDC: $100,000

#### 3. 创建 stUSDC/USDC 池

1. 点击 "Create Pool"
2. 选择代币对:
   - Token A: stUSDC 合约地址
   - Token B: USDC
3. 选择手续费层级: 0.05%
4. 设置初始价格: 1 stUSDC ≈ 1 USDC (根据 NAV)
5. 设置价格区间:
   - Min Price: 0.95 USDC
   - Max Price: 1.05 USDC
6. 添加流动性:
   - stUSDC: 50,000 stUSDC
   - USDC: $50,000

## 💰 流动性管理

### 监控和调整

#### 1. 价格区间监控

```javascript
// 监控价格是否在区间内
const position = await uniswapPool.positions(positionId);
const currentPrice = await uniswapPool.slot0();

if (currentPrice.tick < position.tickLower || currentPrice.tick > position.tickUpper) {
  console.warn("价格超出区间，需要调整");
}
```

#### 2. 流动性深度检查

定期检查:
- 24小时交易量
- 滑点情况 (应 < 1% for $10k 交易)
- TVL (Total Value Locked)

#### 3. 手续费收入

查看并提取手续费:
```javascript
const fees = await uniswapPool.collect({
  tokenId: positionId,
  recipient: ownerAddress,
  amount0Max: MaxUint128,
  amount1Max: MaxUint128
});
```

### 再平衡策略

**情况 1: DUST 价格上涨**
- DUST 被卖出，池中 USDC 增加
- 需要添加更多 DUST 到池中

**情况 2: DUST 价格下跌**
- USDC 被卖出，池中 DUST 增加
- 需要添加更多 USDC 到池中

**情况 3: stUSDC NAV 变化**
- OCW 更新 NAV 后，stUSDC 价格变动
- 调整价格区间以反映新的 NAV

## 📈 初始资金需求

### Arbitrum 主网（示例）

| 池 | Token A | Token B | 等值 USD | 目的 |
|---|---|---|---|---|
| DUST/USDC | 1,000,000 DUST | $100,000 USDC | $200,000 | 存款兑换 |
| stUSDC/USDC | 50,000 stUSDC | $50,000 USDC | $100,000 | 提取兑换 |
| **总计** | | | **$300,000** | |

### 测试网（最小化）

| 池 | Token A | Token B | 等值 USD | 目的 |
|---|---|---|---|---|
| DUST/USDC | 10,000 DUST | $1,000 USDC | $2,000 | 功能测试 |
| stUSDC/USDC | 1,000 stUSDC | $1,000 USDC | $2,000 | 功能测试 |
| **总计** | | | **$4,000** | |

## 🛡 风险管理

### 无常损失

Uniswap V3 的集中流动性会放大无常损失。

**缓解措施**:
1. 选择合适的价格区间（不要太窄）
2. 定期再平衡
3. 手续费收入应覆盖无常损失

### 流动性枯竭

如果价格移出区间，流动性变为零。

**缓解措施**:
1. 监控价格走势
2. 及时调整价格区间
3. 保持多个位置以覆盖更宽的范围

### MEV 攻击

三明治攻击可能利用大额交易。

**缓解措施**:
1. 在 Router 中设置合理的滑点保护
2. 使用 Flashbots 等 MEV 保护服务
3. 分批执行大额交易

## 📊 监控仪表板

推荐工具:
1. **Uniswap Info** - https://info.uniswap.org/
2. **Dune Analytics** - 自定义查询
3. **The Graph** - 实时数据

监控指标:
- TVL (Total Value Locked)
- 24h 交易量
- 平均滑点
- 手续费 APR
- 价格偏离

## ✅ 完成检查清单

- [ ] DUST/USDC 池创建完成
- [ ] stUSDC/USDC 池创建完成
- [ ] 初始流动性已添加
- [ ] 价格区间设置合理
- [ ] 监控系统部署
- [ ] 再平衡策略制定
- [ ] 团队成员培训完成
- [ ] 紧急情况应对计划

## 🔄 持续运营

### 每日任务
- 检查价格是否在区间内
- 查看交易量和滑点

### 每周任务
- 提取手续费收入
- 评估是否需要再平衡
- 查看无常损失情况

### 每月任务
- 全面评估流动性策略
- 调整价格区间（如需要）
- 优化资金分配

## 联系支持

Uniswap Discord: https://discord.com/invite/uniswap

