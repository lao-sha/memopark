# ä¹°å®¶ä¿¡ç”¨ - é£é™©åˆ†è‡ªç„¶è¡°å‡æœºåˆ¶å®æ–½å®ŒæˆæŠ¥å‘Š

**æ—¥æœŸ**: 2025-10-21  
**æ¨¡å—**: `pallet-buyer-credit`  
**å®æ–½å†…å®¹**: é£é™©åˆ†è‡ªç„¶è¡°å‡æœºåˆ¶ï¼ˆæ¯30å¤©é™50åˆ†ï¼‰

---

## ä¸€ã€å®æ–½æ¦‚è¿°

å·²æˆåŠŸå®æ–½é£é™©åˆ†è‡ªç„¶è¡°å‡æœºåˆ¶ï¼Œè§£å†³"æ°¸ä¹…å°ç¦æ— æ³•æ¢å¤"çš„é—®é¢˜ï¼š

- âœ… **é£é™©åˆ†è‡ªç„¶è¡°å‡**ï¼šæ¯30å¤©æœªè¿çº¦ï¼Œé£é™©åˆ†é™ä½50åˆ†
- âœ… **åˆå§‹é£é™©åˆ†ä¿æŠ¤**ï¼šæœ€ä½ä¸ä½äºç”¨æˆ·çš„åˆå§‹é£é™©åˆ†
- âœ… **æ°¸ä¹…å°ç¦å˜é•¿æœŸå°ç¦**ï¼š1000åˆ† â†’ çº¦120å¤©åæ¢å¤åˆ°800åˆ†
- âœ… **è‡ªåŠ¨åº”ç”¨**ï¼šç”¨æˆ·ä¸‹å•æ—¶è‡ªåŠ¨æ£€æµ‹å¹¶åº”ç”¨è¡°å‡
- âœ… **è¡°å‡äº‹ä»¶**ï¼šè§¦å‘ `RiskScoreDecayed` äº‹ä»¶ï¼Œè®°å½•è¡°å‡è¿‡ç¨‹

---

## äºŒã€æ ¸å¿ƒæ”¹è¿›

### 2.1 è§£å†³çš„é—®é¢˜

**é—®é¢˜ 1ï¼šæ°¸ä¹…å°ç¦æ— æ¢å¤æœºåˆ¶**
- âŒ **ä¿®æ”¹å‰**ï¼š7å¤©å†…è¿ç»­è¿çº¦3æ¬¡ â†’ é£é™©åˆ†=1000 â†’ æ°¸ä¹…å°ç¦ï¼Œæ— æ³•æ¢å¤
- âœ… **ä¿®æ”¹å**ï¼šé£é™©åˆ†æ¯30å¤©é™ä½50åˆ† â†’ çº¦120å¤©åè‡ªåŠ¨æ¢å¤åˆ°800åˆ†

**é—®é¢˜ 2ï¼šæ— æ³•ç»™äºˆç”¨æˆ·æ”¹è¿‡è‡ªæ–°çš„æœºä¼š**
- âŒ **ä¿®æ”¹å‰**ï¼šæ­£å¸¸ç”¨æˆ·å¶å°”å¤±è¯¯ï¼ˆå¦‚ç½‘ç»œé—®é¢˜ï¼‰å¯¼è‡´æ°¸ä¹…å°ç¦ï¼Œæ— æ³•è§£é™¤
- âœ… **ä¿®æ”¹å**ï¼šè€å¿ƒç­‰å¾…120å¤©ï¼ˆçº¦4ä¸ªæœˆï¼‰ï¼Œé£é™©åˆ†è‡ªç„¶æ¢å¤

**é—®é¢˜ 3ï¼šå‘½åæ··æ·†**
- âš ï¸ **ç°çŠ¶**ï¼š"æ°¸ä¹…å°ç¦"å®é™…ä¸Šæ˜¯"é•¿æœŸå°ç¦"ï¼ˆ120å¤©ï¼‰
- âœ… **æ˜ç¡®**ï¼šæ–‡æ¡£ä¸­æ˜ç¡®è¯´æ˜è¡°å‡æœºåˆ¶å’Œæ¢å¤æ—¶é—´

---

## ä¸‰ã€ä»£ç å®ç°è¯¦æƒ…

### 3.1 æ–°å¢äº‹ä»¶

#### `RiskScoreDecayed`

è®°å½•é£é™©åˆ†è¡°å‡äº‹ä»¶ã€‚

```rust
/// å‡½æ•°çº§ä¸­æ–‡æ³¨é‡Šï¼šé£é™©åˆ†è‡ªç„¶è¡°å‡ï¼ˆ2025-10-21 æ–°å¢ï¼‰
/// [è´¦æˆ·, è¡°å‡é‡, æ–°é£é™©åˆ†]
RiskScoreDecayed {
    account: T::AccountId,
    decay_amount: u16,
    new_risk_score: u16,
},
```

---

### 3.2 æ–°å¢è¾…åŠ©å‡½æ•°

#### 1. `get_initial_risk_score`

è®¡ç®—ç”¨æˆ·çš„åˆå§‹é£é™©åˆ†ï¼ˆåŸºäºå¤šç»´åº¦ä¿¡ä»»è¯„ä¼°ï¼‰ã€‚

```rust
/// å‡½æ•°çº§ä¸­æ–‡æ³¨é‡Šï¼šè·å–ç”¨æˆ·åˆå§‹é£é™©åˆ†ï¼ˆ2025-10-21 æ–°å¢ï¼‰
/// 
/// # è¯´æ˜
/// ç”¨äºé£é™©åˆ†è¡°å‡æ—¶è®¾ç½®æœ€ä½é˜ˆå€¼ï¼Œç¡®ä¿é£é™©åˆ†ä¸ä¼šä½äºåˆå§‹å€¼
fn get_initial_risk_score(buyer: &T::AccountId) -> u16 {
    let credit = BuyerCredit::<T>::get(buyer);
    
    // å¦‚æœç”¨æˆ·æœªåˆå§‹åŒ–ï¼Œè¿”å›é»˜è®¤æœ€é«˜é£é™©åˆ†
    if credit.account_created_at.is_zero() {
        return 1000;
    }
    
    // è®¡ç®—å¤šç»´åº¦ä¿¡ä»»è¯„ä¼°
    // 1. èµ„äº§ä¿¡ä»»åº¦ï¼ˆ25%ï¼‰
    let balance = T::Currency::free_balance(buyer);
    let asset_trust = if balance >= 1000u32.into() {
        100
    } else if balance >= 500u32.into() {
        80
    } else if balance >= 100u32.into() {
        60
    } else if balance >= 10u32.into() {
        40
    } else {
        20
    };
    
    // 2. è´¦æˆ·å¹´é¾„ä¿¡ä»»åº¦ï¼ˆ20%ï¼‰
    let current_block = <frame_system::Pallet<T>>::block_number();
    let age_blocks = current_block.saturating_sub(credit.account_created_at);
    let blocks_per_30_days = T::BlocksPerDay::get().saturating_mul(30u32.into());
    let age_30day_cycles: u32 = (age_blocks / blocks_per_30_days).saturated_into();
    let age_trust = core::cmp::min(age_30day_cycles * 10, 100) as u16;
    
    // 3. æ´»è·ƒåº¦ä¿¡ä»»ï¼ˆ20%ï¼‰
    let transfer_count = TransferCount::<T>::get(buyer);
    let activity_trust = core::cmp::min(transfer_count * 5, 100) as u16;
    
    // 4. ç¤¾äº¤ä¿¡ä»»ï¼ˆ20%ï¼‰
    let endorsements = Endorsements::<T>::get(buyer);
    let active_endorsements = endorsements.iter().filter(|e| e.is_active).count();
    let social_trust = core::cmp::min(active_endorsements as u16 * 40, 100);
    
    // 5. èº«ä»½ä¿¡ä»»ï¼ˆ15%ï¼‰
    let has_referrer = Referrer::<T>::contains_key(buyer);
    let identity_trust = if has_referrer { 60 } else { 0 };
    
    // ç»¼åˆä¿¡ä»»åˆ†è®¡ç®—
    let trust_score = (asset_trust * 25 + age_trust * 20 + activity_trust * 20 + 
                      social_trust * 20 + identity_trust * 15) / 100;
    
    // é£é™©åˆ† = 1000 - ç»¼åˆä¿¡ä»»åˆ† * 10
    1000u16.saturating_sub(trust_score * 10)
}
```

**ç‰¹ç‚¹**ï¼š
- âœ… åŸºäºå¤šç»´åº¦ä¿¡ä»»è¯„ä¼°ï¼ˆèµ„äº§ã€å¹´é¾„ã€æ´»è·ƒåº¦ã€ç¤¾äº¤ã€èº«ä»½ï¼‰
- âœ… æ–°ç”¨æˆ·åˆå§‹é£é™©åˆ†è¾ƒé«˜ï¼ˆå¦‚400-600åˆ†ï¼‰
- âœ… è€ç”¨æˆ·/æ´»è·ƒç”¨æˆ·åˆå§‹é£é™©åˆ†è¾ƒä½ï¼ˆå¦‚300-400åˆ†ï¼‰

---

#### 2. `calculate_risk_decay`

è®¡ç®—é£é™©åˆ†è‡ªç„¶è¡°å‡é‡ã€‚

```rust
/// å‡½æ•°çº§ä¸­æ–‡æ³¨é‡Šï¼šè®¡ç®—é£é™©åˆ†è‡ªç„¶è¡°å‡é‡ï¼ˆ2025-10-21 æ–°å¢ï¼‰
/// 
/// # è¡°å‡è§„åˆ™
/// - æ¯30å¤©æœªè¿çº¦ï¼Œé£é™©åˆ†é™ä½ 50åˆ†
/// - æœ€ä½ä¸ä½äºç”¨æˆ·çš„åˆå§‹é£é™©åˆ†
/// - å¦‚æœç”¨æˆ·æ²¡æœ‰è¿çº¦è®°å½•ï¼Œä¸è¡°å‡
/// 
/// # æ•ˆæœç¤ºä¾‹
/// - æ°¸ä¹…å°ç¦ï¼ˆ1000åˆ†ï¼‰â†’ 120å¤©åæ¢å¤åˆ°800åˆ†ï¼ˆè‡ªåŠ¨è§£å°ï¼‰
/// - é«˜é£é™©ç”¨æˆ·ï¼ˆ850åˆ†ï¼‰â†’ 30å¤©åæ¢å¤åˆ°800åˆ†ï¼ˆè‡ªåŠ¨è§£å°ï¼‰
fn calculate_risk_decay(buyer: &T::AccountId) -> u16 {
    let credit = BuyerCredit::<T>::get(buyer);
    
    // å¦‚æœæ²¡æœ‰è¿çº¦è®°å½•ï¼Œä¸è¡°å‡
    if credit.default_count == 0 {
        return 0;
    }
    
    let current_block = <frame_system::Pallet<T>>::block_number();
    let last_default_block = DefaultHistory::<T>::get(buyer)
        .last()
        .copied()
        .unwrap_or(Zero::zero());
    
    let blocks_since_last_default = current_block.saturating_sub(last_default_block);
    let blocks_per_30_days = T::BlocksPerDay::get().saturating_mul(30u32.into());
    
    // è®¡ç®—ç»è¿‡äº†å¤šå°‘ä¸ª30å¤©å‘¨æœŸ
    let decay_cycles: u32 = (blocks_since_last_default / blocks_per_30_days).saturated_into();
    
    // æ¯ä¸ªå‘¨æœŸè¡°å‡50åˆ†
    let decay_amount = (decay_cycles as u16).saturating_mul(50);
    
    decay_amount
}
```

**ç‰¹ç‚¹**ï¼š
- âœ… åŸºäºæœ€åä¸€æ¬¡è¿çº¦çš„æ—¶é—´è®¡ç®—
- âœ… æ¯30å¤©é™ä½50åˆ†
- âœ… å¦‚æœç”¨æˆ·æ²¡æœ‰è¿çº¦è®°å½•ï¼Œä¸è¡°å‡ï¼ˆé¿å…ä¸å¿…è¦çš„è®¡ç®—ï¼‰

---

### 3.3 ä¿®æ”¹æ ¸å¿ƒå‡½æ•°

#### `check_buyer_limit`ï¼ˆæ–°å¢é£é™©åˆ†è¡°å‡åº”ç”¨ï¼‰

**ä¿®æ”¹å‰**ï¼š
```rust
pub fn check_buyer_limit(buyer: &T::AccountId, amount_usdt: u64) -> Result<(), Error<T>> {
    let mut credit = BuyerCredit::<T>::get(buyer);
    
    // å¦‚æœæ˜¯æ–°ç”¨æˆ·ï¼ˆæœªåˆå§‹åŒ–ï¼‰ï¼Œå…ˆåˆå§‹åŒ–
    if credit.account_created_at.is_zero() {
        let _tier = Self::initialize_new_user_credit(buyer);
        credit = BuyerCredit::<T>::get(buyer);
    }
    
    // æ£€æŸ¥ä¿¡ç”¨åˆ†ï¼ˆé£é™©åˆ† > 800 ç¦æ­¢äº¤æ˜“ï¼‰
    ensure!(credit.risk_score <= 800, Error::<T>::CreditScoreTooLow);
    
    // ... å…¶ä»–æ£€æŸ¥é€»è¾‘
}
```

**ä¿®æ”¹å**ï¼š
```rust
pub fn check_buyer_limit(buyer: &T::AccountId, amount_usdt: u64) -> Result<(), Error<T>> {
    let mut credit = BuyerCredit::<T>::get(buyer);
    
    // å¦‚æœæ˜¯æ–°ç”¨æˆ·ï¼ˆæœªåˆå§‹åŒ–ï¼‰ï¼Œå…ˆåˆå§‹åŒ–
    if credit.account_created_at.is_zero() {
        let _tier = Self::initialize_new_user_credit(buyer);
        credit = BuyerCredit::<T>::get(buyer);
    }
    
    // ğŸ†• åº”ç”¨é£é™©åˆ†è‡ªç„¶è¡°å‡ï¼ˆæ¯30å¤©é™ä½50åˆ†ï¼‰
    let decay_amount = Self::calculate_risk_decay(buyer);
    if decay_amount > 0 {
        let initial_risk = Self::get_initial_risk_score(buyer);
        let old_risk_score = credit.risk_score;
        
        // åº”ç”¨è¡°å‡ï¼Œä½†ä¸ä½äºåˆå§‹é£é™©åˆ†
        credit.risk_score = credit.risk_score
            .saturating_sub(decay_amount)
            .max(initial_risk);
        
        // å¦‚æœé£é™©åˆ†ç¡®å®æœ‰å˜åŒ–ï¼Œæ›´æ–°å­˜å‚¨å¹¶è§¦å‘äº‹ä»¶
        if credit.risk_score != old_risk_score {
            BuyerCredit::<T>::insert(buyer, &credit);
            
            Self::deposit_event(Event::RiskScoreDecayed {
                account: buyer.clone(),
                decay_amount: old_risk_score.saturating_sub(credit.risk_score),
                new_risk_score: credit.risk_score,
            });
        }
    }
    
    // æ£€æŸ¥ä¿¡ç”¨åˆ†ï¼ˆé£é™©åˆ† > 800 ç¦æ­¢äº¤æ˜“ï¼‰
    ensure!(credit.risk_score <= 800, Error::<T>::CreditScoreTooLow);
    
    // ... å…¶ä»–æ£€æŸ¥é€»è¾‘
}
```

**å…³é”®ç‚¹**ï¼š
1. âœ… **åº”ç”¨æ—¶æœº**ï¼šåœ¨æ£€æŸ¥é£é™©åˆ†ä¹‹å‰åº”ç”¨è¡°å‡
2. âœ… **æœ€ä½é˜ˆå€¼**ï¼šä¸ä½äºç”¨æˆ·çš„åˆå§‹é£é™©åˆ†
3. âœ… **äº‹ä»¶è§¦å‘**ï¼šé£é™©åˆ†å˜åŒ–æ—¶è§¦å‘ `RiskScoreDecayed` äº‹ä»¶
4. âœ… **å­˜å‚¨æ›´æ–°**ï¼šæ›´æ–° `BuyerCredit` å­˜å‚¨

---

## å››ã€æ•ˆæœå¯¹æ¯”

### 4.1 æ°¸ä¹…å°ç¦æ¢å¤æ—¶é—´

**åœºæ™¯**ï¼šç”¨æˆ·å› 7å¤©å†…è¿ç»­è¿çº¦3æ¬¡è¢«æ°¸ä¹…å°ç¦ï¼ˆé£é™©åˆ†=1000ï¼‰

| æ—¶é—´ | é£é™©åˆ† | è¡°å‡é‡ | è§£å°çŠ¶æ€ | è¯´æ˜ |
|------|--------|--------|---------|------|
| **è¿çº¦åç¬¬1å¤©** | 1000 | 0 | âŒ å°ç¦ | åˆšè§¦å‘æ°¸ä¹…å°ç¦ |
| **30å¤©å** | 950 | 50 | âŒ å°ç¦ï¼ˆ> 800ï¼‰ | è¡°å‡1æ¬¡ |
| **60å¤©å** | 900 | 100 | âŒ å°ç¦ï¼ˆ> 800ï¼‰ | è¡°å‡2æ¬¡ |
| **90å¤©å** | 850 | 150 | âŒ å°ç¦ï¼ˆ> 800ï¼‰ | è¡°å‡3æ¬¡ |
| **120å¤©å** | **800** | **200** | âœ… **è‡ªåŠ¨è§£å°**ï¼ˆ= 800ï¼‰ | âœ… è¡°å‡4æ¬¡ï¼Œåˆšå¥½æ¢å¤ |
| **150å¤©å** | 750 | 250 | âœ… å·²è§£å° | ç»§ç»­è¡°å‡ |

**ç»“è®º**ï¼š
- âœ… æ°¸ä¹…å°ç¦å˜ä¸º"é•¿æœŸå°ç¦"ï¼ˆçº¦120å¤©â‰ˆ4ä¸ªæœˆï¼‰
- âœ… ç»™äºˆç”¨æˆ·æ”¹è¿‡è‡ªæ–°çš„æœºä¼š
- âœ… ä¿æŒå¼ºå¨æ…‘åŠ›ï¼ˆ4ä¸ªæœˆå†·å´æœŸï¼‰

---

### 4.2 é«˜é£é™©ç”¨æˆ·æ¢å¤æ—¶é—´

**åœºæ™¯**ï¼šç”¨æˆ·å› 2æ¬¡è¿çº¦ï¼ˆ7å¤©å¤–ï¼‰é£é™©åˆ†è¾¾åˆ°850åˆ†

| æ—¶é—´ | é£é™©åˆ† | è¡°å‡é‡ | è§£å°çŠ¶æ€ | è¯´æ˜ |
|------|--------|--------|---------|------|
| **è¿çº¦åç¬¬1å¤©** | 850 | 0 | âŒ å°ç¦ï¼ˆ> 800ï¼‰ | - |
| **30å¤©å** | **800** | **50** | âœ… **è‡ªåŠ¨è§£å°**ï¼ˆ= 800ï¼‰ | âœ… è¡°å‡1æ¬¡ï¼Œåˆšå¥½æ¢å¤ |
| **60å¤©å** | 750 | 100 | âœ… å·²è§£å° | ç»§ç»­è¡°å‡ |

**ç»“è®º**ï¼š
- âœ… é«˜é£é™©ç”¨æˆ·30å¤©åå³å¯æ¢å¤
- âœ… æ¢å¤æ—¶é—´å–å†³äºé£é™©åˆ†é«˜ä½

---

### 4.3 åˆå§‹é£é™©åˆ†ä¿æŠ¤

**åœºæ™¯**ï¼šæ–°ç”¨æˆ·åˆå§‹é£é™©åˆ†400åˆ†ï¼Œè¿çº¦1æ¬¡ï¼ˆ+30åˆ†ï¼‰â†’ 430åˆ†

| æ—¶é—´ | é£é™©åˆ† | è¡°å‡é‡ | æœ€ä½é˜ˆå€¼ | å®é™…é£é™©åˆ† | è¯´æ˜ |
|------|--------|--------|---------|-----------|------|
| **è¿çº¦åç¬¬1å¤©** | 430 | 0 | 400 | 430 | - |
| **30å¤©å** | 380 | 50 | **400** | **400** | âœ… è¡°å‡åˆ°380ï¼Œä½†ä¸ä½äº400 |
| **60å¤©å** | 330 | 100 | **400** | **400** | âœ… è¡°å‡åˆ°330ï¼Œä½†ä¸ä½äº400 |

**ç»“è®º**ï¼š
- âœ… é£é™©åˆ†ä¸ä¼šä½äºåˆå§‹å€¼
- âœ… é¿å…å› è¡°å‡è€Œé™å¾—è¿‡ä½
- âœ… ä¿æŒç³»ç»Ÿå¹³è¡¡

---

## äº”ã€ç¼–è¯‘éªŒè¯

### 5.1 ç¼–è¯‘ç»“æœ

```bash
cd /home/xiaodong/æ–‡æ¡£/stardust
cargo check --release -p pallet-buyer-credit
```

**ç»“æœ**ï¼šâœ… **ç¼–è¯‘æˆåŠŸ**
```
    Checking pallet-buyer-credit v1.0.0 (/home/xiaodong/æ–‡æ¡£/stardust/pallets/buyer-credit)
    Finished `release` profile [optimized] target(s) in 1.91s
```

---

## å…­ã€æ–‡æ¡£æ›´æ–°

### 6.1 æ›´æ–° `README.md`

- âœ… å¢åŠ "é£é™©åˆ†è‡ªç„¶è¡°å‡æœºåˆ¶"ç« èŠ‚
- âœ… æ–°å¢ `RiskScoreDecayed` äº‹ä»¶è¯´æ˜
- âœ… å¢åŠ æ•ˆæœç¤ºä¾‹è¡¨æ ¼
- âœ… è¯´æ˜åˆå§‹é£é™©åˆ†è®¡ç®—å…¬å¼

---

## ä¸ƒã€å®æ–½æ€»ç»“

### 7.1 ä»£ç ç»Ÿè®¡

| é¡¹ç›® | æ•°é‡ | è¯´æ˜ |
|------|------|------|
| æ–°å¢äº‹ä»¶ | 1 | `RiskScoreDecayed` |
| æ–°å¢å‡½æ•° | 2 | `get_initial_risk_score`, `calculate_risk_decay` |
| ä¿®æ”¹å‡½æ•° | 1 | `check_buyer_limit`ï¼ˆå¢åŠ è¡°å‡åº”ç”¨é€»è¾‘ï¼‰ |
| **æ€»è®¡æ–°å¢ä»£ç ** | **~120è¡Œ** | å«è¯¦ç»†ä¸­æ–‡æ³¨é‡Š |

### 7.2 æ ¸å¿ƒæ”¹è¿›

1. âœ… **é£é™©åˆ†è‡ªç„¶è¡°å‡**ï¼ˆæ¯30å¤©é™50åˆ†ï¼‰
2. âœ… **åˆå§‹é£é™©åˆ†ä¿æŠ¤**ï¼ˆä¸ä½äºåˆå§‹å€¼ï¼‰
3. âœ… **æ°¸ä¹…å°ç¦å˜é•¿æœŸå°ç¦**ï¼ˆ120å¤©åè‡ªåŠ¨æ¢å¤ï¼‰
4. âœ… **è‡ªåŠ¨åº”ç”¨**ï¼ˆç”¨æˆ·ä¸‹å•æ—¶è‡ªåŠ¨æ£€æµ‹ï¼‰
5. âœ… **è¡°å‡äº‹ä»¶**ï¼ˆè®°å½•è¡°å‡è¿‡ç¨‹ï¼‰

### 7.3 æ•ˆæœé¢„æœŸ

**å¯¹è¢«å°ç¦ç”¨æˆ·**ï¼š
- âš ï¸ æ°¸ä¹…å°ç¦ï¼ˆ1000åˆ†ï¼‰ï¼šè€å¿ƒç­‰å¾…120å¤©ï¼ˆçº¦4ä¸ªæœˆï¼‰
- âš ï¸ é«˜é£é™©ï¼ˆ850åˆ†ï¼‰ï¼šè€å¿ƒç­‰å¾…30å¤©
- âœ… ç»™äºˆæ”¹è¿‡è‡ªæ–°çš„æœºä¼š

**å¯¹åšå¸‚å•†**ï¼š
- âœ… æ¶æ„ç”¨æˆ·ä»éœ€120å¤©æ‰èƒ½æ¢å¤ï¼ˆä¿æŒå¨æ…‘åŠ›ï¼‰
- âœ… å¶å°”å¤±è¯¯çš„æ­£å¸¸ç”¨æˆ·å¯å¿«é€Ÿæ¢å¤ï¼ˆ30å¤©ï¼‰

**å¯¹ç³»ç»Ÿ**ï¼š
- âœ… è‡ªåŠ¨åŒ–å¤„ç†ï¼Œæ— éœ€äººå·¥å¹²é¢„
- âœ… å¹³è¡¡å®‰å…¨æ€§å’Œç”¨æˆ·ä½“éªŒ
- âœ… é£é™©åˆ†ä¸ä¼šé™å¾—è¿‡ä½ï¼ˆåˆå§‹é£é™©åˆ†ä¿æŠ¤ï¼‰

---

## å…«ã€ä¸å†·å´æœŸæœºåˆ¶çš„å¯¹æ¯”

### 8.1 ä¸¤ç§æ¢å¤æœºåˆ¶

| ç‰¹æ€§ | **å†·å´æœŸå°ç¦** | **é£é™©åˆ†å°ç¦** |
|------|--------------|--------------|
| **è§¦å‘æ¡ä»¶** | è¿çº¦æ¬¡æ•°ç´¯ç§¯ï¼ˆ30å¤©å†…ï¼‰ | é£é™©åˆ† > 800 |
| **å°ç¦æ—¶é•¿** | å›ºå®šï¼ˆ1/3/7/14/30å¤©ï¼‰ | åŠ¨æ€ï¼ˆå–å†³äºé£é™©åˆ†ï¼‰ |
| **æ¢å¤æ–¹å¼** | â° æ—¶é—´åˆ°æœŸè‡ªåŠ¨è§£é™¤ | ğŸ“‰ é£é™©åˆ†è¡°å‡åˆ°800ä»¥ä¸‹ |
| **æœ€é•¿æ—¶é•¿** | 30å¤© | **120å¤©**ï¼ˆæ°¸ä¹…å°ç¦æ¢å¤ï¼‰ |
| **å¯é¢„æµ‹æ€§** | âœ… é«˜ï¼ˆå›ºå®šæ—¶é—´ï¼‰ | âš ï¸ ä¸­ï¼ˆå–å†³äºé£é™©åˆ†ï¼‰ |

### 8.2 ä¸¤è€…å…³ç³»

**å†·å´æœŸå°ç¦**ï¼š
- âœ… çŸ­æœŸä¸´æ—¶å°ç¦ï¼ˆ1-30å¤©ï¼‰
- âœ… åŸºäºæœ€åä¸€æ¬¡è¿çº¦æ—¶é—´è®¡ç®—
- âœ… å†·å´æœŸç»“æŸåç«‹å³è§£é™¤

**é£é™©åˆ†å°ç¦**ï¼š
- ğŸ”´ é•¿æœŸ/æ°¸ä¹…å°ç¦ï¼ˆ30-120å¤©ï¼‰
- ğŸ”´ åŸºäºç´¯è®¡é£é™©åˆ†è®¡ç®—
- ğŸ”´ éœ€è¦é£é™©åˆ†è¡°å‡åˆ°800ä»¥ä¸‹æ‰èƒ½è§£é™¤

**ååŒå·¥ä½œ**ï¼š
```
ç”¨æˆ·è¿çº¦
    â†“
è§¦å‘å†·å´æœŸï¼ˆ1-30å¤©ï¼‰
    â†“
ç´¯è®¡é£é™©åˆ†å¢åŠ 
    â†“
å¦‚æœé£é™©åˆ† > 800
    â†“
å†·å´æœŸç»“æŸï¼Œä½†ä»è¢«é£é™©åˆ†å°ç¦
    â†“
ç­‰å¾…é£é™©åˆ†è‡ªç„¶è¡°å‡ï¼ˆ30-120å¤©ï¼‰
    â†“
é£é™©åˆ† <= 800
    â†“
âœ… å®Œå…¨è§£å°
```

---

## ä¹ã€åç»­ä¼˜åŒ–å»ºè®®

### 9.1 æ²»ç†æ‰‹åŠ¨è§£å°ï¼ˆå¯é€‰ï¼‰

**å»ºè®®åŠŸèƒ½**ï¼š
- æ²»ç†å¯æŠ•ç¥¨å†³å®šæ˜¯å¦è§£å°ç‰¹å®šç”¨æˆ·
- Root å¯æ‰‹åŠ¨è°ƒæ•´ç”¨æˆ·é£é™©åˆ†

**å®æ–½éš¾åº¦**ï¼šä½ï¼ˆ~30è¡Œä»£ç ï¼‰

**ç¤ºä¾‹**ï¼š
```rust
#[pallet::call_index(10)]
pub fn unban_user(
    origin: OriginFor<T>,
    who: T::AccountId,
    new_risk_score: u16,
) -> DispatchResult {
    ensure_root(origin)?;
    
    BuyerCredit::<T>::mutate(&who, |credit| {
        credit.risk_score = new_risk_score;
    });
    
    Self::deposit_event(Event::UserUnbanned {
        account: who,
        new_risk_score,
    });
    
    Ok(())
}
```

---

### 9.2 åŠ é€Ÿè¡°å‡æœºåˆ¶ï¼ˆå¯é€‰ï¼‰

**å»ºè®®åŠŸèƒ½**ï¼š
- ç”¨æˆ·å®Œæˆé«˜è´¨é‡è®¢å•ï¼ˆå¿«é€Ÿä»˜æ¬¾ã€å¤§é¢äº¤æ˜“ï¼‰å¯åŠ é€Ÿé£é™©åˆ†è¡°å‡
- ä¾‹å¦‚ï¼šæ¯å®Œæˆ1ç¬”ä¼˜è´¨è®¢å•ï¼Œé¢å¤–é™ä½10åˆ†

**å®æ–½éš¾åº¦**ï¼šä¸­ï¼ˆ~50è¡Œä»£ç ï¼‰

---

### 9.3 å‰ç«¯é›†æˆï¼ˆå¾…å®æ–½ï¼‰

**ç”¨æˆ·æç¤º**ï¼š

**åœºæ™¯1ï¼šç”¨æˆ·åœ¨é£é™©åˆ†å°ç¦ä¸­**
```
âŒ æ‚¨çš„è´¦æˆ·å› é£é™©åˆ†è¿‡é«˜è¢«å°ç¦
- å½“å‰é£é™©åˆ†ï¼š950 / 800
- é¢„è®¡æ¢å¤æ—¶é—´ï¼š60å¤©å
- å»ºè®®ï¼šè€å¿ƒç­‰å¾…é£é™©åˆ†è‡ªç„¶è¡°å‡ï¼Œæˆ–è”ç³»å®¢æœç”³è¯‰
```

**åœºæ™¯2ï¼šé£é™©åˆ†è¡°å‡é€šçŸ¥**
```
âœ… æ‚¨çš„é£é™©åˆ†å·²è‡ªç„¶è¡°å‡
- è¡°å‡é‡ï¼š50åˆ†
- æ–°é£é™©åˆ†ï¼š900 / 800
- å‰©ä½™æ¢å¤æ—¶é—´ï¼šçº¦60å¤©
```

---

## åã€æœ€ç»ˆç»“è®º

### âœ… å®æ–½æˆåŠŸ

- âœ… é£é™©åˆ†è‡ªç„¶è¡°å‡æœºåˆ¶å·²å®æ–½
- âœ… åˆå§‹é£é™©åˆ†ä¿æŠ¤å·²å®æ–½
- âœ… ç¼–è¯‘éªŒè¯é€šè¿‡
- âœ… æ–‡æ¡£å·²æ›´æ–°

### ğŸ“Š æ•ˆæœè¯„ä¼°

| æŒ‡æ ‡ | æ—§æœºåˆ¶ | **æ–°æœºåˆ¶** | æ”¹è¿›æ•ˆæœ |
|------|--------|-----------|---------|
| æ°¸ä¹…å°ç¦ | âŒ æ— æ³•è‡ªåŠ¨è§£é™¤ | âœ… **120å¤©åè‡ªåŠ¨æ¢å¤** | âœ… ç»™äºˆæœºä¼š |
| é«˜é£é™©ç”¨æˆ· | âš ï¸ éš¾ä»¥æ¢å¤ | âœ… **30å¤©åè‡ªåŠ¨æ¢å¤** | âœ… å¿«é€Ÿæ¢å¤ |
| ç”¨æˆ·ä½“éªŒ | âš ï¸ è¿‡äºä¸¥å‰ | âœ… **æ›´åŠ äººæ€§åŒ–** | âœ… æ˜¾è‘—æ”¹å–„ |
| å®‰å…¨æ€§ | âœ… å¼º | âœ… **ä»ç„¶å¼º**ï¼ˆ120å¤©å¨æ…‘ï¼‰ | âœ… ä¿æŒ |

### ğŸ¯ å»ºè®®è¡ŒåŠ¨

1. **ç«‹å³éƒ¨ç½²**ï¼šå½“å‰å®æ–½å·²è¶³å¤Ÿå®Œå–„ï¼Œå¯ç«‹å³éƒ¨ç½²åˆ°æµ‹è¯•ç½‘
2. **ç›‘æ§æ•°æ®**ï¼šéƒ¨ç½²åç›‘æ§é£é™©åˆ†è¡°å‡æ•°æ®ï¼Œè¯„ä¼°æ¢å¤ç‡
3. **ç”¨æˆ·åé¦ˆ**ï¼šæ”¶é›†ç”¨æˆ·åé¦ˆï¼Œè¯„ä¼°120å¤©æ¢å¤æ—¶é—´æ˜¯å¦åˆç†
4. **åç»­ä¼˜åŒ–**ï¼šæ ¹æ®æ•°æ®åé¦ˆï¼Œè€ƒè™‘å®æ–½æ²»ç†æ‰‹åŠ¨è§£å°æˆ–åŠ é€Ÿè¡°å‡æœºåˆ¶

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-10-21  
**å®æ–½çŠ¶æ€**: âœ… **å®Œæˆ**  
**ç¼–è¯‘éªŒè¯**: âœ… **é€šè¿‡**  
**é£é™©ç­‰çº§**: ğŸŸ¢ **ä½**ï¼ˆå‘åå…¼å®¹ï¼Œä»…å¢å¼ºåŠŸèƒ½ï¼‰  
**æ ¸å¿ƒä»·å€¼**: âœ… **è®©"æ°¸ä¹…å°ç¦"å˜ä¸º"é•¿æœŸå°ç¦"ï¼Œç»™äºˆç”¨æˆ·æ”¹è¿‡è‡ªæ–°çš„æœºä¼š**

