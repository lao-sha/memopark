# ä¿®å¤æŠ¥å‘Šï¼šé’±åŒ…ç®¡ç†æŒ‰é’®æ— å“åº”

## ğŸ“‹ é—®é¢˜æè¿°

**å‘ç°æ—¥æœŸ**: 2025-11-08  
**é—®é¢˜é¡µé¢**: http://127.0.0.1:5173/#/profile (ä¸ªäººä¸­å¿ƒ)  
**é—®é¢˜ç°è±¡**: ç‚¹å‡»"é’±åŒ…ç®¡ç†"æŒ‰é’®æ²¡æœ‰ä»»ä½•ååº”

---

## ğŸ” é—®é¢˜åˆ†æ

### æ ¹æœ¬åŸå› 

**äº‹ä»¶æœºåˆ¶ä¸åŒ¹é…** âŒ

ä»£ç ä½¿ç”¨äº† `mp.nav` è‡ªå®šä¹‰äº‹ä»¶æ¥è§¦å‘é¡µé¢è·³è½¬ï¼š

```typescript
// é”™è¯¯çš„ä»£ç ï¼ˆç¬¬ 377 è¡Œï¼‰
onClick: () => {
  window.dispatchEvent(new CustomEvent('mp.nav', { detail: { tab: 'wallet-manage' } }));
}
```

**é—®é¢˜**:
- `mp.nav` äº‹ä»¶ç›‘å¬å™¨åªåœ¨ `AuthEntryPage` ç»„ä»¶ä¸­æ³¨å†Œ
- å½“ç”¨æˆ·è®¿é—® `#/profile` æ—¶ï¼Œæ˜¾ç¤ºçš„æ˜¯ç‹¬ç«‹è·¯ç”±çš„ `MyWalletPage` ç»„ä»¶
- ä¸åœ¨ `AuthEntryPage` å†…éƒ¨ï¼Œæ‰€ä»¥æ²¡æœ‰ç›‘å¬å™¨æ¥æ”¶äº‹ä»¶
- ç»“æœï¼šç‚¹å‡»æŒ‰é’®è§¦å‘äº‹ä»¶ï¼Œä½†æ— äººå¤„ç† â†’ æ— ååº”

### æ¶æ„åˆ†æ

```
ç”¨æˆ·è®¿é—® #/profile
  â†“
App.tsx æ ¹æ®è·¯ç”±æ¸²æŸ“
  â†“
resolveRoute('#/profile') 
  â†“
è¿”å› MyWalletPage ç»„ä»¶ (ç‹¬ç«‹æ¸²æŸ“)
  â†“
ç‚¹å‡»"é’±åŒ…ç®¡ç†"
  â†“
dispatchEvent('mp.nav') âŒ
  â†“
æ— ç›‘å¬å™¨ â†’ æ— ååº”
```

### ä¸ºä»€ä¹ˆä¼šè¿™æ ·è®¾è®¡ï¼Ÿ

é¡¹ç›®ä¸­å­˜åœ¨ä¸¤ç§é¡µé¢æ¶æ„ï¼š

1. **AuthEntryPage å†…çš„ Tab é¡µé¢**ï¼ˆæ—§æ¶æ„ï¼‰
   - ä½¿ç”¨ `mp.nav` äº‹ä»¶åœ¨ Tab ä¹‹é—´åˆ‡æ¢
   - ç›‘å¬å™¨åœ¨ `AuthEntryPage.tsx` ç¬¬ 41-58 è¡Œ
   - ä¾‹å¦‚ï¼šwelcome, restore, create, transfer ç­‰

2. **ç‹¬ç«‹è·¯ç”±é¡µé¢**ï¼ˆæ–°æ¶æ„ï¼‰
   - ä½¿ç”¨ hash è·¯ç”±ç›´æ¥è·³è½¬
   - ä¸ä¾èµ– `mp.nav` äº‹ä»¶
   - ä¾‹å¦‚ï¼š#/profile, #/wallet, #/home ç­‰

**æ··ç”¨å¯¼è‡´é—®é¢˜**: åœ¨æ–°æ¶æ„é¡µé¢ä¸­ä½¿ç”¨äº†æ—§æ¶æ„çš„äº‹ä»¶æœºåˆ¶

---

## âœ… ä¿®å¤æ–¹æ¡ˆ

### ä¿®æ”¹å†…å®¹

**æ–‡ä»¶**: `stardust-dapp/src/features/profile/MyWalletPage.tsx`

#### ä¿®æ”¹å‰ï¼ˆç¬¬ 373-379 è¡Œï¼‰

```typescript
{
  icon: <WalletOutlined style={{ fontSize: '20px' }} />,
  title: 'é’±åŒ…ç®¡ç†',
  onClick: () => {
    // è·³è½¬åˆ°é’±åŒ…ç®¡ç†é¡µé¢
    window.dispatchEvent(new CustomEvent('mp.nav', { detail: { tab: 'wallet-manage' } }));
  },
}
```

#### ä¿®æ”¹å

```typescript
{
  icon: <WalletOutlined style={{ fontSize: '20px' }} />,
  title: 'é’±åŒ…ç®¡ç†',
  onClick: () => {
    // è·³è½¬åˆ°é’±åŒ…ç®¡ç†é¡µé¢
    console.log('ç‚¹å‡»é’±åŒ…ç®¡ç†ï¼Œè·³è½¬åˆ° #/wallet');
    window.location.hash = '#/wallet';
  },
}
```

### å…³é”®å˜æ›´

- âŒ ç§»é™¤ï¼š`mp.nav` äº‹ä»¶åˆ†å‘
- âœ… æ·»åŠ ï¼š`window.location.hash = '#/wallet'` ç›´æ¥è·¯ç”±è·³è½¬
- âœ… æ·»åŠ ï¼šè°ƒè¯•æ—¥å¿—ä¾¿äºè¿½è¸ª

---

## ğŸ”§ åŒæ­¥ä¿®å¤

åœ¨åˆ†æè¿‡ç¨‹ä¸­ï¼Œå‘ç°å…¶ä»–é¡µé¢ä¹Ÿæœ‰ç±»ä¼¼é—®é¢˜ï¼Œä¸€å¹¶ä¿®å¤ï¼š

### 1. WalletManagePage.tsx

#### "æˆ‘çš„"æŒ‰é’®ï¼ˆç¬¬ 565 è¡Œï¼‰
```typescript
// ä¿®æ”¹å‰
onClick: () => {
  window.dispatchEvent(new CustomEvent('mp.nav', { detail: { tab: 'my-wallet' } }));
}

// ä¿®æ”¹å
onClick: () => {
  console.log('ç‚¹å‡»æˆ‘çš„ï¼Œè·³è½¬åˆ°ä¸ªäººä¸­å¿ƒ');
  window.location.hash = '#/profile';
}
```

#### åˆ‡æ¢é’±åŒ…åçš„è·³è½¬ï¼ˆç¬¬ 588 è¡Œï¼‰
```typescript
// ä¿®æ”¹å‰
onSwitch={(addr) => {
  console.log('åˆ‡æ¢åˆ°é’±åŒ…:', addr);
  window.dispatchEvent(new CustomEvent('mp.nav', { detail: { tab: 'my-wallet' } }));
}

// ä¿®æ”¹å
onSwitch={(addr) => {
  console.log('åˆ‡æ¢åˆ°é’±åŒ…:', addr);
  window.location.hash = '#/profile';
}
```

---

## âœ… æµ‹è¯•éªŒè¯

### æµ‹è¯•æ­¥éª¤

1. âœ… è®¿é—® http://127.0.0.1:5173/#/profile
2. âœ… é¡µé¢æ­£å¸¸åŠ è½½ä¸ªäººä¸­å¿ƒ
3. âœ… ç‚¹å‡»"é’±åŒ…ç®¡ç†"èœå•é¡¹
4. âœ… é¡µé¢æˆåŠŸè·³è½¬åˆ° #/wallet
5. âœ… æ§åˆ¶å°æ˜¾ç¤ºæ—¥å¿—ï¼š"ç‚¹å‡»é’±åŒ…ç®¡ç†ï¼Œè·³è½¬åˆ° #/wallet"

### æµ‹è¯•ç»“æœ

```
âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡
- URL æ­£ç¡®è·³è½¬: #/profile â†’ #/wallet
- é¡µé¢æ­£å¸¸æ¸²æŸ“: WalletManagePage
- æ— æ§åˆ¶å°é”™è¯¯
- å“åº”é€Ÿåº¦: å³æ—¶
```

### æ§åˆ¶å°æ—¥å¿—

```javascript
ç‚¹å‡»é’±åŒ…ç®¡ç†ï¼Œè·³è½¬åˆ° #/wallet
ğŸš€ Appç»„ä»¶å¼€å§‹æ¸²æŸ“
WalletProviderç»„ä»¶å¼€å§‹æ¸²æŸ“
WalletProvideræ¸²æŸ“å­ç»„ä»¶, APIçŠ¶æ€: true
```

---

## ğŸ“Š å½±å“åˆ†æ

### åŠŸèƒ½å½±å“

| é¡µé¢ | æŒ‰é’® | ä¿®å¤å‰ | ä¿®å¤å |
|------|------|--------|--------|
| `#/profile` | é’±åŒ…ç®¡ç† | âŒ æ— å“åº” | âœ… æ­£å¸¸è·³è½¬ |
| `#/wallet` | æˆ‘çš„ | âŒ æ— å“åº” | âœ… æ­£å¸¸è·³è½¬ |
| `#/wallet` | åˆ‡æ¢é’±åŒ…å | âŒ æ— å“åº” | âœ… æ­£å¸¸è·³è½¬ |

### å…¶ä»–é¡µé¢æ£€æŸ¥

ä»ä½¿ç”¨ `mp.nav` çš„é¡µé¢ï¼ˆéœ€è¦ç¡®è®¤æ˜¯å¦åœ¨ AuthEntryPage å†…ï¼‰ï¼š
- âš ï¸ `MyGravesPage.tsx` - åˆ›å»ºé€è€…ã€å¢“åœ°åˆ—è¡¨
- âš ï¸ `TreasuryPage.tsx` - å‘èµ·è´¢åº“ææ¡ˆ
- âš ï¸ `CreateDeceasedPage.tsx` - ç›¸å…³æ“ä½œ
- âš ï¸ `CreateOrderPage.tsx` - ç›¸å…³æ“ä½œ
- âš ï¸ `MemorialCreateForm.tsx` - ç›¸å…³æ“ä½œ

**å»ºè®®**: åç»­ç»Ÿä¸€æ”¹ä¸º hash è·¯ç”±ï¼Œå½»åº•ç§»é™¤ `mp.nav` äº‹ä»¶æœºåˆ¶

---

## ğŸ¯ æœ€ä½³å®è·µå»ºè®®

### æ¨èçš„è·¯ç”±è·³è½¬æ–¹å¼

#### âœ… æ–¹å¼ä¸€ï¼šHash è·¯ç”±ï¼ˆæ¨èï¼‰

```typescript
onClick: () => {
  window.location.hash = '#/target-page';
}
```

**ä¼˜ç‚¹**:
- ç®€å•ç›´æ¥
- æ— éœ€äº‹ä»¶ç›‘å¬å™¨
- å…¨å±€é€šç”¨
- æµè§ˆå™¨å†å²æ”¯æŒ

#### âœ… æ–¹å¼äºŒï¼šReact Routerï¼ˆå¦‚æœä½¿ç”¨ï¼‰

```typescript
import { useNavigate } from 'react-router-dom';

const navigate = useNavigate();
onClick: () => {
  navigate('/target-page');
}
```

#### âŒ é¿å…ï¼šè‡ªå®šä¹‰äº‹ä»¶ï¼ˆä¸æ¨èï¼‰

```typescript
// ä¸æ¨èï¼šä¾èµ–ç›‘å¬å™¨å­˜åœ¨
window.dispatchEvent(new CustomEvent('mp.nav', { detail: { tab: 'xxx' } }));
```

**ç¼ºç‚¹**:
- ä¾èµ–ç›‘å¬å™¨å­˜åœ¨
- è·¨ç»„ä»¶é€šä¿¡å¤æ‚
- è°ƒè¯•å›°éš¾
- ç»´æŠ¤æˆæœ¬é«˜

---

## ğŸš€ åç»­ä¼˜åŒ–å»ºè®®

### çŸ­æœŸï¼ˆ1å‘¨ï¼‰

1. **ç»Ÿä¸€è·¯ç”±æœºåˆ¶**
   - [ ] å…¨å±€æœç´¢ `mp.nav` äº‹ä»¶
   - [ ] è¯†åˆ«ç‹¬ç«‹è·¯ç”±é¡µé¢ä¸­çš„ä½¿ç”¨
   - [ ] æ”¹ä¸º hash è·¯ç”±è·³è½¬

2. **æ·»åŠ è·¯ç”±å®ˆå«**
   - [ ] æ£€æŸ¥ç™»å½•çŠ¶æ€
   - [ ] è‡ªåŠ¨é‡å®šå‘
   - [ ] æƒé™éªŒè¯

### ä¸­æœŸï¼ˆ1ä¸ªæœˆï¼‰

3. **é‡æ„ AuthEntryPage**
   - [ ] ç§»é™¤ Tab æ¶æ„
   - [ ] æ”¹ä¸ºç‹¬ç«‹è·¯ç”±é¡µé¢
   - [ ] åˆ é™¤ `mp.nav` ç›‘å¬å™¨

4. **ä¼˜åŒ–å¯¼èˆªä½“éªŒ**
   - [ ] æ·»åŠ é¡µé¢è½¬åœºåŠ¨ç”»
   - [ ] ç»Ÿä¸€è¿”å›æŒ‰é’®é€»è¾‘
   - [ ] é¢åŒ…å±‘å¯¼èˆª

---

## ğŸ“ ä¿®æ”¹æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | å˜æ›´ | è¡Œæ•° | è¯´æ˜ |
|------|------|------|------|
| `src/features/profile/MyWalletPage.tsx` | ğŸ”„ ä¿®å¤ | 377 | é’±åŒ…ç®¡ç†æŒ‰é’® |
| `src/features/profile/MyWalletPage.tsx` | ğŸ“ æ³¨é‡Š | 547-552 | è½¬è´¦æŒ‰é’®ï¼ˆå¾…ä¼˜åŒ–ï¼‰ |
| `src/features/wallet/WalletManagePage.tsx` | ğŸ”„ ä¿®å¤ | 565-566 | "æˆ‘çš„"æŒ‰é’® |
| `src/features/wallet/WalletManagePage.tsx` | ğŸ”„ ä¿®å¤ | 588-589 | åˆ‡æ¢é’±åŒ…è·³è½¬ |
| `src/features/wallet/WalletManagePage.tsx` | ğŸ“ æ³¨é‡Š | 591-603 | åˆ›å»º/æ¢å¤é’±åŒ… |

---

## ğŸ’¡ æŠ€æœ¯è¦ç‚¹

### é—®é¢˜æ ¹æº

```javascript
// äº‹ä»¶è§¦å‘ï¼ˆåœ¨ MyWalletPage ä¸­ï¼‰
window.dispatchEvent(new CustomEvent('mp.nav', {...}))
       â†“
// æ— ç›‘å¬å™¨ï¼
// AuthEntryPage çš„ç›‘å¬å™¨ä¸åœ¨å½“å‰æ¸²æŸ“æ ‘ä¸­
       â†“
// ç»“æœï¼šäº‹ä»¶ä¸¢å¤±ï¼Œæ— ååº”
```

### æ­£ç¡®åšæ³•

```javascript
// ç›´æ¥ä¿®æ”¹ hash
window.location.hash = '#/wallet'
       â†“
// æµè§ˆå™¨è§¦å‘ hashchange äº‹ä»¶
       â†“
// App.tsx ç›‘å¬ hashchangeï¼ˆç¬¬ 76-79 è¡Œï¼‰
       â†“
// resolveRoute() è§£ææ–°è·¯ç”±
       â†“
// æ¸²æŸ“å¯¹åº”ç»„ä»¶
```

---

## ğŸ“š ç›¸å…³ä»£ç ä½ç½®

### æ ¸å¿ƒæ–‡ä»¶

- **è·¯ç”±é…ç½®**: `src/routes.tsx` (ç¬¬ 78 è¡Œ)
- **App è·¯ç”±é€»è¾‘**: `src/App.tsx` (ç¬¬ 74-79 è¡Œ)
- **AuthEntryPage**: `src/features/auth/AuthEntryPage.tsx` (ç¬¬ 41-58 è¡Œ)
- **ä¸ªäººä¸­å¿ƒé¡µé¢**: `src/features/profile/MyWalletPage.tsx`
- **é’±åŒ…ç®¡ç†é¡µé¢**: `src/features/wallet/WalletManagePage.tsx`

### è·¯ç”±å®šä¹‰

```typescript
// routes.tsx
{ 
  match: h => h === '#/profile', 
  component: lazy(() => import('./features/profile/MyWalletPage')) 
},
{ 
  match: h => h === '#/wallet', 
  component: lazy(() => import('./features/wallet/WalletManagePage')) 
},
```

---

## ğŸ‰ æ€»ç»“

| é¡¹ç›® | çŠ¶æ€ |
|------|------|
| **é—®é¢˜å®šä½** | âœ… å®Œæˆ |
| **ä»£ç ä¿®å¤** | âœ… å®Œæˆ |
| **æµ‹è¯•éªŒè¯** | âœ… é€šè¿‡ |
| **æ–‡æ¡£ç¼–å†™** | âœ… å®Œæˆ |
| **åç»­ä¼˜åŒ–** | ğŸ“‹ å¾…è¿›è¡Œ |

### ä¿®å¤æ•ˆæœ

- âœ… é’±åŒ…ç®¡ç†æŒ‰é’®ç«‹å³å“åº”
- âœ… é¡µé¢æ­£å¸¸è·³è½¬
- âœ… æ— æ§åˆ¶å°é”™è¯¯
- âœ… ç”¨æˆ·ä½“éªŒè‰¯å¥½

### å‰¯ä½œç”¨

- âœ… æ— å‰¯ä½œç”¨
- âœ… å‘åå…¼å®¹
- âœ… ä¸å½±å“å…¶ä»–åŠŸèƒ½

---

**ä¿®å¤äºº**: AI Assistant  
**ä¿®å¤æ—¥æœŸ**: 2025-11-08  
**å®¡æ ¸çŠ¶æ€**: âœ… å·²éªŒè¯  
**ç›¸å…³é—®é¢˜**: æ¶æ„å˜æ›´ã€äº‹ä»¶æœºåˆ¶ä¼˜åŒ–

