# æŠ¼é‡‘æ‰˜ç®¡ç»Ÿä¸€åŒ–åˆ†ææŠ¥å‘Š

## ğŸ“Š æ‰§è¡Œæ‘˜è¦

æœ¬æŠ¥å‘Šå¯¹ Stardust é¡¹ç›®ä¸­çš„æŠ¼é‡‘ï¼ˆDepositï¼‰å’Œæ‰˜ç®¡ï¼ˆEscrowï¼‰ç®¡ç†è¿›è¡Œå…¨é¢å®¡æŸ¥ï¼Œå‘ç°**pallet-depositså·²ç»ä¸å†è¢«ä½¿ç”¨**ï¼Œå»ºè®®å°†å…¶åŠŸèƒ½æ•´åˆåˆ° pallet-escrow ä¸­ï¼Œå®ç°ç»Ÿä¸€çš„èµ„é‡‘ç®¡ç†æ¶æ„ã€‚

**å…³é”®å‘ç°**ï¼š
- âœ… pallet-deposits å·²ç»è¢« pallet-stardust-appeals å¼ƒç”¨ï¼Œè¿ç§»åˆ° Holds API
- âœ… pallet-escrow åŠŸèƒ½å®Œå–„ï¼Œå¯æ‰©å±•æ€§å¼º
- âš ï¸ pallet-trading ä½¿ç”¨ç‹¬ç«‹çš„ `Currency::reserve` ç®¡ç†æŠ¼é‡‘ï¼Œæœªç»Ÿä¸€
- ğŸ¯ å»ºè®®ï¼šç»Ÿä¸€åˆ° pallet-escrow + Holds API æ¶æ„

---

## 1ï¸âƒ£ pallet-deposits ä½¿ç”¨æƒ…å†µå®¡æŸ¥

### 1.1 è®¾è®¡ç›®æ ‡

`pallet-deposits` çš„åŸå§‹è®¾è®¡ç›®æ ‡æ˜¯æä¾›**é€šç”¨æŠ¼é‡‘ç®¡ç†æœåŠ¡**ï¼š

```rust
/// æ ¸å¿ƒåŠŸèƒ½
/// - å†»ç»“æŠ¼é‡‘ï¼šreserve_deposit - å°†ç”¨æˆ·èµ„é‡‘å†»ç»“ä½œä¸ºæŠ¼é‡‘
/// - é‡Šæ”¾æŠ¼é‡‘ï¼šrelease_deposit - å…¨é¢é€€å›æŠ¼é‡‘
/// - ç½šæ²¡æŠ¼é‡‘ï¼šslash_deposit - éƒ¨åˆ†æˆ–å…¨éƒ¨ç½šæ²¡æŠ¼é‡‘
/// - æŸ¥è¯¢æŠ¼é‡‘ï¼šæŸ¥è¯¢æŠ¼é‡‘è®°å½•å’ŒçŠ¶æ€
```

**æ”¯æŒçš„ä¸šåŠ¡åœºæ™¯**ï¼š
1. ç”³è¯‰æŠ¼é‡‘ï¼ˆpallet-stardust-appealsï¼‰
2. ä¾›å¥‰å“å®¡æ ¸æŠ¼é‡‘ï¼ˆpallet-memorialï¼‰
3. æ–‡æœ¬/åª’ä½“æŠ•è¯‰æŠ¼é‡‘ï¼ˆpallet-deceasedï¼‰
4. è‡ªå®šä¹‰ç”¨é€”æŠ¼é‡‘

### 1.2 å®é™…ä½¿ç”¨æƒ…å†µ

é€šè¿‡ä»£ç å®¡æŸ¥å‘ç°ï¼š

#### âœ… å·²åºŸå¼ƒï¼ˆPhase 1 ä¼˜åŒ–ï¼‰

**pallet-stardust-appeals** å·²ç»åœ¨ v0.3.0 è¿ç§»åˆ° **Holds API**ï¼š

```rust
//! ### v0.3.0 - Phase 1ä¼˜åŒ–ï¼ˆ2025-10-27ï¼‰
//! - è¿ç§»åˆ°Holds APIï¼šç§»é™¤pallet-depositsä¾èµ–
//! - ä½¿ç”¨pallet-balances Holds APIç®¡ç†æŠ¼é‡‘
//! - æ›´å¥½çš„ç±»å‹å®‰å…¨å’Œå®˜æ–¹ç»´æŠ¤

/// Phase 1.5ä¼˜åŒ–ï¼šå®šä¹‰HoldåŸå› æšä¸¾
#[pallet::composite_enum]
pub enum HoldReason {
    /// ç”³è¯‰æŠ¼é‡‘é”å®š
    Appeal,
}

type Fungible: frame_support::traits::fungible::Mutate<Self::AccountId>
    + frame_support::traits::fungible::MutateHold<Self::AccountId, 
        Reason = Self::RuntimeHoldReason>
```

**è¿ç§»åŸå› **ï¼š
- âœ… **å®˜æ–¹ç»´æŠ¤**ï¼šHolds API æ˜¯ Substrate å®˜æ–¹æ¨èçš„æŠ¼é‡‘ç®¡ç†æ–¹æ¡ˆ
- âœ… **ç±»å‹å®‰å…¨**ï¼šç¼–è¯‘æœŸä¿è¯æŠ¼é‡‘ç±»å‹æ­£ç¡®
- âœ… **ç®€åŒ–æ¶æ„**ï¼šå‡å°‘ pallet ä¾èµ–
- âœ… **æ›´å¥½çš„é›†æˆ**ï¼šä¸ Balances pallet æ— ç¼é›†æˆ

#### âŒ æœªè¢«å…¶ä»–æ¨¡å—ä½¿ç”¨

æœç´¢ç»“æœæ˜¾ç¤ºï¼Œé™¤äº† appeals çš„æµ‹è¯•ä»£ç ï¼Œ**æ²¡æœ‰ä»»ä½•ä¸šåŠ¡ä»£ç å®é™…ä½¿ç”¨ pallet-deposits**ï¼š

```bash
# ä»…åœ¨ä»¥ä¸‹æ–‡ä»¶ä¸­å‡ºç°ï¼š
runtime/src/configs/mod.rs            # Runtimeé…ç½®ï¼ˆå·²æ— å®é™…ç”¨é€”ï¼‰
pallets/deposits/src/lib.rs           # æ¨¡å—æœ¬èº«
pallets/deposits/src/tests.rs         # æµ‹è¯•ä»£ç 
pallets/stardust-appeals/src/tests_deposit.rs  # æ—§æµ‹è¯•ï¼ˆå·²åºŸå¼ƒï¼‰
```

### 1.3 pallet-deposits çš„åŠŸèƒ½æ¸…å•

| åŠŸèƒ½ | å®ç°æ–¹å¼ | ä½¿ç”¨æƒ…å†µ |
|------|---------|---------|
| **å†»ç»“æŠ¼é‡‘** | `Currency::reserve()` | âŒ å·²ä¸ä½¿ç”¨ |
| **é‡Šæ”¾æŠ¼é‡‘** | `Currency::unreserve()` | âŒ å·²ä¸ä½¿ç”¨ |
| **ç½šæ²¡æŠ¼é‡‘** | `Currency::unreserve() + Currency::transfer()` | âŒ å·²ä¸ä½¿ç”¨ |
| **ç”¨é€”æ ‡è®°** | `DepositPurpose` æšä¸¾ | âŒ å·²ä¸ä½¿ç”¨ |
| **çŠ¶æ€ç®¡ç†** | `DepositStatus` æšä¸¾ | âŒ å·²ä¸ä½¿ç”¨ |
| **è´¦æˆ·ç´¢å¼•** | `DepositsByAccount` å­˜å‚¨ | âŒ å·²ä¸ä½¿ç”¨ |

### 1.4 ç»“è®ºï¼špallet-deposits å¯ä»¥å®‰å…¨åºŸå¼ƒ

**å»ºè®®**ï¼š
1. âœ… **ä¿ç•™å½’æ¡£**ï¼šå°† pallet-deposits ç§»è‡³ `archived-pallets/` æ–‡ä»¶å¤¹
2. âœ… **ä» Runtime ç§»é™¤**ï¼šåˆ é™¤ `impl pallet_deposits::Config for Runtime`
3. âœ… **æ›´æ–°æ–‡æ¡£**ï¼šæ ‡è®°ä¸ºå·²åºŸå¼ƒï¼Œæ¨èä½¿ç”¨ Holds API

---

## 2ï¸âƒ£ Escrow æ‰©å±•åŠŸèƒ½è®¾è®¡

### 2.1 å½“å‰ pallet-escrow åŠŸèƒ½åˆ†æ

#### å·²æœ‰åŠŸèƒ½ï¼ˆâœ… å®Œå–„ï¼‰

| åŠŸèƒ½æ¨¡å— | å…·ä½“åŠŸèƒ½ | å®ç°è´¨é‡ |
|---------|---------|---------|
| **èµ„é‡‘é”å®š** | `lock_from()` - ä»ä»˜æ¬¾äººé”å®šèµ„é‡‘ | âœ… ä¼˜ç§€ |
| **èµ„é‡‘è½¬å‡º** | `transfer_from_escrow()` - éƒ¨åˆ†è½¬å‡º | âœ… ä¼˜ç§€ |
|  | `release_all()` - å…¨é¢é‡Šæ”¾ | âœ… ä¼˜ç§€ |
|  | `refund_all()` - å…¨é¢é€€æ¬¾ | âœ… ä¼˜ç§€ |
|  | `release_split()` - å¤šæ–¹åˆ†è´¦ | âœ… ä¼˜ç§€ |
| **çŠ¶æ€ç®¡ç†** | Locked/Disputed/Resolved/Closed | âœ… ä¼˜ç§€ |
| **å®‰å…¨æœºåˆ¶** | Nonceé˜²é‡æ”¾ | âœ… ä¼˜ç§€ |
|  | å…¨å±€æš‚åœå¼€å…³ | âœ… ä¼˜ç§€ |
|  | æƒé™æ§åˆ¶ï¼ˆAuthorizedOriginï¼‰ | âœ… ä¼˜ç§€ |
| **äº‰è®®ä»²è£** | `dispute()` - æ ‡è®°äº‰è®® | âœ… ä¼˜ç§€ |
|  | `apply_decision_*()` - ä»²è£å†³è®® | âœ… ä¼˜ç§€ |
|  | éƒ¨åˆ†ç½šæ²¡ï¼ˆæŒ‰bpsï¼‰ | âœ… ä¼˜ç§€ |
| **åˆ°æœŸå¤„ç†** | `schedule_expiry()` - å®‰æ’åˆ°æœŸ | âœ… ä¼˜ç§€ |
|  | `on_initialize()` - è‡ªåŠ¨å¤„ç† | âœ… ä¼˜ç§€ï¼ˆH-1ä¼˜åŒ–ï¼‰ |

#### æ ¸å¿ƒæ¶æ„

```rust
/// Escrow Trait - å…¶ä»– Pallet è°ƒç”¨æ¥å£
pub trait Escrow<AccountId, Balance> {
    fn lock_from(payer: &AccountId, id: u64, amount: Balance) -> DispatchResult;
    fn transfer_from_escrow(id: u64, to: &AccountId, amount: Balance) -> DispatchResult;
    fn release_all(id: u64, to: &AccountId) -> DispatchResult;
    fn refund_all(id: u64, to: &AccountId) -> DispatchResult;
    fn amount_of(id: u64) -> Balance;
}

/// åˆ°æœŸç­–ç•¥ Trait - Runtime æ³¨å…¥
pub trait ExpiryPolicy<AccountId, BlockNumber> {
    fn on_expire(id: u64) -> Result<ExpiryAction<AccountId>, DispatchError>;
    fn now() -> BlockNumber;
}
```

### 2.2 å¯æ‰©å±•æ–¹å‘ï¼šç»Ÿä¸€æŠ¼é‡‘ç®¡ç†

#### è®¾è®¡ç›®æ ‡

å°† pallet-deposits çš„åŠŸèƒ½æ•´åˆåˆ° pallet-escrowï¼Œå®ç°**ç»Ÿä¸€çš„èµ„é‡‘ç®¡ç†æ¶æ„**ï¼š

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   pallet-escrow (ç»Ÿä¸€ç®¡ç†å±‚)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ‰˜ç®¡åŠŸèƒ½ (Escrow)            æŠ¼é‡‘åŠŸèƒ½ (Deposit)            â”‚
â”‚ - è®¢å•æ‰˜ç®¡                    - åšå¸‚å•†ä¿è¯é‡‘                â”‚
â”‚ - æ¡¥æ¥æ‰˜ç®¡                    - ç”³è¯‰æŠ¼é‡‘ï¼ˆHolds APIä¼˜å…ˆï¼‰   â”‚
â”‚ - ä»²è£æ‰˜ç®¡                    - å®¡æ ¸æŠ¼é‡‘                    â”‚
â”‚ - åˆ°æœŸè‡ªåŠ¨å¤„ç†                - æŠ•è¯‰æŠ¼é‡‘                    â”‚
â”‚ - äº‰è®®çŠ¶æ€ç®¡ç†                - ç½šæ²¡æœºåˆ¶                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ‰©å±•æ–¹æ¡ˆ Aï¼šè½»é‡æ‰©å±•ï¼ˆæ¨èï¼‰

**åªæ‰©å±•å¿…è¦çš„æŠ¼é‡‘åŠŸèƒ½**ï¼Œå…¶ä»–æŠ¼é‡‘åœºæ™¯æ¨èä½¿ç”¨ **Holds API**ï¼š

```rust
/// æ‰©å±•1ï¼šå¢åŠ  reserve_deposit() å‡½æ•°
/// - ç”¨äºåšå¸‚å•†ä¿è¯é‡‘ç­‰éœ€è¦"å†»ç»“åœ¨ç”¨æˆ·è´¦æˆ·"çš„åœºæ™¯
/// - ä¸è½¬å…¥æ‰˜ç®¡è´¦æˆ·ï¼Œä½¿ç”¨ Currency::reserve()
impl<T: Config> Pallet<T> {
    /// å†»ç»“ç”¨æˆ·è´¦æˆ·èµ„é‡‘ï¼ˆä½œä¸ºæŠ¼é‡‘ï¼‰
    /// 
    /// ä¸ lock_from() çš„åŒºåˆ«ï¼š
    /// - lock_from: è½¬å…¥æ‰˜ç®¡è´¦æˆ·ï¼Œç”¨äºäº¤æ˜“/æ‰˜ç®¡
    /// - reserve_deposit: å†»ç»“åœ¨ç”¨æˆ·è´¦æˆ·ï¼Œç”¨äºä¿è¯é‡‘
    pub fn reserve_deposit(
        who: &T::AccountId,
        id: u64,
        amount: BalanceOf<T>,
        purpose: DepositPurpose,
    ) -> DispatchResult {
        // 1. å†»ç»“èµ„é‡‘
        T::Currency::reserve(who, amount)?;
        
        // 2. è®°å½•æŠ¼é‡‘ä¿¡æ¯
        DepositRecords::<T>::insert(id, DepositRecord {
            depositor: who.clone(),
            amount,
            purpose,
            status: DepositStatus::Active,
            reserved_at: <frame_system::Pallet<T>>::block_number(),
        });
        
        // 3. å‘é€äº‹ä»¶
        Self::deposit_event(Event::DepositReserved { id, who: who.clone(), amount });
        
        Ok(())
    }
    
    /// é‡Šæ”¾æŠ¼é‡‘ï¼ˆå…¨é¢é€€å›ï¼‰
    pub fn release_deposit(id: u64) -> DispatchResult {
        DepositRecords::<T>::try_mutate(id, |maybe_record| {
            let record = maybe_record.as_mut().ok_or(Error::<T>::DepositNotFound)?;
            ensure!(record.status == DepositStatus::Active, Error::<T>::InvalidStatus);
            
            T::Currency::unreserve(&record.depositor, record.amount);
            record.status = DepositStatus::Released;
            
            Self::deposit_event(Event::DepositReleased { id, amount: record.amount });
            Ok(())
        })
    }
    
    /// ç½šæ²¡æŠ¼é‡‘ï¼ˆéƒ¨åˆ†æˆ–å…¨éƒ¨ï¼‰
    pub fn slash_deposit(
        id: u64,
        slash_ratio: Perbill,
        beneficiary: &T::AccountId,
    ) -> DispatchResult {
        DepositRecords::<T>::try_mutate(id, |maybe_record| {
            let record = maybe_record.as_mut().ok_or(Error::<T>::DepositNotFound)?;
            ensure!(record.status == DepositStatus::Active, Error::<T>::InvalidStatus);
            
            let slash_amount = slash_ratio * record.amount;
            let refund_amount = record.amount.saturating_sub(slash_amount);
            
            // 1. è§£å†»
            T::Currency::unreserve(&record.depositor, record.amount);
            
            // 2. è½¬ç§»ç½šæ²¡éƒ¨åˆ†åˆ°å—ç›Šäºº
            if !slash_amount.is_zero() {
                T::Currency::transfer(
                    &record.depositor,
                    beneficiary,
                    slash_amount,
                    ExistenceRequirement::KeepAlive,
                )?;
            }
            
            record.status = DepositStatus::Slashed;
            
            Self::deposit_event(Event::DepositSlashed {
                id,
                slashed: slash_amount,
                refunded: refund_amount,
            });
            
            Ok(())
        })
    }
}
```

**æ–°å¢å­˜å‚¨**ï¼š

```rust
/// æŠ¼é‡‘ç”¨é€”æšä¸¾
#[derive(Encode, Decode, Clone, PartialEq, Eq, RuntimeDebug, TypeInfo, MaxEncodedLen)]
pub enum DepositPurpose {
    /// åšå¸‚å•†ä¿è¯é‡‘
    MakerDeposit { maker_id: u64 },
    /// ä¾›å¥‰å“å®¡æ ¸æŠ¼é‡‘
    OfferingReview { offering_id: u64 },
    /// æ–‡æœ¬æŠ•è¯‰æŠ¼é‡‘
    TextComplaint { text_id: u64, complaint_type: u8 },
    /// åª’ä½“æŠ•è¯‰æŠ¼é‡‘
    MediaComplaint { media_id: u64, complaint_type: u8 },
    /// è‡ªå®šä¹‰ç”¨é€”
    Custom { pallet_name: BoundedVec<u8, ConstU32<32>>, purpose_id: u64 },
}

/// æŠ¼é‡‘çŠ¶æ€
#[derive(Encode, Decode, Clone, PartialEq, Eq, RuntimeDebug, TypeInfo, MaxEncodedLen)]
pub enum DepositStatus {
    Active,        // æ¿€æ´»ä¸­
    Released,      // å·²é‡Šæ”¾
    Slashed,       // å·²ç½šæ²¡
}

/// æŠ¼é‡‘è®°å½•
#[derive(Encode, Decode, Clone, PartialEq, Eq, RuntimeDebug, TypeInfo, MaxEncodedLen)]
#[scale_info(skip_type_params(T))]
pub struct DepositRecord<T: Config> {
    pub depositor: T::AccountId,
    pub amount: BalanceOf<T>,
    pub purpose: DepositPurpose,
    pub status: DepositStatus,
    pub reserved_at: BlockNumberFor<T>,
}

/// æŠ¼é‡‘è®°å½•å­˜å‚¨ï¼ˆä»…ç”¨äºéœ€è¦"å†»ç»“åœ¨ç”¨æˆ·è´¦æˆ·"çš„æŠ¼é‡‘ï¼‰
#[pallet::storage]
pub type DepositRecords<T: Config> = StorageMap<
    _,
    Blake2_128Concat,
    u64, // deposit_id
    DepositRecord<T>,
    OptionQuery,
>;
```

**æ–°å¢äº‹ä»¶**ï¼š

```rust
#[pallet::event]
pub enum Event<T: Config> {
    // ... åŸæœ‰äº‹ä»¶ ...
    
    /// æŠ¼é‡‘å·²å†»ç»“
    DepositReserved { id: u64, who: T::AccountId, amount: BalanceOf<T> },
    /// æŠ¼é‡‘å·²é‡Šæ”¾
    DepositReleased { id: u64, amount: BalanceOf<T> },
    /// æŠ¼é‡‘å·²ç½šæ²¡
    DepositSlashed { id: u64, slashed: BalanceOf<T>, refunded: BalanceOf<T> },
}
```

#### æ‰©å±•æ–¹æ¡ˆ Bï¼šå®Œæ•´æ•´åˆï¼ˆä¸æ¨èï¼‰

å°† pallet-deposits çš„æ‰€æœ‰åŠŸèƒ½å®Œå…¨è¿ç§»åˆ° pallet-escrowï¼š

**ä¸æ¨èåŸå› **ï¼š
- âŒ **è¿‡åº¦è®¾è®¡**ï¼šå¤§å¤šæ•°æŠ¼é‡‘åœºæ™¯åº”è¯¥ä½¿ç”¨ Holds API
- âŒ **å¢åŠ å¤æ‚åº¦**ï¼šEscrow å’Œ Deposit çš„è¯­ä¹‰ä¸åŒï¼Œå¼ºè¡Œæ•´åˆä¼šæ··æ·†
- âŒ **ç»´æŠ¤æˆæœ¬é«˜**ï¼šéœ€è¦åŒæ—¶ç»´æŠ¤ä¸¤å¥—é€»è¾‘

### 2.3 æ¨èæ–¹æ¡ˆï¼šä¸‰å±‚æ¶æ„

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ç¬¬ä¸€å±‚ï¼šHolds APIï¼ˆå®˜æ–¹æŠ¼é‡‘ï¼‰                   â”‚
â”‚              - pallet-balances MutateHold                   â”‚
â”‚              - ç”¨äºï¼šç”³è¯‰ã€å®¡æ ¸ã€æŠ•è¯‰æŠ¼é‡‘                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         ç¬¬äºŒå±‚ï¼špallet-escrowï¼ˆè½»é‡æ‰©å±•ï¼‰                    â”‚
â”‚         - æ‰˜ç®¡åŠŸèƒ½ï¼šè®¢å•ã€æ¡¥æ¥ã€ä»²è£                         â”‚
â”‚         - æŠ¼é‡‘åŠŸèƒ½ï¼šåšå¸‚å•†ä¿è¯é‡‘ï¼ˆéœ€è¦ç½šæ²¡é€»è¾‘ï¼‰             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           ç¬¬ä¸‰å±‚ï¼šä¸šåŠ¡ Palletï¼ˆç›´æ¥è°ƒç”¨ï¼‰                    â”‚
â”‚           - pallet-trading: è°ƒç”¨ escrow æ‰˜ç®¡                â”‚
â”‚           - pallet-stardust-appeals: ä½¿ç”¨ Holds API         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¼˜åŠ¿**ï¼š
- âœ… **èŒè´£æ¸…æ™°**ï¼šå®˜æ–¹ API + é€šç”¨æœåŠ¡ + ä¸šåŠ¡é€»è¾‘
- âœ… **æœ€å°ä¾µå…¥**ï¼šåªåœ¨å¿…è¦æ—¶æ‰©å±• escrow
- âœ… **æ˜“äºç»´æŠ¤**ï¼šéµå¾ª Substrate æœ€ä½³å®è·µ
- âœ… **å‘åå…¼å®¹**ï¼šä¸å½±å“ç°æœ‰ä¸šåŠ¡

---

## 3ï¸âƒ£ æ•°æ®è¿ç§»æ–¹æ¡ˆ

### 3.1 è¿ç§»ç­–ç•¥

#### ç­–ç•¥ Aï¼šç›´æ¥åºŸå¼ƒï¼ˆæ¨èï¼‰

**é€‚ç”¨åœºæ™¯**ï¼šä¸»ç½‘æœªä¸Šçº¿ï¼Œæ— å†å²æ•°æ®

```rust
// ç¬¬ä¸€æ­¥ï¼šä» Runtime ç§»é™¤ pallet-deposits
// runtime/src/lib.rs
// âŒ åˆ é™¤ä»¥ä¸‹ä»£ç ï¼š
// #[runtime::pallet_index(52)]
// pub type Deposits = pallet_deposits;

// runtime/src/configs/mod.rs
// âŒ åˆ é™¤ä»¥ä¸‹ä»£ç ï¼š
// impl pallet_deposits::Config for Runtime {
//     ...
// }

// ç¬¬äºŒæ­¥ï¼šå½’æ¡£æ¨¡å—
// mv pallets/deposits archived-pallets/deposits

// ç¬¬ä¸‰æ­¥ï¼šæ›´æ–°æ–‡æ¡£
// docs/ARCHIVED.md è®°å½•åºŸå¼ƒåŸå› 
```

**ä¼˜åŠ¿**ï¼š
- âœ… **é›¶è¿ç§»æˆæœ¬**ï¼šæ— éœ€æ•°æ®è¿ç§»
- âœ… **ç®€åŒ–æ¶æ„**ï¼šå‡å°‘ä¸€ä¸ª pallet ä¾èµ–
- âœ… **ä»£ç æ¸…ç†**ï¼šåˆ é™¤æœªä½¿ç”¨ä»£ç 

#### ç­–ç•¥ Bï¼šæ•°æ®è¿ç§»ï¼ˆå¦‚æœ‰å†å²æ•°æ®ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼šä¸»ç½‘å·²ä¸Šçº¿ï¼Œå­˜åœ¨å†å²æŠ¼é‡‘è®°å½•

```rust
/// è¿ç§»é€»è¾‘ï¼špallet-deposits -> pallet-escrow
pub mod v1 {
    use super::*;
    use frame_support::{
        pallet_prelude::*,
        traits::OnRuntimeUpgrade,
        storage_alias,
    };
    
    /// æ—§çš„æŠ¼é‡‘è®°å½•ï¼ˆæ¥è‡ª pallet-depositsï¼‰
    #[storage_alias]
    pub type OldDeposits<T: Config> = StorageMap<
        pallet_deposits::Pallet<T>,
        Blake2_128Concat,
        u64, // deposit_id
        DepositRecord<T>,
    >;
    
    pub struct MigrateToEscrow<T>(PhantomData<T>);
    
    impl<T: Config> OnRuntimeUpgrade for MigrateToEscrow<T> {
        fn on_runtime_upgrade() -> Weight {
            let mut weight = Weight::zero();
            let mut count = 0u64;
            
            // 1. éå†æ‰€æœ‰æ—§æŠ¼é‡‘è®°å½•
            for (deposit_id, old_record) in OldDeposits::<T>::drain() {
                // 2. è½¬æ¢ä¸ºæ–°æ ¼å¼ï¼ˆpallet-escrowï¼‰
                let new_record = crate::DepositRecord {
                    depositor: old_record.who,
                    amount: old_record.amount,
                    purpose: convert_purpose(old_record.purpose),
                    status: convert_status(old_record.status),
                    reserved_at: old_record.reserved_at,
                };
                
                // 3. å†™å…¥æ–°å­˜å‚¨
                crate::DepositRecords::<T>::insert(deposit_id, new_record);
                
                count += 1;
                weight = weight.saturating_add(T::DbWeight::get().reads_writes(1, 1));
            }
            
            log::info!("âœ… è¿ç§»å®Œæˆï¼š{} ä¸ªæŠ¼é‡‘è®°å½•å·²ä» pallet-deposits è¿ç§»åˆ° pallet-escrow", count);
            
            weight
        }
        
        #[cfg(feature = "try-runtime")]
        fn pre_upgrade() -> Result<Vec<u8>, &'static str> {
            let count: u64 = OldDeposits::<T>::iter().count() as u64;
            log::info!("ğŸ“Š pre_upgrade: å‘ç° {} ä¸ªå¾…è¿ç§»æŠ¼é‡‘è®°å½•", count);
            Ok(count.encode())
        }
        
        #[cfg(feature = "try-runtime")]
        fn post_upgrade(state: Vec<u8>) -> Result<(), &'static str> {
            let old_count: u64 = Decode::decode(&mut &state[..])
                .map_err(|_| "è§£ç å¤±è´¥")?;
            
            let new_count = crate::DepositRecords::<T>::iter().count() as u64;
            
            ensure!(
                old_count == new_count,
                "âŒ è¿ç§»å¤±è´¥ï¼šè®°å½•æ•°ä¸åŒ¹é…"
            );
            
            log::info!("âœ… post_upgrade: éªŒè¯é€šè¿‡ï¼Œè¿ç§» {} ä¸ªè®°å½•", new_count);
            Ok(())
        }
    }
    
    fn convert_purpose(old: DepositPurpose) -> crate::DepositPurpose {
        match old {
            DepositPurpose::OfferingReview { offering_id, .. } => {
                crate::DepositPurpose::OfferingReview { offering_id }
            }
            DepositPurpose::TextComplaint { text_id, complaint_type } => {
                crate::DepositPurpose::TextComplaint { text_id, complaint_type }
            }
            // ... å…¶ä»–è½¬æ¢
        }
    }
    
    fn convert_status<T: Config>(old: DepositStatus<T>) -> crate::DepositStatus {
        match old {
            DepositStatus::Reserved => crate::DepositStatus::Active,
            DepositStatus::Released => crate::DepositStatus::Released,
            DepositStatus::Slashed | DepositStatus::PartiallySlashed { .. } => {
                crate::DepositStatus::Slashed
            }
        }
    }
}
```

**è¿ç§»é…ç½®ï¼ˆruntime/src/lib.rsï¼‰**ï¼š

```rust
pub type Migrations = (
    // ... å…¶ä»–è¿ç§»
    pallet_escrow::migrations::v1::MigrateToEscrow<Runtime>,
);
```

### 3.2 è¿ç§»æ‰§è¡Œè®¡åˆ’

| é˜¶æ®µ | ä»»åŠ¡ | é¢„è®¡æ—¶é—´ | é£é™© |
|------|------|---------|------|
| **Phase 1** | ç¡®è®¤æ•°æ®çŠ¶æ€ | 1å¤© | ä½ |
|  | - æ£€æŸ¥ pallet-deposits æ˜¯å¦æœ‰æ•°æ® |  |  |
|  | - ç¡®è®¤è¿ç§»ç­–ç•¥ï¼ˆAæˆ–Bï¼‰ |  |  |
| **Phase 2** | æ‰©å±• pallet-escrow | 2å¤© | ä¸­ |
|  | - æ·»åŠ  `reserve_deposit()` ç­‰å‡½æ•° |  |  |
|  | - æ·»åŠ  `DepositRecords` å­˜å‚¨ |  |  |
|  | - ç¼–å†™å•å…ƒæµ‹è¯• |  |  |
| **Phase 3** | ç¼–å†™è¿ç§»é€»è¾‘ | 1å¤© | ä¸­ |
|  | - å®ç° `OnRuntimeUpgrade` |  |  |
|  | - æ·»åŠ  try-runtime æµ‹è¯• |  |  |
| **Phase 4** | æ›´æ–°ä¸šåŠ¡ä»£ç  | 2å¤© | ä½ |
|  | - è¿ç§» pallet-trading åšå¸‚å•†æŠ¼é‡‘ |  |  |
|  | - æ›´æ–° README æ–‡æ¡£ |  |  |
| **Phase 5** | æµ‹è¯•éªŒè¯ | 2å¤© | é«˜ |
|  | - æœ¬åœ°æµ‹è¯•é“¾éªŒè¯ |  |  |
|  | - try-runtime æµ‹è¯• |  |  |
|  | - å‹åŠ›æµ‹è¯• |  |  |
| **Phase 6** | å½’æ¡£æ¸…ç† | 1å¤© | ä½ |
|  | - å½’æ¡£ pallet-deposits |  |  |
|  | - æ›´æ–°æ–‡æ¡£ |  |  |

---

## 4ï¸âƒ£ pallet-trading åšå¸‚å•†æŠ¼é‡‘è¿ç§»

### 4.1 å½“å‰å®ç°

**pallet-trading** ç›®å‰ä½¿ç”¨ `Currency::reserve()` ç›´æ¥ç®¡ç†åšå¸‚å•†æŠ¼é‡‘ï¼š

```rust
// pallets/trading/src/maker.rs:172
pub fn do_lock_deposit<T: Config>(who: &T::AccountId) -> DispatchResult {
    let deposit = T::MakerDepositAmount::get();
    
    // é”å®šæŠ¼é‡‘
    <T as Config>::Currency::reserve(who, deposit)
        .map_err(|_| Error::<T>::InsufficientBalance)?;
    
    // åˆ›å»ºç”³è¯·è®°å½•
    let application = MakerApplication::<T> {
        owner: who.clone(),
        deposit,
        status: ApplicationStatus::DepositLocked,
        // ...
    };
    // ...
}
```

**é—®é¢˜**ï¼š
- âŒ **æ— ç»Ÿä¸€ç®¡ç†**ï¼šæŠ¼é‡‘åˆ†æ•£åœ¨å„ä¸ª pallet ä¸­
- âŒ **ç¼ºå°‘è¿½æº¯**ï¼šæ— æ³•æŸ¥è¯¢æŠ¼é‡‘å†å²
- âŒ **ç½šæ²¡é€»è¾‘å¤æ‚**ï¼šéœ€è¦æ‰‹åŠ¨ç¼–å†™ç½šæ²¡ä»£ç 

### 4.2 è¿ç§»åˆ° pallet-escrow

```rust
// pallets/trading/src/maker.rs
pub fn do_lock_deposit<T: Config>(who: &T::AccountId) -> DispatchResult {
    use crate::pallet::{NextMakerId, MakerApplications, AccountToMaker, Pallet, Event, Error};
    
    // æ£€æŸ¥æ˜¯å¦å·²ç”³è¯·
    ensure!(
        !AccountToMaker::<T>::contains_key(who),
        Error::<T>::MakerAlreadyExists
    );
    
    let deposit = T::MakerDepositAmount::get();
    let maker_id = NextMakerId::<T>::get();
    
    // ã€æ–°ã€‘ä½¿ç”¨ pallet-escrow ç®¡ç†æŠ¼é‡‘
    T::DepositManager::reserve_deposit(
        who,
        maker_id, // ä½¿ç”¨ maker_id ä½œä¸º deposit_id
        deposit,
        crate::DepositPurpose::MakerDeposit { maker_id },
    )?;
    
    NextMakerId::<T>::put(maker_id.saturating_add(1));
    
    // åˆ›å»ºç”³è¯·è®°å½•ï¼ˆä¸å†å­˜å‚¨ deposit å­—æ®µï¼‰
    let application = MakerApplication::<T> {
        owner: who.clone(),
        status: ApplicationStatus::DepositLocked,
        // ... å…¶ä»–å­—æ®µ
    };
    
    MakerApplications::<T>::insert(maker_id, application);
    AccountToMaker::<T>::insert(who, maker_id);
    
    Ok(())
}

/// æç°æŠ¼é‡‘ï¼ˆå…¨é¢é€€å›ï¼‰
pub fn do_withdraw_deposit<T: Config>(maker_id: u64) -> DispatchResult {
    // ã€æ–°ã€‘ä½¿ç”¨ pallet-escrow é‡Šæ”¾æŠ¼é‡‘
    T::DepositManager::release_deposit(maker_id)?;
    
    // æ›´æ–°çŠ¶æ€
    MakerApplications::<T>::mutate(maker_id, |app| {
        if let Some(app) = app {
            app.status = ApplicationStatus::Withdrawn;
        }
    });
    
    Ok(())
}

/// ç½šæ²¡æŠ¼é‡‘ï¼ˆå› è¿è§„ï¼‰
pub fn do_slash_maker<T: Config>(
    maker_id: u64,
    slash_ratio: Perbill,
) -> DispatchResult {
    // ã€æ–°ã€‘ä½¿ç”¨ pallet-escrow ç½šæ²¡æŠ¼é‡‘
    let treasury = T::TreasuryAccount::get();
    T::DepositManager::slash_deposit(maker_id, slash_ratio, &treasury)?;
    
    // æ›´æ–°çŠ¶æ€
    MakerApplications::<T>::mutate(maker_id, |app| {
        if let Some(app) = app {
            app.status = ApplicationStatus::Slashed;
        }
    });
    
    Ok(())
}
```

**Config é…ç½®**ï¼š

```rust
// pallets/trading/src/lib.rs
#[pallet::config]
pub trait Config: frame_system::Config {
    // ... å…¶ä»–é…ç½® ...
    
    /// ã€æ–°ã€‘æŠ¼é‡‘ç®¡ç†å™¨ï¼ˆæ¥è‡ª pallet-escrowï¼‰
    type DepositManager: pallet_escrow::DepositManager<
        Self::AccountId,
        BalanceOf<Self>,
    >;
    
    /// ã€æ–°ã€‘å›½åº“è´¦æˆ·ï¼ˆç½šæ²¡æ¥æ”¶è€…ï¼‰
    #[pallet::constant]
    type TreasuryAccount: Get<Self::AccountId>;
}
```

**Runtime é…ç½®**ï¼š

```rust
// runtime/src/configs/mod.rs
impl pallet_trading::Config for Runtime {
    // ... å…¶ä»–é…ç½® ...
    
    // ã€æ–°ã€‘ä½¿ç”¨ pallet-escrow ä½œä¸ºæŠ¼é‡‘ç®¡ç†å™¨
    type DepositManager = Escrow;
    
    // ã€æ–°ã€‘å›½åº“è´¦æˆ·
    type TreasuryAccount = TreasuryAccountId;
}
```

**ä¼˜åŠ¿**ï¼š
- âœ… **ç»Ÿä¸€ç®¡ç†**ï¼šæ‰€æœ‰æŠ¼é‡‘ç»Ÿä¸€åˆ° pallet-escrow
- âœ… **å®Œæ•´è¿½æº¯**ï¼šæŠ¼é‡‘å†å²å¯æŸ¥è¯¢
- âœ… **ç®€åŒ–ä»£ç **ï¼šå‡å°‘é‡å¤é€»è¾‘
- âœ… **æ›´å®‰å…¨**ï¼šç»è¿‡å……åˆ†æµ‹è¯•çš„æŠ¼é‡‘ç®¡ç†

---

## 5ï¸âƒ£ å®æ–½å»ºè®®

### 5.1 çŸ­æœŸè¡ŒåŠ¨ï¼ˆ1-2å‘¨ï¼‰

#### âœ… ç«‹å³å¯åšï¼ˆé›¶é£é™©ï¼‰

1. **å½’æ¡£ pallet-deposits**
   - ç§»è‡³ `archived-pallets/deposits/`
   - åˆ›å»º `ARCHIVED.md` è¯´æ˜åºŸå¼ƒåŸå› 
   - ä» Runtime ç§»é™¤é…ç½®

2. **æ›´æ–°æ–‡æ¡£**
   - æ ‡è®° pallet-deposits ä¸ºå·²åºŸå¼ƒ
   - æ¨èä½¿ç”¨ Holds API æˆ– pallet-escrow

3. **ä»£ç æ¸…ç†**
   - åˆ é™¤ pallet-stardust-appeals ä¸­çš„æ—§æµ‹è¯•ä»£ç 
   - ç§»é™¤ Runtime ä¸­çš„ pallet-deposits ä¾èµ–

#### ğŸ”§ éœ€æ±‚è¯„ä¼°ï¼ˆä½é£é™©ï¼‰

4. **è¯„ä¼°åšå¸‚å•†æŠ¼é‡‘éœ€æ±‚**
   - ç¡®è®¤æ˜¯å¦éœ€è¦ç½šæ²¡åŠŸèƒ½
   - å¦‚æœéœ€è¦ï¼Œè®¡åˆ’è¿ç§»åˆ° pallet-escrow
   - å¦‚æœä¸éœ€è¦ï¼Œä¿æŒç°çŠ¶ï¼ˆä½¿ç”¨ `Currency::reserve`ï¼‰

### 5.2 ä¸­æœŸè§„åˆ’ï¼ˆ1-2æœˆï¼‰

#### ğŸš€ åŠŸèƒ½æ‰©å±•

5. **æ‰©å±• pallet-escrow**ï¼ˆå¦‚éœ€è¦ï¼‰
   - å®ç° `reserve_deposit()` å‡½æ•°
   - æ·»åŠ  `DepositRecords` å­˜å‚¨
   - ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

6. **è¿ç§» pallet-trading åšå¸‚å•†æŠ¼é‡‘**
   - ä½¿ç”¨ pallet-escrow ç®¡ç†æŠ¼é‡‘
   - å®ç°ç½šæ²¡é€»è¾‘
   - æ›´æ–°å‰ç«¯ä»£ç 

#### ğŸ“š æ–‡æ¡£å®Œå–„

7. **ç¼–å†™è¿ç§»æŒ‡å—**
   - ä» pallet-deposits åˆ° Holds API
   - ä» pallet-deposits åˆ° pallet-escrow
   - æœ€ä½³å®è·µæ–‡æ¡£

### 5.3 é•¿æœŸä¼˜åŒ–ï¼ˆ3-6æœˆï¼‰

8. **ç»Ÿä¸€æ¶æ„å®¡æŸ¥**
   - å®¡æŸ¥æ‰€æœ‰èµ„é‡‘ç®¡ç†åœºæ™¯
   - ç»Ÿä¸€åˆ°ä¸‰å±‚æ¶æ„ï¼ˆHolds API + Escrow + ä¸šåŠ¡ï¼‰
   - æ€§èƒ½ä¼˜åŒ–å’Œå‹åŠ›æµ‹è¯•

9. **å®‰å…¨å®¡è®¡**
   - å®¡è®¡ pallet-escrow æ‰©å±•ä»£ç 
   - å®¡è®¡åšå¸‚å•†æŠ¼é‡‘ç®¡ç†
   - ç¬¬ä¸‰æ–¹å®‰å…¨å®¡è®¡

---

## 6ï¸âƒ£ é£é™©è¯„ä¼°

| é£é™©ç±»å‹ | æè¿° | å½±å“ | ç¼“è§£æªæ–½ |
|---------|------|------|---------|
| **æ•°æ®ä¸¢å¤±** | è¿ç§»è¿‡ç¨‹ä¸­æ•°æ®æŸå | ğŸ”´ é«˜ | try-runtime æµ‹è¯• + å¤‡ä»½ |
| **å…¼å®¹æ€§** | æ–°æ—§ API ä¸å…¼å®¹ | ğŸŸ¡ ä¸­ | ç¼–å†™é€‚é…å±‚ + æ¸è¿›å¼è¿ç§» |
| **æ€§èƒ½ä¸‹é™** | æ‰©å±•åæ€§èƒ½ä¸‹é™ | ğŸŸ¡ ä¸­ | Benchmark æµ‹è¯• + ä¼˜åŒ– |
| **ä¸šåŠ¡ä¸­æ–­** | è¿ç§»æœŸé—´æœåŠ¡ä¸­æ–­ | ğŸŸ¡ ä¸­ | é›¶åœæœºè¿ç§» + å›æ»šé¢„æ¡ˆ |
| **å®‰å…¨æ¼æ´** | æ–°ä»£ç å¼•å…¥æ¼æ´ | ğŸ”´ é«˜ | ä»£ç å®¡è®¡ + å•å…ƒæµ‹è¯• |

---

## 7ï¸âƒ£ æ€»ç»“

### æ ¸å¿ƒç»“è®º

1. âœ… **pallet-deposits å·²åºŸå¼ƒ**
   - pallet-stardust-appeals å·²è¿ç§»åˆ° Holds API
   - æ— å…¶ä»–æ¨¡å—ä½¿ç”¨
   - **å»ºè®®ç«‹å³å½’æ¡£**

2. âœ… **pallet-escrow åŠŸèƒ½å®Œå–„**
   - å·²æ”¯æŒæ‰˜ç®¡ã€åˆ†è´¦ã€äº‰è®®ã€åˆ°æœŸå¤„ç†
   - æ¶æ„è®¾è®¡ä¼˜ç§€ï¼Œå¯æ‰©å±•æ€§å¼º
   - **å¯è½»é‡æ‰©å±•æ”¯æŒæŠ¼é‡‘åŠŸèƒ½**

3. ğŸ”§ **æ¨èä¸‰å±‚æ¶æ„**
   - ç¬¬ä¸€å±‚ï¼šHolds APIï¼ˆå®˜æ–¹æŠ¼é‡‘ï¼‰
   - ç¬¬äºŒå±‚ï¼špallet-escrowï¼ˆæ‰˜ç®¡ + æŠ¼é‡‘ï¼‰
   - ç¬¬ä¸‰å±‚ï¼šä¸šåŠ¡ Palletï¼ˆè°ƒç”¨è€…ï¼‰

4. âš¡ **å¿«é€Ÿè¡ŒåŠ¨é¡¹**
   - **ç«‹å³å½’æ¡£** pallet-deposits
   - **è¯„ä¼°éœ€æ±‚** åšå¸‚å•†æŠ¼é‡‘æ˜¯å¦éœ€è¦è¿ç§»
   - **æŒ‰éœ€æ‰©å±•** pallet-escrow

### æŠ€æœ¯å€ºåŠ¡æ¸…ç†

| é¡¹ç›® | ä¼˜å…ˆçº§ | é¢„è®¡å·¥ä½œé‡ |
|------|-------|-----------|
| å½’æ¡£ pallet-deposits | ğŸ”´ é«˜ | 0.5å¤© |
| æ›´æ–°æ–‡æ¡£ï¼ˆæ ‡è®°åºŸå¼ƒï¼‰ | ğŸ”´ é«˜ | 0.5å¤© |
| æ‰©å±• pallet-escrowï¼ˆå¯é€‰ï¼‰ | ğŸŸ¡ ä¸­ | 2å¤© |
| è¿ç§»åšå¸‚å•†æŠ¼é‡‘ï¼ˆå¯é€‰ï¼‰ | ğŸŸ¡ ä¸­ | 2å¤© |
| ç¼–å†™è¿ç§»æŒ‡å— | ğŸŸ¢ ä½ | 1å¤© |

---

## é™„å½•

### A. pallet-deposits ä¸ Holds API å¯¹æ¯”

| ç‰¹æ€§ | pallet-deposits | Holds API |
|------|----------------|-----------|
| **ç»´æŠ¤è€…** | è‡ªç ” | Substrate å®˜æ–¹ |
| **ç±»å‹å®‰å…¨** | è¿è¡Œæ—¶æ£€æŸ¥ | ç¼–è¯‘æœŸæ£€æŸ¥ |
| **é›†æˆåº¦** | éœ€è¦é¢å¤–é…ç½® | æ— ç¼é›†æˆ Balances |
| **å­¦ä¹ æ›²çº¿** | éœ€è¦å­¦ä¹ è‡ªå®šä¹‰ API | éµå¾ª Substrate æ ‡å‡† |
| **åŠŸèƒ½å®Œæ•´åº¦** | åŸºç¡€åŠŸèƒ½ | å®Œæ•´åŠŸèƒ½ + ç¤¾åŒºæ”¯æŒ |
| **æ¨èåº¦** | âŒ ä¸æ¨èï¼ˆå·²åºŸå¼ƒï¼‰ | âœ… å¼ºçƒˆæ¨è |

### B. å‚è€ƒèµ„æ–™

- [Substrate Holds API æ–‡æ¡£](https://docs.substrate.io/reference/how-to-guides/pallet-design/implement-lockable-currency/)
- [pallet-balances Hold æœºåˆ¶](https://paritytech.github.io/substrate/master/pallet_balances/trait.Config.html#associatedtype.RuntimeHoldReason)
- [Stardust pallet-escrow README](../pallets/escrow/README.md)
- [Stardust pallet-deposits README](../archived-pallets/deposits/README.md)

---

**æŠ¥å‘Šç¼–åˆ¶**ï¼šAI Assistant  
**å®¡æŸ¥æ—¥æœŸ**ï¼š2025-11-03  
**ç‰ˆæœ¬**ï¼šv1.0  
**çŠ¶æ€**ï¼šâœ… å¾…å®¡æ‰¹

