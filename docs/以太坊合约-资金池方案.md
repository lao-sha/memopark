# ä»¥å¤ªåŠåˆçº¦èµ„é‡‘æ± æ–¹æ¡ˆï¼šå®‰å…¨çš„ AI äº¤æ˜“ç³»ç»Ÿ

**æ ¸å¿ƒç†å¿µï¼š** ç”¨æˆ·å°†èµ„é‡‘å­˜å…¥æ™ºèƒ½åˆçº¦ï¼ˆåªè¿›ä¸å‡ºï¼‰ï¼Œé€šè¿‡ä»½é¢ä»£å¸å…‘æ¢æ”¶ç›Šï¼Œé¿å…ç§é’¥æ³„éœ²é£é™©

**æ—¥æœŸï¼š** 2025-11-04

---

## ğŸ¯ æ–¹æ¡ˆæ¦‚è¿°

### æ ¸å¿ƒæœºåˆ¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä»¥å¤ªåŠ/Arbitrum æ™ºèƒ½åˆçº¦ (Stardust Trading Vault)           â”‚
â”‚                                                              â”‚
â”‚  ç”¨æˆ·æ“ä½œï¼š                                                   â”‚
â”‚  â”œâ”€ å­˜å…¥ USDC â†’ è·å¾— stUSDC (ä»½é¢ä»£å¸)                      â”‚
â”‚  â”œâ”€ âŒ æ— æ³•ç›´æ¥æå– USDC                                    â”‚
â”‚  â””â”€ âœ… å¯ä»¥å°† stUSDC å…‘æ¢å› USDC (é€šè¿‡æµåŠ¨æ€§æ± )             â”‚
â”‚                                                              â”‚
â”‚  åˆçº¦åŠŸèƒ½ï¼š                                                   â”‚
â”‚  â”œâ”€ æ€»èµ„é‡‘æ± : $1,000,000 USDC                               â”‚
â”‚  â”œâ”€ æ€»ä»½é¢: 1,000,000 stUSDC                                â”‚
â”‚  â”œâ”€ å½“å‰å‡€å€¼: 1 stUSDC = 1.05 USDC (ç›ˆåˆ© 5%)               â”‚
â”‚  â””â”€ AI ç­–ç•¥ç®¡ç†: å¤šä¸ªç­–ç•¥åœ¨ Hyperliquid äº¤æ˜“                â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ Hyperliquid API Wallet ç­¾å
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Hyperliquid äº¤æ˜“æ‰€                                            â”‚
â”‚                                                              â”‚
â”‚  åˆçº¦è´¦æˆ·: 0xVault123...                                     â”‚
â”‚  â”œâ”€ æŒä»“: BTC-USD Long $100,000                             â”‚
â”‚  â”œâ”€ æŒä»“: ETH-USD Short $50,000                             â”‚
â”‚  â””â”€ å¯ç”¨ä½™é¢: $850,000 USDC                                 â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â–²
                        â”‚ OCW è°ƒç”¨ API
                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stardust åŒºå—é“¾ - Off-Chain Worker                           â”‚
â”‚                                                              â”‚
â”‚  â”œâ”€ è¯»å–é“¾ä¸Š AI ç­–ç•¥é…ç½®                                     â”‚
â”‚  â”œâ”€ è°ƒç”¨ AI æ¨ç†æœåŠ¡ç”Ÿæˆä¿¡å·                                 â”‚
â”‚  â”œâ”€ ä½¿ç”¨ API Wallet ç­¾åè®¢å•                                 â”‚
â”‚  â””â”€ æ‰§è¡Œäº¤æ˜“å¹¶è®°å½•ç»“æœ                                       â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¡ æ–¹æ¡ˆç»†èŠ‚

### æ–¹æ¡ˆAï¼šçº¯ä»¥å¤ªåŠåˆçº¦ + API Walletï¼ˆæ¨èï¼‰

#### æ™ºèƒ½åˆçº¦è®¾è®¡

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
import "@openzeppelin/contracts/token/ERC20/ERC20.sol";
import "@openzeppelin/contracts/security/ReentrancyGuard.sol";
import "@openzeppelin/contracts/access/Ownable.sol";

/**
 * @title StardustTradingVault
 * @notice å»ä¸­å¿ƒåŒ– AI äº¤æ˜“é‡‘åº“
 * 
 * æ ¸å¿ƒç‰¹æ€§ï¼š
 * 1. ç”¨æˆ·å­˜å…¥ USDCï¼Œè·å¾— stUSDC ä»½é¢ä»£å¸
 * 2. ç”¨æˆ·æ— æ³•ç›´æ¥æå– USDCï¼ˆé¿å…ç§é’¥æ³„éœ²é£é™©ï¼‰
 * 3. ç”¨æˆ·å¯ä»¥åœ¨ Uniswap ç­‰ DEX å…‘æ¢ stUSDC â†’ USDC
 * 4. åˆçº¦é€šè¿‡ Hyperliquid API Wallet è¿›è¡Œäº¤æ˜“
 * 5. æ‰€æœ‰ç›ˆäºè‡ªåŠ¨åæ˜ åœ¨ stUSDC å‡€å€¼ä¸­
 */
contract StardustTradingVault is ERC20, ReentrancyGuard, Ownable {
    
    // ===== çŠ¶æ€å˜é‡ =====
    
    /// USDC ä»£å¸åˆçº¦åœ°å€
    IERC20 public immutable USDC;
    
    /// Hyperliquid API Wallet åœ°å€
    address public apiWallet;
    
    /// Stardust OCW æˆæƒåœ°å€ï¼ˆæœ‰æƒæ›´æ–°å‡€å€¼ï¼‰
    address public ocwAuthorizedAddress;
    
    /// æœ€åä¸€æ¬¡å‡€å€¼æ›´æ–°æ—¶é—´
    uint256 public lastNavUpdateTime;
    
    /// å½“å‰æ€»èµ„äº§å‡€å€¼ï¼ˆUSDCï¼ŒåŒ…å« Hyperliquid ä¸Šçš„æŒä»“ï¼‰
    uint256 public totalNetAssetValue;
    
    /// ç´§æ€¥æš‚åœæ ‡å¿—
    bool public emergencyPaused;
    
    /// ç®¡ç†è´¹ç‡ï¼ˆå¹´åŒ–ï¼ŒåŸºç‚¹è¡¨ç¤ºï¼Œ100 = 1%ï¼‰
    uint256 public managementFeeRate = 200; // 2%
    
    // ===== äº‹ä»¶ =====
    
    event Deposit(address indexed user, uint256 usdcAmount, uint256 sharesMinted);
    event NavUpdated(uint256 oldNav, uint256 newNav, uint256 timestamp);
    event ApiWalletUpdated(address indexed oldWallet, address indexed newWallet);
    event EmergencyPaused();
    event EmergencyUnpaused();
    
    // ===== æ„é€ å‡½æ•° =====
    
    constructor(
        address _usdc,
        address _apiWallet,
        address _ocwAuthorizedAddress
    ) ERC20("Stardust Vault USDC", "stUSDC") {
        USDC = IERC20(_usdc);
        apiWallet = _apiWallet;
        ocwAuthorizedAddress = _ocwAuthorizedAddress;
        totalNetAssetValue = 0;
        lastNavUpdateTime = block.timestamp;
    }
    
    // ===== ç”¨æˆ·æ“ä½œ =====
    
    /**
     * @notice ç”¨æˆ·å­˜å…¥ USDCï¼Œè·å¾— stUSDC ä»½é¢
     * @param usdcAmount å­˜å…¥çš„ USDC æ•°é‡
     */
    function deposit(uint256 usdcAmount) external nonReentrant {
        require(!emergencyPaused, "Vault paused");
        require(usdcAmount > 0, "Amount must be > 0");
        
        // è®¡ç®—åº”é“¸é€ çš„ä»½é¢æ•°é‡
        uint256 sharesToMint;
        
        if (totalSupply() == 0) {
            // é¦–æ¬¡å­˜å…¥ï¼š1 USDC = 1 stUSDC
            sharesToMint = usdcAmount;
            totalNetAssetValue = usdcAmount;
        } else {
            // åç»­å­˜å…¥ï¼šæ ¹æ®å½“å‰å‡€å€¼è®¡ç®—ä»½é¢
            // sharesToMint = usdcAmount * totalSupply() / totalNetAssetValue
            sharesToMint = (usdcAmount * totalSupply()) / totalNetAssetValue;
        }
        
        // è½¬ç§» USDC åˆ°åˆçº¦
        require(
            USDC.transferFrom(msg.sender, address(this), usdcAmount),
            "USDC transfer failed"
        );
        
        // é“¸é€  stUSDC ä»½é¢ç»™ç”¨æˆ·
        _mint(msg.sender, sharesToMint);
        
        // æ›´æ–°æ€»å‡€å€¼
        totalNetAssetValue += usdcAmount;
        
        emit Deposit(msg.sender, usdcAmount, sharesToMint);
    }
    
    /**
     * @notice âŒ ç¦æ­¢ç›´æ¥æå– USDC
     * @dev ç”¨æˆ·å¿…é¡»é€šè¿‡ DEX å…‘æ¢ stUSDC â†’ USDC
     */
    function withdraw(uint256 shares) external pure {
        revert("Direct withdrawal disabled. Use DEX to swap stUSDC.");
    }
    
    /**
     * @notice æŸ¥è¯¢ç”¨æˆ·çš„ stUSDC å¯¹åº”çš„ USDC ä»·å€¼
     * @param user ç”¨æˆ·åœ°å€
     * @return USDC ä»·å€¼
     */
    function getUserValue(address user) external view returns (uint256) {
        uint256 userShares = balanceOf(user);
        if (totalSupply() == 0) return 0;
        
        return (userShares * totalNetAssetValue) / totalSupply();
    }
    
    /**
     * @notice æŸ¥è¯¢å½“å‰ stUSDC å‡€å€¼
     * @return 1 stUSDC å¯¹åº”çš„ USDC æ•°é‡ï¼ˆ18ä½ç²¾åº¦ï¼‰
     */
    function getSharePrice() external view returns (uint256) {
        if (totalSupply() == 0) return 1e18;
        
        return (totalNetAssetValue * 1e18) / totalSupply();
    }
    
    // ===== OCW æ“ä½œ =====
    
    /**
     * @notice OCW æ›´æ–°é‡‘åº“å‡€å€¼ï¼ˆåŒ…å« Hyperliquid ä¸Šçš„ç›ˆäºï¼‰
     * @param newNav æ–°çš„æ€»å‡€å€¼ï¼ˆUSDCï¼‰
     * @param proof é“¾ä¸‹è®¡ç®—çš„è¯æ˜ï¼ˆå¯é€‰ï¼‰
     */
    function updateNetAssetValue(
        uint256 newNav,
        bytes calldata proof
    ) external {
        require(msg.sender == ocwAuthorizedAddress, "Unauthorized");
        require(!emergencyPaused, "Vault paused");
        
        // TODO: éªŒè¯ proofï¼ˆç¡®ä¿ OCW è®¡ç®—æ­£ç¡®ï¼‰
        
        uint256 oldNav = totalNetAssetValue;
        totalNetAssetValue = newNav;
        lastNavUpdateTime = block.timestamp;
        
        emit NavUpdated(oldNav, newNav, block.timestamp);
    }
    
    /**
     * @notice OCW æå– USDC åˆ° Hyperliquidï¼ˆé€šè¿‡è·¨é“¾æ¡¥ï¼‰
     * @param amount æå–é‡‘é¢
     */
    function transferToHyperliquid(uint256 amount) external {
        require(msg.sender == ocwAuthorizedAddress, "Unauthorized");
        require(!emergencyPaused, "Vault paused");
        
        // è½¬ç§» USDC åˆ° Hyperliquid Bridge åˆçº¦
        // å®é™…åœ°å€éœ€è¦æŸ¥è¯¢ Hyperliquid å®˜æ–¹æ–‡æ¡£
        address hyperliquidBridge = 0x2Df1c51E09aECF9cacB7bc98cB1742757f163dF7; // ç¤ºä¾‹
        
        require(
            USDC.transfer(hyperliquidBridge, amount),
            "Transfer to bridge failed"
        );
        
        // è§¦å‘è·¨é“¾äº‹ä»¶ï¼ˆç”± Hyperliquid éªŒè¯èŠ‚ç‚¹ç›‘å¬ï¼‰
        // èµ„é‡‘ä¼šè‡ªåŠ¨åˆ°è¾¾ API Wallet åœ¨ Hyperliquid ä¸Šçš„åœ°å€
    }
    
    // ===== ç®¡ç†å‘˜æ“ä½œ =====
    
    /**
     * @notice æ›´æ–° API Wallet åœ°å€
     * @param newApiWallet æ–°çš„ API Wallet åœ°å€
     */
    function updateApiWallet(address newApiWallet) external onlyOwner {
        require(newApiWallet != address(0), "Invalid address");
        
        address oldWallet = apiWallet;
        apiWallet = newApiWallet;
        
        emit ApiWalletUpdated(oldWallet, newApiWallet);
    }
    
    /**
     * @notice ç´§æ€¥æš‚åœï¼ˆå®‰å…¨æªæ–½ï¼‰
     */
    function emergencyPause() external onlyOwner {
        emergencyPaused = true;
        emit EmergencyPaused();
    }
    
    /**
     * @notice è§£é™¤æš‚åœ
     */
    function emergencyUnpause() external onlyOwner {
        emergencyPaused = false;
        emit EmergencyUnpaused();
    }
}
```

---

### æµåŠ¨æ€§æ± è®¾è®¡

ä¸ºäº†è®©ç”¨æˆ·èƒ½å¤Ÿé€€å‡ºï¼Œæˆ‘ä»¬éœ€è¦åœ¨ Uniswap V3ï¼ˆæˆ–å…¶ä»– DEXï¼‰åˆ›å»ºæµåŠ¨æ€§æ± ï¼š

```
Uniswap V3 æµåŠ¨æ€§æ± : stUSDC / USDC
â”œâ”€ åˆå§‹æµåŠ¨æ€§: 100,000 stUSDC + 100,000 USDC
â”œâ”€ æ‰‹ç»­è´¹: 0.3%
â””â”€ ç”¨æˆ·å¯ä»¥éšæ—¶å…‘æ¢ stUSDC â†’ USDC
```

**ç”¨æˆ·é€€å‡ºæµç¨‹ï¼š**

1. ç”¨æˆ·æŒæœ‰ 10,000 stUSDCï¼ˆå½“å‰å‡€å€¼ 1.05 USDC/stUSDCï¼‰
2. ç†è®ºä»·å€¼ï¼š10,000 Ã— 1.05 = 10,500 USDC
3. åœ¨ Uniswap å…‘æ¢ï¼š10,000 stUSDC â†’ ~10,470 USDCï¼ˆæ‰£é™¤ 0.3% æ‰‹ç»­è´¹ï¼‰
4. ç”¨æˆ·æˆåŠŸé€€å‡ºï¼Œè·å¾—æœ¬é‡‘ + æ”¶ç›Š

**é‡‘åº“è¡¥å……æµåŠ¨æ€§ï¼š**

```solidity
/**
 * @notice é‡‘åº“å‘ Uniswap æ± å­è¡¥å……æµåŠ¨æ€§ï¼ˆä½¿ç”¨ç›ˆåˆ©ï¼‰
 */
function addLiquidityToPool(uint256 usdcAmount) external onlyOwner {
    // é“¸é€ ç­‰é‡ stUSDC
    uint256 shares = (usdcAmount * totalSupply()) / totalNetAssetValue;
    _mint(address(this), shares);
    
    // æˆæƒ Uniswap Router
    USDC.approve(uniswapRouter, usdcAmount);
    approve(uniswapRouter, shares);
    
    // æ·»åŠ æµåŠ¨æ€§
    IUniswapV3Router(uniswapRouter).addLiquidity(...);
}
```

---

## ğŸ”’ å®‰å…¨æ€§åˆ†æ

### ä¼˜åŠ¿

| å®‰å…¨ç‰¹æ€§ | è¯´æ˜ |
|---------|------|
| âœ… **æ— ç§é’¥æ³„éœ²é£é™©** | API Wallet ç§é’¥å³ä½¿æ³„éœ²ï¼Œä¹Ÿæ— æ³•æå–åˆçº¦èµ„é‡‘ |
| âœ… **èµ„é‡‘éš”ç¦»** | ç”¨æˆ·èµ„é‡‘åœ¨æ™ºèƒ½åˆçº¦ä¸­ï¼Œä¸ OCW èŠ‚ç‚¹éš”ç¦» |
| âœ… **é€æ˜å®¡è®¡** | æ‰€æœ‰æ“ä½œé“¾ä¸Šå¯æŸ¥ï¼Œå®Œå…¨é€æ˜ |
| âœ… **å»ä¸­å¿ƒåŒ–é€€å‡º** | é€šè¿‡ DEX æµåŠ¨æ€§æ± é€€å‡ºï¼Œæ— éœ€è®¸å¯ |
| âœ… **é˜²æ­¢ Rug Pull** | åˆçº¦ç¦æ­¢ç›´æ¥æå–ï¼Œåªèƒ½é€šè¿‡å¸‚åœºå…‘æ¢ |

### é£é™©

| é£é™© | ç¼“è§£æªæ–½ |
|------|---------|
| âš ï¸ **æ™ºèƒ½åˆçº¦æ¼æ´** | ä¸“ä¸šå®¡è®¡ï¼ˆOpenZeppelinã€CertiKï¼‰ |
| âš ï¸ **OCW æ¶æ„æ›´æ–°å‡€å€¼** | ä½¿ç”¨é“¾ä¸‹è¯æ˜ + å¤šç­¾éªŒè¯ |
| âš ï¸ **æµåŠ¨æ€§ä¸è¶³** | é‡‘åº“æŒç»­è¡¥å……æµåŠ¨æ€§ |
| âš ï¸ **API Wallet æ¶æ„äº¤æ˜“** | é“¾ä¸Šé£æ§é™åˆ¶ + ç­–ç•¥éªŒè¯ |
| âš ï¸ **Hyperliquid äº¤æ˜“å¤±è´¥** | é£é™©æ•å£é™åˆ¶ + æ­¢æŸæœºåˆ¶ |

---

## ğŸ”„ å®Œæ•´äº¤æ˜“æµç¨‹

### ç”¨æˆ·å­˜å…¥

```
1. ç”¨æˆ·æˆæƒ USDC ç»™åˆçº¦
   â†“
2. è°ƒç”¨ deposit(10000e6)  // 10,000 USDC
   â†“
3. åˆçº¦è®¡ç®—ä»½é¢ï¼š
   - å½“å‰å‡€å€¼ï¼š1 stUSDC = 1.05 USDC
   - åº”è·å¾—ä»½é¢ï¼š10,000 / 1.05 = 9,523.81 stUSDC
   â†“
4. åˆçº¦é“¸é€  9,523.81 stUSDC ç»™ç”¨æˆ·
   â†“
5. ç”¨æˆ·æŒæœ‰ 9,523.81 stUSDC
```

### OCW äº¤æ˜“

```
1. Stardust OCW è¯»å–é“¾ä¸Šç­–ç•¥
   â†“
2. AI æ¨ç†æœåŠ¡ç”Ÿæˆä¿¡å·ï¼šBUY BTC-USD
   â†“
3. OCW è°ƒç”¨ Hyperliquid API (ä½¿ç”¨ API Wallet ç­¾å)
   â†“
4. Hyperliquid æ‰§è¡Œè®¢å•ï¼š
   - è´¦æˆ·ï¼š0xVault123... (åˆçº¦çš„ API Wallet)
   - è®¢å•ï¼šBuy 1 BTC @ $45,000
   â†“
5. OCW æ›´æ–°åˆçº¦å‡€å€¼ï¼š
   - è°ƒç”¨ updateNetAssetValue(newNav, proof)
   - æ–°å‡€å€¼åæ˜ äº¤æ˜“ç›ˆäº
   â†“
6. stUSDC å‡€å€¼è‡ªåŠ¨è°ƒæ•´
```

### ç”¨æˆ·é€€å‡º

```
1. ç”¨æˆ·æŒæœ‰ 9,523.81 stUSDC
   â†“
2. å½“å‰å‡€å€¼ï¼š1 stUSDC = 1.10 USDC (ç›ˆåˆ©)
   â†“
3. ç†è®ºä»·å€¼ï¼š9,523.81 Ã— 1.10 = 10,476.19 USDC
   â†“
4. ç”¨æˆ·åœ¨ Uniswap å…‘æ¢ï¼š
   - è¾“å…¥ï¼š9,523.81 stUSDC
   - è¾“å‡ºï¼š~10,444.73 USDC (æ‰£é™¤ 0.3% æ‰‹ç»­è´¹)
   â†“
5. ç”¨æˆ·æˆåŠŸé€€å‡ºï¼Œè·å¾—æ”¶ç›Šï¼š
   - æœ¬é‡‘ï¼š10,000 USDC
   - æ”¶ç›Šï¼š444.73 USDC (4.45%)
```

---

## ğŸ†š æ–¹æ¡ˆå¯¹æ¯”

### ä¸ä¼ ç»Ÿ API Wallet æ–¹æ¡ˆå¯¹æ¯”

| ç‰¹æ€§ | API Wallet æ–¹æ¡ˆ | åˆçº¦èµ„é‡‘æ± æ–¹æ¡ˆ |
|------|----------------|---------------|
| **ä¸»è´¦æˆ·ç§é’¥** | éœ€è¦ï¼ˆå­˜å‚¨åœ¨æœ¬åœ°ï¼‰ | âœ… ä¸éœ€è¦ |
| **èµ„é‡‘å®‰å…¨** | API Wallet æ³„éœ²å¯äº¤æ˜“ | âœ… åˆçº¦é”å®šï¼Œæ— æ³•ç›´æ¥æå– |
| **ç”¨æˆ·é€€å‡º** | ç›´æ¥æå– | é€šè¿‡ DEX å…‘æ¢ |
| **é€æ˜åº¦** | ä¸­ç­‰ | âœ… é«˜ï¼ˆé“¾ä¸Šå¯å®¡è®¡ï¼‰ |
| **å»ä¸­å¿ƒåŒ–ç¨‹åº¦** | ä¸­ç­‰ | âœ… é«˜ |
| **å®ç°å¤æ‚åº¦** | ç®€å• | âš ï¸ ä¸­ç­‰ |
| **Gas æˆæœ¬** | ä½ | âš ï¸ ä¸­ç­‰ |
| **æµåŠ¨æ€§è¦æ±‚** | æ—  | âš ï¸ éœ€è¦ç»´æŠ¤ DEX æµåŠ¨æ€§ |

---

## ğŸ’° ç»æµæ¨¡å‹

### è´¹ç”¨ç»“æ„

```solidity
// ç®¡ç†è´¹ï¼šä»å‡€å€¼å¢é•¿ä¸­æå–
uint256 public managementFeeRate = 200; // 2% å¹´åŒ–

function collectManagementFee() external {
    uint256 timeElapsed = block.timestamp - lastNavUpdateTime;
    uint256 annualizedReturn = (totalNetAssetValue - initialNav) * 365 days / timeElapsed;
    uint256 fee = annualizedReturn * managementFeeRate / 10000;
    
    // é“¸é€  stUSDC ç»™ç®¡ç†å‘˜
    uint256 feeShares = (fee * totalSupply()) / totalNetAssetValue;
    _mint(owner(), feeShares);
}
```

### æµåŠ¨æ€§æ¿€åŠ±

```solidity
// å¥–åŠ±åœ¨ Uniswap æä¾›æµåŠ¨æ€§çš„ç”¨æˆ·
contract LiquidityRewards {
    // æ¯æœˆä»åˆ©æ¶¦ä¸­æ‹¿å‡º 10% å¥–åŠ± LP æä¾›è€…
    function distributeRewards() external {
        uint256 monthlyProfit = calculateMonthlyProfit();
        uint256 rewardAmount = monthlyProfit * 1000 / 10000; // 10%
        
        // åˆ†é…ç»™ Uniswap LP token æŒæœ‰è€…
        distributeToLPHolders(rewardAmount);
    }
}
```

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### 1ï¸âƒ£ éƒ¨ç½²æ™ºèƒ½åˆçº¦

```bash
# åœ¨ Arbitrum ä¸Šéƒ¨ç½²ï¼ˆHyperliquid åœ¨ Arbitrumï¼‰
forge create StardustTradingVault \
  --rpc-url https://arb1.arbitrum.io/rpc \
  --constructor-args \
    "0xFF970A61A04b1cA14834A43f5dE4533eBDDB5CC8" \ # USDC on Arbitrum
    "0xApiWallet123..." \                            # API Wallet åœ°å€
    "0xOCWAddress456..."                              # OCW æˆæƒåœ°å€
```

### 2ï¸âƒ£ åˆ›å»º Uniswap V3 æµåŠ¨æ€§æ± 

```typescript
// åœ¨ Uniswap V3 åˆ›å»º stUSDC/USDC æ± 
const factory = new ethers.Contract(UNISWAP_V3_FACTORY, ...);
await factory.createPool(stUSDC.address, USDC.address, 3000); // 0.3% æ‰‹ç»­è´¹
```

### 3ï¸âƒ£ åˆå§‹åŒ– API Wallet

```bash
# åœ¨ Hyperliquid æˆæƒ API Wallet
node scripts/approve-api-wallet.js
```

### 4ï¸âƒ£ é…ç½® Stardust OCW

```rust
// runtime/src/lib.rs

impl pallet_ai_strategy::Config for Runtime {
    // ...
    type VaultContract = EthereumVault;  // åˆçº¦åœ°å€
}
```

### 5ï¸âƒ£ éƒ¨ç½²å‰ç«¯

```typescript
// é›†æˆåˆçº¦äº¤äº’
import { StardustVault__factory } from './typechain';

const vault = StardustVault__factory.connect(vaultAddress, signer);

// ç”¨æˆ·å­˜å…¥
await usdc.approve(vault.address, amount);
await vault.deposit(amount);

// æŸ¥è¯¢å‡€å€¼
const nav = await vault.getSharePrice();
```

---

## ğŸ“Š ç›‘æ§ä¸ç»´æŠ¤

### é“¾ä¸Šç›‘æ§

```typescript
// ç›‘å¬åˆçº¦äº‹ä»¶
vault.on('Deposit', (user, usdcAmount, shares) => {
  console.log(`ç”¨æˆ· ${user} å­˜å…¥ ${usdcAmount} USDC`);
});

vault.on('NavUpdated', (oldNav, newNav) => {
  console.log(`å‡€å€¼æ›´æ–°: ${oldNav} â†’ ${newNav}`);
});
```

### æµåŠ¨æ€§ç»´æŠ¤

```typescript
// å®šæœŸæ£€æŸ¥ Uniswap æ± å­æ·±åº¦
async function checkLiquidity() {
  const pool = await getUniswapPool(stUSDC, USDC);
  const liquidity = await pool.liquidity();
  
  if (liquidity < MIN_LIQUIDITY) {
    console.warn('âš ï¸ æµåŠ¨æ€§ä¸è¶³ï¼Œéœ€è¦è¡¥å……');
    await vault.addLiquidityToPool(è¡¥å……é‡‘é¢);
  }
}
```

---

## âœ… æ¨èå®æ–½æ–¹æ¡ˆ

### é˜¶æ®µ1ï¼šç®€åŒ–ç‰ˆï¼ˆMVPï¼‰

1. **åªéƒ¨ç½²åˆçº¦é‡‘åº“**
   - ç”¨æˆ·å­˜å…¥ USDC â†’ è·å¾— stUSDC
   - åˆçº¦é€šè¿‡ API Wallet åœ¨ Hyperliquid äº¤æ˜“
   - âš ï¸ æš‚æ—¶ç¦æ­¢é€€å‡ºï¼ˆç­‰æµåŠ¨æ€§æ± å»ºç«‹ï¼‰

2. **OCW é›†æˆ**
   - OCW è¯»å–ç­–ç•¥
   - ä½¿ç”¨ API Wallet äº¤æ˜“
   - å®šæœŸæ›´æ–°åˆçº¦å‡€å€¼

### é˜¶æ®µ2ï¼šå®Œæ•´ç‰ˆ

1. **æ·»åŠ  Uniswap æµåŠ¨æ€§æ± **
   - åˆ›å»º stUSDC/USDC æ± 
   - åˆå§‹æµåŠ¨æ€§æ³¨å…¥
   - ç”¨æˆ·å¯ä»¥è‡ªç”±é€€å‡º

2. **å¢å¼ºåŠŸèƒ½**
   - å¤šç­–ç•¥æ”¯æŒ
   - é£é™©åˆ†çº§ï¼ˆä¿å®ˆ/æ¿€è¿›ï¼‰
   - ç®¡ç†è´¹å’Œæ¿€åŠ±æœºåˆ¶

---

## ğŸ¯ ç»“è®º

**è¿™ä¸ªæ–¹æ¡ˆå®Œç¾ç»“åˆäº†å®‰å…¨æ€§å’Œçµæ´»æ€§ï¼**

âœ… **å®‰å…¨ä¼˜åŠ¿ï¼š**
- ç”¨æˆ·ä¸»è´¦æˆ·ç§é’¥å®Œå…¨ä¸æš´éœ²
- èµ„é‡‘é”å®šåœ¨æ™ºèƒ½åˆçº¦ä¸­
- å³ä½¿ API Wallet æ³„éœ²ï¼Œä¹Ÿæ— æ³•æå–èµ„é‡‘

âœ… **çµæ´»ä¼˜åŠ¿ï¼š**
- ç”¨æˆ·é€šè¿‡ DEX è‡ªç”±è¿›å‡º
- å‡€å€¼è‡ªåŠ¨åæ˜ ç›ˆäº
- å®Œå…¨å»ä¸­å¿ƒåŒ–

âœ… **æŠ€æœ¯å¯è¡Œï¼š**
- åˆçº¦é€»è¾‘æ¸…æ™°
- ä¸ç°æœ‰æ¶æ„å…¼å®¹
- å¯é€æ­¥å®æ–½

**å»ºè®®ï¼šå…ˆå®æ–½ API Wallet æ–¹æ¡ˆï¼ˆç®€å•å¿«é€Ÿï¼‰ï¼Œå†å‡çº§åˆ°åˆçº¦èµ„é‡‘æ± æ–¹æ¡ˆï¼ˆæ›´å®‰å…¨å»ä¸­å¿ƒåŒ–ï¼‰ã€‚**

---

*æ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-11-04*
*ä½œè€…: Stardust Team*

