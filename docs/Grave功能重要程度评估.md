# Grave 功能重要程度评估

> **目标**：全面评估所有依赖 Grave 的功能的重要程度，为迁移决策提供优先级参考

---

## 📋 目录

1. [评估标准](#1-评估标准)
2. [功能分类评估](#2-功能分类评估)
3. [各模块功能评估](#3-各模块功能评估)
4. [综合优先级排序](#4-综合优先级排序)
5. [迁移建议](#5-迁移建议)

---

## 1. 评估标准

### 1.1 评估维度

**业务价值**（Business Value）：
- ⭐⭐⭐⭐⭐ 核心业务功能，直接影响用户体验
- ⭐⭐⭐⭐ 重要业务功能，影响部分用户
- ⭐⭐⭐ 次要业务功能，影响少数用户
- ⭐⭐ 边缘功能，影响很小
- ⭐ 非核心功能，可以移除

**用户影响**（User Impact）：
- ⭐⭐⭐⭐⭐ 所有用户都使用，移除会导致用户流失
- ⭐⭐⭐⭐ 大部分用户使用，移除会影响用户体验
- ⭐⭐⭐ 部分用户使用，移除会影响部分用户
- ⭐⭐ 少数用户使用，移除影响较小
- ⭐ 极少数用户使用，移除影响很小

**技术复杂度**（Technical Complexity）：
- ⭐⭐⭐⭐⭐ 非常复杂，需要大量重构
- ⭐⭐⭐⭐ 较复杂，需要中等重构
- ⭐⭐⭐ 中等复杂度，需要少量重构
- ⭐⭐ 简单，重构容易
- ⭐ 非常简单，几乎无需重构

**替代难度**（Replacement Difficulty）：
- ⭐⭐⭐⭐⭐ 难以替代，需要全新设计
- ⭐⭐⭐⭐ 较难替代，需要较大改动
- ⭐⭐⭐ 中等难度，有现成替代方案
- ⭐⭐ 容易替代，有简单替代方案
- ⭐ 非常容易替代，几乎无需改动

### 1.2 综合评分

**综合重要程度** = (业务价值 × 0.4) + (用户影响 × 0.3) + (技术复杂度 × 0.2) + (替代难度 × 0.1)

**优先级等级**：
- **P0（关键）**：综合评分 ≥ 4.0，必须保留或完整替代
- **P1（重要）**：综合评分 3.0-3.9，应该保留或替代
- **P2（次要）**：综合评分 2.0-2.9，可以保留或简化替代
- **P3（低优先级）**：综合评分 < 2.0，可以移除或忽略

---

## 2. 功能分类评估

### 2.1 墓位管理功能

#### 2.1.1 创建墓位（`create_grave`）

**业务价值**：⭐⭐⭐
- 墓位是逝者的容器和组织方式
- 但逝者可以独立存在，不必须墓位

**用户影响**：⭐⭐⭐
- 部分用户习惯使用墓位组织逝者
- 但可以改为使用逝者关系组织

**技术复杂度**：⭐⭐⭐⭐
- 需要移除整个pallet
- 影响多个依赖模块

**替代难度**：⭐⭐
- 可以使用逝者关系替代
- 替代方案简单

**综合评分**：2.8（P2 - 次要）

**评估结论**：可以移除，使用逝者关系替代

---

#### 2.1.2 更新墓位（`update_grave`）

**业务价值**：⭐⭐
- 墓位信息更新功能
- 非核心功能

**用户影响**：⭐⭐
- 少数用户使用
- 影响较小

**技术复杂度**：⭐⭐⭐⭐
- 需要移除整个pallet
- 影响多个依赖模块

**替代难度**：⭐⭐
- 可以使用逝者关系替代
- 替代方案简单

**综合评分**：2.4（P2 - 次要）

**评估结论**：可以移除

---

#### 2.1.3 删除墓位（`remove_grave`）

**业务价值**：⭐
- 删除功能，非核心业务

**用户影响**：⭐
- 极少数用户使用
- 影响很小

**技术复杂度**：⭐⭐⭐⭐
- 需要移除整个pallet
- 影响多个依赖模块

**替代难度**：⭐⭐
- 可以使用逝者关系替代
- 替代方案简单

**综合评分**：2.0（P3 - 低优先级）

**评估结论**：可以移除

---

#### 2.1.4 转让墓位（`transfer_grave`）

**业务价值**：⭐⭐⭐
- 墓位拥有权转让
- 但逝者拥有权转让更重要

**用户影响**：⭐⭐
- 少数用户使用
- 影响较小

**技术复杂度**：⭐⭐⭐⭐
- 需要移除整个pallet
- 影响多个依赖模块

**替代难度**：⭐⭐
- 可以使用逝者拥有权转让替代
- 替代方案简单

**综合评分**：2.6（P2 - 次要）

**评估结论**：可以移除，使用逝者拥有权转让替代

---

### 2.2 墓位权限功能

#### 2.2.1 墓位管理员（`add_admin`, `remove_admin`）

**业务价值**：⭐⭐⭐⭐
- 多人协作管理墓位
- 重要功能，但可以改为逝者授权

**用户影响**：⭐⭐⭐
- 部分用户使用
- 影响中等

**技术复杂度**：⭐⭐⭐⭐
- 需要移除整个pallet
- 影响多个依赖模块

**替代难度**：⭐⭐⭐
- 可以使用逝者授权功能替代
- 需要新增授权功能

**综合评分**：3.2（P1 - 重要）

**评估结论**：需要替代，使用逝者授权功能

---

#### 2.2.2 墓位成员（`add_member`, `remove_member`）

**业务价值**：⭐⭐⭐
- 墓位成员管理
- 次要功能

**用户影响**：⭐⭐
- 少数用户使用
- 影响较小

**技术复杂度**：⭐⭐⭐⭐
- 需要移除整个pallet
- 影响多个依赖模块

**替代难度**：⭐⭐⭐
- 可以使用逝者授权功能替代
- 需要新增授权功能

**综合评分**：2.8（P2 - 次要）

**评估结论**：可以移除，使用逝者授权功能替代

---

### 2.3 墓位准入策略

#### 2.3.1 准入策略设置（`set_admission_policy`）

**业务价值**：⭐⭐⭐⭐
- 控制谁可以将逝者迁入墓位
- 重要功能，保护墓主权益

**用户影响**：⭐⭐⭐
- 部分用户使用
- 影响中等

**技术复杂度**：⭐⭐⭐⭐
- 需要移除整个pallet
- 影响多个依赖模块

**替代难度**：⭐⭐⭐
- 可以使用逝者可见性/白名单替代
- 需要新增功能

**综合评分**：3.2（P1 - 重要）

**评估结论**：需要替代，使用逝者可见性/白名单

---

#### 2.3.2 准入策略检查（`check_admission_policy`）

**业务价值**：⭐⭐⭐⭐
- 在逝者迁移时检查准入策略
- 重要功能，保护墓主权益

**用户影响**：⭐⭐⭐
- 部分用户使用
- 影响中等

**技术复杂度**：⭐⭐⭐⭐
- 需要移除整个pallet
- 影响多个依赖模块

**替代难度**：⭐⭐⭐
- 可以使用逝者可见性/白名单替代
- 需要新增功能

**综合评分**：3.2（P1 - 重要）

**评估结论**：需要替代，使用逝者可见性/白名单

---

### 2.4 逝者管理功能

#### 2.4.1 创建逝者（`create_deceased` - 关联墓位）

**业务价值**：⭐⭐⭐⭐⭐
- 核心业务功能
- 但可以改为不关联墓位

**用户影响**：⭐⭐⭐⭐⭐
- 所有用户都使用
- 移除会影响所有用户

**技术复杂度**：⭐⭐⭐⭐
- 需要重构接口
- 移除grave_id参数

**替代难度**：⭐⭐
- 可以改为不关联墓位
- 替代方案简单

**综合评分**：4.0（P0 - 关键）

**评估结论**：必须保留，但需要重构（移除grave_id参数）

---

#### 2.4.2 迁移逝者（`transfer_deceased`）

**业务价值**：⭐⭐⭐⭐
- 重要功能，但可以改为拥有权转让

**用户影响**：⭐⭐⭐
- 部分用户使用
- 影响中等

**技术复杂度**：⭐⭐⭐⭐
- 需要删除接口
- 使用transfer_deceased_owner替代

**替代难度**：⭐⭐
- 可以使用拥有权转让替代
- 替代方案简单

**综合评分**：3.2（P1 - 重要）

**评估结论**：需要替代，使用拥有权转让

---

#### 2.4.3 关系管理（`add_relation` 等 - 基于墓位权限）

**业务价值**：⭐⭐⭐⭐⭐
- 核心业务功能
- 但可以改为基于逝者owner权限

**用户影响**：⭐⭐⭐⭐
- 大部分用户使用
- 移除会影响用户体验

**技术复杂度**：⭐⭐⭐
- 需要重构权限检查
- 改为基于逝者owner权限

**替代难度**：⭐⭐
- 可以改为基于逝者owner权限
- 替代方案简单

**综合评分**：3.6（P1 - 重要）

**评估结论**：必须保留，但需要重构（改为基于逝者owner权限）

---

### 2.5 供奉功能

#### 2.5.1 供奉下单（`offer` - 针对墓位）

**业务价值**：⭐⭐⭐⭐⭐
- 核心业务功能
- 但可以改为针对逝者/宠物

**用户影响**：⭐⭐⭐⭐⭐
- 所有用户都使用
- 移除会影响所有用户

**技术复杂度**：⭐⭐⭐⭐
- 需要重构接口
- 改为target_type + target_id

**替代难度**：⭐⭐⭐
- 可以改为针对逝者/宠物
- 需要重构分账逻辑

**综合评分**：4.1（P0 - 关键）

**评估结论**：必须保留，但需要重构（改为针对逝者/宠物）

---

#### 2.5.2 供奉分账（`transfer_with_simple_route` - 分账给墓主）

**业务价值**：⭐⭐⭐⭐⭐
- 核心业务功能
- 但可以改为分账给逝者/宠物owner

**用户影响**：⭐⭐⭐⭐⭐
- 所有用户都使用
- 移除会影响所有用户

**技术复杂度**：⭐⭐⭐⭐
- 需要重构分账逻辑
- 改为获取逝者/宠物owner

**替代难度**：⭐⭐⭐
- 可以改为分账给逝者/宠物owner
- 需要重构分账逻辑

**综合评分**：4.1（P0 - 关键）

**评估结论**：必须保留，但需要重构（改为分账给逝者/宠物owner）

---

#### 2.5.3 供奉查询（`get_offerings_by_grave`）

**业务价值**：⭐⭐⭐⭐
- 重要功能
- 但可以改为按目标查询

**用户影响**：⭐⭐⭐⭐
- 大部分用户使用
- 移除会影响用户体验

**技术复杂度**：⭐⭐⭐
- 需要重构查询接口
- 改为按目标查询

**替代难度**：⭐⭐
- 可以改为按目标查询
- 替代方案简单

**综合评分**：3.5（P1 - 重要）

**评估结论**：必须保留，但需要重构（改为按目标查询）

---

### 2.6 统计功能

#### 2.6.1 按墓位统计供奉次数（`TotalsByGrave`）

**业务价值**：⭐⭐⭐⭐
- 重要功能
- 但可以改为按逝者/宠物统计

**用户影响**：⭐⭐⭐
- 部分用户使用
- 影响中等

**技术复杂度**：⭐⭐⭐⭐
- 需要重构存储项
- 改为多维度存储

**替代难度**：⭐⭐
- 可以改为按逝者/宠物统计
- 替代方案简单

**综合评分**：3.2（P1 - 重要）

**评估结论**：需要替代，改为按逝者/宠物统计

---

#### 2.6.2 按墓位统计供奉金额（`TotalMemoByGrave`）

**业务价值**：⭐⭐⭐⭐
- 重要功能
- 但可以改为按逝者/宠物统计

**用户影响**：⭐⭐⭐
- 部分用户使用
- 影响中等

**技术复杂度**：⭐⭐⭐⭐
- 需要重构存储项
- 改为多维度存储

**替代难度**：⭐⭐
- 可以改为按逝者/宠物统计
- 替代方案简单

**综合评分**：3.2（P1 - 重要）

**评估结论**：需要替代，改为按逝者/宠物统计

---

#### 2.6.3 按墓位标记周活跃（`WeeklyActive`）

**业务价值**：⭐⭐⭐⭐
- 重要功能
- 但可以改为按逝者/宠物标记

**用户影响**：⭐⭐⭐
- 部分用户使用
- 影响中等

**技术复杂度**：⭐⭐⭐⭐
- 需要重构存储项
- 改为多维度存储

**替代难度**：⭐⭐
- 可以改为按逝者/宠物标记
- 替代方案简单

**综合评分**：3.2（P1 - 重要）

**评估结论**：需要替代，改为按逝者/宠物标记

---

### 2.7 治理功能

#### 2.7.1 清除封面（`clear_cover_via_governance`）

**业务价值**：⭐⭐
- 治理功能
- 非核心业务

**用户影响**：⭐
- 极少数用户使用
- 影响很小

**技术复杂度**：⭐⭐⭐⭐
- 需要移除治理调用
- 影响较小

**替代难度**：⭐⭐
- 可以在逝者/宠物层面实现
- 替代方案简单

**综合评分**：2.2（P3 - 低优先级）

**评估结论**：可以移除

---

#### 2.7.2 治理转让墓位（`gov_transfer_grave`）

**业务价值**：⭐⭐⭐
- 治理功能
- 但可以使用逝者/宠物治理转让替代

**用户影响**：⭐
- 极少数用户使用
- 影响很小

**技术复杂度**：⭐⭐⭐⭐
- 需要移除治理调用
- 影响较小

**替代难度**：⭐⭐
- 可以使用逝者/宠物治理转让替代
- 替代方案简单

**综合评分**：2.4（P2 - 次要）

**评估结论**：可以移除，使用逝者/宠物治理转让替代

---

#### 2.7.3 设置限制（`gov_set_restricted`）

**业务价值**：⭐⭐
- 治理功能
- 非核心业务

**用户影响**：⭐
- 极少数用户使用
- 影响很小

**技术复杂度**：⭐⭐⭐⭐
- 需要移除治理调用
- 影响较小

**替代难度**：⭐⭐
- 可以在逝者/宠物层面实现
- 替代方案简单

**综合评分**：2.2（P3 - 低优先级）

**评估结论**：可以移除

---

#### 2.7.4 删除墓位（`gov_remove_grave`）

**业务价值**：⭐⭐
- 治理功能
- 非核心业务

**用户影响**：⭐
- 极少数用户使用
- 影响很小

**技术复杂度**：⭐⭐⭐⭐
- 需要移除治理调用
- 影响较小

**替代难度**：⭐⭐
- 可以使用逝者/宠物治理删除替代
- 替代方案简单

**综合评分**：2.2（P3 - 低优先级）

**评估结论**：可以移除

---

#### 2.7.5 恢复墓位（`gov_restore_grave`）

**业务价值**：⭐⭐
- 治理功能
- 非核心业务

**用户影响**：⭐
- 极少数用户使用
- 影响很小

**技术复杂度**：⭐⭐⭐⭐
- 需要移除治理调用
- 影响较小

**替代难度**：⭐⭐
- 可以使用逝者/宠物治理恢复替代
- 替代方案简单

**综合评分**：2.2（P3 - 低优先级）

**评估结论**：可以移除

---

## 3. 各模块功能评估

### 3.1 pallet-deceased 功能评估

| 功能 | 业务价值 | 用户影响 | 技术复杂度 | 替代难度 | 综合评分 | 优先级 |
|------|---------|---------|-----------|---------|---------|--------|
| **create_deceased（关联墓位）** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐ | 4.0 | P0 |
| **transfer_deceased** | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐ | 3.2 | P1 |
| **关系管理（基于墓位权限）** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐ | 3.6 | P1 |
| **Deceased.grave_id字段** | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐ | 2.8 | P2 |
| **DeceasedByGrave存储** | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐ | 2.8 | P2 |

**模块综合评估**：⭐⭐⭐⭐（重要）
- 核心功能需要保留但重构
- 次要功能可以移除

---

### 3.2 pallet-memorial 功能评估

| 功能 | 业务价值 | 用户影响 | 技术复杂度 | 替代难度 | 综合评分 | 优先级 |
|------|---------|---------|-----------|---------|---------|--------|
| **offer（针对墓位）** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | 4.1 | P0 |
| **分账（分账给墓主）** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | 4.1 | P0 |
| **get_offerings_by_grave** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐ | 3.5 | P1 |
| **OfferingRecord.grave_id** | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐ | 2.8 | P2 |
| **OfferingsByGrave存储** | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐ | 2.8 | P2 |

**模块综合评估**：⭐⭐⭐⭐⭐（关键）
- 核心功能必须保留但重构
- 次要功能可以移除

---

### 3.3 pallet-ledger 功能评估

| 功能 | 业务价值 | 用户影响 | 技术复杂度 | 替代难度 | 综合评分 | 优先级 |
|------|---------|---------|-----------|---------|---------|--------|
| **TotalsByGrave** | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐ | 3.2 | P1 |
| **TotalMemoByGrave** | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐ | 3.2 | P1 |
| **WeeklyActive（按墓位）** | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐ | 3.2 | P1 |
| **record_from_hook（grave_id）** | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐ | 2.8 | P2 |

**模块综合评估**：⭐⭐⭐⭐（重要）
- 重要功能需要替代
- 次要功能可以移除

---

### 3.4 pallet-stardust-pet 功能评估

| 功能 | 业务价值 | 用户影响 | 技术复杂度 | 替代难度 | 综合评分 | 优先级 |
|------|---------|---------|-----------|---------|---------|--------|
| **create_pet（关联墓位）** | ⭐⭐⭐ | ⭐⭐ | ⭐⭐⭐ | ⭐⭐ | 2.6 | P2 |
| **Pet.grave_id字段** | ⭐⭐ | ⭐⭐ | ⭐⭐⭐ | ⭐⭐ | 2.2 | P3 |

**模块综合评估**：⭐⭐⭐（次要）
- 功能可以移除
- 影响较小

---

### 3.5 Runtime 功能评估

| 功能 | 业务价值 | 用户影响 | 技术复杂度 | 替代难度 | 综合评分 | 优先级 |
|------|---------|---------|-----------|---------|---------|--------|
| **Pallet注册** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 4.5 | P0 |
| **Config配置** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 4.5 | P0 |
| **适配器实现** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | 3.8 | P1 |

**模块综合评估**：⭐⭐⭐⭐⭐（关键）
- 必须移除
- 影响所有依赖模块

---

### 3.6 治理功能评估

| 功能 | 业务价值 | 用户影响 | 技术复杂度 | 替代难度 | 综合评分 | 优先级 |
|------|---------|---------|-----------|---------|---------|--------|
| **clear_cover_via_governance** | ⭐⭐ | ⭐ | ⭐⭐⭐⭐ | ⭐⭐ | 2.2 | P3 |
| **gov_transfer_grave** | ⭐⭐⭐ | ⭐ | ⭐⭐⭐⭐ | ⭐⭐ | 2.4 | P2 |
| **gov_set_restricted** | ⭐⭐ | ⭐ | ⭐⭐⭐⭐ | ⭐⭐ | 2.2 | P3 |
| **gov_remove_grave** | ⭐⭐ | ⭐ | ⭐⭐⭐⭐ | ⭐⭐ | 2.2 | P3 |
| **gov_restore_grave** | ⭐⭐ | ⭐ | ⭐⭐⭐⭐ | ⭐⭐ | 2.2 | P3 |

**模块综合评估**：⭐⭐（低优先级）
- 可以移除
- 影响很小

---

## 4. 综合优先级排序

### 4.1 P0（关键）功能

| 功能 | 模块 | 综合评分 | 处理方式 |
|------|------|---------|---------|
| **Pallet注册** | Runtime | 4.5 | 必须移除 |
| **Config配置** | Runtime | 4.5 | 必须移除 |
| **offer（针对墓位）** | pallet-memorial | 4.1 | 必须保留但重构 |
| **分账（分账给墓主）** | pallet-memorial | 4.1 | 必须保留但重构 |
| **create_deceased（关联墓位）** | pallet-deceased | 4.0 | 必须保留但重构 |

**处理优先级**：最高
**预计工作量**：6-8周

---

### 4.2 P1（重要）功能

| 功能 | 模块 | 综合评分 | 处理方式 |
|------|------|---------|---------|
| **适配器实现** | Runtime | 3.8 | 需要移除 |
| **关系管理（基于墓位权限）** | pallet-deceased | 3.6 | 必须保留但重构 |
| **get_offerings_by_grave** | pallet-memorial | 3.5 | 必须保留但重构 |
| **transfer_deceased** | pallet-deceased | 3.2 | 需要替代 |
| **墓位管理员** | pallet-stardust-grave | 3.2 | 需要替代 |
| **准入策略设置** | pallet-stardust-grave | 3.2 | 需要替代 |
| **准入策略检查** | pallet-stardust-grave | 3.2 | 需要替代 |
| **TotalsByGrave** | pallet-ledger | 3.2 | 需要替代 |
| **TotalMemoByGrave** | pallet-ledger | 3.2 | 需要替代 |
| **WeeklyActive（按墓位）** | pallet-ledger | 3.2 | 需要替代 |

**处理优先级**：高
**预计工作量**：4-6周

---

### 4.3 P2（次要）功能

| 功能 | 模块 | 综合评分 | 处理方式 |
|------|------|---------|---------|
| **转让墓位** | pallet-stardust-grave | 2.6 | 可以移除 |
| **create_pet（关联墓位）** | pallet-stardust-pet | 2.6 | 可以移除 |
| **Deceased.grave_id字段** | pallet-deceased | 2.8 | 可以移除 |
| **DeceasedByGrave存储** | pallet-deceased | 2.8 | 可以移除 |
| **OfferingRecord.grave_id** | pallet-memorial | 2.8 | 可以移除 |
| **OfferingsByGrave存储** | pallet-memorial | 2.8 | 可以移除 |
| **record_from_hook（grave_id）** | pallet-ledger | 2.8 | 可以移除 |
| **墓位成员** | pallet-stardust-grave | 2.8 | 可以移除 |
| **创建墓位** | pallet-stardust-grave | 2.8 | 可以移除 |
| **更新墓位** | pallet-stardust-grave | 2.4 | 可以移除 |
| **gov_transfer_grave** | 治理功能 | 2.4 | 可以移除 |

**处理优先级**：中
**预计工作量**：2-3周

---

### 4.4 P3（低优先级）功能

| 功能 | 模块 | 综合评分 | 处理方式 |
|------|------|---------|---------|
| **Pet.grave_id字段** | pallet-stardust-pet | 2.2 | 可以移除 |
| **clear_cover_via_governance** | 治理功能 | 2.2 | 可以移除 |
| **gov_set_restricted** | 治理功能 | 2.2 | 可以移除 |
| **gov_remove_grave** | 治理功能 | 2.2 | 可以移除 |
| **gov_restore_grave** | 治理功能 | 2.2 | 可以移除 |
| **删除墓位** | pallet-stardust-grave | 2.0 | 可以移除 |

**处理优先级**：低
**预计工作量**：1周

---

## 5. 迁移建议

### 5.1 迁移优先级

**第一阶段（P0 - 关键功能）**：
1. Runtime配置移除（必须）
2. pallet-memorial核心功能重构（必须）
3. pallet-deceased核心功能重构（必须）

**第二阶段（P1 - 重要功能）**：
1. pallet-ledger统计功能重构
2. pallet-deceased关系管理重构
3. 新增逝者授权功能
4. 新增逝者可见性/白名单功能

**第三阶段（P2 - 次要功能）**：
1. pallet-stardust-pet功能移除
2. 数据结构清理
3. 存储项清理

**第四阶段（P3 - 低优先级功能）**：
1. 治理功能清理
2. 边缘功能清理

### 5.2 迁移策略

**策略1：分阶段迁移**
- 先处理P0功能，确保核心功能可用
- 再处理P1功能，完善重要功能
- 最后处理P2/P3功能，清理冗余代码

**策略2：并行开发**
- P0功能必须串行（依赖关系）
- P1功能可以并行（pallet-ledger和pallet-deceased可以并行）
- P2/P3功能可以并行

**策略3：灰度发布**
- 先发布到测试网络
- 验证核心功能
- 再发布到主网

### 5.3 风险评估

**高风险功能**（需要重点关注）：
- Runtime配置移除（影响所有模块）
- pallet-memorial核心功能重构（影响所有用户）
- pallet-deceased核心功能重构（影响所有用户）

**中风险功能**（需要充分测试）：
- pallet-ledger统计功能重构（影响部分用户）
- 新增逝者授权功能（新功能，需要充分测试）

**低风险功能**（可以快速处理）：
- pallet-stardust-pet功能移除（影响很小）
- 治理功能清理（影响很小）

### 5.4 时间估算

**总时间**：10-15周

| 阶段 | 优先级 | 预计时间 | 风险 |
|------|--------|---------|------|
| **P0功能** | 最高 | 6-8周 | 高 |
| **P1功能** | 高 | 4-6周 | 中 |
| **P2功能** | 中 | 2-3周 | 低 |
| **P3功能** | 低 | 1周 | 低 |

---

## 6. 总结

### 6.1 关键发现

1. **核心功能必须保留但重构**：
   - 创建逝者、供奉下单、分账功能是核心业务，必须保留
   - 但需要重构，移除grave依赖

2. **重要功能需要替代**：
   - 墓位权限、准入策略、统计功能需要替代
   - 可以使用逝者授权、可见性、按目标统计替代

3. **次要功能可以移除**：
   - 墓位管理、宠物关联墓位等功能可以移除
   - 影响较小，替代方案简单

4. **低优先级功能可以忽略**：
   - 治理功能、边缘功能可以移除
   - 影响很小，几乎无需处理

### 6.2 推荐方案

**推荐迁移方案**：
1. **优先处理P0功能**：确保核心功能可用
2. **并行处理P1功能**：完善重要功能
3. **快速处理P2/P3功能**：清理冗余代码

**预计总时间**：10-15周
**预计风险**：中等（主要集中在P0功能）

---

**文档版本**：v1.0.0  
**最后更新**：2025-01-XX  
**维护者**：Stardust 开发团队

