# åšå¸‚å•†æ•æ„Ÿä¿¡æ¯ - ä¸‰å±‚è®¿é—®æ§åˆ¶æ–¹æ¡ˆ

## ä¸€ã€éœ€æ±‚å®šä¹‰

### åšå¸‚å•†æ•æ„Ÿä¿¡æ¯åŒ…æ‹¬
- çœŸå®å§“å
- ç”Ÿæ—¥
- èº«ä»½è¯å·
- æ‰‹æœºå·
- å®¶åº­ä½å€
- é“¶è¡Œå¡å·
- æ”¶æ¬¾æ–¹å¼

### ä¸‰å±‚è®¿é—®æ§åˆ¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ç¬¬1å±‚ï¼šå®Œæ•´æ˜æ–‡                          â”‚
â”‚        åªæœ‰åšå¸‚å•†è‡ªå·± + å§”å‘˜ä¼šå¯ä»¥è§£å¯†                 â”‚
â”‚                                                      â”‚
â”‚  å§“åï¼šå¼ ä¸‰                                          â”‚
â”‚  ç”Ÿæ—¥ï¼š1990-01-01                                    â”‚
â”‚  èº«ä»½è¯ï¼š110101199001011234                          â”‚
â”‚  æ‰‹æœºï¼š13800138000                                   â”‚
â”‚  åœ°å€ï¼šåŒ—äº¬å¸‚æœé˜³åŒºxxxè¡—é“xxxå·                       â”‚
â”‚  é“¶è¡Œå¡ï¼š6214850123456789                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            ç¬¬2å±‚ï¼šè„±æ•ä¿¡æ¯ï¼ˆé“¾ä¸Šå…¬å¼€ï¼‰                 â”‚
â”‚             æ‰€æœ‰ä¹°å®¶å¯ä»¥æŸ¥çœ‹                          â”‚
â”‚                                                      â”‚
â”‚  å§“åï¼šå¼ Ã—ä¸‰                                         â”‚
â”‚  ç”Ÿæ—¥ï¼š1990-xx-xx                                    â”‚
â”‚  èº«ä»½è¯ï¼š1101****1234                                â”‚
â”‚  æ‰‹æœºï¼š138****8000                                   â”‚
â”‚  åœ°å€ï¼šåŒ—äº¬å¸‚æœé˜³åŒº                                   â”‚
â”‚  é“¶è¡Œå¡ï¼š6214****6789ï¼ˆä¸­å›½é“¶è¡Œï¼‰                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ç¬¬3å±‚ï¼šå®Œå…¨ä¸å¯è§                        â”‚
â”‚           å…¶ä»–åšå¸‚å•†ã€æ¸¸å®¢ä¸å¯è§                      â”‚
â”‚                                                      â”‚
â”‚  [æ— æƒé™è®¿é—®]                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äºŒã€å½“å‰å®ç°çŠ¶æ€åˆ†æ

### âœ… å·²å®ç°åŠŸèƒ½ï¼ˆpallets/market-maker/src/lib.rsï¼‰

#### 1. è„±æ•å‡½æ•°ï¼ˆå·²å®ç°ï¼‰

```rust
/// å§“åè„±æ•
/// è§„åˆ™ï¼š2å­—ä¿ç•™å1ï¼Œ3å­—ä¿ç•™å‰åï¼Œ4å­—åŠä»¥ä¸Šä¿ç•™å‰1å1
fn mask_name(full_name: &str) -> Vec<u8> {
    // "å¼ ä¸‰" -> "Ã—ä¸‰"
    // "æå››äº”" -> "æÃ—äº”"
    // "ç‹äºŒéº»å­" -> "ç‹Ã—å­"
}

/// èº«ä»½è¯å·è„±æ•
/// è§„åˆ™ï¼šå‰4å4ï¼Œä¸­é—´æ˜Ÿå·
fn mask_id_card(id_card: &str) -> Vec<u8> {
    // "110101199001011234" -> "1101**********1234"
}
```

**âœ… ä¼˜åŠ¿ï¼š**
- è„±æ•è§„åˆ™åˆç†
- ä¿æŠ¤éšç§çš„åŒæ—¶ä¿ç•™éƒ¨åˆ†ä¿¡æ¯
- ä¹°å®¶å¯ä»¥åˆ¤æ–­åšå¸‚å•†èº«ä»½çœŸå®æ€§

---

#### 2. é“¾ä¸Šå­˜å‚¨ç»“æ„ï¼ˆå·²å®ç°ï¼‰

```rust
pub struct Application<AccountId, Balance> {
    // ===== ç¬¬1å±‚ï¼šå®Œæ•´ä¿¡æ¯ï¼ˆåŠ å¯†ï¼‰ =====
    /// IPFS CID - åŠ å¯†çš„å®Œæ•´æ•æ„Ÿä¿¡æ¯
    /// åªæœ‰åšå¸‚å•†è‡ªå·± + å§”å‘˜ä¼šå¯ä»¥è§£å¯†
    pub private_cid: Cid,
    
    // ===== ç¬¬2å±‚ï¼šè„±æ•ä¿¡æ¯ï¼ˆå…¬å¼€ï¼‰ =====
    /// è„±æ•å§“åï¼ˆå¦‚ "å¼ Ã—ä¸‰"ï¼‰
    pub masked_full_name: BoundedVec<u8, ConstU32<64>>,
    
    /// è„±æ•èº«ä»½è¯å·ï¼ˆå¦‚ "1101****1234"ï¼‰
    pub masked_id_card: BoundedVec<u8, ConstU32<32>>,
    
    /// è„±æ•æ”¶æ¬¾æ–¹å¼ï¼ˆJSONæ ¼å¼ï¼‰
    pub masked_payment_info: BoundedVec<u8, ConstU32<512>>,
    
    // ... å…¶ä»–å­—æ®µ
}
```

**âœ… ä¼˜åŠ¿ï¼š**
- é“¾ä¸Šåªå­˜å‚¨è„±æ•ä¿¡æ¯
- å®Œæ•´ä¿¡æ¯åŠ å¯†å­˜å‚¨åœ¨IPFS
- ä¹°å®¶æŸ¥è¯¢åšå¸‚å•†åˆ—è¡¨æ—¶åªçœ‹åˆ°è„±æ•ä¿¡æ¯

---

#### 3. æäº¤ä¿¡æ¯æ¥å£ï¼ˆå·²å®ç°ï¼‰

```rust
/// æäº¤åšå¸‚å•†ä¿¡æ¯
pub fn submit_info(
    origin: OriginFor<T>,
    mm_id: u64,
    public_root_cid: Vec<u8>,     // å…¬å¼€ä¿¡æ¯CID
    private_cid: Vec<u8>,          // åŠ å¯†çš„æ•æ„Ÿä¿¡æ¯CID
    // ...
    full_name: Vec<u8>,            // å®Œæ•´å§“åï¼ˆé“¾ç«¯è‡ªåŠ¨è„±æ•ï¼‰
    id_card: Vec<u8>,              // å®Œæ•´èº«ä»½è¯ï¼ˆé“¾ç«¯è‡ªåŠ¨è„±æ•ï¼‰
    masked_payment_info_json: Option<Vec<u8>>,  // è„±æ•æ”¶æ¬¾æ–¹å¼
) -> DispatchResult {
    // 1. è‡ªåŠ¨è„±æ•å§“åå’Œèº«ä»½è¯å·
    let masked_name = mask_name(full_name_str);
    let masked_id = mask_id_card(id_card_str);
    
    // 2. å­˜å‚¨è„±æ•ä¿¡æ¯åˆ°é“¾ä¸Š
    app.masked_full_name = masked_name;
    app.masked_id_card = masked_id;
    app.masked_payment_info = masked_payment_info;
    
    // 3. å®Œæ•´ä¿¡æ¯å·²åœ¨å‰ç«¯åŠ å¯†å¹¶ä¸Šä¼ åˆ°IPFSï¼ˆprivate_cidï¼‰
}
```

**âœ… ä¼˜åŠ¿ï¼š**
- é“¾ç«¯è‡ªåŠ¨è„±æ•ï¼Œå‰ç«¯ä¸éœ€è¦æ‰‹åŠ¨å¤„ç†
- å®Œæ•´ä¿¡æ¯ä¸ä¸Šé“¾
- è„±æ•è§„åˆ™ç»Ÿä¸€

---

### âš ï¸ ç¼ºå¤±åŠŸèƒ½ï¼ˆéœ€è¦è¡¥å……ï¼‰

#### 1. ç”Ÿæ—¥å­—æ®µï¼ˆæœªå®ç°ï¼‰

**å½“å‰çŠ¶æ€ï¼š** Application ç»“æ„ä¸­æ²¡æœ‰ç”Ÿæ—¥å­—æ®µ

**éœ€è¦æ·»åŠ ï¼š**
```rust
pub struct Application<AccountId, Balance> {
    // ... ç°æœ‰å­—æ®µ ...
    
    /// ğŸ†• è„±æ•ç”Ÿæ—¥ï¼ˆå¦‚ "1990-xx-xx"ï¼‰
    pub masked_birthday: BoundedVec<u8, ConstU32<16>>,
}
```

**è„±æ•è§„åˆ™ï¼š**
```rust
/// ç”Ÿæ—¥è„±æ•è¾…åŠ©å‡½æ•°
/// è§„åˆ™ï¼šä¿ç•™å¹´ä»½ï¼Œæœˆä»½å’Œæ—¥æœŸç”¨xxæ›¿æ¢
fn mask_birthday(birthday: &str) -> Vec<u8> {
    // "1990-01-01" -> "1990-xx-xx"
    // åªä¿ç•™å‡ºç”Ÿå¹´ä»½ï¼Œéšè—å…·ä½“ç”Ÿæ—¥
    
    extern crate alloc;
    use alloc::string::String;
    
    if birthday.len() >= 4 {
        let year = &birthday[0..4];
        let masked = format!("{}-xx-xx", year);
        masked.as_bytes().to_vec()
    } else {
        b"****-xx-xx".to_vec()
    }
}
```

---

#### 2. å¤šæ¥æ”¶æ–¹åŠ å¯†ï¼ˆéƒ¨åˆ†å®ç°ï¼‰

**å½“å‰çŠ¶æ€ï¼š** 
- `private_cid` å­˜å‚¨åŠ å¯†çš„æ•æ„Ÿä¿¡æ¯
- ä½†æœªå¼ºåˆ¶è¦æ±‚å¤šæ¥æ”¶æ–¹åŠ å¯†ï¼ˆè‡ªå·± + å§”å‘˜ä¼šï¼‰

**éœ€è¦è¡¥å……ï¼š**

##### æ–¹æ¡ˆAï¼šå¼ºåˆ¶å‰ç«¯å¤šæ¥æ”¶æ–¹åŠ å¯†ï¼ˆæ¨èï¼‰

```rust
/// å‡½æ•°çº§è¯¦ç»†ä¸­æ–‡æ³¨é‡Šï¼šéªŒè¯åŠ å¯†çš„æ•æ„Ÿä¿¡æ¯
/// 
/// æ£€æŸ¥ä¸Šä¼ çš„ private_cid æ˜¯å¦åŒ…å«æ­£ç¡®çš„æ¥æ”¶æ–¹
/// - å¿…é¡»åŒ…å«åšå¸‚å•†è‡ªå·±
/// - å¿…é¡»åŒ…å«æ‰€æœ‰å§”å‘˜ä¼šæˆå‘˜
pub fn validate_private_cid(
    who: &T::AccountId,
    private_cid: &[u8],
) -> DispatchResult {
    // 1. ä»IPFSä¸‹è½½å…ƒæ•°æ®ï¼ˆä¸è§£å¯†å†…å®¹ï¼‰
    // 2. æ£€æŸ¥ encrypted_keys å­—æ®µ
    // 3. éªŒè¯æ˜¯å¦åŒ…å«æ‰€æœ‰å§”å‘˜ä¼šæˆå‘˜
    
    // æ³¨æ„ï¼šé“¾ä¸Šæ— æ³•ç›´æ¥è®¿é—®IPFSï¼Œéœ€è¦å‰ç«¯ä¿è¯
    // æˆ–è€…é€šè¿‡ OCW (Off-chain Worker) å®ç°
    
    Ok(())
}
```

**å®é™…æ“ä½œï¼šå‰ç«¯ä¿è¯ + æ–‡æ¡£çº¦æŸ**
```typescript
// å‰ç«¯æäº¤æ—¶å¿…é¡»è¿™æ ·åšï¼š
const recipients = [
  myAccount,        // åšå¸‚å•†è‡ªå·±
  ...committeeMembers,  // æ‰€æœ‰å§”å‘˜ä¼šæˆå‘˜
];

const { cid } = await encryptForMultipleRecipients(
  sensitiveData,
  recipients
);

await api.tx.marketMaker.submitInfo(
  mmId,
  publicCid,
  cid,  // private_cidï¼Œå·²åŠ å¯†ç»™è‡ªå·±+å§”å‘˜ä¼š
  // ...
);
```

---

##### æ–¹æ¡ˆBï¼šé“¾ä¸Šè®°å½•æˆæƒåˆ—è¡¨

```rust
pub struct Application<AccountId, Balance> {
    // ... ç°æœ‰å­—æ®µ ...
    
    /// ğŸ†• æˆæƒæ¥æ”¶æ–¹åˆ—è¡¨
    /// - è®°å½•å“ªäº›è´¦æˆ·å¯ä»¥è§£å¯† private_cid
    /// - åŒ…å«åšå¸‚å•†è‡ªå·± + å§”å‘˜ä¼šæˆå‘˜
    pub authorized_decryptors: BoundedVec<AccountId, ConstU32<50>>,
}

/// æäº¤ä¿¡æ¯æ—¶ï¼Œè‡ªåŠ¨è®¾ç½®æˆæƒåˆ—è¡¨
pub fn submit_info(
    origin: OriginFor<T>,
    // ... å‚æ•° ...
) -> DispatchResult {
    let who = ensure_signed(origin)?;
    
    // è·å–å§”å‘˜ä¼šæˆå‘˜
    let committee_members = Self::get_committee_members();
    
    // æ„å»ºæˆæƒåˆ—è¡¨ï¼šè‡ªå·± + å§”å‘˜ä¼š
    let mut authorized_decryptors = BoundedVec::new();
    authorized_decryptors.try_push(who.clone())?;
    for member in committee_members {
        authorized_decryptors.try_push(member)?;
    }
    
    // å­˜å‚¨
    app.authorized_decryptors = authorized_decryptors;
    
    Ok(())
}
```

---

#### 3. è®¿é—®å®¡è®¡ï¼ˆæœªå®ç°ï¼‰

**å½“å‰çŠ¶æ€ï¼š** æ²¡æœ‰è®°å½•è°è®¿é—®äº†æ•æ„Ÿä¿¡æ¯

**éœ€è¦æ·»åŠ ï¼š**

```rust
/// å‡½æ•°çº§è¯¦ç»†ä¸­æ–‡æ³¨é‡Šï¼šè®¿é—®è®°å½•
#[derive(Clone, Encode, Decode, PartialEq, RuntimeDebug, TypeInfo, MaxEncodedLen)]
pub struct AccessRecord<AccountId, BlockNumber> {
    /// è®¿é—®è€…è´¦æˆ·
    pub accessor: AccountId,
    
    /// è®¿é—®æ—¶é—´
    pub accessed_at: BlockNumber,
    
    /// è®¿é—®ç›®çš„
    pub purpose: BoundedVec<u8, ConstU32<256>>,
}

/// å­˜å‚¨ï¼šæ¯ä¸ªåšå¸‚å•†çš„è®¿é—®æ—¥å¿—
#[pallet::storage]
pub type SensitiveDataAccessLogs<T: Config> = StorageMap<
    _,
    Blake2_128Concat,
    u64,  // mm_id
    BoundedVec<AccessRecord<T::AccountId, BlockNumberFor<T>>, ConstU32<100>>,
    ValueQuery,
>;

/// å‡½æ•°çº§è¯¦ç»†ä¸­æ–‡æ³¨é‡Šï¼šè®°å½•å§”å‘˜ä¼šè®¿é—®æ•æ„Ÿä¿¡æ¯
/// 
/// å§”å‘˜ä¼šæˆå‘˜åœ¨å‰ç«¯è§£å¯†åšå¸‚å•†æ•æ„Ÿä¿¡æ¯å‰ï¼Œå¿…é¡»è°ƒç”¨æ­¤æ¥å£è®°å½•æ—¥å¿—
#[pallet::call_index(XX)]
#[pallet::weight(10_000)]
pub fn log_sensitive_access(
    origin: OriginFor<T>,
    mm_id: u64,
    purpose: Vec<u8>,  // "kyc_review", "dispute_investigation", etc.
) -> DispatchResult {
    let who = ensure_signed(origin)?;
    
    // éªŒè¯æ˜¯å§”å‘˜ä¼šæˆå‘˜
    ensure!(
        Self::is_committee_member(&who),
        Error::<T>::NotCommitteeMember
    );
    
    // éªŒè¯åšå¸‚å•†å­˜åœ¨
    let app = Applications::<T>::get(mm_id)
        .ok_or(Error::<T>::NotFound)?;
    
    let now = <frame_system::Pallet<T>>::block_number();
    
    // è®°å½•è®¿é—®æ—¥å¿—
    SensitiveDataAccessLogs::<T>::try_mutate(mm_id, |logs| -> DispatchResult {
        logs.try_push(AccessRecord {
            accessor: who.clone(),
            accessed_at: now,
            purpose: purpose.try_into().map_err(|_| Error::<T>::PurposeTooLong)?,
        })
        .map_err(|_| Error::<T>::TooManyAccessRecords)?;
        Ok(())
    })?;
    
    Self::deposit_event(Event::SensitiveDataAccessed {
        mm_id,
        accessor: who,
        purpose,
    });
    
    Ok(())
}
```

---

## ä¸‰ã€å¯è¡Œæ€§åˆ†æ

### âœ… æŠ€æœ¯å®Œå…¨å¯è¡Œ

#### å½“å‰æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                åšå¸‚å•†ï¼ˆå‰ç«¯ï¼‰                      â”‚
â”‚                                                  â”‚
â”‚  1. å‡†å¤‡å®Œæ•´ä¿¡æ¯ï¼š                                â”‚
â”‚     - å§“åï¼šå¼ ä¸‰                                 â”‚
â”‚     - ç”Ÿæ—¥ï¼š1990-01-01                           â”‚
â”‚     - èº«ä»½è¯ï¼š110101199001011234                 â”‚
â”‚                                                  â”‚
â”‚  2. åŠ å¯†å®Œæ•´ä¿¡æ¯ï¼š                                â”‚
â”‚     - å¤šæ¥æ”¶æ–¹åŠ å¯†ï¼ˆè‡ªå·± + å§”å‘˜ä¼šï¼‰               â”‚
â”‚     - ä¸Šä¼ åˆ°IPFS â†’ private_cid                   â”‚
â”‚                                                  â”‚
â”‚  3. å‡†å¤‡è„±æ•ä¿¡æ¯ï¼ˆå¯é€‰ï¼Œé“¾ç«¯ä¼šè‡ªåŠ¨è„±æ•ï¼‰ï¼š          â”‚
â”‚     - å§“åï¼šå¼ Ã—ä¸‰                                â”‚
â”‚     - ç”Ÿæ—¥ï¼š1990-xx-xx                           â”‚
â”‚     - èº«ä»½è¯ï¼š1101****1234                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Market-Maker Palletï¼ˆé“¾ä¸Šï¼‰             â”‚
â”‚                                                  â”‚
â”‚  1. æ¥æ”¶å®Œæ•´ä¿¡æ¯ï¼ˆä»…ç”¨äºè„±æ•ï¼Œä¸å­˜å‚¨ï¼‰ï¼š            â”‚
â”‚     full_name, id_card, birthday                â”‚
â”‚                                                  â”‚
â”‚  2. è‡ªåŠ¨è„±æ•ï¼š                                    â”‚
â”‚     masked_full_name = mask_name(full_name)     â”‚
â”‚     masked_id_card = mask_id_card(id_card)      â”‚
â”‚     masked_birthday = mask_birthday(birthday)   â”‚
â”‚                                                  â”‚
â”‚  3. å­˜å‚¨åˆ°é“¾ä¸Šï¼š                                  â”‚
â”‚     Application {                               â”‚
â”‚       private_cid,           // åŠ å¯†çš„å®Œæ•´ä¿¡æ¯    â”‚
â”‚       masked_full_name,      // è„±æ•å§“å         â”‚
â”‚       masked_id_card,        // è„±æ•èº«ä»½è¯       â”‚
â”‚       masked_birthday,       // ğŸ†• è„±æ•ç”Ÿæ—¥      â”‚
â”‚       authorized_decryptors, // ğŸ†• æˆæƒåˆ—è¡¨      â”‚
â”‚     }                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æŸ¥è¯¢åšå¸‚å•†åˆ—è¡¨                       â”‚
â”‚                                                  â”‚
â”‚  ä¹°å®¶ â†’ æŸ¥è¯¢ Applications                        â”‚
â”‚       â†“                                         â”‚
â”‚  è¿”å›è„±æ•ä¿¡æ¯ï¼š                                   â”‚
â”‚     å§“åï¼šå¼ Ã—ä¸‰                                  â”‚
â”‚     ç”Ÿæ—¥ï¼š1990-xx-xx                             â”‚
â”‚     èº«ä»½è¯ï¼š1101****1234                         â”‚
â”‚                                                  â”‚
â”‚  âœ… ä¹°å®¶å¯ä»¥åˆ¤æ–­åšå¸‚å•†èº«ä»½çœŸå®æ€§                   â”‚
â”‚  âœ… ä½†æ— æ³•è·å–å®Œæ•´æ•æ„Ÿä¿¡æ¯                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           å§”å‘˜ä¼šå®¡æ ¸ï¼ˆè§£å¯†ï¼‰                       â”‚
â”‚                                                  â”‚
â”‚  1. å§”å‘˜ä¼šæˆå‘˜è°ƒç”¨ï¼š                              â”‚
â”‚     log_sensitive_access(mm_id, "kyc_review")   â”‚
â”‚                                                  â”‚
â”‚  2. å‰ç«¯ä»IPFSä¸‹è½½ private_cid                   â”‚
â”‚                                                  â”‚
â”‚  3. ç”¨å§”å‘˜ä¼šæˆå‘˜ç§é’¥è§£å¯†ï¼š                         â”‚
â”‚     - å§“åï¼šå¼ ä¸‰                                 â”‚
â”‚     - ç”Ÿæ—¥ï¼š1990-01-01                           â”‚
â”‚     - èº«ä»½è¯ï¼š110101199001011234                 â”‚
â”‚                                                  â”‚
â”‚  4. é“¾ä¸Šè®°å½•è®¿é—®æ—¥å¿—ï¼ˆæ°¸ä¹…å¯æŸ¥ï¼‰                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### âœ… å„å±‚æ¬¡å®ç°çŠ¶æ€

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| **è„±æ•å‡½æ•°** | âœ… å·²å®ç° | `mask_name`, `mask_id_card` |
| **ç”Ÿæ—¥è„±æ•** | âš ï¸ éœ€æ·»åŠ  | éœ€å®ç° `mask_birthday` |
| **é“¾ä¸Šå­˜å‚¨è„±æ•ä¿¡æ¯** | âœ… å·²å®ç° | `masked_full_name`, `masked_id_card` |
| **é“¾ä¸Šå­˜å‚¨ç”Ÿæ—¥** | âš ï¸ éœ€æ·»åŠ  | éœ€æ·»åŠ  `masked_birthday` å­—æ®µ |
| **åŠ å¯†å®Œæ•´ä¿¡æ¯** | âœ… å·²å®ç° | `private_cid` |
| **å¤šæ¥æ”¶æ–¹åŠ å¯†** | âš ï¸ éœ€çº¦æŸ | å‰ç«¯å®ç° + æ–‡æ¡£çº¦æŸ |
| **è®¿é—®å®¡è®¡** | âŒ æœªå®ç° | éœ€æ·»åŠ  `log_sensitive_access` |
| **ä¹°å®¶æŸ¥è¯¢è„±æ•ä¿¡æ¯** | âœ… å·²å®ç° | æŸ¥è¯¢ `Applications` å­˜å‚¨ |

---

## å››ã€åˆç†æ€§åˆ†æ

### ä¸ºä»€ä¹ˆéœ€è¦ä¸‰å±‚è®¿é—®æ§åˆ¶ï¼Ÿ

#### åœºæ™¯1ï¼šä¹°å®¶é€‰æ‹©åšå¸‚å•†

**éœ€æ±‚ï¼š** ä¹°å®¶éœ€è¦åˆ¤æ–­åšå¸‚å•†çš„å¯ä¿¡åº¦

**å¦‚æœå®Œå…¨ä¸å…¬å¼€ï¼š**
- âŒ ä¹°å®¶æ— æ³•åˆ¤æ–­åšå¸‚å•†èº«ä»½çœŸå®æ€§
- âŒ æ— æ³•åŒºåˆ†çœŸå®åšå¸‚å•†å’Œè™šå‡è´¦æˆ·
- âŒ ä¹°å®¶å¿ƒç†ä¸å®‰å…¨ï¼Œä¸æ•¢äº¤æ˜“

**è„±æ•ä¿¡æ¯å…¬å¼€ï¼š**
- âœ… ä¹°å®¶å¯ä»¥çœ‹åˆ° "å¼ Ã—ä¸‰"ã€"1101****1234"
- âœ… å¯ä»¥åˆ¤æ–­æ˜¯çœŸå®ä¸ªäººï¼Œä¸æ˜¯æœºå™¨äºº
- âœ… å¯ä»¥æ ¹æ®åœ°åŒºï¼ˆå‰4ä½ï¼‰é€‰æ‹©æœ¬åœ°åšå¸‚å•†
- âœ… å¿ƒç†å®‰å…¨æ„Ÿæå‡ï¼Œæ„¿æ„äº¤æ˜“

**ç¤ºä¾‹ï¼š**
```
ä¹°å®¶åœ¨åšå¸‚å•†åˆ—è¡¨ä¸­çœ‹åˆ°ï¼š

åšå¸‚å•†Aï¼š
  å§“åï¼šå¼ Ã—ä¸‰
  èº«ä»½è¯ï¼š1101****1234ï¼ˆåŒ—äº¬ï¼‰
  ä¿¡ç”¨åˆ†ï¼š98
  
åšå¸‚å•†Bï¼š
  å§“åï¼šæÃ—ï¼ˆç–‘ä¼¼è™šå‡ï¼‰
  èº«ä»½è¯ï¼š****ï¼ˆæœªè®¤è¯ï¼‰
  ä¿¡ç”¨åˆ†ï¼š60

âœ… ä¹°å®¶ä¼šä¼˜å…ˆé€‰æ‹©åšå¸‚å•†A
```

---

#### åœºæ™¯2ï¼šå§”å‘˜ä¼šKYCå®¡æ ¸

**éœ€æ±‚ï¼š** éªŒè¯åšå¸‚å•†èº«ä»½çœŸå®æ€§ï¼Œé˜²æ­¢æ¬ºè¯ˆ

**å¦‚æœå§”å‘˜ä¼šä¸èƒ½è§£å¯†ï¼š**
- âŒ æ— æ³•éªŒè¯èº«ä»½è¯çœŸå®æ€§
- âŒ æ— æ³•é˜²æ­¢é‡å¤ç”³è¯·
- âŒ æ— æ³•è¿›è¡ŒèƒŒæ™¯è°ƒæŸ¥
- âŒ å¹³å°å……æ–¥è™šå‡åšå¸‚å•†

**å§”å‘˜ä¼šå¯ä»¥è§£å¯†ï¼š**
- âœ… éªŒè¯å®Œæ•´èº«ä»½ä¿¡æ¯
- âœ… æ£€æŸ¥èº«ä»½è¯çœŸä¼ª
- âœ… é˜²æ­¢ä¸€äººå¤šå·
- âœ… è¿›è¡Œä¿¡ç”¨èƒŒæ™¯è°ƒæŸ¥
- âœ… ä¿æŠ¤ä¹°å®¶å’Œå¹³å°å®‰å…¨

---

#### åœºæ™¯3ï¼šOTCäº‰è®®ä»²è£

**éœ€æ±‚ï¼š** æ ¸å®åŒæ–¹çœŸå®èº«ä»½ï¼Œå…¬æ­£è£å†³

**å§”å‘˜ä¼šå¯ä»¥è§£å¯†ï¼š**
- âœ… æ ¸å®åšå¸‚å•†çœŸå®èº«ä»½
- âœ… è”ç³»åšå¸‚å•†åè°ƒ
- âœ… éªŒè¯è½¬è´¦è®°å½•çœŸå®æ€§
- âœ… åšå‡ºå…¬æ­£è£å†³

---

### éšç§ä¸é€æ˜åº¦çš„å¹³è¡¡

| ä¿¡æ¯ç±»å‹ | ä¹°å®¶å¯è§ | å§”å‘˜ä¼šå¯è§ | åšå¸‚å•†è‡ªå·± | åˆç†æ€§ |
|---------|---------|-----------|-----------|--------|
| **å§“å** | å¼ Ã—ä¸‰ | å¼ ä¸‰ | å¼ ä¸‰ | âœ… ä¹°å®¶çŸ¥é“æ˜¯çœŸäººï¼Œä½†ä¸çŸ¥é“å…¨å |
| **ç”Ÿæ—¥** | 1990-xx-xx | 1990-01-01 | 1990-01-01 | âœ… ä¹°å®¶çŸ¥é“å¹´é¾„æ®µï¼Œä½†ä¸çŸ¥é“å…·ä½“ç”Ÿæ—¥ |
| **èº«ä»½è¯** | 1101****1234 | 110101199001011234 | 110101199001011234 | âœ… ä¹°å®¶çŸ¥é“åœ°åŒºï¼Œä½†ä¸çŸ¥é“å®Œæ•´å·ç  |
| **æ‰‹æœº** | 138****8000 | 13800138000 | 13800138000 | âœ… ä¹°å®¶çŸ¥é“è¿è¥å•†ï¼Œä½†ä¸çŸ¥é“å®Œæ•´å·ç  |
| **åœ°å€** | åŒ—äº¬å¸‚æœé˜³åŒº | åŒ—äº¬å¸‚æœé˜³åŒºxxxè¡—é“xxxå· | å®Œæ•´åœ°å€ | âœ… ä¹°å®¶çŸ¥é“å¤§è‡´ä½ç½® |
| **é“¶è¡Œå¡** | 6214****6789ï¼ˆä¸­å›½é“¶è¡Œï¼‰ | 6214850123456789 | 6214850123456789 | âœ… ä¹°å®¶çŸ¥é“é“¶è¡Œï¼Œä½†ä¸çŸ¥é“è´¦å· |

**ç»“è®ºï¼š** 
- âœ… **ä¹°å®¶å¯è§è„±æ•ä¿¡æ¯**ï¼šä¿æŠ¤åšå¸‚å•†éšç§ï¼ŒåŒæ—¶æä¾›è¶³å¤Ÿçš„å¯ä¿¡åº¦åˆ¤æ–­ä¾æ®
- âœ… **å§”å‘˜ä¼šå¯è§å®Œæ•´ä¿¡æ¯**ï¼šæ»¡è¶³KYCã€ä»²è£ã€é£æ§éœ€æ±‚
- âœ… **åšå¸‚å•†è‡ªå·±å¯è§**ï¼šéšæ—¶æŸ¥çœ‹ã€ä¿®æ”¹è‡ªå·±çš„ä¿¡æ¯

---

## äº”ã€å®æ–½å»ºè®®

### 5.1 éœ€è¦è¡¥å……çš„ä»£ç 

#### â‘  æ·»åŠ ç”Ÿæ—¥å­—æ®µ

```rust
// pallets/market-maker/src/lib.rs

/// ç”Ÿæ—¥è„±æ•è¾…åŠ©å‡½æ•°
fn mask_birthday(birthday: &str) -> Vec<u8> {
    extern crate alloc;
    use alloc::string::String;
    
    if birthday.len() >= 4 {
        let year = &birthday[0..4];
        let masked = alloc::format!("{}-xx-xx", year);
        masked.as_bytes().to_vec()
    } else {
        b"****-xx-xx".to_vec()
    }
}

pub struct Application<AccountId, Balance> {
    // ... ç°æœ‰å­—æ®µ ...
    
    /// ğŸ†• è„±æ•ç”Ÿæ—¥
    pub masked_birthday: BoundedVec<u8, ConstU32<16>>,
    
    /// ğŸ†• æˆæƒè§£å¯†è€…åˆ—è¡¨ï¼ˆå¯é€‰ï¼‰
    pub authorized_decryptors: BoundedVec<AccountId, ConstU32<50>>,
}

/// ä¿®æ”¹ submit_info æ¥å£
pub fn submit_info(
    origin: OriginFor<T>,
    mm_id: u64,
    // ... ç°æœ‰å‚æ•° ...
    full_name: Vec<u8>,
    id_card: Vec<u8>,
    birthday: Vec<u8>,  // ğŸ†• æ·»åŠ ç”Ÿæ—¥å‚æ•°
    // ...
) -> DispatchResult {
    // ... ç°æœ‰é€»è¾‘ ...
    
    // è„±æ•ç”Ÿæ—¥
    let birthday_str = core::str::from_utf8(&birthday)
        .map_err(|_| Error::<T>::InvalidBirthday)?;
    let masked_birthday_vec = mask_birthday(birthday_str);
    let masked_birthday: BoundedVec<u8, ConstU32<16>> = masked_birthday_vec
        .try_into()
        .map_err(|_| Error::<T>::BirthdayTooLong)?;
    
    // è·å–å§”å‘˜ä¼šæˆå‘˜ï¼ˆå¯é€‰ï¼‰
    let committee_members = Self::get_committee_members();
    let mut authorized_decryptors = BoundedVec::new();
    authorized_decryptors.try_push(who.clone())?;
    for member in committee_members {
        authorized_decryptors.try_push(member)?;
    }
    
    // å­˜å‚¨
    app.masked_birthday = masked_birthday;
    app.authorized_decryptors = authorized_decryptors;
    
    Ok(())
}
```

---

#### â‘¡ æ·»åŠ è®¿é—®å®¡è®¡

```rust
// pallets/market-maker/src/lib.rs

/// è®¿é—®è®°å½•
#[derive(Clone, Encode, Decode, PartialEq, RuntimeDebug, TypeInfo, MaxEncodedLen)]
pub struct AccessRecord<AccountId, BlockNumber> {
    pub accessor: AccountId,
    pub accessed_at: BlockNumber,
    pub purpose: BoundedVec<u8, ConstU32<256>>,
}

#[pallet::storage]
pub type SensitiveDataAccessLogs<T: Config> = StorageMap<
    _,
    Blake2_128Concat,
    u64,  // mm_id
    BoundedVec<AccessRecord<T::AccountId, BlockNumberFor<T>>, ConstU32<100>>,
    ValueQuery,
>;

#[pallet::call_index(XX)]
#[pallet::weight(10_000)]
pub fn log_sensitive_access(
    origin: OriginFor<T>,
    mm_id: u64,
    purpose: Vec<u8>,
) -> DispatchResult {
    let who = ensure_signed(origin)?;
    
    ensure!(
        Self::is_committee_member(&who),
        Error::<T>::NotCommitteeMember
    );
    
    let now = <frame_system::Pallet<T>>::block_number();
    
    SensitiveDataAccessLogs::<T>::try_mutate(mm_id, |logs| -> DispatchResult {
        logs.try_push(AccessRecord {
            accessor: who.clone(),
            accessed_at: now,
            purpose: purpose.try_into().map_err(|_| Error::<T>::PurposeTooLong)?,
        })
        .map_err(|_| Error::<T>::TooManyAccessRecords)?;
        Ok(())
    })?;
    
    Self::deposit_event(Event::SensitiveDataAccessed {
        mm_id,
        accessor: who,
    });
    
    Ok(())
}

/// è¾…åŠ©å‡½æ•°ï¼šæ£€æŸ¥æ˜¯å¦ä¸ºå§”å‘˜ä¼šæˆå‘˜
fn is_committee_member(account: &T::AccountId) -> bool {
    pallet_collective::Members::<T, pallet_collective::Instance3>::get()
        .contains(account)
}
```

---

#### â‘¢ æ·»åŠ é”™è¯¯ç±»å‹

```rust
#[pallet::error]
pub enum Error<T> {
    // ... ç°æœ‰é”™è¯¯ ...
    
    /// ğŸ†• ç”Ÿæ—¥æ ¼å¼æ— æ•ˆ
    InvalidBirthday,
    
    /// ğŸ†• ç”Ÿæ—¥å¤ªé•¿
    BirthdayTooLong,
    
    /// ğŸ†• ä¸æ˜¯å§”å‘˜ä¼šæˆå‘˜
    NotCommitteeMember,
    
    /// ğŸ†• è®¿é—®ç›®çš„å¤ªé•¿
    PurposeTooLong,
    
    /// ğŸ†• è®¿é—®è®°å½•å¤ªå¤š
    TooManyAccessRecords,
}
```

---

### 5.2 å‰ç«¯å®ç°

#### â‘  åšå¸‚å•†æäº¤ç”³è¯·

```typescript
// src/pages/MarketMaker/SubmitApplication.tsx

const handleSubmit = async (values: any) => {
  // 1. å‡†å¤‡å®Œæ•´æ•æ„Ÿä¿¡æ¯
  const sensitiveData = {
    full_name: values.full_name,
    birthday: values.birthday,
    id_card: values.id_card,
    phone: values.phone,
    address: values.address,
    bank_accounts: values.bank_accounts,
  };
  
  // 2. è·å–å§”å‘˜ä¼šæˆå‘˜
  const committeeMembers = await api.query.collective.members(3);
  
  // 3. åŠ å¯†ç»™è‡ªå·± + å§”å‘˜ä¼š
  const recipients = [
    myAccount.address,
    ...committeeMembers.map(m => m.toString()),
  ];
  
  const { cid: privateCid } = await encryptForMultipleRecipients(
    sensitiveData,
    recipients
  );
  
  console.log('âœ… æ•æ„Ÿä¿¡æ¯å·²åŠ å¯†ç»™', recipients.length, 'ä¸ªæ¥æ”¶æ–¹');
  
  // 4. æäº¤åˆ°é“¾ä¸Šï¼ˆé“¾ç«¯ä¼šè‡ªåŠ¨è„±æ•ï¼‰
  await api.tx.marketMaker.submitInfo(
    mmId,
    publicCid,
    privateCid,
    buyPremiumBps,
    sellPremiumBps,
    minAmount,
    tronAddress,
    values.full_name,      // å®Œæ•´å§“åï¼ˆé“¾ç«¯è‡ªåŠ¨è„±æ•ï¼‰
    values.id_card,        // å®Œæ•´èº«ä»½è¯ï¼ˆé“¾ç«¯è‡ªåŠ¨è„±æ•ï¼‰
    values.birthday,       // ğŸ†• å®Œæ•´ç”Ÿæ—¥ï¼ˆé“¾ç«¯è‡ªåŠ¨è„±æ•ï¼‰
    maskedPaymentInfoJson
  ).signAndSend(myAccount);
  
  message.success('âœ… ç”³è¯·å·²æäº¤ï¼æ•æ„Ÿä¿¡æ¯å·²åŠ å¯†ä¿æŠ¤');
};
```

---

#### â‘¡ ä¹°å®¶æŸ¥çœ‹åšå¸‚å•†åˆ—è¡¨ï¼ˆè„±æ•ä¿¡æ¯ï¼‰

```typescript
// src/pages/OTC/MarketMakerList.tsx

const MarketMakerList: React.FC = () => {
  const [makers, setMakers] = useState<any[]>([]);
  
  const loadMakers = async () => {
    const entries = await api.query.marketMaker.applications.entries();
    
    const makerList = entries.map(([key, app]) => {
      const mmId = key.args[0].toNumber();
      
      return {
        mm_id: mmId,
        // âœ… ä¹°å®¶åªèƒ½çœ‹åˆ°è„±æ•ä¿¡æ¯
        masked_name: new TextDecoder().decode(app.masked_full_name),
        masked_id_card: new TextDecoder().decode(app.masked_id_card),
        masked_birthday: new TextDecoder().decode(app.masked_birthday),
        credit_score: app.credit_score.toNumber(),
        status: app.status.toString(),
      };
    });
    
    setMakers(makerList);
  };
  
  return (
    <Table
      dataSource={makers}
      columns={[
        {
          title: 'åšå¸‚å•†',
          dataIndex: 'masked_name',
          key: 'name',
          // æ˜¾ç¤ºï¼šå¼ Ã—ä¸‰
        },
        {
          title: 'èº«ä»½è®¤è¯',
          dataIndex: 'masked_id_card',
          key: 'id_card',
          render: (text) => (
            <Tooltip title="å·²é€šè¿‡KYCè®¤è¯">
              <Badge status="success" text={text} />
              {/* æ˜¾ç¤ºï¼š1101****1234 */}
            </Tooltip>
          ),
        },
        {
          title: 'å¹´é¾„æ®µ',
          dataIndex: 'masked_birthday',
          key: 'birthday',
          render: (text) => {
            const year = text.split('-')[0];
            const age = new Date().getFullYear() - parseInt(year);
            return `${age}å² (${text})`;
            // æ˜¾ç¤ºï¼š35å² (1990-xx-xx)
          },
        },
        {
          title: 'ä¿¡ç”¨åˆ†',
          dataIndex: 'credit_score',
          key: 'credit',
          sorter: (a, b) => a.credit_score - b.credit_score,
        },
      ]}
    />
  );
};
```

---

#### â‘¢ å§”å‘˜ä¼šå®¡æ ¸ï¼ˆè§£å¯†å®Œæ•´ä¿¡æ¯ï¼‰

```typescript
// src/pages/Governance/ReviewMarketMaker.tsx

const ReviewMarketMaker: React.FC<{ mmId: number }> = ({ mmId }) => {
  const [sensitiveData, setSensitiveData] = useState<any>(null);
  
  const handleViewSensitiveInfo = async () => {
    // 1. è®°å½•è®¿é—®æ—¥å¿—ï¼ˆé“¾ä¸Šï¼‰
    await api.tx.marketMaker.logSensitiveAccess(
      mmId,
      'åšå¸‚å•†KYCå®¡æ ¸'  // è®¿é—®ç›®çš„
    ).signAndSend(myAccount);
    
    // 2. è·å–åŠ å¯†CID
    const app = await api.query.marketMaker.applications(mmId);
    const privateCid = app.unwrap().private_cid.toString();
    
    // 3. ä»IPFSä¸‹è½½å¹¶è§£å¯†
    const decrypted = await downloadAndDecrypt(privateCid, myPrivateKey);
    
    setSensitiveData(decrypted);
    
    Modal.info({
      title: 'âš ï¸ è®¿é—®è®°å½•å·²è®°å½•',
      content: 'æ‚¨æŸ¥çœ‹äº†åšå¸‚å•†çš„æ•æ„Ÿä¿¡æ¯ï¼Œè¯¥æ“ä½œå·²è®°å½•åœ¨é“¾ä¸Šï¼Œåšå¸‚å•†å¯ä»¥æŸ¥çœ‹è®¿é—®æ—¥å¿—ã€‚',
    });
  };
  
  return (
    <Card>
      <Alert
        message="éšç§æç¤º"
        description="æ‚¨å³å°†æŸ¥çœ‹åšå¸‚å•†çš„å®Œæ•´æ•æ„Ÿä¿¡æ¯ï¼Œè¯¥æ“ä½œä¼šè¢«è®°å½•åœ¨é“¾ä¸Šã€‚"
        type="warning"
      />
      
      <Button 
        type="primary" 
        onClick={handleViewSensitiveInfo}
      >
        æŸ¥çœ‹å®Œæ•´ä¿¡æ¯ï¼ˆéœ€æˆæƒï¼‰
      </Button>
      
      {sensitiveData && (
        <Descriptions bordered column={1}>
          <Descriptions.Item label="å§“å">
            {sensitiveData.full_name}  {/* å¼ ä¸‰ */}
          </Descriptions.Item>
          <Descriptions.Item label="ç”Ÿæ—¥">
            {sensitiveData.birthday}  {/* 1990-01-01 */}
          </Descriptions.Item>
          <Descriptions.Item label="èº«ä»½è¯å·">
            {sensitiveData.id_card}  {/* 110101199001011234 */}
          </Descriptions.Item>
          <Descriptions.Item label="æ‰‹æœºå·">
            {sensitiveData.phone}  {/* 13800138000 */}
          </Descriptions.Item>
          <Descriptions.Item label="åœ°å€">
            {sensitiveData.address}  {/* å®Œæ•´åœ°å€ */}
          </Descriptions.Item>
        </Descriptions>
      )}
    </Card>
  );
};
```

---

#### â‘£ åšå¸‚å•†æŸ¥çœ‹è®¿é—®æ—¥å¿—

```typescript
// src/pages/MarketMaker/MyProfile.tsx

const ViewAccessLogs: React.FC<{ mmId: number }> = ({ mmId }) => {
  const [logs, setLogs] = useState<any[]>([]);
  
  const loadLogs = async () => {
    const rawLogs = await api.query.marketMaker.sensitiveDataAccessLogs(mmId);
    
    const formattedLogs = rawLogs.map((log: any) => ({
      accessor: log.accessor.toString(),
      accessedAt: new Date(log.accessed_at.toNumber() * 6000).toLocaleString(),
      purpose: new TextDecoder().decode(log.purpose),
    }));
    
    setLogs(formattedLogs);
  };
  
  return (
    <Card title="ğŸ“‹ æ•æ„Ÿä¿¡æ¯è®¿é—®æ—¥å¿—">
      <Alert
        message="æ‚¨å¯ä»¥æŸ¥çœ‹è°è®¿é—®äº†æ‚¨çš„æ•æ„Ÿä¿¡æ¯"
        type="info"
        style={{ marginBottom: 16 }}
      />
      
      <Table
        dataSource={logs}
        columns={[
          {
            title: 'è®¿é—®è€…',
            dataIndex: 'accessor',
            key: 'accessor',
            render: (text) => <code>{text}</code>,
          },
          {
            title: 'è®¿é—®æ—¶é—´',
            dataIndex: 'accessedAt',
            key: 'accessedAt',
          },
          {
            title: 'è®¿é—®ç›®çš„',
            dataIndex: 'purpose',
            key: 'purpose',
          },
        ]}
      />
      
      {logs.length === 0 && (
        <Empty description="æš‚æ— è®¿é—®è®°å½•" />
      )}
    </Card>
  );
};
```

---

## å…­ã€æ€»ç»“

### âœ… å¯è¡Œæ€§ç»“è®º

**æŠ€æœ¯å®Œå…¨å¯è¡Œ**ï¼Œå¤§éƒ¨åˆ†åŠŸèƒ½å·²å®ç°ï¼š

| åŠŸèƒ½ | çŠ¶æ€ | å·¥ä½œé‡ |
|------|------|--------|
| è„±æ•å‡½æ•° | âœ… å·²å®ç° | 0 |
| é“¾ä¸Šå­˜å‚¨è„±æ•ä¿¡æ¯ | âœ… å·²å®ç° | 0 |
| åŠ å¯†å®Œæ•´ä¿¡æ¯ | âœ… å·²å®ç° | 0 |
| **ç”Ÿæ—¥å­—æ®µ** | âš ï¸ éœ€æ·»åŠ  | 1å°æ—¶ |
| **è®¿é—®å®¡è®¡** | âš ï¸ éœ€æ·»åŠ  | 2å°æ—¶ |
| **æˆæƒåˆ—è¡¨** | âš ï¸ å¯é€‰ | 1å°æ—¶ |
| **å‰ç«¯é›†æˆ** | âš ï¸ éœ€å¼€å‘ | 1å¤© |

**æ€»å·¥ä½œé‡ï¼šçº¦2å¤©**

---

### âœ… åˆç†æ€§ç»“è®º

**ä¸šåŠ¡ä¸Šåˆç†ä¸”å¿…è¦**ï¼š

#### 1. ä¹°å®¶éœ€è¦è„±æ•ä¿¡æ¯
- âœ… åˆ¤æ–­åšå¸‚å•†èº«ä»½çœŸå®æ€§
- âœ… æå‡äº¤æ˜“ä¿¡å¿ƒ
- âœ… ä¸æ³„éœ²å®Œæ•´éšç§

#### 2. å§”å‘˜ä¼šéœ€è¦å®Œæ•´ä¿¡æ¯
- âœ… KYCå®¡æ ¸
- âœ… äº‰è®®ä»²è£
- âœ… é£é™©æ§åˆ¶
- âœ… åˆè§„è¦æ±‚

#### 3. éšç§ä¿æŠ¤æœºåˆ¶
- âœ… è®¿é—®å®¡è®¡ï¼ˆé“¾ä¸Šè®°å½•ï¼‰
- âœ… åšå¸‚å•†å¯ç›‘ç£
- âœ… å§”å‘˜ä¼šè¡Œä¸ºé€æ˜

---

### ğŸ¯ æ¨èå®æ–½

#### ç«‹å³å®æ–½ï¼ˆå¿…éœ€ï¼‰
1. âœ… æ·»åŠ ç”Ÿæ—¥å­—æ®µå’Œè„±æ•å‡½æ•°
2. âœ… æ·»åŠ è®¿é—®å®¡è®¡åŠŸèƒ½
3. âœ… å‰ç«¯é›†æˆå¤šæ¥æ”¶æ–¹åŠ å¯†
4. âœ… å‰ç«¯å±•ç¤ºè„±æ•ä¿¡æ¯ç»™ä¹°å®¶

#### å¯é€‰åŠŸèƒ½ï¼ˆå¢å¼ºï¼‰
5. âš ï¸ æ·»åŠ æˆæƒåˆ—è¡¨å­—æ®µ
6. âš ï¸ å®ç°è®¿é—®åˆ†çº§ï¼ˆä¸åŒæ•æ„Ÿåº¦ä¸åŒé—¨æ§›ï¼‰
7. âš ï¸ å®šæœŸå…¬å¼€è®¿é—®ç»Ÿè®¡æŠ¥å‘Š

---

**ç¼–å†™æ—¥æœŸ**ï¼š2025-10-23  
**ç‰ˆæœ¬**ï¼šv1.0  
**çŠ¶æ€**ï¼šå®æ–½æ–¹æ¡ˆ  
**ç»“è®º**ï¼šâœ… æŠ€æœ¯å¯è¡Œ + âœ… ä¸šåŠ¡åˆç† + âš ï¸ éœ€è¡¥å……å°‘é‡ä»£ç 

