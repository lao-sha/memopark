# DeepSeek AI äº¤æ˜“å†³ç­–é›†æˆæ–¹æ¡ˆ

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–¹æ¡ˆå°† **DeepSeek AI** é›†æˆåˆ° Stardust é“¾çš„ AI Strategy Pallet ä¸­ï¼Œé€šè¿‡è°ƒç”¨ DeepSeek API (`https://api.deepseek.com`) å®ç°æ™ºèƒ½äº¤æ˜“å†³ç­–ã€‚

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### å®Œæ•´æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·æ“ä½œ                                                             â”‚
â”‚                                                                      â”‚
â”‚  åˆ›å»ºAIç­–ç•¥ â†’ aiStrategy.createAiStrategy({                         â”‚
â”‚                 ai_config: {                                         â”‚
â”‚                   primaryModel: "DeepSeek",                          â”‚
â”‚                   inferenceEndpoint: "https://api.deepseek.com",     â”‚
â”‚                   apiKeyHash: hash("sk-xxxxx"),                      â”‚
â”‚                   confidenceThreshold: 70                            â”‚
â”‚                 }                                                    â”‚
â”‚              })                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é“¾ä¸Šå­˜å‚¨                                                             â”‚
â”‚                                                                      â”‚
â”‚  AIStrategies[0] = {                                                â”‚
â”‚    strategy_id: 0,                                                  â”‚
â”‚    symbol: "BTC-USD",                                               â”‚
â”‚    ai_config: { ... },                                              â”‚
â”‚    status: Active                                                   â”‚
â”‚  }                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼ æ¯10ä¸ªåŒºå—è§¦å‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Off-Chain Worker (OCW)                                              â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 1. è¯»å–æ´»è·ƒç­–ç•¥                                             â”‚    â”‚
â”‚  â”‚    â”œâ”€ for strategy in AIStrategies.iter()                  â”‚    â”‚
â”‚  â”‚    â””â”€ if strategy.status == Active                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                             â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 2. æ”¶é›†å¸‚åœºæ•°æ®                                             â”‚    â”‚
â”‚  â”‚    â”œâ”€ å½“å‰ä»·æ ¼ (ä» Hyperliquid æˆ– Oracle)                  â”‚    â”‚
â”‚  â”‚    â”œâ”€ 24å°æ—¶ä»·æ ¼å†å²                                        â”‚    â”‚
â”‚  â”‚    â”œâ”€ 24å°æ—¶æˆäº¤é‡                                          â”‚    â”‚
â”‚  â”‚    â””â”€ èµ„é‡‘è´¹ç‡ (å¯é€‰)                                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                             â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 3. æ„å»º DeepSeek è¯·æ±‚                                       â”‚    â”‚
â”‚  â”‚    â”œâ”€ ç”Ÿæˆ Prompt (åŒ…å«å¸‚åœºæ•°æ®)                           â”‚    â”‚
â”‚  â”‚    â”œâ”€ è®¾ç½®æ¨¡å‹å‚æ•° (temperature, max_tokens)               â”‚    â”‚
â”‚  â”‚    â””â”€ æ·»åŠ  API Key è®¤è¯                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                             â”‚                                       â”‚
â”‚                             â–¼ HTTP POST                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ DeepSeek API                    â”‚
              â”‚ https://api.deepseek.com        â”‚
              â”‚                                 â”‚
              â”‚ POST /chat/completions          â”‚
              â”‚ {                               â”‚
              â”‚   "model": "deepseek-chat",     â”‚
              â”‚   "messages": [                 â”‚
              â”‚     {                           â”‚
              â”‚       "role": "user",           â”‚
              â”‚       "content": "<prompt>"     â”‚
              â”‚     }                           â”‚
              â”‚   ],                            â”‚
              â”‚   "temperature": 0.7            â”‚
              â”‚ }                               â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼ AI åˆ†æå¹¶è¿”å›
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ DeepSeek å“åº”                   â”‚
              â”‚ {                               â”‚
              â”‚   "choices": [{                 â”‚
              â”‚     "message": {                â”‚
              â”‚       "content": "{             â”‚
              â”‚         \"action\": \"BUY\",    â”‚
              â”‚         \"confidence\": 85,     â”‚
              â”‚         \"position_size\": ...  â”‚
              â”‚       }"                        â”‚
              â”‚     }                           â”‚
              â”‚   }]                            â”‚
              â”‚ }                               â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OCW (ç»§ç»­)                                                           â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 4. è§£æ AI å“åº”                                             â”‚    â”‚
â”‚  â”‚    â”œâ”€ æå–äº¤æ˜“ä¿¡å·: BUY/SELL/HOLD/CLOSE                    â”‚    â”‚
â”‚  â”‚    â”œâ”€ æå–ç½®ä¿¡åº¦: 85                                        â”‚    â”‚
â”‚  â”‚    â”œâ”€ æå–ä»“ä½å¤§å°: 1000 USDC                              â”‚    â”‚
â”‚  â”‚    â””â”€ æå–æ­¢æŸæ­¢ç›ˆä»·æ ¼                                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                             â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 5. éªŒè¯äº¤æ˜“ä¿¡å·                                             â”‚    â”‚
â”‚  â”‚    â”œâ”€ ç½®ä¿¡åº¦ >= é…ç½®çš„é˜ˆå€¼ (70)?                           â”‚    â”‚
â”‚  â”‚    â”œâ”€ ä»“ä½å¤§å° <= é£æ§é™åˆ¶?                                â”‚    â”‚
â”‚  â”‚    â””â”€ ç¬¦åˆç­–ç•¥ç±»å‹è§„åˆ™?                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                             â”‚                                       â”‚
â”‚                             â–¼ å¦‚æœéªŒè¯é€šè¿‡                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 6. æ‰§è¡Œ Hyperliquid äº¤æ˜“                                    â”‚    â”‚
â”‚  â”‚    â”œâ”€ æ„å»ºè®¢å• (å¸‚ä»·å•/é™ä»·å•)                             â”‚    â”‚
â”‚  â”‚    â”œâ”€ EIP-712 ç­¾å                                          â”‚    â”‚
â”‚  â”‚    â”œâ”€ HTTP POST åˆ° Hyperliquid                             â”‚    â”‚
â”‚  â”‚    â””â”€ è·å–è®¢å•ID                                            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                             â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 7. è®°å½•ç»“æœåˆ°é“¾ä¸Š (æ— ç­¾åäº¤æ˜“)                              â”‚    â”‚
â”‚  â”‚    â””â”€ aiStrategy.recordAiSignal({                           â”‚    â”‚
â”‚  â”‚          strategy_id: 0,                                    â”‚    â”‚
â”‚  â”‚          signal: { action: BUY, confidence: 85, ... },      â”‚    â”‚
â”‚  â”‚          order_id: "hyperliquid-order-123"                  â”‚    â”‚
â”‚  â”‚       })                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é“¾ä¸Šäº‹ä»¶ & å­˜å‚¨æ›´æ–°                                                  â”‚
â”‚                                                                      â”‚
â”‚  âœ… Event::AISignalGenerated { strategy_id: 0, signal: BUY, ... }   â”‚
â”‚  âœ… Event::TradeExecuted { order_id: "...", ... }                   â”‚
â”‚  âœ… SignalHistory æ›´æ–°                                               â”‚
â”‚  âœ… PerformanceMetrics æ›´æ–°                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”‘ é…ç½® DeepSeek API Key

### æ–¹å¼ä¸€ï¼šç¯å¢ƒå˜é‡ï¼ˆæ¨èç”¨äºå¼€å‘ï¼‰

```bash
# è®¾ç½® API Key
export DEEPSEEK_API_KEY="sk-your-api-key-here"

# å¯åŠ¨èŠ‚ç‚¹
./target/release/stardust-node --dev --tmp
```

### æ–¹å¼äºŒï¼šé“¾ä¸ŠåŠ å¯†å­˜å‚¨

åˆ›å»ºç­–ç•¥æ—¶ï¼ŒAPI Key ä»¥å“ˆå¸Œå½¢å¼å­˜å‚¨ï¼š

```rust
use sp_core::hashing::blake2_256;

let api_key = b"sk-your-api-key";
let api_key_hash = blake2_256(api_key);  // å­˜å‚¨åœ¨é“¾ä¸Š

// åˆ›å»ºç­–ç•¥æ—¶ä½¿ç”¨
let ai_config = AIModelConfig {
    api_key_hash,  // é“¾ä¸Šåªå­˜å‚¨å“ˆå¸Œ
    // ... å…¶ä»–é…ç½®
};
```

**æ³¨æ„ï¼š** å®é™… API Key éœ€è¦åœ¨èŠ‚ç‚¹æœ¬åœ°é…ç½®ï¼Œé“¾ä¸Šåªå­˜å‚¨å“ˆå¸Œç”¨äºéªŒè¯ã€‚

### æ–¹å¼ä¸‰ï¼šèŠ‚ç‚¹é…ç½®æ–‡ä»¶

åˆ›å»º `config/deepseek.toml`ï¼š

```toml
[deepseek]
api_key = "sk-your-api-key-here"
api_url = "https://api.deepseek.com/chat/completions"
model = "deepseek-chat"
default_temperature = 0.7
default_max_tokens = 500
```

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### 1. åˆ›å»ºä½¿ç”¨ DeepSeek çš„ AI ç­–ç•¥

```javascript
const { ApiPromise, WsProvider, Keyring } = require('@polkadot/api');

async function createDeepSeekStrategy() {
  const api = await ApiPromise.create({ 
    provider: new WsProvider('ws://127.0.0.1:9944') 
  });
  
  const keyring = new Keyring({ type: 'sr25519' });
  const alice = keyring.addFromUri('//Alice');

  // AI é…ç½® - ä½¿ç”¨ DeepSeek
  const aiConfig = {
    primaryModel: 'DeepSeek',  // æŒ‡å®šä½¿ç”¨ DeepSeek
    fallbackModel: 'LSTM',      // å¤‡ç”¨æœ¬åœ°æ¨¡å‹
    inferenceEndpoint: Array.from(
      new TextEncoder().encode('https://api.deepseek.com/chat/completions')
    ),
    apiKeyHash: new Array(32).fill(0),  // API Key å“ˆå¸Œ (å®é™…åº”è¯¥æ˜¯çœŸå®çš„å“ˆå¸Œ)
    confidenceThreshold: 70,  // åªæ‰§è¡Œç½®ä¿¡åº¦ >= 70% çš„ä¿¡å·
    featuresEnabled: [
      'TechnicalIndicators',
      'MarketMicrostructure',
      'SocialSentiment'
    ],
    inferenceTimeoutSecs: 30,  // DeepSeek å¯èƒ½éœ€è¦æ›´é•¿æ—¶é—´
    maxRetries: 2,
    modelVersion: Array.from(new TextEncoder().encode('deepseek-chat'))
  };

  // ç­–ç•¥å‚æ•° - ç½‘æ ¼äº¤æ˜“
  const strategyParams = {
    gridLowerPrice: 40_000_000_000n,  // $40,000
    gridUpperPrice: 50_000_000_000n,  // $50,000
    gridLevels: 10,
    gridOrderSize: 1_000_000_000n,    // $1,000
    // ... å…¶ä»–å‚æ•°è®¾ä¸º null
  };

  // é£æ§é™åˆ¶
  const riskLimits = {
    maxPositionSize: 10_000_000_000n,  // $10,000
    maxLeverage: 30,                    // 3x
    stopLossPrice: 39_000_000_000n,
    takeProfitPrice: 51_000_000_000n,
    maxTradesPerDay: 20,
    maxDailyLoss: 1_000_000_000n        // $1,000
  };

  // åˆ›å»ºç­–ç•¥
  const tx = api.tx.aiStrategy.createAiStrategy(
    Array.from(new TextEncoder().encode('DeepSeek BTC Strategy')),
    Array.from(new TextEncoder().encode('0x1234567890abcdef')),
    Array.from(new TextEncoder().encode('BTC-USD')),
    aiConfig,
    'Grid',
    strategyParams,
    riskLimits
  );

  await tx.signAndSend(alice, ({ status, events }) => {
    if (status.isInBlock) {
      console.log('âœ… ç­–ç•¥å·²åˆ›å»º');
      events.forEach(({ event }) => {
        if (api.events.aiStrategy.AIStrategyCreated.is(event)) {
          const [strategyId] = event.data;
          console.log(`   ç­–ç•¥ID: ${strategyId.toNumber()}`);
        }
      });
    }
  });

  await api.disconnect();
}

createDeepSeekStrategy().catch(console.error);
```

---

## ğŸ¤– DeepSeek Prompt è®¾è®¡

### Prompt æ¨¡æ¿

```
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„åŠ å¯†è´§å¸äº¤æ˜“AIåˆ†æå¸ˆã€‚è¯·åŸºäºä»¥ä¸‹å¸‚åœºæ•°æ®ï¼Œç»™å‡ºäº¤æ˜“å»ºè®®ã€‚

**äº¤æ˜“å¯¹**: BTC-USD
**å½“å‰ä»·æ ¼**: $45,123.50 USD
**24å°æ—¶ä»·æ ¼å˜åŒ–**: +2.3%
**ç­–ç•¥ç±»å‹**: Grid (ç½‘æ ¼äº¤æ˜“)

**24å°æ—¶ä»·æ ¼æ•°æ®** (æœ€è¿‘10ä¸ªæ•°æ®ç‚¹):
$44,000, $44,500, $44,800, $45,000, $45,100, ...

**24å°æ—¶æˆäº¤é‡æ•°æ®**:
$1,200,000, $1,150,000, $1,300,000, ...

**è¦æ±‚**:
1. åˆ†æå½“å‰å¸‚åœºè¶‹åŠ¿
2. ç»™å‡ºæ˜ç¡®çš„äº¤æ˜“ä¿¡å·: BUY (ä¹°å…¥), SELL (å–å‡º), HOLD (æŒæœ‰), æˆ– CLOSE (å¹³ä»“)
3. æä¾›ç½®ä¿¡åº¦ (0-100)
4. å»ºè®®ä»“ä½å¤§å° (ä»¥USDCè®¡)
5. å»ºè®®æ­¢æŸå’Œæ­¢ç›ˆä»·æ ¼
6. ç®€è¦è¯´æ˜ç†ç”±

**å“åº”æ ¼å¼** (å¿…é¡»ä¸¥æ ¼éµå®ˆJSONæ ¼å¼):
{
  "action": "BUY|SELL|HOLD|CLOSE",
  "confidence": 85,
  "position_size": 1000000000,
  "entry_price": 45000000000,
  "stop_loss": 44000000000,
  "take_profit": 47000000000,
  "reasoning": "åˆ†æç†ç”±..."
}

è¯·ç›´æ¥è¿”å›JSONï¼Œä¸è¦åŒ…å«å…¶ä»–å†…å®¹ã€‚
```

### DeepSeek å“åº”ç¤ºä¾‹

```json
{
  "action": "BUY",
  "confidence": 85,
  "position_size": 1000000000,
  "entry_price": 45123000000,
  "stop_loss": 44000000000,
  "take_profit": 47000000000,
  "reasoning": "å½“å‰BTC-USDå‘ˆç°ä¸Šå‡è¶‹åŠ¿ï¼Œ24å°æ—¶æ¶¨å¹…2.3%ï¼Œæˆäº¤é‡ç¨³å®šã€‚æŠ€æœ¯æŒ‡æ ‡æ˜¾ç¤ºå¤šå¤´å¼ºåŠ¿ï¼Œå»ºè®®åœ¨å½“å‰ä»·æ ¼é™„è¿‘ä¹°å…¥ï¼Œè®¾ç½®æ­¢æŸäº44000ç¾å…ƒï¼Œç›®æ ‡ä»·ä½47000ç¾å…ƒã€‚"
}
```

---

## ğŸ”§ OCW ä¸­çš„ DeepSeek è°ƒç”¨å®ç°

### HTTP è¯·æ±‚ä»£ç ï¼ˆåœ¨ OCW ä¸­ï¼‰

```rust
use sp_runtime::offchain::http;
use crate::deepseek::*;

/// è°ƒç”¨ DeepSeek API è·å–äº¤æ˜“ä¿¡å·
fn call_deepseek_api(
    strategy: &AITradingStrategy,
    market_data: &MarketData,
) -> Result<TradingSignal, &'static str> {
    // 1. æ„å»º Prompt
    let prompt = build_trading_prompt(
        &strategy.symbol,
        market_data.current_price,
        &market_data.prices_24h,
        &market_data.volumes_24h,
        "Grid"  // ç­–ç•¥ç±»å‹
    );

    // 2. æ„å»º DeepSeek è¯·æ±‚
    let request = DeepSeekRequest {
        model: b"deepseek-chat".to_vec(),
        messages: vec![
            ChatMessage {
                role: b"system".to_vec(),
                content: b"You are a professional cryptocurrency trading analyst.".to_vec(),
            },
            ChatMessage {
                role: b"user".to_vec(),
                content: prompt,
            },
        ],
        temperature: 7,  // 0.7
        max_tokens: 500,
    };

    // 3. åºåˆ—åŒ–ä¸º JSON
    let body = serde_json::to_vec(&request).map_err(|_| "JSON serialization failed")?;

    // 4. å‘é€ HTTP POST è¯·æ±‚
    let api_key = get_deepseek_api_key()?;  // ä»ç¯å¢ƒæˆ–é…ç½®è·å–
    
    let http_request = http::Request::post(
        DEEPSEEK_API_URL,
        vec![body]
    )
    .add_header("Content-Type", "application/json")
    .add_header("Authorization", &format!("Bearer {}", api_key))
    .deadline(sp_runtime::offchain::timestamp().add(Duration::from_millis(30000)))
    .send()
    .map_err(|_| "HTTP request failed")?;

    // 5. ç­‰å¾…å“åº”
    let response = http_request.wait().map_err(|_| "HTTP wait failed")?;
    let response_body = response.body().collect::<Vec<u8>>();

    // 6. è§£æå“åº”
    let deepseek_response: DeepSeekResponse = serde_json::from_slice(&response_body)
        .map_err(|_| "Failed to parse DeepSeek response")?;

    // 7. æå–äº¤æ˜“ä¿¡å·
    let signal = parse_trading_signal(&deepseek_response)?;

    log::info!(
        "ğŸ¤– DeepSeek ä¿¡å·: {:?}, ç½®ä¿¡åº¦: {}%",
        core::str::from_utf8(&signal.action),
        signal.confidence
    );

    Ok(signal)
}
```

---

## ğŸ“Š å®Œæ•´æµ‹è¯•æµç¨‹

### æ­¥éª¤ 1ï¼šå‡†å¤‡ DeepSeek API Key

è®¿é—® https://platform.deepseek.com/ è·å– API Key

### æ­¥éª¤ 2ï¼šé…ç½®èŠ‚ç‚¹

```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export DEEPSEEK_API_KEY="sk-your-api-key"

# å¯åŠ¨èŠ‚ç‚¹
./target/release/stardust-node --dev --tmp --rpc-external --rpc-port 9944
```

### æ­¥éª¤ 3ï¼šåˆ›å»ºç­–ç•¥

```bash
node test-deepseek-strategy.js
```

### æ­¥éª¤ 4ï¼šç›‘æ§ OCW æ—¥å¿—

```bash
tail -f /tmp/stardust-node.log | grep -E "ğŸ¤–|DeepSeek"
```

**é¢„æœŸæ—¥å¿—ï¼š**
```
ğŸ¤– OCWæ‰§è¡ŒäºåŒºå— #10
ğŸ“Š å¤„ç†ç­–ç•¥ #0
ğŸŒ è°ƒç”¨ DeepSeek API...
ğŸ¤– DeepSeek ä¿¡å·: BUY, ç½®ä¿¡åº¦: 85%
âœ… ä¿¡å·éªŒè¯é€šè¿‡
ğŸ’° æ‰§è¡Œ Hyperliquid äº¤æ˜“...
ğŸ“ å·²è®°å½•åˆ°é“¾ä¸Š
```

---

## ğŸ’° æˆæœ¬ä¼°ç®—

### DeepSeek API å®šä»·

| é¡¹ç›® | ä»·æ ¼ |
|------|------|
| Input  | ~$0.14 / 1M tokens |
| Output | ~$0.28 / 1M tokens |

### æ¯æ¬¡è°ƒç”¨æˆæœ¬ä¼°ç®—

- **Prompt tokens**: ~500 tokens
- **Completion tokens**: ~150 tokens
- **å•æ¬¡æˆæœ¬**: ~$0.00011 (çº¦ 0.77 å…ƒäººæ°‘å¸)

### æ¯æ—¥æˆæœ¬ï¼ˆå‡è®¾æ¯10åˆ†é’Ÿä¸€æ¬¡ï¼‰

- **æ¯æ—¥è°ƒç”¨æ¬¡æ•°**: 144 æ¬¡
- **æ¯æ—¥æˆæœ¬**: ~$0.016 (çº¦ 1.1 å…ƒ)
- **æ¯æœˆæˆæœ¬**: ~$0.48 (çº¦ 33 å…ƒ)

**ä¼˜åŒ–å»ºè®®ï¼š**
- åªåœ¨å…³é”®æ—¶åˆ»è°ƒç”¨ï¼ˆå¸‚åœºæ³¢åŠ¨å¤§æ—¶ï¼‰
- ä½¿ç”¨æœ¬åœ°æ¨¡å‹ä½œä¸ºä¸»åŠ›ï¼ŒDeepSeek ä½œä¸ºè¾…åŠ©
- è®¾ç½®è°ƒç”¨é¢‘ç‡é™åˆ¶

---

## ğŸ”’ å®‰å…¨æ³¨æ„äº‹é¡¹

### 1. API Key å®‰å…¨

- âŒ ä¸è¦åœ¨é“¾ä¸Šæ˜æ–‡å­˜å‚¨ API Key
- âœ… ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–åŠ å¯†é…ç½®
- âœ… å®šæœŸè½®æ¢ API Key
- âœ… ç›‘æ§ API ä½¿ç”¨é‡ï¼Œé˜²æ­¢æ»¥ç”¨

### 2. å“åº”éªŒè¯

```rust
// éªŒè¯ DeepSeek å“åº”çš„åˆæ³•æ€§
fn validate_signal(signal: &TradingSignal, strategy: &AITradingStrategy) -> bool {
    // 1. ç½®ä¿¡åº¦éªŒè¯
    if signal.confidence < strategy.ai_config.confidence_threshold {
        return false;
    }
    
    // 2. ä»“ä½å¤§å°éªŒè¯
    if signal.position_size > strategy.risk_limits.max_position_size {
        return false;
    }
    
    // 3. äº¤æ˜“åŠ¨ä½œéªŒè¯
    let valid_actions = [b"BUY", b"SELL", b"HOLD", b"CLOSE"];
    if !valid_actions.contains(&&signal.action.as_slice()) {
        return false;
    }
    
    true
}
```

### 3. é”™è¯¯å¤„ç†

- è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´
- å®ç°é‡è¯•æœºåˆ¶
- è®°å½•æ‰€æœ‰å¼‚å¸¸
- é™çº§åˆ°æœ¬åœ°æ¨¡å‹

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [AI Strategy Pallet README](../pallets/ai-strategy/README.md)
- [Stardusté“¾ä¸Hyperliquidäº¤äº’æ–¹æ¡ˆ](./Stardusté“¾ä¸Hyperliquidäº¤äº’æ–¹æ¡ˆ.md)
- [AI-Strategyæ¨¡å—æµ‹è¯•æµç¨‹](./AI-Strategyæ¨¡å—æµ‹è¯•æµç¨‹.md)
- [DeepSeek API æ–‡æ¡£](https://platform.deepseek.com/api-docs/)

---

*æ–‡æ¡£æ›´æ–°æ—¶é—´: 2025-11-04*

