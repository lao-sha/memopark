# 佛境区块链项目文档

## 项目概述

佛境（BuddhaLand）是一个基于 Substrate 框架开发的专注于佛教文化和数字化修行的区块链平台。项目旨在将传统佛教修行方式与现代区块链技术相结合，为用户提供去中心化的修行记录、福德积累和慈善功德系统。

## 技术架构

### 核心框架
- **Substrate Framework**: 基于 Polkadot 生态的模块化区块链开发框架
- **Runtime 模块化设计**: 采用 pallet 架构，支持功能模块的独立开发和升级
- **WebAssembly Runtime**: 支持无分叉链上升级

### 系统架构图

```mermaid
graph TD
    Substrate[Substrate 框架]
    Substrate --> Karma[Karma Pallet<br/>福缘值系统]
    # 移除：Substrate --> Exchange[Exchange Pallet<br/>代币兑换]
    # 移除：Exchange -.-> Karma
    Substrate --> Paymaster[Paymaster Pallet<br/>代理支付]
    
    # 移除：Exchange -.-> Paymaster
    
    Meditation -.-> Karma
    Prayer -.-> Karma
    Commemorate -.-> Karma
    
    Paymaster -.-> All[所有需要代付的交易]
```

### 共识机制
- **Aura (Authority Round)**: 用于区块生产的轮询共识
- **GRANDPA**: 用于最终确定性的投票共识

## 核心模块 (Pallets)

### 1. Karma Pallet - 福缘值系统
佛境生态的核心积分系统，记录用户的功德和修行成果。

#### 主要功能
- **功德等级**: 支持多等级功德系统（0-4级）
- **每日签到**: 基础福缘值获取方式，支持连续签到奖励
- **功德记录**: 详细记录用户的功德来源和使用情况
- **等级计算**: 基于累计福缘值自动计算用户等级

#### 技术特性
- 支持外部验证器接入
- 完整的事件记录和查询
- 防刷机制（区块间隔限制）

### 2. Meditation Pallet - 禅修记录系统
数字化禅修体验，结合生理数据验证真实修行。

#### 主要功能
- **禅修会话记录**: 完整记录禅修时长、生理数据等
- **质量评估**: 基于心率、呼吸等生理指标评估禅修质量
- **自动奖励**: 根据禅修时长和质量自动发放 Karma 奖励
- **进度追踪**: 统计用户禅修历史和进步情况

#### 数据验证
- 最小时长要求（5分钟）
- 质量阈值控制（60分）
- 防作弊机制

### 3. Prayer Pallet - 祈福系统
数字化佛教仪式，提供多种传统修行方式。

#### 祈福功能
- **烧香祈福**: 消耗 Karma 进行虚拟烧香仪式
- **功德回向**: 将功德转赠给指定用户或群体
- **供奉布施**: 使用 BUD 代币进行数字化供奉
- **敲木鱼**: 交互式修行体验，支持连击奖励

#### 特色系统
- **本命佛供养**: 基于生肖的个性化佛像供养
- **日常限制**: 防止过度消耗的保护机制
- **社交回向**: 支持多人回向和群体祈福

### 4. Commemorate Pallet - 祭念系统
数字化纪念和祭奠平台，永久保存珍贵回忆。

#### 核心功能
- **数字祭念馆**: 创建永久性纪念空间
- **多媒体存储**: 集成 IPFS 存储照片、视频等
- **祭奠仪式**: 支持传统和现代两种祭奠方式
- **留言追思**: 家属朋友可留言纪念

#### 技术特性
- IPFS 分布式存储
- 多文件类型支持
- 访问权限控制
- 永久化记录

# 删除以下整节（原为第5节）
# ### 5. Exchange Pallet - 代币兑换系统
BUD 代币与 Karma 福缘值的兑换桥梁，支持灵活的资金分配机制。

#### 兑换机制
- **固定汇率**: 1 BUD = 1000 Karma（可配置）
- **即时兑换**: 实时处理兑换请求
- **多池分配**: 兑换资金按比例分配到不同池子

#### 奖金池系统
支持多种奖金池类型的动态配置：
- **Blackhole**: 代币销毁（通胀控制）
- **Treasury**: 国库账户（项目发展基金）
- **Paymaster**: 系统托管池（免签名代付）
- **Custom**: 自定义账户（扩展性支持）

#### 管理功能
- Root 权限的奖金池管理
- 动态比例调整
- 完整的操作审计

### 6. Paymaster Pallet - 代理支付系统
为用户提供免签名交易体验，降低使用门槛。

#### 核心功能
- **系统托管池**: 集中管理代付资金
- **授权充值**: 支持用户预付费充值
- **批量代付**: 高效处理多笔免签名交易
- **权限控制**: 细粒度的代付权限管理

#### 资金来源
#### 资金来源
- **用户充值**: 用户直接预付费充值
- **其他模块**: 其他 pallet 注入的资金
# （移除原有的 “Exchange 分配”）

#### 安全机制
- 最小充值限制
- 服务费机制
- 余额监控和警报

## 代币经济

### 资金流向图
```mermaid
graph LR
    # 移除 Exchange 节点与边
    # User[用户 BUD] --> Exchange[Exchange Pallet]
    # Exchange --> A[黑洞销毁]
    # Exchange --> B[国库]
    # Exchange --> Karma[Karma 福缘值<br/>按汇率发放]

    User[用户 BUD] --> B[国库]
    B --> Karma[Karma 福缘值相关系统]

    style B fill:#4ecdc4
    style Karma fill:#96ceb4
```

### BUD 代币
- **总供应量**: 根据经济模型设定
- **基础货币**: 用于支付交易费用和兑换 Karma
- **通胀控制**: 通过销毁机制维持代币价值

### Karma 福缘值
- **获取方式**: 
  - 每日签到
  - 禅修奖励
  - 特殊活动奖励
# （移除原有的 “BUD 兑换（主要来源）”）
- **消耗场景**:
  - 祈福仪式
  - 创建祭念馆
  - 高级功能使用

## 治理机制

### 链上治理
- **Sudo 模块**: 开发阶段的紧急治理
- **参数调整**: 支持关键参数的动态修改
- **升级机制**: 无分叉运行时升级

### 社区参与
- **提案系统**: 社区提出功能建议
- **投票机制**: 基于 Karma 的权重投票
- **激励机制**: 参与治理获得额外奖励

## 开发指南

### 环境搭建
1. 安装 Rust 和 Substrate 依赖
2. 克隆项目仓库
3. 编译运行时和节点
4. 启动本地测试网络

### 模块开发
1. 创建新的 pallet 目录
2. 实现必要的 trait 和接口
3. 添加到 runtime 配置
4. 编写测试用例
5. 更新文档

### 测试部署
1. 单元测试覆盖
2. 集成测试验证
3. 基准测试优化
4. 安全审计检查

## 路线图

### 第一阶段 (已完成)
- ✅ 基础 Karma 系统
- ✅ 禅修记录功能
- ✅ 祈福仪式系统
# （移除：✅ 代币兑换机制）
### 第二阶段 (已完成)
- ✅ 祭念纪念系统
- ✅ 代理支付功能
- ✅ 奖金池动态配置
- ✅ 系统集成优化

### 第三阶段 (进行中)
- 🔄 移动端 APP 开发
- 🔄 社区治理模块
- 🔄 用户界面优化
- 🔄 性能基准测试

### 第四阶段 (规划中)
- 📋 跨链桥接功能
- 📋 NFT 功德证书
- 📋 DAO 治理升级
- 📋 生态合作伙伴接入

## 社区生态

### 开发者社区
- GitHub 开源协作
- 技术文档维护
- 代码审查机制
- 开发者激励计划

### 用户社区
- 修行指导服务
- 社群活动组织
- 用户反馈收集
- 产品迭代优化

### 合作伙伴
- 佛教机构合作
- 技术服务提供商
- 钱包和交易所对接
- 内容创作者支持

## 安全保障

### 技术安全
- 代码审计机制
- 形式化验证
- 模糊测试覆盖
- 漏洞奖励计划

### 经济安全
- 通胀控制机制
- 防刷保护措施
- 异常监控系统
- 紧急暂停功能

### 隐私保护
- 最小化数据收集
- 用户控制权限
- 加密存储传输
- 合规性保障

---

本文档将继续更新，反映项目的最新发展和功能变化。更多技术细节请参考各模块的专项文档和代码注释。
# 变更记录（Karma / Exchange / 冥想）
- 2025-08-：移除 Exchange Pallet 及其所有依赖引用；Karma 不再包含“兑换”相关逻辑
- 2025-08-：移除冥想验证器（Meditation Verifier）及冥想任务相关接口与权重
- Karma Pallet 现支持：每日签到、功德行为（消耗 Karma 增加功德）、功德等级、历史记录