//! 梅花易数静态常量数据模块
//!
//! 本模块包含梅花易数排盘系统所需的所有静态数据：
//! - 六十四卦名称表
//! - 八卦属性表
//! - 卦辞数据
//! - 爻辞数据

/// 八卦名称表（先天八卦数序）
///
/// 索引 0-7 对应坤(0/8)、乾(1)、兑(2)、离(3)、震(4)、巽(5)、坎(6)、艮(7)
pub const BAGUA_NAMES: [&str; 8] = [
    "坤", // 0 或 8
    "乾", // 1
    "兑", // 2
    "离", // 3
    "震", // 4
    "巽", // 5
    "坎", // 6
    "艮", // 7
];

/// 八卦 Unicode 符号
pub const BAGUA_SYMBOLS: [&str; 8] = [
    "☷", // 坤 0/8
    "☰", // 乾 1
    "☱", // 兑 2
    "☲", // 离 3
    "☳", // 震 4
    "☴", // 巽 5
    "☵", // 坎 6
    "☶", // 艮 7
];

/// 八卦自然象征
pub const BAGUA_NATURE: [&str; 8] = [
    "地", // 坤
    "天", // 乾
    "泽", // 兑
    "火", // 离
    "雷", // 震
    "风", // 巽
    "水", // 坎
    "山", // 艮
];

/// 八卦五行属性（0=金, 1=木, 2=水, 3=火, 4=土）
pub const BAGUA_WUXING: [u8; 8] = [
    4, // 坤 - 土
    0, // 乾 - 金
    0, // 兑 - 金
    3, // 离 - 火
    1, // 震 - 木
    1, // 巽 - 木
    2, // 坎 - 水
    4, // 艮 - 土
];

/// 五行名称
pub const WUXING_NAMES: [&str; 5] = ["金", "木", "水", "火", "土"];

/// 六十四卦名称表
///
/// 按照上卦*8+下卦的顺序排列
/// 上卦索引：坤(0)、乾(1)、兑(2)、离(3)、震(4)、巽(5)、坎(6)、艮(7)
/// 下卦索引：坤(0)、乾(1)、兑(2)、离(3)、震(4)、巽(5)、坎(6)、艮(7)
pub const HEXAGRAM_NAMES: [&str; 64] = [
    // 上卦为坤 (0)
    "坤为地",     // 坤上坤下 0
    "地天泰",     // 坤上乾下 1
    "地泽临",     // 坤上兑下 2
    "地火明夷",   // 坤上离下 3
    "地雷复",     // 坤上震下 4
    "地风升",     // 坤上巽下 5
    "地水师",     // 坤上坎下 6
    "地山谦",     // 坤上艮下 7
    // 上卦为乾 (1)
    "天地否",     // 乾上坤下 8
    "乾为天",     // 乾上乾下 9
    "天泽履",     // 乾上兑下 10
    "天火同人",   // 乾上离下 11
    "天雷无妄",   // 乾上震下 12
    "天风姤",     // 乾上巽下 13
    "天水讼",     // 乾上坎下 14
    "天山遁",     // 乾上艮下 15
    // 上卦为兑 (2)
    "泽地萃",     // 兑上坤下 16
    "泽天夬",     // 兑上乾下 17
    "兑为泽",     // 兑上兑下 18
    "泽火革",     // 兑上离下 19
    "泽雷随",     // 兑上震下 20
    "泽风大过",   // 兑上巽下 21
    "泽水困",     // 兑上坎下 22
    "泽山咸",     // 兑上艮下 23
    // 上卦为离 (3)
    "火地晋",     // 离上坤下 24
    "火天大有",   // 离上乾下 25
    "火泽睽",     // 离上兑下 26
    "离为火",     // 离上离下 27
    "火雷噬嗑",   // 离上震下 28
    "火风鼎",     // 离上巽下 29
    "火水未济",   // 离上坎下 30
    "火山旅",     // 离上艮下 31
    // 上卦为震 (4)
    "雷地豫",     // 震上坤下 32
    "雷天大壮",   // 震上乾下 33
    "雷泽归妹",   // 震上兑下 34
    "雷火丰",     // 震上离下 35
    "震为雷",     // 震上震下 36
    "雷风恒",     // 震上巽下 37
    "雷水解",     // 震上坎下 38
    "雷山小过",   // 震上艮下 39
    // 上卦为巽 (5)
    "风地观",     // 巽上坤下 40
    "风天小畜",   // 巽上乾下 41
    "风泽中孚",   // 巽上兑下 42
    "风火家人",   // 巽上离下 43
    "风雷益",     // 巽上震下 44
    "巽为风",     // 巽上巽下 45
    "风水涣",     // 巽上坎下 46
    "风山渐",     // 巽上艮下 47
    // 上卦为坎 (6)
    "水地比",     // 坎上坤下 48
    "水天需",     // 坎上乾下 49
    "水泽节",     // 坎上兑下 50
    "水火既济",   // 坎上离下 51
    "水雷屯",     // 坎上震下 52
    "水风井",     // 坎上巽下 53
    "坎为水",     // 坎上坎下 54
    "水山蹇",     // 坎上艮下 55
    // 上卦为艮 (7)
    "山地剥",     // 艮上坤下 56
    "山天大畜",   // 艮上乾下 57
    "山泽损",     // 艮上兑下 58
    "山火贲",     // 艮上离下 59
    "山雷颐",     // 艮上震下 60
    "山风蛊",     // 艮上巽下 61
    "山水蒙",     // 艮上坎下 62
    "艮为山",     // 艮上艮下 63
];

/// 六十四卦卦辞（简短版）
///
/// 按照 HEXAGRAM_NAMES 相同的顺序排列
pub const HEXAGRAM_GUACI: [&str; 64] = [
    // 上卦为坤 (0)
    "元亨，利牝马之贞。君子有攸往，先迷后得主。",           // 坤为地
    "小往大来，吉亨。",                                     // 地天泰
    "元亨利贞。至于八月有凶。",                             // 地泽临
    "利艰贞。",                                             // 地火明夷
    "亨。出入无疾，朋来无咎。反复其道，七日来复。",         // 地雷复
    "元亨，用见大人，勿恤，南征吉。",                       // 地风升
    "贞，丈人吉，无咎。",                                   // 地水师
    "亨，君子有终。",                                       // 地山谦
    // 上卦为乾 (1)
    "否之匪人，不利君子贞。大往小来。",                     // 天地否
    "元亨利贞。",                                           // 乾为天
    "履虎尾，不咥人，亨。",                                 // 天泽履
    "同人于野，亨。利涉大川，利君子贞。",                   // 天火同人
    "元亨利贞。其匪正有眚，不利有攸往。",                   // 天雷无妄
    "女壮，勿用取女。",                                     // 天风姤
    "有孚，窒惕，中吉，终凶。利见大人，不利涉大川。",       // 天水讼
    "亨，小利贞。",                                         // 天山遁
    // 上卦为兑 (2)
    "亨，王假有庙，利见大人，亨，利贞。用大牲吉，利有攸往。", // 泽地萃
    "扬于王庭，孚号，有厉。告自邑，不利即戎，利有攸往。",   // 泽天夬
    "亨，利贞。",                                           // 兑为泽
    "元亨利贞。悔亡。",                                     // 泽火革
    "元亨利贞，无咎。",                                     // 泽雷随
    "栋桡，利有攸往，亨。",                                 // 泽风大过
    "亨，贞，大人吉，无咎，有言不信。",                     // 泽水困
    "亨，利贞，取女吉。",                                   // 泽山咸
    // 上卦为离 (3)
    "康侯用锡马蕃庶，昼日三接。",                           // 火地晋
    "元亨。",                                               // 火天大有
    "小事吉。",                                             // 火泽睽
    "利贞，亨。畜牝牛，吉。",                               // 离为火
    "亨，利用狱。",                                         // 火雷噬嗑
    "元吉，亨。",                                           // 火风鼎
    "亨，小狐汔济，濡其尾，无攸利。",                       // 火水未济
    "小亨，旅贞吉。",                                       // 火山旅
    // 上卦为震 (4)
    "利建侯行师。",                                         // 雷地豫
    "利贞。",                                               // 雷天大壮
    "征凶，无攸利。",                                       // 雷泽归妹
    "亨，王假之，勿忧，宜日中。",                           // 雷火丰
    "亨。震来虩虩，笑言哑哑。",                             // 震为雷
    "亨，无咎，利贞，利有攸往。",                           // 雷风恒
    "利西南，无所往，其来复吉。有攸往，夙吉。",             // 雷水解
    "亨，利贞。可小事，不可大事。",                         // 雷山小过
    // 上卦为巽 (5)
    "大观，盥而不荐，有孚顒若。",                           // 风地观
    "亨，密云不雨，自我西郊。",                             // 风天小畜
    "豚鱼吉，利涉大川，利贞。",                             // 风泽中孚
    "利女贞。",                                             // 风火家人
    "利有攸往，利涉大川。",                                 // 风雷益
    "小亨，利有攸往，利见大人。",                           // 巽为风
    "亨，王假有庙，利涉大川，利贞。",                       // 风水涣
    "女归吉，利贞。",                                       // 风山渐
    // 上卦为坎 (6)
    "吉。原筮元永贞，无咎。不宁方来，后夫凶。",             // 水地比
    "有孚，光亨，贞吉。利涉大川。",                         // 水天需
    "亨，苦节不可贞。",                                     // 水泽节
    "亨，小利贞。初吉终乱。",                               // 水火既济
    "元亨利贞，勿用，有攸往，利建侯。",                     // 水雷屯
    "改邑不改井，无丧无得，往来井井。",                     // 水风井
    "习坎，有孚，维心亨，行有尚。",                         // 坎为水
    "利西南，不利东北。利见大人，贞吉。",                   // 水山蹇
    // 上卦为艮 (7)
    "不利有攸往。",                                         // 山地剥
    "利贞，不家食吉，利涉大川。",                           // 山天大畜
    "有孚，元吉，无咎，可贞，利有攸往。",                   // 山泽损
    "亨，小利有攸往。",                                     // 山火贲
    "贞吉。观颐，自求口实。",                               // 山雷颐
    "元亨，利涉大川。先甲三日，后甲三日。",                 // 山风蛊
    "亨。匪我求童蒙，童蒙求我。初筮告，再三渎，渎则不告。", // 山水蒙
    "艮其背，不获其身，行其庭，不见其人，无咎。",           // 艮为山
];

/// 体用关系名称
pub const TIYONG_NAMES: [&str; 5] = [
    "比和",   // 同五行
    "用生体", // 大吉
    "体生用", // 小凶
    "用克体", // 大凶
    "体克用", // 中平
];

/// 吉凶等级名称
pub const FORTUNE_NAMES: [&str; 5] = [
    "大凶", // 0
    "小凶", // 1
    "平",   // 2
    "小吉", // 3
    "大吉", // 4
];

/// 十二地支名称
pub const DIZHI_NAMES: [&str; 12] = [
    "子", "丑", "寅", "卯", "辰", "巳",
    "午", "未", "申", "酉", "戌", "亥",
];

/// 十天干名称
pub const TIANGAN_NAMES: [&str; 10] = [
    "甲", "乙", "丙", "丁", "戊",
    "己", "庚", "辛", "壬", "癸",
];

/// 根据先天八卦数获取八卦名称
///
/// # 参数
/// - `num`: 先天八卦数 (0-8，其中0和8都是坤卦)
///
/// # 返回
/// - 八卦名称字符串
#[inline]
pub fn get_bagua_name(num: u8) -> &'static str {
    let idx = (num % 8) as usize;
    BAGUA_NAMES[idx]
}

/// 根据先天八卦数获取八卦符号
#[inline]
pub fn get_bagua_symbol(num: u8) -> &'static str {
    let idx = (num % 8) as usize;
    BAGUA_SYMBOLS[idx]
}

/// 获取六十四卦名称
///
/// # 参数
/// - `shang_num`: 上卦先天数 (0-7)
/// - `xia_num`: 下卦先天数 (0-7)
///
/// # 返回
/// - 六十四卦名称
#[inline]
pub fn get_hexagram_name(shang_num: u8, xia_num: u8) -> &'static str {
    let shang_idx = (shang_num % 8) as usize;
    let xia_idx = (xia_num % 8) as usize;
    let index = shang_idx * 8 + xia_idx;
    HEXAGRAM_NAMES[index]
}

/// 获取六十四卦卦辞
///
/// # 参数
/// - `shang_num`: 上卦先天数 (0-7)
/// - `xia_num`: 下卦先天数 (0-7)
///
/// # 返回
/// - 卦辞字符串
#[inline]
pub fn get_hexagram_guaci(shang_num: u8, xia_num: u8) -> &'static str {
    let shang_idx = (shang_num % 8) as usize;
    let xia_idx = (xia_num % 8) as usize;
    let index = shang_idx * 8 + xia_idx;
    HEXAGRAM_GUACI[index]
}

/// 将先天八卦数转换为内部索引
///
/// 先天八卦数：乾1、兑2、离3、震4、巽5、坎6、艮7、坤8/0
/// 内部索引：坤0、乾1、兑2、离3、震4、巽5、坎6、艮7
///
/// # 参数
/// - `num`: 先天八卦数 (1-8)
///
/// # 返回
/// - 内部索引 (0-7)
#[inline]
pub fn xiantian_to_index(num: u8) -> u8 {
    match num {
        1 => 1, // 乾
        2 => 2, // 兑
        3 => 3, // 离
        4 => 4, // 震
        5 => 5, // 巽
        6 => 6, // 坎
        7 => 7, // 艮
        _ => 0, // 坤 (0 或 8)
    }
}

/// 将内部索引转换为先天八卦数
///
/// # 参数
/// - `idx`: 内部索引 (0-7)
///
/// # 返回
/// - 先天八卦数 (1-8)
#[inline]
pub fn index_to_xiantian(idx: u8) -> u8 {
    match idx {
        0 => 8, // 坤
        1 => 1, // 乾
        2 => 2, // 兑
        3 => 3, // 离
        4 => 4, // 震
        5 => 5, // 巽
        6 => 6, // 坎
        7 => 7, // 艮
        _ => 8, // 默认坤
    }
}

/// 获取爻位名称
///
/// # 参数
/// - `yao`: 爻位 (1-6)
///
/// # 返回
/// - 爻位名称
#[inline]
pub fn get_yao_name(yao: u8) -> &'static str {
    match yao {
        1 => "初爻",
        2 => "二爻",
        3 => "三爻",
        4 => "四爻",
        5 => "五爻",
        6 => "上爻",
        _ => "未知",
    }
}

/// 获取时辰名称
///
/// # 参数
/// - `zhi_num`: 地支数 (1-12)
///
/// # 返回
/// - 时辰名称（如"子时"）
#[inline]
pub fn get_shichen_name(zhi_num: u8) -> &'static str {
    match zhi_num {
        1 => "子时",
        2 => "丑时",
        3 => "寅时",
        4 => "卯时",
        5 => "辰时",
        6 => "巳时",
        7 => "午时",
        8 => "未时",
        9 => "申时",
        10 => "酉时",
        11 => "戌时",
        12 => "亥时",
        _ => "未知",
    }
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_get_bagua_name() {
        assert_eq!(get_bagua_name(1), "乾");
        assert_eq!(get_bagua_name(2), "兑");
        assert_eq!(get_bagua_name(8), "坤");
        assert_eq!(get_bagua_name(0), "坤");
    }

    #[test]
    fn test_get_hexagram_name() {
        // 乾为天: 上卦乾(1)，下卦乾(1)
        assert_eq!(get_hexagram_name(1, 1), "乾为天");
        // 坤为地: 上卦坤(0)，下卦坤(0)
        assert_eq!(get_hexagram_name(0, 0), "坤为地");
        // 地天泰: 上卦坤(0)，下卦乾(1)
        assert_eq!(get_hexagram_name(0, 1), "地天泰");
        // 天地否: 上卦乾(1)，下卦坤(0)
        assert_eq!(get_hexagram_name(1, 0), "天地否");
    }

    #[test]
    fn test_xiantian_conversion() {
        // 测试先天数和索引的转换
        for num in 1..=8u8 {
            let idx = xiantian_to_index(num);
            let back = index_to_xiantian(idx);
            assert_eq!(num, back, "先天数 {} 转换失败", num);
        }
    }

    #[test]
    fn test_yao_names() {
        assert_eq!(get_yao_name(1), "初爻");
        assert_eq!(get_yao_name(6), "上爻");
    }

    #[test]
    fn test_shichen_names() {
        assert_eq!(get_shichen_name(1), "子时");
        assert_eq!(get_shichen_name(7), "午时");
        assert_eq!(get_shichen_name(12), "亥时");
    }
}
