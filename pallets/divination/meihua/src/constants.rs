//! 梅花易数静态常量数据模块
//!
//! 本模块包含梅花易数排盘系统所需的所有静态数据：
//! - 六十四卦名称表
//! - 八卦属性表
//! - 卦辞数据
//! - 爻辞数据

/// 八卦名称表（先天八卦数序）
///
/// 索引 0-7 对应坤(0/8)、乾(1)、兑(2)、离(3)、震(4)、巽(5)、坎(6)、艮(7)
pub const BAGUA_NAMES: [&str; 8] = [
    "坤", // 0 或 8
    "乾", // 1
    "兑", // 2
    "离", // 3
    "震", // 4
    "巽", // 5
    "坎", // 6
    "艮", // 7
];

/// 八卦 Unicode 符号
pub const BAGUA_SYMBOLS: [&str; 8] = [
    "☷", // 坤 0/8
    "☰", // 乾 1
    "☱", // 兑 2
    "☲", // 离 3
    "☳", // 震 4
    "☴", // 巽 5
    "☵", // 坎 6
    "☶", // 艮 7
];

/// 八卦自然象征
pub const BAGUA_NATURE: [&str; 8] = [
    "地", // 坤
    "天", // 乾
    "泽", // 兑
    "火", // 离
    "雷", // 震
    "风", // 巽
    "水", // 坎
    "山", // 艮
];

/// 八卦五行属性（0=金, 1=木, 2=水, 3=火, 4=土）
pub const BAGUA_WUXING: [u8; 8] = [
    4, // 坤 - 土
    0, // 乾 - 金
    0, // 兑 - 金
    3, // 离 - 火
    1, // 震 - 木
    1, // 巽 - 木
    2, // 坎 - 水
    4, // 艮 - 土
];

/// 五行名称
pub const WUXING_NAMES: [&str; 5] = ["金", "木", "水", "火", "土"];

/// 六十四卦名称表
///
/// 按照上卦*8+下卦的顺序排列
/// 上卦索引：坤(0)、乾(1)、兑(2)、离(3)、震(4)、巽(5)、坎(6)、艮(7)
/// 下卦索引：坤(0)、乾(1)、兑(2)、离(3)、震(4)、巽(5)、坎(6)、艮(7)
pub const HEXAGRAM_NAMES: [&str; 64] = [
    // 上卦为坤 (0)
    "坤为地",     // 坤上坤下 0
    "地天泰",     // 坤上乾下 1
    "地泽临",     // 坤上兑下 2
    "地火明夷",   // 坤上离下 3
    "地雷复",     // 坤上震下 4
    "地风升",     // 坤上巽下 5
    "地水师",     // 坤上坎下 6
    "地山谦",     // 坤上艮下 7
    // 上卦为乾 (1)
    "天地否",     // 乾上坤下 8
    "乾为天",     // 乾上乾下 9
    "天泽履",     // 乾上兑下 10
    "天火同人",   // 乾上离下 11
    "天雷无妄",   // 乾上震下 12
    "天风姤",     // 乾上巽下 13
    "天水讼",     // 乾上坎下 14
    "天山遁",     // 乾上艮下 15
    // 上卦为兑 (2)
    "泽地萃",     // 兑上坤下 16
    "泽天夬",     // 兑上乾下 17
    "兑为泽",     // 兑上兑下 18
    "泽火革",     // 兑上离下 19
    "泽雷随",     // 兑上震下 20
    "泽风大过",   // 兑上巽下 21
    "泽水困",     // 兑上坎下 22
    "泽山咸",     // 兑上艮下 23
    // 上卦为离 (3)
    "火地晋",     // 离上坤下 24
    "火天大有",   // 离上乾下 25
    "火泽睽",     // 离上兑下 26
    "离为火",     // 离上离下 27
    "火雷噬嗑",   // 离上震下 28
    "火风鼎",     // 离上巽下 29
    "火水未济",   // 离上坎下 30
    "火山旅",     // 离上艮下 31
    // 上卦为震 (4)
    "雷地豫",     // 震上坤下 32
    "雷天大壮",   // 震上乾下 33
    "雷泽归妹",   // 震上兑下 34
    "雷火丰",     // 震上离下 35
    "震为雷",     // 震上震下 36
    "雷风恒",     // 震上巽下 37
    "雷水解",     // 震上坎下 38
    "雷山小过",   // 震上艮下 39
    // 上卦为巽 (5)
    "风地观",     // 巽上坤下 40
    "风天小畜",   // 巽上乾下 41
    "风泽中孚",   // 巽上兑下 42
    "风火家人",   // 巽上离下 43
    "风雷益",     // 巽上震下 44
    "巽为风",     // 巽上巽下 45
    "风水涣",     // 巽上坎下 46
    "风山渐",     // 巽上艮下 47
    // 上卦为坎 (6)
    "水地比",     // 坎上坤下 48
    "水天需",     // 坎上乾下 49
    "水泽节",     // 坎上兑下 50
    "水火既济",   // 坎上离下 51
    "水雷屯",     // 坎上震下 52
    "水风井",     // 坎上巽下 53
    "坎为水",     // 坎上坎下 54
    "水山蹇",     // 坎上艮下 55
    // 上卦为艮 (7)
    "山地剥",     // 艮上坤下 56
    "山天大畜",   // 艮上乾下 57
    "山泽损",     // 艮上兑下 58
    "山火贲",     // 艮上离下 59
    "山雷颐",     // 艮上震下 60
    "山风蛊",     // 艮上巽下 61
    "山水蒙",     // 艮上坎下 62
    "艮为山",     // 艮上艮下 63
];

/// 六十四卦卦辞（简短版）
///
/// 按照 HEXAGRAM_NAMES 相同的顺序排列
pub const HEXAGRAM_GUACI: [&str; 64] = [
    // 上卦为坤 (0)
    "元亨，利牝马之贞。君子有攸往，先迷后得主。",           // 坤为地
    "小往大来，吉亨。",                                     // 地天泰
    "元亨利贞。至于八月有凶。",                             // 地泽临
    "利艰贞。",                                             // 地火明夷
    "亨。出入无疾，朋来无咎。反复其道，七日来复。",         // 地雷复
    "元亨，用见大人，勿恤，南征吉。",                       // 地风升
    "贞，丈人吉，无咎。",                                   // 地水师
    "亨，君子有终。",                                       // 地山谦
    // 上卦为乾 (1)
    "否之匪人，不利君子贞。大往小来。",                     // 天地否
    "元亨利贞。",                                           // 乾为天
    "履虎尾，不咥人，亨。",                                 // 天泽履
    "同人于野，亨。利涉大川，利君子贞。",                   // 天火同人
    "元亨利贞。其匪正有眚，不利有攸往。",                   // 天雷无妄
    "女壮，勿用取女。",                                     // 天风姤
    "有孚，窒惕，中吉，终凶。利见大人，不利涉大川。",       // 天水讼
    "亨，小利贞。",                                         // 天山遁
    // 上卦为兑 (2)
    "亨，王假有庙，利见大人，亨，利贞。用大牲吉，利有攸往。", // 泽地萃
    "扬于王庭，孚号，有厉。告自邑，不利即戎，利有攸往。",   // 泽天夬
    "亨，利贞。",                                           // 兑为泽
    "元亨利贞。悔亡。",                                     // 泽火革
    "元亨利贞，无咎。",                                     // 泽雷随
    "栋桡，利有攸往，亨。",                                 // 泽风大过
    "亨，贞，大人吉，无咎，有言不信。",                     // 泽水困
    "亨，利贞，取女吉。",                                   // 泽山咸
    // 上卦为离 (3)
    "康侯用锡马蕃庶，昼日三接。",                           // 火地晋
    "元亨。",                                               // 火天大有
    "小事吉。",                                             // 火泽睽
    "利贞，亨。畜牝牛，吉。",                               // 离为火
    "亨，利用狱。",                                         // 火雷噬嗑
    "元吉，亨。",                                           // 火风鼎
    "亨，小狐汔济，濡其尾，无攸利。",                       // 火水未济
    "小亨，旅贞吉。",                                       // 火山旅
    // 上卦为震 (4)
    "利建侯行师。",                                         // 雷地豫
    "利贞。",                                               // 雷天大壮
    "征凶，无攸利。",                                       // 雷泽归妹
    "亨，王假之，勿忧，宜日中。",                           // 雷火丰
    "亨。震来虩虩，笑言哑哑。",                             // 震为雷
    "亨，无咎，利贞，利有攸往。",                           // 雷风恒
    "利西南，无所往，其来复吉。有攸往，夙吉。",             // 雷水解
    "亨，利贞。可小事，不可大事。",                         // 雷山小过
    // 上卦为巽 (5)
    "大观，盥而不荐，有孚顒若。",                           // 风地观
    "亨，密云不雨，自我西郊。",                             // 风天小畜
    "豚鱼吉，利涉大川，利贞。",                             // 风泽中孚
    "利女贞。",                                             // 风火家人
    "利有攸往，利涉大川。",                                 // 风雷益
    "小亨，利有攸往，利见大人。",                           // 巽为风
    "亨，王假有庙，利涉大川，利贞。",                       // 风水涣
    "女归吉，利贞。",                                       // 风山渐
    // 上卦为坎 (6)
    "吉。原筮元永贞，无咎。不宁方来，后夫凶。",             // 水地比
    "有孚，光亨，贞吉。利涉大川。",                         // 水天需
    "亨，苦节不可贞。",                                     // 水泽节
    "亨，小利贞。初吉终乱。",                               // 水火既济
    "元亨利贞，勿用，有攸往，利建侯。",                     // 水雷屯
    "改邑不改井，无丧无得，往来井井。",                     // 水风井
    "习坎，有孚，维心亨，行有尚。",                         // 坎为水
    "利西南，不利东北。利见大人，贞吉。",                   // 水山蹇
    // 上卦为艮 (7)
    "不利有攸往。",                                         // 山地剥
    "利贞，不家食吉，利涉大川。",                           // 山天大畜
    "有孚，元吉，无咎，可贞，利有攸往。",                   // 山泽损
    "亨，小利有攸往。",                                     // 山火贲
    "贞吉。观颐，自求口实。",                               // 山雷颐
    "元亨，利涉大川。先甲三日，后甲三日。",                 // 山风蛊
    "亨。匪我求童蒙，童蒙求我。初筮告，再三渎，渎则不告。", // 山水蒙
    "艮其背，不获其身，行其庭，不见其人，无咎。",           // 艮为山
];

/// 体用关系名称
pub const TIYONG_NAMES: [&str; 5] = [
    "比和",   // 同五行
    "用生体", // 大吉
    "体生用", // 小凶
    "用克体", // 大凶
    "体克用", // 中平
];

/// 吉凶等级名称
pub const FORTUNE_NAMES: [&str; 5] = [
    "大凶", // 0
    "小凶", // 1
    "平",   // 2
    "小吉", // 3
    "大吉", // 4
];

/// 十二地支名称
pub const DIZHI_NAMES: [&str; 12] = [
    "子", "丑", "寅", "卯", "辰", "巳",
    "午", "未", "申", "酉", "戌", "亥",
];

/// 十天干名称
pub const TIANGAN_NAMES: [&str; 10] = [
    "甲", "乙", "丙", "丁", "戊",
    "己", "庚", "辛", "壬", "癸",
];

/// 根据先天八卦数获取八卦名称
///
/// # 参数
/// - `num`: 先天八卦数 (0-8，其中0和8都是坤卦)
///
/// # 返回
/// - 八卦名称字符串
#[inline]
pub fn get_bagua_name(num: u8) -> &'static str {
    let idx = (num % 8) as usize;
    BAGUA_NAMES[idx]
}

/// 根据先天八卦数获取八卦符号
#[inline]
pub fn get_bagua_symbol(num: u8) -> &'static str {
    let idx = (num % 8) as usize;
    BAGUA_SYMBOLS[idx]
}

/// 获取六十四卦名称
///
/// # 参数
/// - `shang_num`: 上卦先天数 (0-7)
/// - `xia_num`: 下卦先天数 (0-7)
///
/// # 返回
/// - 六十四卦名称
#[inline]
pub fn get_hexagram_name(shang_num: u8, xia_num: u8) -> &'static str {
    let shang_idx = (shang_num % 8) as usize;
    let xia_idx = (xia_num % 8) as usize;
    let index = shang_idx * 8 + xia_idx;
    HEXAGRAM_NAMES[index]
}

/// 获取六十四卦卦辞
///
/// # 参数
/// - `shang_num`: 上卦先天数 (0-7)
/// - `xia_num`: 下卦先天数 (0-7)
///
/// # 返回
/// - 卦辞字符串
#[inline]
pub fn get_hexagram_guaci(shang_num: u8, xia_num: u8) -> &'static str {
    let shang_idx = (shang_num % 8) as usize;
    let xia_idx = (xia_num % 8) as usize;
    let index = shang_idx * 8 + xia_idx;
    HEXAGRAM_GUACI[index]
}

/// 将先天八卦数转换为内部索引
///
/// 先天八卦数：乾1、兑2、离3、震4、巽5、坎6、艮7、坤8/0
/// 内部索引：坤0、乾1、兑2、离3、震4、巽5、坎6、艮7
///
/// # 参数
/// - `num`: 先天八卦数 (1-8)
///
/// # 返回
/// - 内部索引 (0-7)
#[inline]
pub fn xiantian_to_index(num: u8) -> u8 {
    match num {
        1 => 1, // 乾
        2 => 2, // 兑
        3 => 3, // 离
        4 => 4, // 震
        5 => 5, // 巽
        6 => 6, // 坎
        7 => 7, // 艮
        _ => 0, // 坤 (0 或 8)
    }
}

/// 将内部索引转换为先天八卦数
///
/// # 参数
/// - `idx`: 内部索引 (0-7)
///
/// # 返回
/// - 先天八卦数 (1-8)
#[inline]
pub fn index_to_xiantian(idx: u8) -> u8 {
    match idx {
        0 => 8, // 坤
        1 => 1, // 乾
        2 => 2, // 兑
        3 => 3, // 离
        4 => 4, // 震
        5 => 5, // 巽
        6 => 6, // 坎
        7 => 7, // 艮
        _ => 8, // 默认坤
    }
}

/// 获取爻位名称
///
/// # 参数
/// - `yao`: 爻位 (1-6)
///
/// # 返回
/// - 爻位名称
#[inline]
pub fn get_yao_name(yao: u8) -> &'static str {
    match yao {
        1 => "初爻",
        2 => "二爻",
        3 => "三爻",
        4 => "四爻",
        5 => "五爻",
        6 => "上爻",
        _ => "未知",
    }
}

/// 获取时辰名称
///
/// # 参数
/// - `zhi_num`: 地支数 (1-12)
///
/// # 返回
/// - 时辰名称（如"子时"）
#[inline]
pub fn get_shichen_name(zhi_num: u8) -> &'static str {
    match zhi_num {
        1 => "子时",
        2 => "丑时",
        3 => "寅时",
        4 => "卯时",
        5 => "辰时",
        6 => "巳时",
        7 => "午时",
        8 => "未时",
        9 => "申时",
        10 => "酉时",
        11 => "戌时",
        12 => "亥时",
        _ => "未知",
    }
}

/// 六十四卦爻辞数据
///
/// 每个卦有6个爻辞，按初爻到上爻顺序排列
/// 索引与 HEXAGRAM_NAMES 相同
pub const HEXAGRAM_YAOCI: [[&str; 6]; 64] = [
    // 坤为地 (0)
    [
        "履霜坚冰至。",
        "直方大，不习，无不利。",
        "含章可贞，或从王事，无成有终。",
        "括囊，无咎无誉。",
        "黄裳元吉。",
        "龙战于野，其血玄黄。",
    ],
    // 地天泰 (1)
    [
        "拔茅茹，以其汇，征吉。",
        "包荒，用冯河，不遐遗。朋亡，得尚于中行。",
        "无平不陂，无往不复，艰贞无咎。勿恤其孚，于食有福。",
        "翩翩，不富以其邻，不戒以孚。",
        "帝乙归妹，以祉元吉。",
        "城复于隍，勿用师。自邑告命，贞吝。",
    ],
    // 地泽临 (2)
    [
        "咸临，贞吉。",
        "咸临，吉无不利。",
        "甘临，无攸利。既忧之，无咎。",
        "至临，无咎。",
        "知临，大君之宜，吉。",
        "敦临，吉，无咎。",
    ],
    // 地火明夷 (3)
    [
        "明夷于飞，垂其翼。君子于行，三日不食，有攸往，主人有言。",
        "明夷，夷于左股，用拯马壮，吉。",
        "明夷于南狩，得其大首。不可疾贞。",
        "入于左腹，获明夷之心，出于门庭。",
        "箕子之明夷，利贞。",
        "不明晦，初登于天，后入于地。",
    ],
    // 地雷复 (4)
    [
        "不远复，无祗悔，元吉。",
        "休复，吉。",
        "频复，厉，无咎。",
        "中行独复。",
        "敦复，无悔。",
        "迷复，凶，有灾眚。用行师，终以大败。以其国君凶，至于十年不克征。",
    ],
    // 地风升 (5)
    [
        "允升，大吉。",
        "孚乃利用禴，无咎。",
        "升虚邑。",
        "王用亨于岐山，吉，无咎。",
        "贞吉，升阶。",
        "冥升，利于不息之贞。",
    ],
    // 地水师 (6)
    [
        "师出以律，否臧凶。",
        "在师，中吉，无咎，王三锡命。",
        "师或舆尸，凶。",
        "师左次，无咎。",
        "田有禽，利执言，无咎。长子帅师，弟子舆尸。贞凶。",
        "大君有命，开国承家，小人勿用。",
    ],
    // 地山谦 (7)
    [
        "谦谦君子，用涉大川，吉。",
        "鸣谦，贞吉。",
        "劳谦，君子有终，吉。",
        "无不利，㧑谦。",
        "不富以其邻，利用侵伐，无不利。",
        "鸣谦，利用行师，征邑国。",
    ],
    // 天地否 (8)
    [
        "拔茅茹，以其汇，贞吉，亨。",
        "包承，小人吉，大人否，亨。",
        "包羞。",
        "有命无咎，畴离祉。",
        "休否，大人吉，其亡其亡，系于苞桑。",
        "倾否，先否后喜。",
    ],
    // 乾为天 (9)
    [
        "潜龙勿用。",
        "见龙在田，利见大人。",
        "君子终日乾乾，夕惕若厉，无咎。",
        "或跃在渊，无咎。",
        "飞龙在天，利见大人。",
        "亢龙有悔。",
    ],
    // 天泽履 (10)
    [
        "素履，往无咎。",
        "履道坦坦，幽人贞吉。",
        "眇能视，跛能履，履虎尾，咥人，凶。武人为于大君。",
        "履虎尾，愬愬，终吉。",
        "夬履，贞厉。",
        "视履考祥，其旋元吉。",
    ],
    // 天火同人 (11)
    [
        "同人于门，无咎。",
        "同人于宗，吝。",
        "伏戎于莽，升其高陵，三岁不兴。",
        "乘其墉。弗克攻。吉。",
        "同人，先号啕而后笑，大师克，相遇。",
        "同人于郊，无悔。",
    ],
    // 天雷无妄 (12)
    [
        "无妄，往吉。",
        "不耕获，不菑畲，则利有攸往。",
        "无妄之灾，或系之牛，行人之得，邑人之灾。",
        "可贞，无咎。",
        "无妄之疾，勿药有喜。",
        "无妄，行有眚，无攸利。",
    ],
    // 天风姤 (13)
    [
        "系于金柅，贞吉。有攸往，见凶，羸豕孚蹢躅。",
        "包有鱼，无咎，不利宾。",
        "臀无肤，其行次且，厉，无大咎。",
        "包无鱼，起凶。",
        "以杞包瓜，含章，有陨自天。",
        "姤其角，吝，无咎。",
    ],
    // 天水讼 (14)
    [
        "不永所事，小有言，终吉。",
        "不克讼，归而逋。其邑人三百户，无眚。",
        "食旧德，贞厉，终吉。或从王事，无成。",
        "不克讼，复既命，渝，安贞吉。",
        "讼元，吉。",
        "或锡之鞶带，终朝三褫之。",
    ],
    // 天山遁 (15)
    [
        "遁尾，厉，勿用有攸往。",
        "执之，用黄牛之革，莫之胜说。",
        "系遁，有疾厉。畜臣妾，吉。",
        "好遁，君子吉，小人否。",
        "嘉遁，贞吉。",
        "肥遁，无不利。",
    ],
    // 泽地萃 (16)
    [
        "有孚不终，乃乱乃萃。若号，一握为笑，勿恤，往无咎。",
        "引吉，无咎。孚乃利用禴。",
        "萃如嗟如，无攸利。往无咎，小吝。",
        "大吉，无咎。",
        "萃有位，无咎。匪孚，元永贞，悔亡。",
        "赍咨涕洟，无咎。",
    ],
    // 泽天夬 (17)
    [
        "壮于前趾，往不胜，为咎。",
        "惕号，莫夜有戎，勿恤。",
        "壮于頄，有凶。君子夬夬，独行遇雨，若濡有愠，无咎。",
        "臀无肤，其行次且。牵羊悔亡，闻言不信。",
        "苋陆夬夬，中行无咎。",
        "无号，终有凶。",
    ],
    // 兑为泽 (18)
    [
        "和兑，吉。",
        "孚兑，吉，悔亡。",
        "来兑，凶。",
        "商兑未宁，介疾有喜。",
        "孚于剥，有厉。",
        "引兑。",
    ],
    // 泽火革 (19)
    [
        "巩用黄牛之革。",
        "巳日乃革之，征吉，无咎。",
        "征凶，贞厉。革言三就，有孚。",
        "悔亡，有孚改命，吉。",
        "大人虎变，未占有孚。",
        "君子豹变，小人革面，征凶，居贞吉。",
    ],
    // 泽雷随 (20)
    [
        "官有渝，贞吉。出门交有功。",
        "系小子，失丈夫。",
        "系丈夫，失小子，随有求，得，利居贞。",
        "随有获，贞凶。有孚在道以明，何咎？",
        "孚于嘉，吉。",
        "拘系之，乃从维之，王用亨于西山。",
    ],
    // 泽风大过 (21)
    [
        "藉用白茅，无咎。",
        "枯杨生稊，老夫得其女妻，无不利。",
        "栋桡，凶。",
        "栋隆，吉，有它吝。",
        "枯杨生华，老妇得其士夫，无咎无誉。",
        "过涉灭顶，凶，无咎。",
    ],
    // 泽水困 (22)
    [
        "臀困于株木，入于幽谷，三岁不觌。",
        "困于酒食，朱绂方来，利用享祀。征凶，无咎。",
        "困于石，据于蒺藜，入于其宫，不见其妻，凶。",
        "来徐徐，困于金车，吝，有终。",
        "劓刖，困于赤绂；乃徐有说，利用祭祀。",
        "困于葛藟，于臲卼，曰动悔。有悔，征吉。",
    ],
    // 泽山咸 (23)
    [
        "咸其拇。",
        "咸其腓，凶。居吉。",
        "咸其股，执其随，往吝。",
        "贞吉。悔亡。憧憧往来，朋从尔思。",
        "咸其脢，无悔。",
        "咸其辅颊舌。",
    ],
    // 火地晋 (24)
    [
        "晋如，摧如，贞吉。罔孚，裕无咎。",
        "晋如愁如，贞吉。受兹介福，于其王母。",
        "众允，悔亡。",
        "晋如鼫鼠，贞厉。",
        "悔亡，失得勿恤。往吉，无不利。",
        "晋其角，维用伐邑，厉吉，无咎。贞吝。",
    ],
    // 火天大有 (25)
    [
        "无交害，匪咎，艰则无咎。",
        "大车以载，有攸往，无咎。",
        "公用亨于天子，小人弗克。",
        "匪其彭，无咎。",
        "厥孚交如，威如，吉。",
        "自天佑之，吉无不利。",
    ],
    // 火泽睽 (26)
    [
        "悔亡；丧马勿逐，自复。见恶人，无咎。",
        "遇主于巷，无咎。",
        "见舆曳，其牛掣，其人天且劓。无初有终。",
        "睽孤，遇元夫，交孚，厉无咎。",
        "悔亡，厥宗噬肤，往何咎？",
        "睽孤，见豕负涂，载鬼一车。先张之弧，后说之弧。匪寇，婚媾，往遇雨则吉。",
    ],
    // 离为火 (27)
    [
        "履错，然，敬之，无咎。",
        "黄离，元吉。",
        "日昃之离，不鼓缶而歌，则大耋之嗟，凶。",
        "突如其来如，焚如，死如，弃如。",
        "出涕沱若，戚嗟若，吉。",
        "王用出征，有嘉折首，获匪其丑，无咎。",
    ],
    // 火雷噬嗑 (28)
    [
        "屦校灭趾，无咎。",
        "噬肤，灭鼻，无咎。",
        "噬腊肉，遇毒；小吝，无咎。",
        "噬干胏，得金矢，利艰贞，吉。",
        "噬干肉，得黄金，贞厉，无咎。",
        "何校灭耳，凶。",
    ],
    // 火风鼎 (29)
    [
        "鼎颠趾，利出否。得妾以其子，无咎。",
        "鼎有实，我仇有疾，不我能即，吉。",
        "鼎耳革，其行塞，雉膏不食。方雨亏悔，终吉。",
        "鼎折足，覆公餗，其形渥，凶。",
        "鼎黄耳金铉，利贞。",
        "鼎玉铉，大吉，无不利。",
    ],
    // 火水未济 (30)
    [
        "濡其尾，吝。",
        "曳其轮，贞吉。",
        "未济，征凶，利涉大川。",
        "贞吉，悔亡，震用伐鬼方，三年有赏于大国。",
        "贞吉，无悔，君子之光，有孚吉。",
        "有孚于饮酒，无咎。濡其首，有孚失是。",
    ],
    // 火山旅 (31)
    [
        "旅琐琐，斯其所取灾。",
        "旅即次，怀其资，得童仆贞。",
        "旅焚其次，丧其童仆，贞厉。",
        "旅于处，得其资斧，我心不快。",
        "射雉，一矢亡，终以誉命。",
        "鸟焚其巢，旅人先笑后号啕。丧牛于易，凶。",
    ],
    // 雷地豫 (32)
    [
        "鸣豫，凶。",
        "介于石，不终日，贞吉。",
        "盱豫，悔。迟，有悔。",
        "由豫，大有得。勿疑，朋盍簪。",
        "贞疾，恒不死。",
        "冥豫，成有渝，无咎。",
    ],
    // 雷天大壮 (33)
    [
        "壮于趾，征凶，有孚。",
        "贞吉。",
        "小人用壮，君子用罔，贞厉。羝羊触藩，羸其角。",
        "贞吉，悔亡。藩决不羸，壮于大舆之輹。",
        "丧羊于易，无悔。",
        "羝羊触藩，不能退，不能遂，无攸利。艰则吉。",
    ],
    // 雷泽归妹 (34)
    [
        "归妹以娣，跛能履，征吉。",
        "眇能视，利幽人之贞。",
        "归妹以须，反归以娣。",
        "归妹愆期，迟归有时。",
        "帝乙归妹，其君之袂，不如其娣之袂良。月几望，吉。",
        "女承筐无实，士刲羊无血，无攸利。",
    ],
    // 雷火丰 (35)
    [
        "遇其配主，虽旬无咎，往有尚。",
        "丰其蔀，日中见斗，往得疑疾。有孚发若，吉。",
        "丰其沛，日中见沬，折其右肱，无咎。",
        "丰其蔀，日中见斗，遇其夷主，吉。",
        "来章，有庆誉，吉。",
        "丰其屋，蔀其家，闚其户，阒其无人，三岁不觌，凶。",
    ],
    // 震为雷 (36)
    [
        "震来虩虩，后笑言哑哑，吉。",
        "震来厉，亿丧贝，跻于九陵，勿逐，七日得。",
        "震苏苏，震行无眚。",
        "震遂泥。",
        "震往来厉，意无丧有事。",
        "震索索，视矍矍，征凶。震不于其躬，于其邻，无咎。婚媾有言。",
    ],
    // 雷风恒 (37)
    [
        "浚恒，贞凶，无攸利。",
        "悔亡。",
        "不恒其德，或承之羞；贞吝。",
        "田无禽。",
        "恒其德，贞。妇人吉，夫子凶。",
        "振恒，凶。",
    ],
    // 雷水解 (38)
    [
        "无咎。",
        "田获三狐，得黄矢，贞吉。",
        "负且乘，致寇至，贞吝。",
        "解而拇，朋至斯孚。",
        "君子维有解，吉。有孚于小人。",
        "公用射隼于高墉之上，获之，无不利。",
    ],
    // 雷山小过 (39)
    [
        "飞鸟以凶。",
        "过其祖，遇其妣，不及其君，遇其臣，无咎。",
        "弗过防之，从或戕之，凶。",
        "无咎，弗过遇之，往厉必戒，勿用永贞。",
        "密云不雨，自我西郊，公弋取彼在穴。",
        "弗遇过之，飞鸟离之，凶，是谓灾眚。",
    ],
    // 风地观 (40)
    [
        "童观，小人无咎，君子吝。",
        "窥观，利女贞。",
        "观我生，进退。",
        "观国之光，利用宾于王。",
        "观我生，君子无咎。",
        "观其生，君子无咎。",
    ],
    // 风天小畜 (41)
    [
        "复自道，何其咎？吉。",
        "牵复，吉。",
        "舆说辐，夫妻反目。",
        "有孚，血去惕出，无咎。",
        "有孚挛如，富以其邻。",
        "既雨既处，尚德载。妇贞厉，月几望。君子征凶。",
    ],
    // 风泽中孚 (42)
    [
        "虞吉，有它不燕。",
        "鹤鸣在阴，其子和之。我有好爵，吾与尔靡之。",
        "得敌，或鼓或罢，或泣或歌。",
        "月几望，马匹亡，无咎。",
        "有孚挛如，无咎。",
        "翰音登于天，贞凶。",
    ],
    // 风火家人 (43)
    [
        "闲有家，悔亡。",
        "无攸遂，在中馈，贞吉。",
        "家人嗃嗃，悔厉，吉。妇子嘻嘻，终吝。",
        "富家，大吉。",
        "王假有家，勿恤，吉。",
        "有孚，威如，终吉。",
    ],
    // 风雷益 (44)
    [
        "利用为大作，元吉，无咎。",
        "或益之十朋之龟，弗克违，永贞吉。王用享于帝，吉。",
        "益之用凶事，无咎。有孚中行，告公用圭。",
        "中行，告公从，利用为依迁国。",
        "有孚惠心，勿问，元吉。有孚惠我德。",
        "莫益之，或击之，立心勿恒，凶。",
    ],
    // 巽为风 (45)
    [
        "进退，利武人之贞。",
        "巽在床下，用史巫纷若，吉，无咎。",
        "频巽，吝。",
        "悔亡，田获三品。",
        "贞吉，悔亡，无不利。无初有终。先庚三日，后庚三日，吉。",
        "巽在床下，丧其资斧，贞凶。",
    ],
    // 风水涣 (46)
    [
        "用拯马壮，吉。",
        "涣奔其机，悔亡。",
        "涣其躬，无悔。",
        "涣其群，元吉。涣有丘，匪夷所思。",
        "涣汗其大号，涣王居，无咎。",
        "涣其血，去逖出，无咎。",
    ],
    // 风山渐 (47)
    [
        "鸿渐于干，小子厉，有言，无咎。",
        "鸿渐于磐，饮食衎衎，吉。",
        "鸿渐于陆，夫征不复，妇孕不育，凶。利御寇。",
        "鸿渐于木，或得其桷，无咎。",
        "鸿渐于陵，妇三岁不孕，终莫之胜，吉。",
        "鸿渐于陆，其羽可用为仪，吉。",
    ],
    // 水地比 (48)
    [
        "有孚比之，无咎。有孚盈缶，终来有它吉。",
        "比之自内，贞吉。",
        "比之匪人。",
        "外比之，贞吉。",
        "显比，王用三驱，失前禽，邑人不诫，吉。",
        "比之无首，凶。",
    ],
    // 水天需 (49)
    [
        "需于郊，利用恒，无咎。",
        "需于沙，小有言，终吉。",
        "需于泥，致寇至。",
        "需于血，出自穴。",
        "需于酒食，贞吉。",
        "入于穴，有不速之客三人来，敬之，终吉。",
    ],
    // 水泽节 (50)
    [
        "不出户庭，无咎。",
        "不出门庭，凶。",
        "不节若，则嗟若，无咎。",
        "安节，亨。",
        "甘节，吉。往有尚。",
        "苦节，贞凶，悔亡。",
    ],
    // 水火既济 (51)
    [
        "曳其轮，濡其尾，无咎。",
        "妇丧其茀，勿逐，七日得。",
        "高宗伐鬼方，三年克之，小人勿用。",
        "繻有衣袽，终日戒。",
        "东邻杀牛，不如西郊之禴祭，实受其福。",
        "濡其首，厉。",
    ],
    // 水雷屯 (52)
    [
        "磐桓，利居贞，利建侯。",
        "屯如邅如，乘马班如。匪寇，婚媾。女子贞不字，十年乃字。",
        "即鹿无虞，惟入于林中。君子几，不如舍，往吝。",
        "乘马班如，求婚媾，往吉，无不利。",
        "屯其膏，小贞吉，大贞凶。",
        "乘马班如，泣血涟如。",
    ],
    // 水风井 (53)
    [
        "井泥不食，旧井无禽。",
        "井谷射鲋，瓮敝漏。",
        "井渫不食，为我心恻。可用汲，王明并受其福。",
        "井甃，无咎。",
        "井冽，寒泉食。",
        "井收，勿幕。有孚，元吉。",
    ],
    // 坎为水 (54)
    [
        "习坎，入于坎窞，凶。",
        "坎有险，求小得。",
        "来之坎坎，险且枕。入于坎窞，勿用。",
        "樽酒，簋贰，用缶，纳约自牖，终无咎。",
        "坎不盈，祗既平，无咎。",
        "系用徽纆，置于丛棘，三岁不得，凶。",
    ],
    // 水山蹇 (55)
    [
        "往蹇，来誉。",
        "王臣蹇蹇，匪躬之故。",
        "往蹇，来反。",
        "往蹇，来连。",
        "大蹇，朋来。",
        "往蹇，来硕。吉，利见大人。",
    ],
    // 山地剥 (56)
    [
        "剥床以足，蔑贞凶。",
        "剥床以辨，蔑贞凶。",
        "剥之，无咎。",
        "剥床以肤，凶。",
        "贯鱼，以宫人宠，无不利。",
        "硕果不食，君子得舆，小人剥庐。",
    ],
    // 山天大畜 (57)
    [
        "有厉，利已。",
        "舆说輹。",
        "良马逐，利艰贞。日闲舆卫，利有攸往。",
        "童牛之牿，元吉。",
        "豶豕之牙，吉。",
        "何天之衢，亨。",
    ],
    // 山泽损 (58)
    [
        "已事遄往，无咎，酌损之。",
        "利贞，征凶。弗损，益之。",
        "三人行，则损一人。一人行，则得其友。",
        "损其疾，使遄有喜，无咎。",
        "或益之十朋之龟，弗克违，元吉。",
        "弗损益之，无咎，贞吉，利有攸往。得臣无家。",
    ],
    // 山火贲 (59)
    [
        "贲其趾，舍车而徒。",
        "贲其须。",
        "贲如濡如，永贞吉。",
        "贲如皤如，白马翰如。匪寇，婚媾。",
        "贲于丘园，束帛戋戋。吝，终吉。",
        "白贲，无咎。",
    ],
    // 山雷颐 (60)
    [
        "舍尔灵龟，观我朵颐，凶。",
        "颠颐，拂经于丘颐，征凶。",
        "拂颐，贞凶。十年勿用，无攸利。",
        "颠颐，吉。虎视眈眈，其欲逐逐，无咎。",
        "拂经，居贞吉，不可涉大川。",
        "由颐，厉吉。利涉大川。",
    ],
    // 山风蛊 (61)
    [
        "干父之蛊，有子，考无咎，厉终吉。",
        "干母之蛊，不可贞。",
        "干父之蛊，小有晦，无大咎。",
        "裕父之蛊，往见吝。",
        "干父之蛊，用誉。",
        "不事王侯，高尚其事。",
    ],
    // 山水蒙 (62)
    [
        "发蒙，利用刑人，用说桎梏。以往吝。",
        "包蒙，吉。纳妇，吉。子克家。",
        "勿用取女，见金夫，不有躬，无攸利。",
        "困蒙，吝。",
        "童蒙，吉。",
        "击蒙，不利为寇，利御寇。",
    ],
    // 艮为山 (63)
    [
        "艮其趾，无咎，利永贞。",
        "艮其腓，不拯其随，其心不快。",
        "艮其限，列其夤，厉熏心。",
        "艮其身，无咎。",
        "艮其辅，言有序，悔亡。",
        "敦艮，吉。",
    ],
];

/// 爻名数据（根据阴阳爻性质）
///
/// 阳爻用"九"，阴爻用"六"
pub const YAO_MING_YANG: [&str; 6] = ["初九", "九二", "九三", "九四", "九五", "上九"];
pub const YAO_MING_YIN: [&str; 6] = ["初六", "六二", "六三", "六四", "六五", "上六"];

/// 获取爻辞
///
/// # 参数
/// - `shang_num`: 上卦先天数 (0-7)
/// - `xia_num`: 下卦先天数 (0-7)
/// - `yao`: 爻位 (1-6)
///
/// # 返回
/// - 爻辞字符串
#[inline]
pub fn get_yaoci(shang_num: u8, xia_num: u8, yao: u8) -> &'static str {
    let shang_idx = (shang_num % 8) as usize;
    let xia_idx = (xia_num % 8) as usize;
    let index = shang_idx * 8 + xia_idx;
    let yao_idx = if yao >= 1 && yao <= 6 {
        (yao - 1) as usize
    } else {
        0
    };
    HEXAGRAM_YAOCI[index][yao_idx]
}

/// 伏卦（飞伏神）数据表
///
/// 伏卦是八纯卦（乾、兑、离、震、巽、坎、艮、坤）对应的伏神所在卦位
/// 伏卦规则：
/// - 乾(111)的伏卦是巽(110) - 初爻变
/// - 兑(011)的伏卦是艮(100) - 错卦
/// - 离(101)的伏卦是坎(010) - 错卦
/// - 震(001)的伏卦是巽(110) - 错卦
/// - 巽(110)的伏卦是震(001) - 错卦
/// - 坎(010)的伏卦是离(101) - 错卦
/// - 艮(100)的伏卦是兑(011) - 错卦
/// - 坤(000)的伏卦是乾(111) - 错卦
///
/// 索引顺序：坤(0)、乾(1)、兑(2)、离(3)、震(4)、巽(5)、坎(6)、艮(7)
/// 值为伏卦的先天八卦数（用于 from_num 创建）
pub const FU_GUA_MAP: [u8; 8] = [
    1, // 坤(0/8) → 乾(1)
    5, // 乾(1) → 巽(5)
    7, // 兑(2) → 艮(7)
    6, // 离(3) → 坎(6)
    5, // 震(4) → 巽(5)
    4, // 巽(5) → 震(4)
    3, // 坎(6) → 离(3)
    2, // 艮(7) → 兑(2)
];

/// 获取单卦的伏卦先天数
///
/// # 参数
/// - `gua_num`: 先天八卦数 (1-8，0和8都是坤)
///
/// # 返回
/// - 伏卦的先天八卦数 (1-8)
#[inline]
pub fn get_fu_gua_num(gua_num: u8) -> u8 {
    let idx = (gua_num % 8) as usize;
    FU_GUA_MAP[idx]
}

/// 纳音五行对照表（六十甲子纳音）
///
/// 六十甲子按顺序排列，每两个干支对应一个纳音五行
/// 0-9:甲子乙丑海中金, 10-19:丙寅丁卯炉中火, ...
/// 五行编码：0=金, 1=木, 2=水, 3=火, 4=土
pub const NA_YIN: [(&str, u8); 30] = [
    ("海中金", 0),   // 甲子、乙丑
    ("炉中火", 3),   // 丙寅、丁卯
    ("大林木", 1),   // 戊辰、己巳
    ("路旁土", 4),   // 庚午、辛未
    ("剑锋金", 0),   // 壬申、癸酉
    ("山头火", 3),   // 甲戌、乙亥
    ("涧下水", 2),   // 丙子、丁丑
    ("城头土", 4),   // 戊寅、己卯
    ("白蜡金", 0),   // 庚辰、辛巳
    ("杨柳木", 1),   // 壬午、癸未
    ("泉中水", 2),   // 甲申、乙酉
    ("屋上土", 4),   // 丙戌、丁亥
    ("霹雳火", 3),   // 戊子、己丑
    ("松柏木", 1),   // 庚寅、辛卯
    ("长流水", 2),   // 壬辰、癸巳
    ("沙中金", 0),   // 甲午、乙未
    ("山下火", 3),   // 丙申、丁酉
    ("平地木", 1),   // 戊戌、己亥
    ("壁上土", 4),   // 庚子、辛丑
    ("金箔金", 0),   // 壬寅、癸卯
    ("覆灯火", 3),   // 甲辰、乙巳
    ("天河水", 2),   // 丙午、丁未
    ("大驿土", 4),   // 戊申、己酉
    ("钗钏金", 0),   // 庚戌、辛亥
    ("桑柘木", 1),   // 壬子、癸丑
    ("大溪水", 2),   // 甲寅、乙卯
    ("沙中土", 4),   // 丙辰、丁巳
    ("天上火", 3),   // 戊午、己未
    ("石榴木", 1),   // 庚申、辛酉
    ("大海水", 2),   // 壬戌、癸亥
];

/// 根据干支索引获取纳音
///
/// # 参数
/// - `ganzhi_index`: 六十甲子索引 (0-59)
///
/// # 返回
/// - (纳音名称, 五行编码)
#[inline]
pub fn get_nayin(ganzhi_index: u8) -> (&'static str, u8) {
    let idx = (ganzhi_index / 2) as usize % 30;
    NA_YIN[idx]
}

/// 空亡对照表
///
/// 十天干配十二地支，每旬（十天）中有两个地支无天干对应，称为空亡
/// 按甲子旬首排列，索引为旬首干支在六十甲子中的位置 / 10
/// 值为空亡的两个地支索引 (0-11 对应 子丑寅卯辰巳午未申酉戌亥)
pub const KONG_WANG: [[u8; 2]; 6] = [
    [10, 11], // 甲子旬: 戌亥空
    [8, 9],   // 甲戌旬: 申酉空
    [6, 7],   // 甲申旬: 午未空
    [4, 5],   // 甲午旬: 辰巳空
    [2, 3],   // 甲辰旬: 寅卯空
    [0, 1],   // 甲寅旬: 子丑空
];

/// 根据日柱干支索引获取空亡地支
///
/// # 参数
/// - `day_ganzhi_index`: 日柱在六十甲子中的索引 (0-59)
///
/// # 返回
/// - 空亡的两个地支索引 [地支1, 地支2]
#[inline]
pub fn get_kongwang(day_ganzhi_index: u8) -> [u8; 2] {
    let xun_index = (day_ganzhi_index / 10) as usize % 6;
    KONG_WANG[xun_index]
}

/// 体用关系详细解释
///
/// 提供五种体用关系的详细解读文本
pub const TIYONG_INTERPRETATION: [&str; 5] = [
    // BiHe 比和
    "体用五行相同，名为比和。主事顺遂，可得助力，谋事易成，无大碍阻。",
    // YongShengTi 用生体
    "用卦五行生体卦五行，名为用生体。大吉之象，主有贵人相助，所谋顺遂，财利可得。",
    // TiShengYong 体生用
    "体卦五行生用卦五行，名为体生用。主泄气耗财，凡事需付出代价方可成，或有小损。",
    // YongKeTi 用克体
    "用卦五行克体卦五行，名为用克体。大凶之象，主事多阻碍，小心口舌是非，谨防损失。",
    // TiKeYong 体克用
    "体卦五行克用卦五行，名为体克用。中平之象，可成但需耗力，宜稳步推进，不宜冒进。",
];

/// 获取体用关系详细解释
///
/// # 参数
/// - `relation_index`: 体用关系索引 (0-4，对应 BiHe/YongShengTi/TiShengYong/YongKeTi/TiKeYong)
///
/// # 返回
/// - 详细解释文本
#[inline]
pub fn get_tiyong_interpretation(relation_index: u8) -> &'static str {
    let idx = (relation_index as usize) % 5;
    TIYONG_INTERPRETATION[idx]
}

/// 获取爻名（如"初九"、"六二"）
///
/// # 参数
/// - `shang_gua_binary`: 上卦二进制 (3 bits)
/// - `xia_gua_binary`: 下卦二进制 (3 bits)
/// - `yao`: 爻位 (1-6)
///
/// # 返回
/// - 爻名字符串
#[inline]
pub fn get_yao_ming(shang_gua_binary: u8, xia_gua_binary: u8, yao: u8) -> &'static str {
    if yao < 1 || yao > 6 {
        return "未知";
    }

    // 组合六爻：上卦占高3位，下卦占低3位
    let full_binary = (shang_gua_binary << 3) | xia_gua_binary;

    // 获取指定爻位的阴阳（bit 0-5 对应爻1-6）
    let bit_position = yao - 1;
    let is_yang = (full_binary >> bit_position) & 1 == 1;

    let yao_idx = (yao - 1) as usize;
    if is_yang {
        YAO_MING_YANG[yao_idx]
    } else {
        YAO_MING_YIN[yao_idx]
    }
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_get_bagua_name() {
        assert_eq!(get_bagua_name(1), "乾");
        assert_eq!(get_bagua_name(2), "兑");
        assert_eq!(get_bagua_name(8), "坤");
        assert_eq!(get_bagua_name(0), "坤");
    }

    #[test]
    fn test_get_hexagram_name() {
        // 乾为天: 上卦乾(1)，下卦乾(1)
        assert_eq!(get_hexagram_name(1, 1), "乾为天");
        // 坤为地: 上卦坤(0)，下卦坤(0)
        assert_eq!(get_hexagram_name(0, 0), "坤为地");
        // 地天泰: 上卦坤(0)，下卦乾(1)
        assert_eq!(get_hexagram_name(0, 1), "地天泰");
        // 天地否: 上卦乾(1)，下卦坤(0)
        assert_eq!(get_hexagram_name(1, 0), "天地否");
    }

    #[test]
    fn test_xiantian_conversion() {
        // 测试先天数和索引的转换
        for num in 1..=8u8 {
            let idx = xiantian_to_index(num);
            let back = index_to_xiantian(idx);
            assert_eq!(num, back, "先天数 {} 转换失败", num);
        }
    }

    #[test]
    fn test_yao_names() {
        assert_eq!(get_yao_name(1), "初爻");
        assert_eq!(get_yao_name(6), "上爻");
    }

    #[test]
    fn test_shichen_names() {
        assert_eq!(get_shichen_name(1), "子时");
        assert_eq!(get_shichen_name(7), "午时");
        assert_eq!(get_shichen_name(12), "亥时");
    }

    #[test]
    fn test_fu_gua_map() {
        // 测试伏卦映射
        assert_eq!(get_fu_gua_num(1), 5); // 乾→巽
        assert_eq!(get_fu_gua_num(8), 1); // 坤→乾
        assert_eq!(get_fu_gua_num(0), 1); // 坤(0)→乾
        assert_eq!(get_fu_gua_num(3), 6); // 离→坎
        assert_eq!(get_fu_gua_num(6), 3); // 坎→离
        assert_eq!(get_fu_gua_num(2), 7); // 兑→艮
        assert_eq!(get_fu_gua_num(7), 2); // 艮→兑
        assert_eq!(get_fu_gua_num(4), 5); // 震→巽
        assert_eq!(get_fu_gua_num(5), 4); // 巽→震
    }

    #[test]
    fn test_nayin() {
        // 甲子、乙丑 → 海中金
        let (name, wuxing) = get_nayin(0);
        assert_eq!(name, "海中金");
        assert_eq!(wuxing, 0); // 金

        let (name, wuxing) = get_nayin(1);
        assert_eq!(name, "海中金");
        assert_eq!(wuxing, 0); // 金

        // 丙寅、丁卯 → 炉中火
        let (name, wuxing) = get_nayin(2);
        assert_eq!(name, "炉中火");
        assert_eq!(wuxing, 3); // 火
    }

    #[test]
    fn test_kongwang() {
        // 甲子旬：戌亥空
        let kw = get_kongwang(0);
        assert_eq!(kw, [10, 11]); // 戌=10, 亥=11

        // 甲戌旬：申酉空
        let kw = get_kongwang(10);
        assert_eq!(kw, [8, 9]); // 申=8, 酉=9

        // 甲申旬：午未空
        let kw = get_kongwang(20);
        assert_eq!(kw, [6, 7]); // 午=6, 未=7
    }

    #[test]
    fn test_tiyong_interpretation() {
        // 测试体用解读
        let interp = get_tiyong_interpretation(0);
        assert!(interp.contains("比和"));

        let interp = get_tiyong_interpretation(1);
        assert!(interp.contains("用生体"));

        let interp = get_tiyong_interpretation(2);
        assert!(interp.contains("体生用"));

        let interp = get_tiyong_interpretation(3);
        assert!(interp.contains("用克体"));

        let interp = get_tiyong_interpretation(4);
        assert!(interp.contains("体克用"));
    }
}
