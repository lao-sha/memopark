# pallet-affiliate-instant

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

å³æ—¶åˆ†æˆç³»ç»Ÿæ¨¡å—ï¼Œå®ç°ä¾›å¥‰æ”¯ä»˜åçš„å³æ—¶æ¨èå¥–åŠ±åˆ†é…æœºåˆ¶ã€‚æ¯ç¬”ä¾›å¥‰æ”¯ä»˜å®Œæˆåï¼Œç«‹å³æ ¹æ®æ¨èå…³ç³»é“¾è¿›è¡Œå¤šå±‚çº§åˆ†æˆï¼Œèµ„é‡‘å®æ—¶åˆ°è´¦ï¼Œæ— éœ€ç­‰å¾…å‘¨æœŸç»“ç®—ã€‚

---

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### 1. å³æ—¶åˆ†é…æ¨¡å¼

**ä¸å‘¨ç»“ç®—æ¨¡å¼å¯¹æ¯”ï¼š**

| ç‰¹æ€§ | å‘¨ç»“ç®—æ¨¡å¼ (pallet-memo-affiliate) | å³æ—¶åˆ†æˆæ¨¡å¼ (pallet-affiliate-instant) |
|------|-----------------------------------|----------------------------------------|
| **ç»“ç®—æ—¶æœº** | æ¯å‘¨ç»Ÿä¸€ç»“ç®— | æ¯ç¬”æ”¯ä»˜åç«‹å³åˆ†æˆ |
| **èµ„é‡‘æµ** | å…ˆæ‰˜ç®¡ â†’ å‘¨æœ«æ‰¹é‡è½¬è´¦ | ç›´æ¥è½¬è´¦åˆ°æ¨èäººè´¦æˆ· |
| **ç”¨æˆ·ä½“éªŒ** | å»¶è¿Ÿï¼Œéœ€ç­‰å¾…ç»“ç®—å‘¨æœŸ | å³æ—¶åˆ°è´¦ï¼Œä½“éªŒæ›´å¥½ |
| **é€‚ç”¨åœºæ™¯** | å…¶ä»–æ¶ˆè´¹åœºæ™¯ | ä¼šå‘˜ä¾›å¥‰åœºæ™¯ |
| **ä»£æ•°æ§åˆ¶** | å›ºå®š15å±‚ | æ ¹æ®ä¼šå‘˜ç­‰çº§åŠ¨æ€ï¼ˆ6-15å±‚ï¼‰ |
| **åˆ†æˆæ¯”ä¾‹** | ä¸ç­‰æ¯”ï¼ˆ20/10/4...ï¼‰ | é€’å‡ï¼ˆ30/25/15...ï¼‰ |

**ä¼˜åŠ¿ï¼š**
- âœ… å³æ—¶åˆ°è´¦ï¼Œç”¨æˆ·ä½“éªŒæ›´å¥½
- âœ… æ— éœ€ç»´æŠ¤æ‰˜ç®¡è´¦æˆ·å’Œç»“ç®—çŠ¶æ€
- âœ… é™ä½é“¾ä¸Šå­˜å‚¨æˆæœ¬
- âœ… é…åˆä¼šå‘˜ç³»ç»Ÿï¼ŒåŠ¨æ€æ§åˆ¶åˆ†æˆå±‚æ•°

### 2. å¤šå±‚çº§åˆ†æˆï¼ˆæœ€å¤š15å±‚ï¼‰

**å±‚çº§æ§åˆ¶ï¼š**
- æ ¹æ®ä¼šå‘˜å¯æ‹¿ä»£æ•°å†³å®šåˆ†æˆå±‚æ•°
- ç¬¬1ä»£æ¨èäººåˆ†æˆæ¯”ä¾‹æœ€é«˜ï¼ˆ30%ï¼‰
- é€’å‡è‡³ç¬¬15ä»£ï¼ˆ1%ï¼‰
- è¶…è¿‡ä¼šå‘˜å¯æ‹¿ä»£æ•°çš„å±‚çº§ä¸å‚ä¸åˆ†æˆ

**ç¤ºä¾‹ï¼š**
```
è´­ä¹°è€…Aï¼ˆä¼šå‘˜ï¼‰
â”œâ”€ æ¨èäººBï¼ˆ6ä»£ä¼šå‘˜ï¼‰â†’ æ”¶åˆ°ç¬¬1å±‚å¥–åŠ±ï¼ˆ30%ï¼‰
â”‚   â””â”€ æ¨èäººCï¼ˆ9ä»£ä¼šå‘˜ï¼‰â†’ æ”¶åˆ°ç¬¬2å±‚å¥–åŠ±ï¼ˆ25%ï¼‰
â”‚       â””â”€ æ¨èäººDï¼ˆ12ä»£ä¼šå‘˜ï¼‰â†’ æ”¶åˆ°ç¬¬3å±‚å¥–åŠ±ï¼ˆ15%ï¼‰
â”‚           â””â”€ æ¨èäººEï¼ˆ15ä»£ä¼šå‘˜ï¼‰â†’ æ”¶åˆ°ç¬¬4å±‚å¥–åŠ±ï¼ˆ10%ï¼‰
â”‚               â””â”€ æ¨èäººFï¼ˆ6ä»£ä¼šå‘˜ï¼‰â†’ ä¸æ”¶å¥–åŠ±ï¼ˆè¶…è¿‡ä»£æ•°é™åˆ¶ï¼‰
```

### 3. é€’å‡åˆ†æˆæ¯”ä¾‹ï¼ˆæ–¹æ¡ˆBï¼‰

| å±‚çº§ | åˆ†æˆæ¯”ä¾‹ | è¯´æ˜ |
|------|---------|------|
| ç¬¬1ä»£ | 30% | ç›´æ¥æ¨èäººï¼Œæ¯”ä¾‹æœ€é«˜ |
| ç¬¬2ä»£ | 25% | äºŒçº§æ¨èäºº |
| ç¬¬3ä»£ | 15% | ä¸‰çº§æ¨èäºº |
| ç¬¬4ä»£ | 10% | å››çº§æ¨èäºº |
| ç¬¬5ä»£ | 7% | äº”çº§æ¨èäºº |
| ç¬¬6ä»£ | 3% | å…­çº§æ¨èäºº |
| ç¬¬7-9ä»£ | å„2% | ä¸­å±‚æ¨èäºº |
| ç¬¬10-15ä»£ | å„1% | é¡¶å±‚æ¨èäºº |
| **æ€»è®¡** | **99%** | å‰©ä½™1%å¹¶å…¥å›½åº“ |

**è®¾è®¡ç†å¿µï¼š**
- æ¿€åŠ±ç›´æ¥æ¨èï¼ˆç¬¬1ä»£æ¯”ä¾‹æœ€é«˜ï¼‰
- å…¼é¡¾å¤šå±‚çº§ï¼ˆæœ€å¤š15ä»£ï¼‰
- æ§åˆ¶æ€»å’Œä¸è¶…è¿‡100%

### 4. åˆ†æˆåŸºæ•°è®¡ç®—

**å…¬å¼ï¼š**
```
åˆ†æˆåŸºæ•° = åŸä»· - å›ºå®šå­˜å‚¨è´¹ - å›ºå®šé”€æ¯è´¹
é”€æ¯é‡‘é¢ = åˆ†æˆåŸºæ•° Ã— 5%
å›½åº“é‡‘é¢ = åˆ†æˆåŸºæ•° Ã— 2%
å­˜å‚¨é‡‘é¢ = åˆ†æˆåŸºæ•° Ã— 3%
å¯åˆ†é…é‡‘é¢ = åˆ†æˆåŸºæ•° - é”€æ¯ - å›½åº“ - å­˜å‚¨ = åˆ†æˆåŸºæ•° Ã— 90%
```

**ç¤ºä¾‹ï¼š**
```
åŸä»·ï¼š100,000 MEMO
å›ºå®šå­˜å‚¨è´¹ï¼š1,000 MEMO
å›ºå®šé”€æ¯è´¹ï¼š1,000 MEMO

åˆ†æˆåŸºæ•° = 100,000 - 1,000 - 1,000 = 98,000 MEMO

é”€æ¯ï¼š98,000 Ã— 5% = 4,900 MEMO
å›½åº“ï¼š98,000 Ã— 2% = 1,960 MEMO
å­˜å‚¨ï¼š98,000 Ã— 3% = 2,940 MEMO
å¯åˆ†é…ï¼š98,000 Ã— 90% = 88,200 MEMO

ç¬¬1ä»£ï¼ˆ30%ï¼‰ï¼š88,200 Ã— 30% = 26,460 MEMO
ç¬¬2ä»£ï¼ˆ25%ï¼‰ï¼š88,200 Ã— 25% = 22,050 MEMO
ç¬¬3ä»£ï¼ˆ15%ï¼‰ï¼š88,200 Ã— 15% = 13,230 MEMO
ç¬¬4ä»£ï¼ˆ10%ï¼‰ï¼š88,200 Ã— 10% = 8,820 MEMO
ç¬¬5ä»£ï¼ˆ7%ï¼‰ï¼š 88,200 Ã— 7% = 6,174 MEMO
ç¬¬6ä»£ï¼ˆ3%ï¼‰ï¼š 88,200 Ã— 3% = 2,646 MEMO
...å‰©ä½™å¹¶å…¥å›½åº“
```

### 5. ä¼šå‘˜éªŒè¯æœºåˆ¶

**æ¯å±‚åˆ†æˆå‰éªŒè¯ï¼š**
1. âœ… æ¨èäººæ˜¯å¦ä¸ºæœ‰æ•ˆä¼šå‘˜ï¼ˆæœªè¿‡æœŸï¼‰
2. âœ… æ¨èäººçš„å¯æ‹¿ä»£æ•°æ˜¯å¦è¦†ç›–è¯¥å±‚
3. âœ… å¦‚æœéªŒè¯å¤±è´¥ï¼Œè¯¥å±‚ä»½é¢å¹¶å…¥å›½åº“

**éªŒè¯æµç¨‹ï¼š**
```rust
for (level, ancestor) in referral_chain.iter().enumerate() {
    // 1. æ£€æŸ¥æ˜¯å¦ä¸ºæœ‰æ•ˆä¼šå‘˜
    if !MembershipProvider::is_member_valid(ancestor) {
        treasury_extra += level_amount; // å¹¶å…¥å›½åº“
        continue;
    }
    
    // 2. æ£€æŸ¥ä»£æ•°æ˜¯å¦è¶³å¤Ÿ
    let generations = MembershipProvider::get_member_generations(ancestor)?;
    if level + 1 > generations {
        treasury_extra += level_amount; // å¹¶å…¥å›½åº“
        continue;
    }
    
    // 3. æ‰§è¡Œè½¬è´¦
    transfer(escrow_account, ancestor, level_amount)?;
}
```

---

## ğŸ”§ æ ¸å¿ƒæ¥å£

### å…¬å…±æ¥å£

#### å³æ—¶åˆ†é…æ¨èå¥–åŠ±

```rust
pub fn instant_distribute(
    buyer: &T::AccountId,
    original_price: BalanceOf<T>,
    actual_paid: BalanceOf<T>,
    escrow_account: &T::AccountId,
) -> DispatchResult
```

**å‚æ•°è¯´æ˜ï¼š**
- `buyer`: è´­ä¹°è€…è´¦æˆ·
- `original_price`: åŸä»·ï¼ˆä½œä¸ºåˆ†æˆåŸºæ•°ï¼‰
- `actual_paid`: å®é™…æ”¯ä»˜é‡‘é¢ï¼ˆä¼šå‘˜æŠ˜æ‰£åï¼‰
- `escrow_account`: æ‰˜ç®¡è´¦æˆ·ï¼ˆèµ„é‡‘æ¥æºï¼‰

**æ‰§è¡Œæµç¨‹ï¼š**
1. è®¡ç®—åˆ†æˆåŸºæ•°ï¼ˆåŸä»· - å­˜å‚¨è´¹ - é”€æ¯è´¹ï¼‰
2. æ‰£é™¤é”€æ¯/å›½åº“/å­˜å‚¨è´¹ï¼ˆå…±10%ï¼‰
3. å‰©ä½™90%ä½œä¸ºå¯åˆ†é…é‡‘é¢
4. è·å–æ¨èé“¾ï¼ˆæœ€å¤š15å±‚ï¼‰
5. é€å±‚éªŒè¯ä¼šå‘˜æœ‰æ•ˆæ€§å’Œä»£æ•°
6. è®¡ç®—è¯¥å±‚åˆ†æˆé‡‘é¢
7. å³æ—¶è½¬è´¦åˆ°æ¨èäººè´¦æˆ·
8. æœªåˆ†é…éƒ¨åˆ†å¹¶å…¥å›½åº“
9. æ‰§è¡Œé”€æ¯å’Œå­˜å‚¨è´¹è½¬è´¦
10. æ›´æ–°ç»Ÿè®¡æ•°æ®
11. å‘å‡ºå®Œæˆäº‹ä»¶

**è°ƒç”¨ç¤ºä¾‹ï¼ˆç”± offerings pallet è°ƒç”¨ï¼‰ï¼š**
```rust
// åœ¨ä¾›å¥‰æ”¯ä»˜å
AffiliateInstant::instant_distribute(
    &buyer,
    original_price,
    actual_paid,
    &Self::escrow_account(),
)?;
```

### æ²»ç†æ¥å£

#### è®¾ç½®åˆ†æˆæ¯”ä¾‹

```rust
#[pallet::call_index(0)]
pub fn set_level_percents(
    origin: OriginFor<T>,
    percents: Vec<u8>,
) -> DispatchResult
```

**å‚æ•°è¯´æ˜ï¼š**
- `origin`: Rootæƒé™
- `percents`: æ¯å±‚åˆ†æˆæ¯”ä¾‹ï¼ˆ1-15å±‚ï¼Œä¾‹å¦‚ `[30, 25, 15, ...]`ï¼‰

**éªŒè¯è§„åˆ™ï¼š**
- æœ€å¤š15å±‚
- æ€»å’Œä¸è¶…è¿‡100%

**è°ƒç”¨ç¤ºä¾‹ï¼š**
```rust
// Root æ›´æ–°åˆ†æˆæ¯”ä¾‹
api.tx.affiliateInstant.setLevelPercents([30, 25, 15, 10, 7, 3, 2, 2, 2, 1, 1, 1, 1, 1, 1])
```

---

## ğŸ“Š å­˜å‚¨ç»“æ„

### 1. åˆ†æˆæ¯”ä¾‹é…ç½®

```rust
pub type LevelPercents<T: Config> = StorageValue<_, BoundedVec<u8, ConstU32<15>>, ValueQuery>;
```

**è¯´æ˜ï¼š** æ¯å±‚çš„åˆ†æˆæ¯”ä¾‹ï¼ˆ0-100ï¼‰ï¼Œæœ€å¤š15å±‚

**é»˜è®¤å€¼ï¼š** `[30, 25, 15, 10, 7, 3, 2, 2, 2, 1, 1, 1, 1, 1, 1]`

### 2. ç´¯è®¡åˆ†æˆæ€»é¢

```rust
pub type TotalDistributed<T: Config> = StorageValue<_, BalanceOf<T>, ValueQuery>;
```

**è¯´æ˜ï¼š** ç»Ÿè®¡æ‰€æœ‰å·²åˆ†é…çš„æ¨èå¥–åŠ±æ€»é¢

### 3. ç´¯è®¡é”€æ¯æ€»é¢

```rust
pub type TotalBurned<T: Config> = StorageValue<_, BalanceOf<T>, ValueQuery>;
```

**è¯´æ˜ï¼š** ç»Ÿè®¡æ‰€æœ‰å·²é”€æ¯çš„ä»£å¸æ€»é¢

---

## ğŸ¯ äº‹ä»¶

### 1. RewardDistributed

```rust
RewardDistributed {
    to: T::AccountId,         // æ¨èäºº
    level: u8,                // å±‚çº§ï¼ˆ1-15ï¼‰
    amount: BalanceOf<T>,     // å¥–åŠ±é‡‘é¢
    buyer: T::AccountId,      // è´­ä¹°è€…
}
```

**è§¦å‘æ—¶æœºï¼š** æ¯æ¬¡æˆåŠŸè½¬è´¦æ¨èå¥–åŠ±æ—¶

### 2. DistributionCompleted

```rust
DistributionCompleted {
    buyer: T::AccountId,           // è´­ä¹°è€…
    original_price: BalanceOf<T>,  // åŸä»·
    actual_paid: BalanceOf<T>,     // å®ä»˜
    total_distributed: BalanceOf<T>, // æ€»åˆ†é…é‡‘é¢
}
```

**è§¦å‘æ—¶æœºï¼š** åˆ†æˆæµç¨‹å®Œæˆæ—¶

### 3. TokensBurned

```rust
TokensBurned {
    amount: BalanceOf<T>,  // é”€æ¯é‡‘é¢
}
```

**è§¦å‘æ—¶æœºï¼š** æ‰§è¡Œä»£å¸é”€æ¯æ—¶

### 4. LevelPercentsUpdated

```rust
LevelPercentsUpdated {
    percents: Vec<u8>,  // æ–°æ¯”ä¾‹åˆ—è¡¨
}
```

**è§¦å‘æ—¶æœºï¼š** æ²»ç†æ›´æ–°åˆ†æˆæ¯”ä¾‹æ—¶

---

## âš™ï¸ Runtime é…ç½®

### 1. åœ¨ runtime/Cargo.toml æ·»åŠ ä¾èµ–

```toml
[dependencies]
pallet-affiliate-instant = { path = "../pallets/affiliate-instant", default-features = false }

[features]
std = [
    # ... å…¶ä»–ä¾èµ–
    "pallet-affiliate-instant/std",
]
```

### 2. åœ¨ runtime/src/lib.rs é…ç½®

```rust
use frame_support::PalletId;

parameter_types! {
    pub const AffiliateInstantPalletId: PalletId = PalletId(*b"py/affin");
    pub const BurnPercent: u8 = 5;         // 5% é”€æ¯
    pub const TreasuryPercent: u8 = 2;     // 2% å›½åº“
    pub const StoragePercent: u8 = 3;      // 3% å­˜å‚¨
    pub const StorageFee: Balance = 1_000 * UNITS;  // å›ºå®šå­˜å‚¨è´¹
    pub const BurnFee: Balance = 1_000 * UNITS;      // å›ºå®šé”€æ¯è´¹
    pub const TreasuryAccount: AccountId = ...; // å›½åº“è´¦æˆ·
    pub const StorageAccount: AccountId = ...; // å­˜å‚¨è´¦æˆ·
}

impl pallet_affiliate_instant::Config for Runtime {
    type RuntimeEvent = RuntimeEvent;
    type Currency = Balances;
    type PalletId = AffiliateInstantPalletId;
    type ReferralProvider = MemoReferrals;
    type MembershipProvider = Membership;
    type BurnPercent = BurnPercent;
    type TreasuryPercent = TreasuryPercent;
    type StoragePercent = StoragePercent;
    type StorageFee = StorageFee;
    type BurnFee = BurnFee;
    type TreasuryAccount = TreasuryAccount;
    type StorageAccount = StorageAccount;
}

construct_runtime!(
    pub struct Runtime {
        // ... å…¶ä»– pallets
        AffiliateInstant: pallet_affiliate_instant,
        MemoReferrals: pallet_memo_referrals,
        Membership: pallet_membership,
    }
);
```

### 3. å®ç° Provider Traits

#### ReferralProvider

```rust
impl pallet_affiliate_instant::ReferralProvider<AccountId> for MemoReferrals {
    fn get_sponsor_chain(who: &AccountId, max_depth: u8) -> Vec<AccountId> {
        // è°ƒç”¨ pallet-memo-referrals çš„æ¥å£
        MemoReferrals::get_sponsor_chain_impl(who, max_depth)
    }
}
```

#### MembershipProvider

```rust
impl pallet_affiliate_instant::MembershipProvider<AccountId> for Membership {
    fn is_member_valid(who: &AccountId) -> bool {
        Membership::is_member_valid(who)
    }

    fn get_member_generations(who: &AccountId) -> Option<u8> {
        Membership::get_member_generations(who)
    }
}
```

---

## ğŸ”— ä¸å…¶ä»–æ¨¡å—çš„äº¤äº’

### 1. pallet-membershipï¼ˆä¼šå‘˜ç³»ç»Ÿï¼‰

**ä¾èµ–å…³ç³»ï¼š** å¼ºä¾èµ–

**äº¤äº’æ¥å£ï¼š**
- `is_member_valid`: éªŒè¯ä¼šå‘˜æœ‰æ•ˆæ€§
- `get_member_generations`: è·å–å¯æ‹¿ä»£æ•°

**æ•°æ®æµï¼š**
```
å³æ—¶åˆ†æˆ â†’ é€å±‚éªŒè¯ â†’ æ£€æŸ¥ä¼šå‘˜çŠ¶æ€ â†’ æ£€æŸ¥ä»£æ•° â†’ å†³å®šæ˜¯å¦åˆ†é…
```

### 2. pallet-memo-referralsï¼ˆæ¨èå…³ç³»ï¼‰

**ä¾èµ–å…³ç³»ï¼š** å¼ºä¾èµ–

**äº¤äº’æ¥å£ï¼š**
- `get_sponsor_chain`: è·å–æ¨èé“¾ï¼ˆç¥–å…ˆåˆ—è¡¨ï¼‰

**æ•°æ®æµï¼š**
```
å³æ—¶åˆ†æˆ â†’ è·å–æ¨èé“¾ â†’ é€å±‚éå† â†’ éªŒè¯å¹¶åˆ†é…
```

### 3. pallet-memo-offeringsï¼ˆä¾›å¥‰ç³»ç»Ÿï¼‰

**ä¾èµ–å…³ç³»ï¼š** è¢«ä¾èµ–

**é›†æˆæ–¹å¼ï¼š**
```rust
// åœ¨ offerings pallet çš„ä¾›å¥‰æ”¯ä»˜å‡½æ•°ä¸­è°ƒç”¨
impl<T: Config> Pallet<T> {
    pub fn make_offering(...) -> DispatchResult {
        // ... éªŒè¯å’Œæ‰£è´¹é€»è¾‘
        
        // è§¦å‘å³æ—¶åˆ†æˆ
        T::AffiliateProvider::instant_distribute(
            &who,
            original_price,
            actual_price,
            &Self::escrow_account(),
        )?;
        
        // ... å…¶ä»–é€»è¾‘
    }
}
```

---

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
cd pallets/affiliate-instant
cargo test
```

### æµ‹è¯•è¦†ç›–

- âœ… å³æ—¶åˆ†æˆåŸºæœ¬åŠŸèƒ½
- âœ… ä¼šå‘˜ä»£æ•°é™åˆ¶
- âœ… è®¾ç½®åˆ†æˆæ¯”ä¾‹
- âœ… åˆ†æˆæ¯”ä¾‹éªŒè¯ï¼ˆæ€»å’Œã€å±‚æ•°ï¼‰
- âœ… ç»Ÿè®¡æ•°æ®æ›´æ–°
- âœ… æ— æ•ˆä¼šå‘˜å¤„ç†
- âœ… è½¬è´¦å¤±è´¥å¤„ç†
- âœ… é”€æ¯å’Œå›½åº“è½¬è´¦

---

## ğŸ“ˆ ç»æµæ¨¡å‹

### åˆ†æˆæ¯”ä¾‹åˆ†æ

**æ€»åˆ†æˆæ± ï¼š90%**ï¼ˆæ‰£é™¤10%é”€æ¯/å›½åº“/å­˜å‚¨è´¹åï¼‰

**15å±‚å®Œæ•´åˆ†æˆï¼š**
```
ç¬¬1ä»£ï¼š30% Ã— 90% = 27.0%ï¼ˆåŸä»·ï¼‰
ç¬¬2ä»£ï¼š25% Ã— 90% = 22.5%
ç¬¬3ä»£ï¼š15% Ã— 90% = 13.5%
ç¬¬4ä»£ï¼š10% Ã— 90% = 9.0%
ç¬¬5ä»£ï¼š7% Ã— 90% = 6.3%
ç¬¬6ä»£ï¼š3% Ã— 90% = 2.7%
ç¬¬7-9ä»£ï¼šå„ 2% Ã— 90% = 1.8%ï¼ˆå…±5.4%ï¼‰
ç¬¬10-15ä»£ï¼šå„ 1% Ã— 90% = 0.9%ï¼ˆå…±5.4%ï¼‰

æ€»è®¡ï¼š27.0 + 22.5 + 13.5 + 9.0 + 6.3 + 2.7 + 5.4 + 5.4 = 91.8%ï¼ˆåŸä»·ï¼‰
å‰©ä½™ï¼š8.2%å¹¶å…¥å›½åº“
```

**ç¤ºä¾‹æ”¶ç›Šï¼ˆå‡è®¾åŸä»·100,000 MEMOï¼‰ï¼š**
```
ç¬¬1ä»£æ¨èäººæ”¶ç›Šï¼š27,000 MEMO
ç¬¬2ä»£æ¨èäººæ”¶ç›Šï¼š22,500 MEMO
ç¬¬3ä»£æ¨èäººæ”¶ç›Šï¼š13,500 MEMO
ç¬¬4ä»£æ¨èäººæ”¶ç›Šï¼š9,000 MEMO
ç¬¬5ä»£æ¨èäººæ”¶ç›Šï¼š6,300 MEMO
...
æ€»åˆ†é…ï¼š91,800 MEMO
å›½åº“ï¼š8,200 MEMO
```

---

## ğŸ”’ å®‰å…¨è€ƒè™‘

### 1. ä¼šå‘˜éªŒè¯

- **æœ‰æ•ˆæœŸæ£€æŸ¥**ï¼šæ¯å±‚åˆ†æˆå‰éªŒè¯ä¼šå‘˜æ˜¯å¦è¿‡æœŸ
- **ä»£æ•°æ£€æŸ¥**ï¼šéªŒè¯æ¨èäººçš„å¯æ‹¿ä»£æ•°æ˜¯å¦è¦†ç›–è¯¥å±‚
- **è‡ªåŠ¨é™çº§**ï¼šæ— æ•ˆä¼šå‘˜ä¸å‚ä¸åˆ†æˆï¼Œä»½é¢å¹¶å…¥å›½åº“

### 2. èµ„é‡‘å®‰å…¨

- **KeepAliveä¿æŠ¤**ï¼šæ‰€æœ‰è½¬è´¦ä½¿ç”¨ `KeepAlive`ï¼Œé¿å…è´¦æˆ·è¢«é”€æ¯
- **è½¬è´¦å¤±è´¥å¤„ç†**ï¼šè½¬è´¦å¤±è´¥çš„ä»½é¢å¹¶å…¥å›½åº“ï¼Œä¸ä¸¢å¤±
- **ç²¾åº¦æ§åˆ¶**ï¼šå‘ä¸‹å–æ•´ï¼Œç¡®ä¿ä¸è¶…å‘

### 3. æƒé™æ§åˆ¶

- **Rootæƒé™**ï¼šåªæœ‰Rootå¯ä»¥è®¾ç½®åˆ†æˆæ¯”ä¾‹
- **æ¯”ä¾‹éªŒè¯**ï¼šç¡®ä¿æ€»å’Œä¸è¶…è¿‡100%ï¼Œå±‚æ•°ä¸è¶…è¿‡15

### 4. é˜²æ­¢æ”»å‡»

- **æ¨èç¯æ£€æµ‹**ï¼šä¾èµ– `pallet-memo-referrals` çš„å¾ªç¯æ£€æµ‹
- **é˜²è‡ªæ¨**ï¼š`pallet-memo-referrals` ä¿è¯ä¸èƒ½æ¨èè‡ªå·±
- **ä»£æ•°å°é¡¶**ï¼šæœ€å¤š15å±‚ï¼Œé˜²æ­¢æ— é™é€’å½’

---

## ğŸ› ï¸ å‰ç«¯é›†æˆç¤ºä¾‹

### æŸ¥è¯¢åˆ†æˆæ¯”ä¾‹é…ç½®

```typescript
// æŸ¥è¯¢å½“å‰åˆ†æˆæ¯”ä¾‹
const percents = await api.query.affiliateInstant.levelPercents();
console.log('åˆ†æˆæ¯”ä¾‹:', percents.toJSON());
```

### æŸ¥è¯¢ç»Ÿè®¡æ•°æ®

```typescript
// æŸ¥è¯¢ç´¯è®¡åˆ†æˆæ€»é¢
const totalDistributed = await api.query.affiliateInstant.totalDistributed();
console.log('ç´¯è®¡åˆ†æˆ:', totalDistributed.toString());

// æŸ¥è¯¢ç´¯è®¡é”€æ¯æ€»é¢
const totalBurned = await api.query.affiliateInstant.totalBurned();
console.log('ç´¯è®¡é”€æ¯:', totalBurned.toString());
```

### ç›‘å¬åˆ†æˆäº‹ä»¶

```typescript
api.query.system.events((events) => {
  events.forEach((record) => {
    const { event } = record;
    
    if (api.events.affiliateInstant.RewardDistributed.is(event)) {
      const [to, level, amount, buyer] = event.data;
      console.log(`ç¬¬${level}å±‚æ¨èäºº ${to} æ”¶åˆ° ${amount} å¥–åŠ±ï¼ˆæ¥è‡ª ${buyer}ï¼‰`);
    }
    
    if (api.events.affiliateInstant.DistributionCompleted.is(event)) {
      const [buyer, originalPrice, actualPaid, totalDistributed] = event.data;
      console.log(`åˆ†æˆå®Œæˆï¼šåŸä»· ${originalPrice}ï¼Œå®ä»˜ ${actualPaid}ï¼Œæ€»åˆ†é… ${totalDistributed}`);
    }
  });
});
```

---

## ğŸ“ å¾…ä¼˜åŒ–äº‹é¡¹

### 1. åŠ¨æ€åˆ†æˆæ¯”ä¾‹

**å½“å‰çŠ¶æ€ï¼š** å›ºå®šæ¯”ä¾‹é…ç½®

**ä¼˜åŒ–æ–¹å‘ï¼š**
- æ ¹æ®ä¼šå‘˜ç­‰çº§è°ƒæ•´åˆ†æˆæ¯”ä¾‹
- ä¸åŒæ¶ˆè´¹ç±»å‹ä½¿ç”¨ä¸åŒæ¯”ä¾‹
- åŸºäºæ—¶é—´æˆ–æ´»è·ƒåº¦çš„åŠ¨æ€è°ƒæ•´

### 2. åˆ†æˆæ± ç´¯ç§¯

**å½“å‰çŠ¶æ€ï¼š** ç«‹å³åˆ†é…

**ä¼˜åŒ–æ–¹å‘ï¼š**
- æ”¯æŒåˆ†æˆæ± ç´¯ç§¯æ¨¡å¼
- è¾¾åˆ°é˜ˆå€¼åæ‰¹é‡åˆ†é…
- èŠ‚çœgasè´¹ç”¨

### 3. åˆ†æˆè®°å½•æŸ¥è¯¢

**å½“å‰çŠ¶æ€ï¼š** ä»…é€šè¿‡äº‹ä»¶æŸ¥è¯¢

**ä¼˜åŒ–æ–¹å‘ï¼š**
- é“¾ä¸Šå­˜å‚¨åˆ†æˆå†å²
- æŒ‰è´¦æˆ·/æ—¶é—´æŸ¥è¯¢åˆ†æˆè®°å½•
- ç”Ÿæˆåˆ†æˆæŠ¥è¡¨

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å¹´è´¹ä¼šå‘˜ç³»ç»ŸæŠ€æœ¯å®æ–½æ–¹æ¡ˆ](/docs/å¹´è´¹ä¼šå‘˜ç³»ç»ŸæŠ€æœ¯å®æ–½æ–¹æ¡ˆ.md)
- [pallet-membership](/pallets/membership/README.md)
- [pallet-memo-referrals](/pallets/memo-referrals/README.md)
- [pallet-memo-affiliate](/pallets/memo-affiliate/README.md)

---

**ç‰ˆæœ¬ï¼š** v0.1.0  
**åˆ›å»ºæ—¥æœŸï¼š** 2025-10-06  
**æœ€åæ›´æ–°ï¼š** 2025-10-06  
**ç»´æŠ¤è€…ï¼š** Memopark Team  
**è®¸å¯è¯ï¼š** Apache-2.0

