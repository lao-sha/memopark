# 治理平台恢复钱包功能测试指南

## 🎯 测试目标

验证治理平台（memopark-governance）仅保留恢复钱包功能，移除创建钱包功能。

---

## ✅ 快速验证清单

### 1. 路由检查

```bash
# 启动开发服务器
cd /home/xiaodong/文档/memopark/memopark-governance
npm run dev
```

访问以下URL：

| URL | 预期结果 | 状态 |
|-----|---------|-----|
| http://localhost:3000/wallet/recover | ✅ 显示恢复钱包页面 | ⬜ |
| http://localhost:3000/wallet/create | ❌ 404 Not Found | ⬜ |
| http://localhost:3000/wallet/manage | ✅ 显示钱包管理页面 | ⬜ |

### 2. 界面检查

#### 侧边栏菜单
- [ ] 打开治理平台首页
- [ ] 查看左侧菜单"钱包管理"
- [ ] 确认只有以下选项：
  - ✅ 我的钱包
  - ✅ 恢复钱包
  - ❌ **无**"创建钱包"选项

#### 钱包管理页面
- [ ] 点击"钱包管理" → "我的钱包"
- [ ] 查看右上角按钮
- [ ] 确认只有一个按钮：
  - ✅ "恢复钱包"（primary 类型，蓝色）
  - ❌ **无**"创建钱包"按钮

#### 未连接钱包提示
- [ ] 清空 localStorage（F12 → Application → Local Storage → 清除）
- [ ] 刷新页面
- [ ] 查看"未连接钱包"提示
- [ ] 确认提示内容：
  - ✅ "未检测到本地钱包"
  - ✅ "治理平台使用助记词恢复钱包"
  - ✅ "恢复钱包"按钮
  - ✅ "提示：使用 memopark-dapp 创建的助记词恢复"
  - ❌ **无**外部链接

---

## 🧪 功能测试

### 测试 1：恢复钱包完整流程

#### 前置条件
- 已在 memopark-dapp 创建钱包并备份助记词
- 或准备一个测试助记词（12个单词）

#### 测试步骤

**步骤 1：访问恢复页面**
```
1. 访问 http://localhost:3000/wallet/recover
2. 查看页面布局
3. 确认左侧有主内容区，右侧有说明区
```

✅ 预期结果：
- 页面标题："恢复钱包"
- 步骤指示器：[输入助记词] → [设置密码]
- 左侧：输入助记词表单
- 右侧：治理平台钱包说明

**步骤 2：输入助记词**
```
1. 在"助记词（12个单词）"文本框输入助记词
   例如：abandon abandon abandon abandon abandon abandon abandon abandon abandon abandon abandon about
2. 点击"验证并继续"按钮
```

✅ 预期结果：
- 助记词验证成功
- 显示恢复的地址
- 进入"设置密码"步骤

**步骤 3：设置密码**
```
1. 输入密码（至少8位）
2. 确认密码
3. 点击"恢复钱包"按钮
```

✅ 预期结果：
- 显示"钱包恢复成功！"提示
- 1秒后自动跳转到首页
- 顶部显示已连接的账户地址

**步骤 4：验证恢复成功**
```
1. 查看顶部导航栏
2. 确认显示账户地址和余额
3. 点击"钱包管理" → "我的钱包"
4. 查看账户列表
```

✅ 预期结果：
- 账户列表显示恢复的地址
- 地址标记为"当前"
- 显示余额

---

### 测试 2：账户数据共享（与 dapp 共享）

#### 前置条件
- 同时启动 memopark-dapp 和 memopark-governance

#### 测试步骤

**步骤 1：在 dapp 创建钱包**
```bash
# 启动 dapp
cd /home/xiaodong/文档/memopark/memopark-dapp
npm run dev
# 访问 http://localhost:5173

1. 在 dapp 中创建钱包
2. 记录生成的助记词
3. 记录钱包地址
```

**步骤 2：在 governance 恢复钱包**
```bash
# 启动 governance（如果未启动）
cd /home/xiaodong/文档/memopark/memopark-governance
npm run dev
# 访问 http://localhost:3000

1. 在 governance 中恢复钱包
2. 使用步骤1记录的助记词
3. 设置密码（可以与 dapp 不同）
```

**步骤 3：验证地址一致性**
```
1. 对比两个平台的地址
2. 对比两个平台的余额
```

✅ 预期结果：
- 地址完全相同
- 余额相同（链上数据）
- 密码可以不同

**步骤 4：测试密码独立性**
```
1. 在 governance 发起一个治理操作（需要签名）
2. 输入 governance 设置的密码
```

✅ 预期结果：
- 签名成功
- 即使密码与 dapp 不同，仍可正常签名

---

### 测试 3：界面响应式（网页端布局）

#### 测试步骤

**步骤 1：大屏测试（≥1200px）**
```
1. 浏览器窗口最大化
2. 访问恢复钱包页面
3. 观察布局
```

✅ 预期结果：
- 左侧主内容（58%宽度）
- 右侧说明（42%宽度）
- 左右并排显示

**步骤 2：小屏测试（<576px）**
```
1. 按 F12 打开开发者工具
2. 点击设备工具栏图标
3. 选择 iPhone SE（375px）
4. 观察布局
```

✅ 预期结果：
- 主内容在上
- 说明区在下
- 垂直堆叠显示

---

## 🔍 详细检查项

### 代码检查

```bash
# 检查是否删除了创建钱包页面
ls -la /home/xiaodong/文档/memopark/memopark-governance/src/pages/Wallet/Create/
# 预期：No such file or directory

# 检查路由配置
grep -n "CreateWallet" /home/xiaodong/文档/memopark/memopark-governance/src/App.tsx
# 预期：无结果

# 检查菜单配置
grep -n "创建钱包" /home/xiaodong/文档/memopark/memopark-governance/src/layouts/BasicLayout/index.tsx
# 预期：无结果

# 检查钱包管理页面
grep -n "创建钱包" /home/xiaodong/文档/memopark/memopark-governance/src/pages/Wallet/Manage/index.tsx
# 预期：无结果
```

### TypeScript 检查

```bash
cd /home/xiaodong/文档/memopark/memopark-governance
npm run build
# 预期：无错误，编译成功
```

---

## 📝 测试报告模板

### 测试环境
- 浏览器：________
- 浏览器版本：________
- 屏幕分辨率：________
- 测试日期：________

### 测试结果

| 测试项 | 结果 | 备注 |
|-------|-----|------|
| 恢复页面可访问 | ⬜ 通过 / ⬜ 失败 | |
| 创建页面404 | ⬜ 通过 / ⬜ 失败 | |
| 菜单无创建选项 | ⬜ 通过 / ⬜ 失败 | |
| 管理页面无创建按钮 | ⬜ 通过 / ⬜ 失败 | |
| 恢复钱包流程 | ⬜ 通过 / ⬜ 失败 | |
| 账户数据共享 | ⬜ 通过 / ⬜ 失败 | |
| 密码独立性 | ⬜ 通过 / ⬜ 失败 | |
| 响应式布局 | ⬜ 通过 / ⬜ 失败 | |

### 发现的问题
1. 
2. 
3. 

### 建议
1. 
2. 
3. 

---

## 🆘 问题排查

### 问题 1：恢复页面404

**可能原因：**
- 路由配置错误
- 组件导入失败

**排查步骤：**
```bash
# 检查路由配置
cat /home/xiaodong/文档/memopark/memopark-governance/src/App.tsx | grep -A 2 "wallet/recover"

# 检查组件文件
ls -la /home/xiaodong/文档/memopark/memopark-governance/src/pages/Wallet/Recover/index.tsx

# 检查开发服务器日志
# 查看终端是否有错误信息
```

### 问题 2：助记词验证失败

**可能原因：**
- 助记词格式错误
- 单词拼写错误
- 单词数量不对

**排查步骤：**
```
1. 确认助记词是12个单词
2. 单词之间用空格分隔
3. 单词全部小写
4. 无多余空格或换行符
```

### 问题 3：账户数据不共享

**可能原因：**
- localStorage 隔离（不同域名）
- 浏览器隐私模式

**排查步骤：**
```bash
# 检查 localStorage
# 在浏览器控制台运行：
console.log('dapp keystores:', localStorage.getItem('mp.keystores'))
console.log('governance keystores:', localStorage.getItem('mp.keystores'))

# 应该显示相同的数据
```

**解决方案：**
- 确保两个应用在同一台机器的同一浏览器打开
- 使用相同的浏览器配置文件
- 不使用隐私/无痕模式

---

## ✅ 验收标准

### 必须满足（P0）

- [ ] 创建钱包页面已删除（访问返回404）
- [ ] 恢复钱包页面正常工作
- [ ] 侧边栏菜单无"创建钱包"选项
- [ ] 钱包管理页面无"创建钱包"按钮
- [ ] 可以使用助记词恢复钱包
- [ ] 恢复后可以正常使用治理功能
- [ ] 无 TypeScript 编译错误

### 应该满足（P1）

- [ ] 界面说明清晰，用户知道为何仅恢复
- [ ] 响应式布局正常（大屏、小屏）
- [ ] 与 dapp 账户数据共享
- [ ] 密码可以独立设置

### 可以满足（P2）

- [ ] 界面美观
- [ ] 动画流畅
- [ ] 错误提示友好

---

## 📞 支持

如有问题，请查看：
- 改造文档：`/home/xiaodong/文档/memopark/docs/治理平台钱包功能简化-仅恢复.md`
- 使用指南：`/home/xiaodong/文档/memopark/memopark-governance/钱包管理功能使用说明.md`

或在浏览器控制台查看错误日志（F12 → Console）。

