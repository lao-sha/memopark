# Memopark 治理平台 - 使用说明

## ✅ 项目已启动

**开发服务器**: http://localhost:3000  
**状态**: ✅ 运行中  
**进程**: Vite (PID: 正在运行)  

---

## 🚀 快速开始

### 1. 打开应用

在浏览器中访问：
```
http://localhost:3000
```

### 2. 安装钱包扩展

#### Polkadot.js Extension（推荐）

1. 访问：https://polkadot.js.org/extension/
2. 点击"Download for Chrome"（或对应浏览器）
3. 安装扩展
4. 创建或导入账户

#### 快速导入账户（测试用）

在扩展中导入测试账户：
```
助记词: //Alice
或使用私钥导入现有账户
```

### 3. 连接钱包

1. 在应用右上角点击"连接钱包"按钮
2. 扩展弹窗会请求授权
3. 选择"是，允许该应用访问"
4. 选择要使用的账户

### 4. 开始使用

连接成功后，你会看到：
- ✅ 侧边栏导航
- ✅ 右上角显示账户名称
- ✅ 仪表盘统计数据
- ✅ 所有功能菜单可用

---

## 📖 功能使用指南

### 功能1：查看提案列表

**路径**: 侧边栏 → 提案管理 → 提案列表

**步骤**：
1. 点击侧边栏"提案管理"
2. 查看所有活跃提案
3. 每个提案显示：
   - 提案ID
   - 调用内容（批准/驳回做市商）
   - 投票进度（赞成/反对票数）
   - 状态（可执行、已投票）
4. 点击"查看详情"查看完整信息

**操作**：
- 点击"刷新"更新列表
- 点击"创建提案"跳转到创建页面
- 点击"赞成"/"反对"进行投票
- 点击"执行提案"（达到阈值后）

### 功能2：创建提案

**路径**: 侧边栏 → 提案管理 → 创建提案

**步骤**：
1. 选择提案类型：
   - 批准做市商申请
   - 驳回做市商申请

2. 选择申请编号：
   - 下拉列表自动加载待审申请
   - 显示申请人、费率等信息

3. 设置投票阈值：
   - 输入需要的投票数（推荐：2）
   - 代表 2/3 多数决

4. 设置扣罚比例（驳回时）：
   - 输入 0-10000 bps
   - 100 bps = 1%

5. 提交：
   - 点击"提交提案"
   - 扩展弹窗确认签名
   - 等待交易确认
   - 查看提案哈希

**注意事项**：
- ⚠️ 系统会自动检查重复提案
- ⚠️ 只有委员会成员可提交
- ⚠️ 提交后无法撤销

### 功能3：投票

**路径**: 提案列表 → 找到提案 → 点击"赞成"或"反对"

**步骤**：
1. 在提案列表找到要投票的提案
2. 确认提案内容（调用类型、申请编号）
3. 点击"赞成"或"反对"按钮
4. 确认投票
5. 扩展弹窗确认签名
6. 等待交易确认
7. 列表自动刷新显示新进度

**限制**：
- 每个提案只能投票一次
- 投票后会显示"已投票"标签
- 只有委员会成员可投票

### 功能4：执行提案

**路径**: 提案列表 → 找到可执行的提案 → 点击"执行提案"

**条件**：
- 提案显示"可执行"标签
- 赞成票 ≥ 阈值

**步骤**：
1. 找到已达阈值的提案
2. 点击紫色"执行提案"按钮
3. 确认执行
4. 扩展弹窗确认签名
5. 等待交易确认
6. 提案自动执行（批准或驳回做市商）

**说明**：
- 任何人都可执行（不限于委员会成员）
- 执行后提案从列表移除
- 做市商状态自动更新

### 功能5：审核申请

**路径**: 侧边栏 → 申请审核

**步骤**：
1. 查看"待审核"标签
   - 显示所有待审核的做市商申请
   - 包含申请人、押金、费率等信息

2. 查看申请详情
   - 点击"查看详情"
   - 查看CID、时间等完整信息
   - 复制CID到IPFS查看资料

3. 快速创建提案
   - 点击"创建批准提案"或"创建驳回提案"
   - 自动跳转并填充申请编号
   - 完成提案创建

4. 查看"已批准"标签
   - 显示所有已批准的做市商
   - 查看历史记录

---

## 💡 使用技巧

### 技巧1：批量处理提案

虽然当前版本不支持批量投票UI，但你可以：
1. 在提案列表快速浏览所有提案
2. 逐个点击投票（优化的UI流程很快）
3. 未来版本将支持勾选批量操作

### 技巧2：提案哈希分享

创建提案后：
1. 复制提案哈希
2. 分享给其他委员会成员
3. 他们可以在提案列表搜索并投票

### 技巧3：账户切换

如果你有多个委员会账户：
1. 点击右上角账户名
2. 选择其他账户
3. 页面自动更新权限

### 技巧4：查看交易状态

浏览器控制台会显示详细日志：
```
[API] 正在连接...
[钱包] 已连接
[Council] 查询到 3 个提案
[交易状态] InBlock
[交易状态] Finalized
✓ 交易执行成功
```

---

## 🔧 常见问题

### Q1: 连接钱包后没有反应？

**解决**：
1. 检查扩展是否授权
2. 刷新页面重试
3. 查看浏览器控制台是否有错误

### Q2: 提案列表为空？

**原因**：
- 确实没有活跃提案
- 或API连接失败

**检查**：
1. 确保链节点运行中
2. 检查环境变量 `VITE_CHAIN_WS`
3. 点击"刷新"按钮

### Q3: 无法投票？

**原因**：
- 不是委员会成员
- 或已经投过票

**检查**：
1. 查看是否显示"您不是委员会成员"提示
2. 查看提案是否显示"已投票"标签

### Q4: 创建提案失败？

**常见原因**：
- `BadOrigin` → 不是委员会成员
- `DuplicateProposal` → 提案已存在（已有自动检查）
- `TooManyProposals` → 提案数量达上限

### Q5: 交易一直在"等待"？

**原因**：
- 链节点未出块
- 或网络连接问题

**解决**：
1. 检查链节点是否运行
2. 查看控制台日志
3. 刷新页面重试

---

## 🎯 完整使用流程示例

### 场景：批准做市商 #0

```bash
# Step 1: Alice（委员会成员）创建提案
访问: http://localhost:3000/proposals/create
操作:
  - 提案类型: 批准做市商申请
  - 申请编号: #0
  - 投票阈值: 2
  - 提交
结果: 提案 #0 已创建

# Step 2: Bob（委员会成员）投赞成票
访问: http://localhost:3000/proposals
操作:
  - 找到提案 #0（批准 MM#0）
  - 点击"赞成"
  - 确认签名
结果: 进度更新 1/2

# Step 3: Charlie（委员会成员）投赞成票
访问: http://localhost:3000/proposals
操作:
  - 找到提案 #0
  - 点击"赞成"
  - 确认签名
结果: 进度更新 2/2 ✓ 可执行

# Step 4: 任何人执行提案
访问: http://localhost:3000/proposals
操作:
  - 找到提案 #0（显示"可执行"）
  - 点击"执行提案"
  - 确认签名
结果: 做市商 #0 已批准！
```

---

## 📞 技术支持

### 查看日志

浏览器控制台（F12）会显示详细日志：
- API连接状态
- 数据查询过程
- 交易执行状态
- 错误信息

### 检查链状态

```bash
# 链节点日志
cd /home/xiaodong/文档/memopark
tail -f nohup.out
```

### 参考文档

项目内文档：
- `GETTING_STARTED.md` - 开发指南
- `README.md` - 项目介绍

Docs目录：
- `docs/治理Web平台-开发完成.md` - 完整技术文档
- `docs/委员会提案使用指南.md` - 原DAPP使用指南（参考）

---

## 🎊 开始使用吧！

**应用地址**: http://localhost:3000  
**推荐浏览器**: Chrome / Edge / Firefox  
**推荐钱包**: Polkadot.js Extension  

**祝使用愉快！** 🚀

