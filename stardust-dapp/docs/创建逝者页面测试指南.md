# 创建逝者档案页面测试指南

> **测试页面**: http://127.0.0.1:5173/#/deceased/create  
> **测试时间**: 2024-01-15  
> **测试范围**: 完整功能测试

---

## 🎯 测试目标

验证创建逝者档案页面的：
1. 页面正确加载和显示
2. 表单功能完整可用
3. 日期选择器工作正常
4. 视觉效果符合设计
5. 响应式布局正确
6. 错误处理完善

---

## 🚀 测试准备

### 前置条件

1. **已连接钱包**
   - 需要先创建或导入钱包
   - 确保账户有余额

2. **已创建纪念馆**
   - 至少创建 1 个纪念馆
   - 记录纪念馆 ID

3. **开发服务器运行中**
   ```bash
   cd /home/xiaodong/文档/stardust/stardust-dapp
   npm run dev
   ```

---

## 📋 详细测试步骤

### 测试 1：页面加载

#### 1.1 直接访问

**操作：**
- 浏览器访问：`http://127.0.0.1:5173/#/deceased/create`

**预期结果：**
- ✅ 页面正确加载
- ✅ 显示顶部导航栏
- ✅ 显示进度指示器（步骤 1 高亮）
- ✅ 显示提示信息
- ✅ 显示创建表单
- ✅ 显示使用说明
- ✅ 页面进入有淡入动画

#### 1.2 视觉效果检查

**检查项：**
- [ ] 整体色调符合主题（深金色、墨绿色）
- [ ] 卡片有圆角和阴影
- [ ] 渐变效果显示正常
- [ ] 文字清晰易读
- [ ] 图标显示正确

#### 1.3 错峰动画检查

**检查项：**
- [ ] 步骤卡片（延迟 0.1s）
- [ ] 信息提示（延迟 0.2s）
- [ ] 表单卡片（延迟 0.35s）
- [ ] 说明卡片（延迟 0.4s）
- [ ] 动画流畅不卡顿

---

### 测试 2：表单功能

#### 2.1 关联纪念馆字段

**测试操作：**
1. 点击"关联纪念馆"下拉框
2. 查看纪念馆列表
3. 点击"刷新列表"按钮
4. 搜索纪念馆
5. 选择一个纪念馆

**预期结果：**
- ✅ 如果已连接钱包，显示我的纪念馆列表
- ✅ 如果未连接，显示"请先连接钱包"
- ✅ 刷新按钮工作正常（有 loading 状态）
- ✅ 搜索功能正常
- ✅ 显示格式：`#ID · 名称 · Slug`
- ✅ 选择后表单值更新

**焦点效果：**
- [ ] 点击时边框变深金色
- [ ] 有光晕效果

#### 2.2 逝者姓名字段

**测试操作：**
1. 点击姓名输入框
2. 不输入，点击提交
3. 输入姓名（如：张三）
4. 清空后重新输入

**预期结果：**
- ✅ 必填验证生效（提示"请填写逝者姓名"）
- ✅ 焦点效果正确（深金色边框 + 光晕）
- ✅ 输入正常
- ✅ 字体加粗（font-weight: 500）

#### 2.3 性别选择

**测试操作：**
1. 查看性别选项
2. 悬停在各个选项上
3. 点击"男"
4. 点击"女"
5. 点击"保密"

**预期结果：**
- ✅ 默认选中"保密"
- ✅ 悬停时边框和文字变色
- ✅ 选中时显示深金色渐变背景
- ✅ 显示对应图标（男/女图标）
- ✅ 按钮宽度均等

#### 2.4 出生日期选择

**测试操作：**
1. 点击出生日期选择器
2. 在日历中选择日期
3. 查看表单值
4. 尝试手动输入

**预期结果：**
- ✅ 日历面板弹出
- ✅ 选择日期后自动格式化为 YYYYMMDD
- ✅ 隐藏字段 `birth_ts` 自动更新
- ✅ 日期选择器关闭
- ✅ 焦点效果正确

#### 2.5 离世日期选择

**测试操作：**
1. 点击离世日期选择器
2. 选择日期
3. 验证格式

**预期结果：**
- ✅ 同出生日期
- ✅ 格式为 YYYYMMDD
- ✅ 自动更新隐藏字段 `death_ts`

#### 2.6 完整姓名 CID（可选）

**测试操作：**
1. 点击输入框
2. 输入 IPFS CID
3. 清空输入

**预期结果：**
- ✅ 可选字段，可以留空
- ✅ 焦点效果正常
- ✅ 占位符显示清楚

#### 2.7 外部链接管理

**测试操作：**
1. 查看初始状态（空状态提示）
2. 点击"添加链接"
3. 输入链接（https://example.com）
4. 添加第二条链接
5. 继续添加至 8 条
6. 尝试添加第 9 条
7. 删除一条链接

**预期结果：**
- ✅ 初始显示空状态提示
- ✅ 点击添加后出现输入框
- ✅ 输入框带链接图标
- ✅ 可以添加多条
- ✅ 达到 8 条时提示"最多添加 8 条链接"
- ✅ 添加按钮禁用
- ✅ 删除功能正常
- ✅ 每条链接有悬停效果（右移）

---

### 测试 3：表单验证

#### 3.1 必填字段验证

**测试场景 1：所有字段为空**

**操作：**
- 不填写任何内容
- 点击"创建逝者档案"按钮

**预期结果：**
- ✅ 提示"请选择纪念馆"
- ✅ 纪念馆字段标红
- ✅ 不会弹出密码框

**测试场景 2：只填写纪念馆**

**操作：**
- 选择纪念馆
- 点击提交

**预期结果：**
- ✅ 提示"请填写逝者姓名"
- ✅ 姓名字段标红

**测试场景 3：缺少日期**

**操作：**
- 选择纪念馆
- 填写姓名
- 点击提交

**预期结果：**
- ✅ 提示"请选择出生日期"
- ✅ 填写出生日期后提示"请选择离世日期"

#### 3.2 日期格式验证

**测试操作：**
1. 手动输入错误格式（如：2023-01-15）
2. 手动输入不完整日期（如：202301）

**预期结果：**
- ✅ 提示"出生日期需为 YYYYMMDD 格式"
- ✅ 不允许提交

---

### 测试 4：提交流程

#### 4.1 完整提交流程

**测试步骤：**

1. **填写完整信息**
   - 选择纪念馆
   - 填写姓名：张三
   - 选择性别：男
   - 选择出生日期：1945-10-01
   - 选择离世日期：2023-03-15

2. **点击提交**
   - 点击"创建逝者档案"按钮

3. **输入密码**
   - 密码弹窗弹出
   - 输入钱包密码（≥ 8 位）
   - 点击"确认创建"

4. **等待提交**
   - 显示"正在提交交易..."
   - 步骤更新为"提交上链"
   - 如果超过 8 秒，显示"连接较慢"提示

5. **创建成功**
   - 显示成功消息（含交易哈希）
   - 步骤更新为"创建完成"
   - 显示"正在检测IPFS固定状态..."

6. **Pin 状态显示**
   - 3 秒内检测到 Pin 事件
   - 显示 Pin 状态卡片
   - 成功或失败状态

7. **自动跳转**
   - 2 秒后自动跳转
   - 进入"我的纪念馆"页面

**预期结果：**
- ✅ 整个流程顺畅无卡顿
- ✅ 每个步骤有明确反馈
- ✅ 进度条正确更新
- ✅ 成功创建逝者档案

---

### 测试 5：错误处理

#### 5.1 钱包未连接

**测试操作：**
1. 退出登录（移除钱包）
2. 访问创建页面
3. 尝试提交

**预期结果：**
- ✅ 显示"需要连接钱包"警告
- ✅ 纪念馆下拉框禁用
- ✅ 提示"请先连接钱包"

#### 5.2 密码错误

**测试操作：**
1. 填写表单
2. 输入错误密码
3. 点击确认

**预期结果：**
- ✅ 提示"密码错误或解密失败，请重试"
- ✅ 弹窗不关闭
- ✅ 可以重新输入

#### 5.3 纪念馆加载失败

**测试操作：**
1. 模拟网络断开
2. 点击"刷新列表"

**预期结果：**
- ✅ 显示错误提示
- ✅ 提示信息清晰
- ✅ 可以重试

---

### 测试 6：交互效果

#### 6.1 卡片悬停

**测试每个卡片：**
- 步骤卡片
- 提示卡片
- 表单卡片
- 说明卡片

**预期效果：**
- ✅ 悬停时上浮
- ✅ 阴影加深
- ✅ 边框颜色变化
- ✅ 过渡流畅

#### 6.2 输入框焦点

**测试所有输入：**
- 纪念馆选择框
- 姓名输入框
- 日期选择器
- CID 输入框
- 外部链接输入框

**预期效果：**
- ✅ 焦点时边框变深金色
- ✅ 显示光晕效果
- ✅ 悬停时边框变色

#### 6.3 按钮效果

**测试按钮：**
- 提交按钮
- 添加链接按钮
- 删除链接按钮
- 刷新按钮

**预期效果：**
- ✅ 悬停时颜色/位移变化
- ✅ 点击时有反馈
- ✅ Loading 状态正确
- ✅ 禁用状态明显

---

### 测试 7：响应式布局

#### 7.1 桌面端（> 768px）

**检查项：**
- [ ] 最大宽度 900px
- [ ] 内容居中
- [ ] 日期选择器 2 列布局
- [ ] 所有样式正确

#### 7.2 平板端（≤ 768px）

**检查项：**
- [ ] 内边距调整
- [ ] 日期保持 2 列
- [ ] 字号适当缩小
- [ ] 布局不拥挤

#### 7.3 移动端（≤ 576px）

**检查项：**
- [ ] 最小内边距
- [ ] 日期改为 1 列（垂直排列）
- [ ] 性别按钮文字缩小
- [ ] 提交按钮高度 44px
- [ ] 触摸目标足够大

---

### 测试 8：使用说明

#### 8.1 必填信息章节

**检查项：**
- [ ] 红色渐变标签
- [ ] 列出 4 项必填字段
- [ ] 每项有说明文字
- [ ] 悬停有动画

#### 8.2 可选信息章节

**检查项：**
- [ ] 蓝色渐变标签
- [ ] 列出 3 项可选字段
- [ ] 说明清晰易懂

#### 8.3 重要提示章节

**检查项：**
- [ ] 金色渐变标签
- [ ] 列出 4 项注意事项
- [ ] 红色圆点标记
- [ ] 字体加粗

#### 8.4 后续操作指引

**检查项：**
- [ ] 4 个步骤完整
- [ ] 编号圆圈样式正确
- [ ] 悬停右移动画
- [ ] 网格布局（桌面端 2 列）

---

### 测试 9：特殊场景

#### 9.1 无纪念馆

**操作：**
1. 确保账户没有创建纪念馆
2. 访问创建逝者页面

**预期结果：**
- ✅ 纪念馆下拉框为空
- ✅ 提示创建纪念馆
- ✅ 可点击跳转到创建纪念馆

#### 9.2 纪念馆达到上限

**操作：**
1. 选择已达上限的纪念馆
2. 提交创建

**预期结果：**
- ✅ 提示"已达上限"
- ✅ 引导联系管理员或清理

#### 9.3 网络异常

**操作：**
1. 断开网络
2. 尝试提交

**预期结果：**
- ✅ 提示网络错误
- ✅ 建议检查节点连接
- ✅ 可以重试

---

## 📊 测试记录表

### 基础功能测试

| 测试项 | 通过 | 失败 | 备注 |
|--------|------|------|------|
| 页面加载 | □ | □ | |
| 进度显示 | □ | □ | |
| 纪念馆选择 | □ | □ | |
| 姓名输入 | □ | □ | |
| 性别选择 | □ | □ | |
| 出生日期 | □ | □ | |
| 离世日期 | □ | □ | |
| CID 输入 | □ | □ | |
| 外部链接 | □ | □ | |
| 表单提交 | □ | □ | |

### 交互效果测试

| 测试项 | 通过 | 失败 | 备注 |
|--------|------|------|------|
| 卡片悬停 | □ | □ | |
| 输入框焦点 | □ | □ | |
| 按钮效果 | □ | □ | |
| 动画流畅 | □ | □ | |
| 进度更新 | □ | □ | |

### 错误处理测试

| 测试项 | 通过 | 失败 | 备注 |
|--------|------|------|------|
| 必填验证 | □ | □ | |
| 格式验证 | □ | □ | |
| 钱包未连 | □ | □ | |
| 密码错误 | □ | □ | |
| 网络异常 | □ | □ | |

### 响应式测试

| 测试项 | 通过 | 失败 | 备注 |
|--------|------|------|------|
| 桌面端 | □ | □ | |
| 平板端 | □ | □ | |
| 移动端 | □ | □ | |

---

## 🐛 常见问题排查

### 问题 1：日期选择器不显示

**可能原因：**
- dayjs 未正确导入
- DatePicker 组件导入错误

**解决方案：**
1. 检查 import 语句
2. 确认 dayjs 已安装
3. 查看 Console 错误

### 问题 2：纪念馆列表为空

**可能原因：**
- 账户未创建纪念馆
- 链连接异常
- 权限问题

**解决方案：**
1. 先创建纪念馆
2. 检查钱包连接
3. 点击刷新按钮

### 问题 3：样式显示异常

**可能原因：**
- CSS 文件未导入
- 类名不匹配

**解决方案：**
1. 确认 CreateDeceasedPage.css 已导入
2. 检查 className 是否正确
3. 查看浏览器开发工具

### 问题 4：提交没反应

**可能原因：**
- JavaScript 错误
- 表单验证未通过
- 网络问题

**解决方案：**
1. 打开浏览器 Console
2. 检查错误信息
3. 验证表单填写

---

## ✅ 完整测试流程

### 正常创建流程

**步骤：**

1. ✅ 访问页面
2. ✅ 查看进度（步骤 1）
3. ✅ 阅读提示信息
4. ✅ 选择关联纪念馆
5. ✅ 填写逝者姓名
6. ✅ 选择性别
7. ✅ 选择出生日期（DatePicker）
8. ✅ 选择离世日期（DatePicker）
9. ✅ （可选）填写完整姓名 CID
10. ✅ （可选）添加外部链接
11. ✅ 点击"创建逝者档案"
12. ✅ 输入密码
13. ✅ 等待提交（进度更新）
14. ✅ 检测 Pin 状态
15. ✅ 显示成功消息
16. ✅ 自动跳转

**耗时：** 约 10-20 秒（取决于网络）

---

## 🎯 验收标准

### 必须达标
- ✅ 所有表单字段功能正常
- ✅ DatePicker 工作正确
- ✅ 表单验证完整
- ✅ 提交流程顺畅
- ✅ 错误处理完善
- ✅ 视觉效果符合设计
- ✅ 响应式布局正确

### 期望达标
- ✅ 动画流畅不卡顿
- ✅ 交互反馈及时
- ✅ 使用说明清晰
- ✅ 用户体验优秀

---

## 📝 测试报告模板

### 测试环境
- 操作系统：______
- 浏览器：______
- 版本号：______
- 屏幕分辨率：______

### 测试结果汇总
- 功能测试：□ 通过 □ 失败
- 交互测试：□ 通过 □ 失败
- 错误测试：□ 通过 □ 失败
- 响应式测试：□ 通过 □ 失败

### 发现的问题
1. ______
2. ______

### 总体评价
- 功能完整性：□ 优秀 □ 良好 □ 一般
- 视觉效果：□ 优秀 □ 良好 □ 一般
- 用户体验：□ 优秀 □ 良好 □ 一般

---

**测试指南版本**: v1.0  
**编写时间**: 2024-01-15  
**适用页面**: 创建逝者档案

