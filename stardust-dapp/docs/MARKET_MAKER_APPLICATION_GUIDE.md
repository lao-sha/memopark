# åšå¸‚å•†ç”³è¯·æŒ‡å—

## è®¿é—®è·¯å¾„

```
#/otc/mm-apply
```

## åŠŸèƒ½æ¦‚è¿°

åšå¸‚å•†ç”³è¯·é‡‡ç”¨**ä¸¤æ­¥å¼æµç¨‹**ï¼Œç¡®ä¿ç”³è¯·äººæœ‰å……è¶³æ—¶é—´å‡†å¤‡èµ„æ–™ï¼ŒåŒæ—¶ä¿éšœå¹³å°èµ„é‡‘å®‰å…¨ã€‚

---

## ç”³è¯·æµç¨‹

### æ­¥éª¤ 1ï¼šè´¨æŠ¼ä¿è¯é‡‘

#### æ“ä½œæ­¥éª¤
1. è®¿é—® `#/otc/mm-apply`
2. è¾“å…¥è´¨æŠ¼é‡‘é¢ï¼ˆæœ€ä½ 1000 DUSTï¼‰
3. ç‚¹å‡»"ç­¾åè´¨æŠ¼"
4. è¾“å…¥æœ¬åœ°é’±åŒ…å¯†ç å®Œæˆç­¾å
5. ç­‰å¾…é“¾ä¸Šç¡®è®¤

#### é“¾ä¸Šè°ƒç”¨
```typescript
api.tx.marketMaker.lockDeposit(amount)
```

#### æ•ˆæœ
- é”å®šè´¨æŠ¼é‡‘é¢ï¼ˆä½¿ç”¨ `reserve` æœºåˆ¶ï¼‰
- ç”Ÿæˆ `mm_id`ï¼ˆç”³è¯·ç¼–å·ï¼‰
- è®¾ç½® 24 å°æ—¶èµ„æ–™æäº¤çª—å£
- çŠ¶æ€å˜æ›´ä¸º `DepositLocked`

#### æ³¨æ„äº‹é¡¹
- âš ï¸ è´¨æŠ¼é‡‘é¢å°†è¢«é”å®šï¼Œç›´åˆ°ç”³è¯·è¢«æ‰¹å‡†æˆ–é©³å›
- âš ï¸ 24 å°æ—¶å†…å¿…é¡»æäº¤èµ„æ–™ï¼Œå¦åˆ™å¯èƒ½è¢«æ‰£é™¤æ‰‹ç»­è´¹
- âœ… è´¨æŠ¼æˆåŠŸåï¼Œé¡µé¢ä¼šæ˜¾ç¤º `mm_id` å’Œæˆªæ­¢æ—¶é—´

---

### æ­¥éª¤ 2ï¼šæäº¤èµ„æ–™

#### å‡†å¤‡èµ„æ–™

##### 1. å…¬å¼€èµ„æ–™ï¼ˆpublic_root_cidï¼‰
åˆ›å»ºä¸€ä¸ª IPFS ç›®å½•ï¼ŒåŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

```
public/
â”œâ”€â”€ mm.json          # åšå¸‚å•†åŸºæœ¬ä¿¡æ¯
â”œâ”€â”€ logo.png         # Logo å›¾æ ‡ï¼ˆæ¨è 256x256ï¼‰
â”œâ”€â”€ banner.png       # æ¨ªå¹…å›¾ï¼ˆæ¨è 1200x400ï¼‰
â”œâ”€â”€ fee.json         # è´¹ç‡è¯´æ˜
â””â”€â”€ pairs.json       # æ”¯æŒçš„äº¤æ˜“å¯¹åˆ—è¡¨
```

**mm.json ç¤ºä¾‹**ï¼š
```json
{
  "name": "ç¤ºä¾‹åšå¸‚å•†",
  "description": "ä¸“ä¸šçš„æ•°å­—èµ„äº§åšå¸‚æœåŠ¡",
  "website": "https://example.com",
  "contact": "support@example.com",
  "established": "2024-01-01",
  "social": {
    "twitter": "https://twitter.com/example",
    "telegram": "https://t.me/example"
  }
}
```

**fee.json ç¤ºä¾‹**ï¼š
```json
{
  "fee_bps": 25,
  "fee_percentage": "0.25%",
  "description": "æ¯ç¬”äº¤æ˜“æ”¶å– 0.25% æ‰‹ç»­è´¹",
  "min_amount": "100.00 DUST",
  "max_amount": "1000000.00 DUST"
}
```

**ä¸Šä¼ åˆ° IPFS**ï¼š
```bash
ipfs add -r public/
# è·å–æ ¹ç›®å½•çš„ CIDï¼Œä¾‹å¦‚ï¼š
# bafybeigdyrzt5sfp7udm7hu76uh7y26nf3efuylqabf3oclgtqy55fbzdi
```

##### 2. ç§å¯†èµ„æ–™ï¼ˆprivate_root_cidï¼‰
åˆ›å»ºç§å¯†æ–‡ä»¶å¹¶åŠ å¯†ï¼š

```
private/
â”œâ”€â”€ manifest.json    # æ–‡ä»¶æ¸…å•ï¼ˆæ˜æ–‡ï¼‰
â”œâ”€â”€ license.enc      # è¥ä¸šæ‰§ç…§ï¼ˆåŠ å¯†ï¼‰
â”œâ”€â”€ identity.enc     # èº«ä»½è¯æ˜ï¼ˆåŠ å¯†ï¼‰
â”œâ”€â”€ proof.enc        # èµ„é‡‘è¯æ˜ï¼ˆåŠ å¯†ï¼‰
â””â”€â”€ contact.enc      # è¯¦ç»†è”ç³»æ–¹å¼ï¼ˆåŠ å¯†ï¼‰
```

**åŠ å¯†æµç¨‹**ï¼š
```bash
# 1. ç”ŸæˆåŠ å¯†å¯†é’¥ï¼ˆä½¿ç”¨å§”å‘˜ä¼šå…¬é’¥ï¼‰
# 2. åŠ å¯†æ–‡ä»¶
openssl enc -aes-256-cbc -salt -in license.pdf -out license.enc -k <password>

# 3. åˆ›å»º manifest.json
{
  "files": [
    {
      "name": "license.enc",
      "original": "license.pdf",
      "sha256": "...",
      "encrypted": true,
      "description": "è¥ä¸šæ‰§ç…§"
    },
    {
      "name": "identity.enc",
      "original": "identity.pdf",
      "sha256": "...",
      "encrypted": true,
      "description": "èº«ä»½è¯æ˜æ–‡ä»¶"
    }
  ],
  "encryption": {
    "algorithm": "AES-256-CBC",
    "note": "ä½¿ç”¨å§”å‘˜ä¼šå…¬é’¥åŠ å¯†"
  }
}

# 4. ä¸Šä¼ åˆ° IPFS
ipfs add -r private/
```

**é‡è¦è§„åˆ™**ï¼š
- âœ… CID ä¸€å¾‹ä¸åŠ å¯†ï¼ˆæ˜æ–‡ IPFS CIDï¼‰
- âœ… æ–‡ä»¶å†…å®¹åŠ å¯†ï¼ŒCID æŒ‡å‘å¯†æ–‡æ–‡ä»¶
- âœ… ç¦æ­¢ä½¿ç”¨ `enc:` å‰ç¼€
- âœ… æ”¯æŒ CIDv0ï¼ˆQm...ï¼‰å’Œ CIDv1ï¼ˆbafy...ï¼‰

#### å¡«å†™è¡¨å•

1. **å…¬å¼€èµ„æ–™æ ¹ CID**
   - ç²˜è´´ä¸Šä¼ åçš„å…¬å¼€ç›®å½• CID
   - æ ¼å¼ï¼š`bafy...` æˆ– `Qm...`
   - é•¿åº¦ï¼š46+ å­—ç¬¦

2. **ç§å¯†èµ„æ–™æ ¹ CID**
   - ç²˜è´´ä¸Šä¼ åçš„ç§å¯†ç›®å½• CID
   - æ ¼å¼ï¼š`bafy...` æˆ– `Qm...`
   - é•¿åº¦ï¼š46+ å­—ç¬¦

3. **è´¹ç‡ï¼ˆbpsï¼‰**
   - èŒƒå›´ï¼š0-10000 bps
   - ç¤ºä¾‹ï¼š25 bps = 0.25%
   - è¯´æ˜ï¼š1 bps = 0.01%

4. **æœ€å°ä¸‹å•é¢ï¼ˆDUSTï¼‰**
   - æœ€å°å€¼ï¼š0.01 DUST
   - ç¤ºä¾‹ï¼š100.00 DUST
   - è¯´æ˜ï¼šç”¨æˆ·å•ç¬”äº¤æ˜“çš„æœ€å°é‡‘é¢é™åˆ¶

#### æäº¤æ“ä½œ

1. å¡«å†™å®Œæ•´è¡¨å•
2. ç‚¹å‡»"æäº¤èµ„æ–™"
3. è¾“å…¥æœ¬åœ°é’±åŒ…å¯†ç å®Œæˆç­¾å
4. ç­‰å¾…é“¾ä¸Šç¡®è®¤

#### é“¾ä¸Šè°ƒç”¨
```typescript
api.tx.marketMaker.submitInfo(
  mm_id,
  public_root_cid,
  private_root_cid,
  fee_bps,
  min_amount
)
```

#### æ•ˆæœ
- çŠ¶æ€å˜æ›´ä¸º `PendingReview`
- è¿›å…¥å§”å‘˜ä¼šå®¡æ ¸é˜Ÿåˆ—
- å‘å‡º `Submitted` äº‹ä»¶

---

## å®¡æ ¸æµç¨‹

### å§”å‘˜ä¼šå®¡æ ¸

1. **è®¿é—®å®¡æ ¸é¡µé¢**
   - è·¯å¾„ï¼š`#/gov/mm-review`
   - æƒé™ï¼šå§”å‘˜ä¼šæˆå‘˜

2. **å®¡æŸ¥èµ„æ–™**
   - ä¸‹è½½å…¬å¼€èµ„æ–™ï¼ˆIPFS ç½‘å…³ï¼‰
   - ä¸‹è½½ç§å¯†èµ„æ–™ï¼ˆåŠ å¯†æ–‡ä»¶ï¼‰
   - ç¦»çº¿è§£å¯†å¹¶éªŒè¯
   - æ ¸å¯¹æ–‡ä»¶å“ˆå¸Œä¸ manifest

3. **å®¡æ‰¹å†³ç­–**
   - **æ‰¹å‡†**ï¼š`api.tx.marketMaker.approve(mm_id)`
     - çŠ¶æ€å˜æ›´ä¸º `Active`
     - æŠ¼é‡‘è½¬ä¸ºé•¿æœŸä¿è¯é‡‘
     - åšå¸‚å•†å¯ä»¥å¼€å§‹æ¥å•
   - **é©³å›**ï¼š`api.tx.marketMaker.reject(mm_id, slash_bps)`
     - çŠ¶æ€å˜æ›´ä¸º `Rejected`
     - æŒ‰æ¯”ä¾‹æ‰£ç½šæŠ¼é‡‘ï¼ˆ0-100%ï¼‰
     - ä½™é¢é€€è¿˜ç”³è¯·äºº

### å®¡æ ¸æ ‡å‡†

âœ… **é€šè¿‡æ¡ä»¶**ï¼š
- å…¬å¼€èµ„æ–™å®Œæ•´ä¸”çœŸå®
- ç§å¯†èµ„æ–™é½å…¨å¯éªŒè¯
- è¥ä¸šæ‰§ç…§/èº«ä»½è¯æ˜æœ‰æ•ˆ
- èµ„é‡‘è¯æ˜å……è¶³
- è´¹ç‡åˆç†
- æ— æ¬ºè¯ˆè®°å½•

âŒ **é©³å›åŸå› **ï¼š
- èµ„æ–™è™šå‡æˆ–ä¼ªé€ 
- èº«ä»½ä¿¡æ¯ä¸ç¬¦
- èµ„é‡‘è¯æ˜ä¸è¶³
- è´¹ç‡è¿‡é«˜æˆ–ä¸åˆç†
- æœ‰æ¬ºè¯ˆ/è¿è§„è®°å½•
- èµ„æ–™ä¸å®Œæ•´

---

## çŠ¶æ€æµè½¬

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  æœªç”³è¯·       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    lock_deposit
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ DepositLocked â”‚ (24h çª—å£)
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    submit_info
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ PendingReviewâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
           â”‚                                â”‚
        approve                          reject
           â”‚                                â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    Active    â”‚              â”‚    Rejected     â”‚
    â”‚  (å¯æ¥å•)     â”‚              â”‚  (æ‰£ç½š+é€€æ¬¾)    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å¸¸è§é—®é¢˜

### Q1: è´¨æŠ¼é‡‘é¢ä¼šè¢«é€€è¿˜å—ï¼Ÿ
**A**: 
- âœ… ç”³è¯·é€šè¿‡ï¼šæŠ¼é‡‘è½¬ä¸ºé•¿æœŸä¿è¯é‡‘ï¼ˆå¯æç°ä½†éœ€ä¿æŒæœ€ä½ä½™é¢ï¼‰
- âŒ ç”³è¯·é©³å›ï¼šæŒ‰æ¯”ä¾‹æ‰£ç½šåé€€è¿˜ä½™é¢
- â±ï¸ è¶…æ—¶æœªæäº¤ï¼šå¯èƒ½æ‰£é™¤æ‰‹ç»­è´¹åé€€è¿˜

### Q2: å¦‚ä½•å‡†å¤‡ç§å¯†èµ„æ–™ï¼Ÿ
**A**: 
1. æ‰«æ/æ‹æ‘„åŸå§‹æ–‡ä»¶ï¼ˆPDF/JPGï¼‰
2. ä½¿ç”¨å§”å‘˜ä¼šå…¬é’¥åŠ å¯†
3. åˆ›å»º manifest.json è®°å½•æ–‡ä»¶æ¸…å•
4. ä¸Šä¼ åˆ° IPFS è·å– CID
5. å°†æ˜æ–‡ CID å¡«å…¥è¡¨å•

### Q3: CID æ ¼å¼è¦æ±‚æ˜¯ä»€ä¹ˆï¼Ÿ
**A**:
- âœ… æ”¯æŒ CIDv0ï¼š`Qm...`ï¼ˆBase58btcï¼Œ44+ å­—ç¬¦ï¼‰
- âœ… æ”¯æŒ CIDv1ï¼š`bafy...`ï¼ˆBase32ï¼Œ46+ å­—ç¬¦ï¼‰
- âŒ ç¦æ­¢ï¼š`enc:...`ï¼ˆåŠ å¯†å‰ç¼€ï¼‰
- âŒ ç¦æ­¢ï¼šéæ³•å­—ç¬¦æˆ–é•¿åº¦ä¸è¶³

### Q4: æäº¤èµ„æ–™åå¤šä¹…èƒ½å¾—åˆ°å®¡æ ¸ç»“æœï¼Ÿ
**A**:
- é€šå¸¸ 3-7 ä¸ªå·¥ä½œæ—¥
- å¤æ‚æ¡ˆä¾‹å¯èƒ½å»¶é•¿è‡³ 14 å¤©
- å¯åœ¨"æˆ‘çš„ç”³è¯·"ä¸­æŸ¥çœ‹è¿›åº¦

### Q5: ç”³è¯·è¢«é©³å›åå¯ä»¥é‡æ–°ç”³è¯·å—ï¼Ÿ
**A**:
- âœ… å¯ä»¥é‡æ–°ç”³è¯·
- âš ï¸ éœ€è¦é‡æ–°è´¨æŠ¼
- ğŸ’¡ å»ºè®®ä¿®æ­£é©³å›åŸå› åå†ç”³è¯·

---

## æŠ€æœ¯è§„æ ¼

### é“¾ä¸Šå­˜å‚¨

```rust
pub struct Application {
    pub owner: AccountId,          // ç”³è¯·äºº
    pub deposit: Balance,          // è´¨æŠ¼é‡‘é¢
    pub status: ApplicationStatus, // çŠ¶æ€
    pub public_cid: Cid,          // å…¬å¼€èµ„æ–™ CID
    pub private_cid: Cid,         // ç§å¯†èµ„æ–™ CID
    pub fee_bps: u16,             // è´¹ç‡ï¼ˆbpsï¼‰
    pub min_amount: Balance,      // æœ€å°ä¸‹å•é¢
    pub created_at: u32,          // è´¨æŠ¼æ—¶é—´ï¼ˆç§’ï¼‰
    pub info_deadline: u32,       // èµ„æ–™æˆªæ­¢æ—¶é—´
    pub review_deadline: u32,     // å®¡æ ¸æˆªæ­¢æ—¶é—´
}
```

### äº‹ä»¶

| äº‹ä»¶å | å‚æ•° | è¯´æ˜ |
|--------|------|------|
| `Applied` | `mm_id, owner, deposit` | è´¨æŠ¼æˆåŠŸ |
| `Submitted` | `mm_id` | èµ„æ–™æäº¤æˆåŠŸ |
| `Approved` | `mm_id` | ç”³è¯·æ‰¹å‡† |
| `Rejected` | `mm_id, slash` | ç”³è¯·é©³å› |
| `Cancelled` | `mm_id` | ç”³è¯·å–æ¶ˆ |
| `Expired` | `mm_id` | ç”³è¯·è¿‡æœŸ |

### é”™è¯¯ç 

| é”™è¯¯å | è¯´æ˜ |
|--------|------|
| `AlreadyMember` | å·²æ˜¯åšå¸‚å•† |
| `NotFound` | ç”³è¯·ä¸å­˜åœ¨ |
| `NotDepositLocked` | çŠ¶æ€ä¸æ˜¯ DepositLocked |
| `NotPendingReview` | çŠ¶æ€ä¸æ˜¯ PendingReview |
| `AlreadyFinalized` | ç”³è¯·å·²ç»ˆç»“ |
| `DeadlinePassed` | è¶…è¿‡æˆªæ­¢æ—¶é—´ |
| `InvalidFee` | è´¹ç‡è¶…å‡ºèŒƒå›´ |
| `BadSlashRatio` | æ‰£ç½šæ¯”ä¾‹è¶…å‡ºé™åˆ¶ |
| `MinDepositNotMet` | æŠ¼é‡‘ä½äºæœ€å°å€¼ |

---

## å¼€å‘è€…æ³¨æ„äº‹é¡¹

### å‰ç«¯é›†æˆ

```typescript
// 1. è´¨æŠ¼
const depositAmount = formatMemoAmount(1000) // 1000 DUST
const hash = await signAndSendLocalFromKeystore(
  'marketMaker', 
  'lockDeposit', 
  [depositAmount]
)

// 2. æäº¤èµ„æ–™
const publicCid = Array.from(new TextEncoder().encode('bafy...'))
const privateCid = Array.from(new TextEncoder().encode('bafy...'))
const hash = await signAndSendLocalFromKeystore(
  'marketMaker', 
  'submitInfo', 
  [mmId, publicCid, privateCid, feeBps, minAmount]
)
```

### ä½™é¢æ ¼å¼

DUST ä½¿ç”¨ **12 ä½å°æ•°**ï¼š
```typescript
1 DUST = 1,000,000,000,000 (1e12)
0.001 DUST = 1,000,000,000 (1e9)
```

### CID ç¼–ç 

```typescript
// å­—ç¬¦ä¸² â†’ Uint8Array
const cidBytes = Array.from(new TextEncoder().encode(cidString))

// Uint8Array â†’ å­—ç¬¦ä¸²
const cidString = new TextDecoder().decode(new Uint8Array(cidBytes))
```

---

## å®‰å…¨å»ºè®®

1. âœ… **æœ¬åœ°ç­¾å**ï¼šä½¿ç”¨æœ¬åœ° keystoreï¼Œä¸ä¾èµ–æµè§ˆå™¨æ‰©å±•
2. âœ… **èµ„æ–™åŠ å¯†**ï¼šç§å¯†æ–‡ä»¶ä½¿ç”¨å§”å‘˜ä¼šå…¬é’¥åŠ å¯†
3. âœ… **CID éªŒè¯**ï¼šæäº¤å‰éªŒè¯ CID å¯è®¿é—®
4. âœ… **å¤‡ä»½èµ„æ–™**ï¼šä¿ç•™åŸå§‹æ–‡ä»¶å’ŒåŠ å¯†å¯†é’¥
5. âš ï¸ **é˜²æ­¢æ³„éœ²**ï¼šä¸è¦åœ¨å…¬å¼€æ¸ é“åˆ†äº«ç§å¯† CID çš„è§£å¯†å¯†é’¥

---

## è”ç³»æ”¯æŒ

å¦‚æœ‰ç–‘é—®ï¼Œè¯·è”ç³»ï¼š
- ğŸ“§ Email: support@stardust.com
- ğŸ’¬ Telegram: @stardust_support
- ğŸ“– æ–‡æ¡£: https://docs.stardust.com

---

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-09-30)
- âœ¨ åˆå§‹ç‰ˆæœ¬
- âœ¨ å®ç°ä¸¤æ­¥å¼ç”³è¯·æµç¨‹
- âœ¨ é›†æˆé“¾ä¸Šè°ƒç”¨
- âœ¨ å®Œæ•´çš„è¡¨å•éªŒè¯
- âœ¨ å‹å¥½çš„ç”¨æˆ·ä½“éªŒ
